{
  "compatibilityLevel": 1601,
  "model": {
    "annotations": [
      {
        "name": "__PBI_TimeIntelligenceEnabled",
        "value": "0"
      },
      {
        "name": "PBIDesktopVersion",
        "value": "2.139.1678.0 (24.12)+2a034ab280bddf891eb7bb9ebfe6996f9c3a3196"
      },
      {
        "name": "PBI_QueryOrder",
        "value": "[\"Customer\",\"Date 👍\",\"Employee\",\"Geography\",\"ProductCategory 😀\",\"ProductSubcategory\",\"Product\",\"InternetSales 😀\",\"All ToDate Measures\",\"All Last (Previous) Measures\",\"All Running Measures\",\"All Average Measures\",\"All Rank (Top) Measures\",\"ProductCategory2\",\"All ALL Measures\",\"All FILTER Measures\",\"InternetSales_Current\",\"All Correct Totals\",\"DOCUMENTATION 👍😎\",\"List of Pages:\",\"List of all Columns/Fields/Measures/Expressions Used in Visuals:\",\"List of Measures:\",\"PageDetailsForMeasures\",\"Function_Dates_EDNA\",\"Dates_EDNA\",\"dax\",\"Imke_function\",\"Dates_IMKE\",\"DISCONNECTED Countries\",\"ChatGPT_LatLong_WRONG\",\"Errors in Geography\",\"ChatGPT_LatLong\",\"Errors in Geography (2)\",\"DAX Debugger\",\"DAX Debugger DATESYTD\",\"Customer earliest order per year\",\"2020 Summer Olympics\",\"Calendar53\",\"Dates_AVI\",\"MeasureKiller\",\"Dates_DeGroot\",\"CalendarLanguage\",\"Tally (in M)\",\"Countries PQ\",\"PQ input data then custom grouping\",\"Time - Radacad\",\"Time - seconds\",\"Time - minutes\",\"Dates_Haq_fn\",\"Dates_Haq\",\"Stock\"]"
      },
      {
        "name": "__TEdtr",
        "value": "1"
      },
      {
        "name": "PBI_ProTooling",
        "value": "[\"DaxQueryView_Desktop\",\"CalcGroup\",\"DevMode\"]"
      }
    ],
    "culture": "en-US",
    "cultures": [
      {
        "name": "en-US",
        "linguisticMetadata": {
          "content": {
            "Language": "en-US",
            "Version": "1.0.0"
          },
          "contentType": "json"
        }
      }
    ],
    "dataAccessOptions": {
      "legacyRedirects": true,
      "returnErrorValuesAsNull": true
    },
    "defaultPowerBIDataSourceVersion": "powerBI_V3",
    "discourageImplicitMeasures": true,
    "expressions": [
      {
        "name": "List of Pages:",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Source = File.Contents(\"C:\\SCRATCH-TMP\\AdventureworksDWv18_HELPER.htm\"),",
          "    #\"Extracted Table From Html\" = Html.Table(Source, {{\"Column1\", \"TABLE:nth-child(23) > * > TR > :nth-child(1)\"}, {\"Column2\", \"TABLE:nth-child(23) > * > TR > :nth-child(2)\"}, {\"Column3\", \"TABLE:nth-child(23) > * > TR > :nth-child(3)\"}, {\"Column4\", \"TABLE:nth-child(23) > * > TR > :nth-child(4)\"}, {\"Column5\", \"TABLE:nth-child(23) > * > TR > :nth-child(5)\"}, {\"Column6\", \"TABLE:nth-child(23) > * > TR > :nth-child(6)\"}, {\"Column7\", \"TABLE:nth-child(23) > * > TR > :nth-child(7)\"}}, [RowSelector=\"TABLE:nth-child(23) > * > TR\"]),",
          "    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Extracted Table From Html\", [PromoteAllScalars=true]),",
          "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Promoted Headers\",{{\"DisplayName\", type text}, {\"Name\", type text}, {\"Ordinal\", Int64.Type}, {\"DisplayOption\", Int64.Type}, {\"Width\", Int64.Type}, {\"Height\", Int64.Type}, {\"PageIndex\", Int64.Type}}),",
          "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Name\", \"DisplayOption\", \"Width\", \"Height\", \"Ordinal\"})",
          "in",
          "    #\"Removed Columns\""
        ],
        "kind": "m",
        "lineageTag": "1fe08436-a148-4559-9dfd-c26d31a29c30"
      },
      {
        "name": "List of all Columns/Fields/Measures/Expressions Used in Visuals:",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Source = File.Contents(\"C:\\SCRATCH-TMP\\AdventureworksDWv18_HELPER.htm\"),",
          "    #\"Extracted Table From Html\" = Html.Table(Source, {{\"Column1\", \"TABLE:nth-child(303) > * > TR > :nth-child(1)\"}, {\"Column2\", \"TABLE:nth-child(303) > * > TR > :nth-child(2)\"}, {\"Column3\", \"TABLE:nth-child(303) > * > TR > :nth-child(3)\"}, {\"Column4\", \"TABLE:nth-child(303) > * > TR > :nth-child(4)\"}, {\"Column5\", \"TABLE:nth-child(303) > * > TR > :nth-child(5)\"}, {\"Column6\", \"TABLE:nth-child(303) > * > TR > :nth-child(6)\"}}, [RowSelector=\"TABLE:nth-child(303) > * > TR\"]),",
          "    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Extracted Table From Html\", [PromoteAllScalars=true]),",
          "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Promoted Headers\",{{\"Name\", type text}, {\"Table Name\", type text}, {\"Aggregation\", type text}, {\"Expression\", type text}, {\"VisualIndex\", Int64.Type}, {\"PageIndex\", Int64.Type}}),",
          "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Aggregation\", \"VisualIndex\"}),",
          "    #\"Inserted Text After Delimiter\" = Table.AddColumn(#\"Removed Columns\", \"Text After Delimiter\", each Text.AfterDelimiter([Expression], \".\"), type text),",
          "    #\"Renamed Columns\" = Table.RenameColumns(#\"Inserted Text After Delimiter\",{{\"Text After Delimiter\", \"Name.1\"}}),",
          "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Renamed Columns\",{\"Name.1\", \"Name\", \"Table Name\", \"Expression\", \"PageIndex\"})",
          "in",
          "    #\"Reordered Columns\""
        ],
        "kind": "m",
        "lineageTag": "979c7d2a-2ce1-474d-816e-3af8f760128d"
      },
      {
        "name": "List of Measures:",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Source = File.Contents(\"C:\\SCRATCH-TMP\\AdventureworksDWv18_HELPER.htm\"),",
          "    #\"Extracted Table From Html\" = Html.Table(Source, {{\"Column1\", \"TABLE:nth-child(344) > * > TR > :nth-child(1)\"}, {\"Column2\", \"TABLE:nth-child(344) > * > TR > :nth-child(2)\"}, {\"Column3\", \"TABLE:nth-child(344) > * > TR > :nth-child(3)\"}, {\"Column4\", \"TABLE:nth-child(344) > * > TR > :nth-child(4)\"}, {\"Column5\", \"TABLE:nth-child(344) > * > TR > :nth-child(5)\"}, {\"Column6\", \"TABLE:nth-child(344) > * > TR > :nth-child(6)\"}}, [RowSelector=\"TABLE:nth-child(344) > * > TR\"]),",
          "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Extracted Table From Html\",{{\"Column1\", type text}, {\"Column2\", type text}, {\"Column3\", type text}, {\"Column4\", type text}, {\"Column5\", type text}, {\"Column6\", type text}}),",
          "    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Changed Type\", [PromoteAllScalars=true]),",
          "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Promoted Headers\",{{\"Measure Name\", type text}, {\"Table Name\", type text}, {\"Description\", type text}, {\"Expression\", type text}, {\"Dependency\", type text}, {\"Reverse Dependency\", type text}}),",
          "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type1\",{\"Description\"})",
          "in",
          "    #\"Removed Columns\""
        ],
        "kind": "m",
        "lineageTag": "09b82957-ff6c-457d-be04-91da0f9c08ab"
      },
      {
        "name": "Function_Dates_EDNA",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Function"
          }
        ],
        "expression": [
          "let fnDateTable = ( StartDate as date, EndDate as date, optional FYStartMonthNum as number, optional Holidays as list, optional WDStartNum as number, optional AddRelativeNetWorkdays as logical ) as table =>",
          "  let",
          "      FYStartMonth = List.Select( {1..12}, each _ = FYStartMonthNum ){0}? ?? 1,",
          "      WDStart = List.Select( {0..1}, each _ = WDStartNum ){0}? ?? 0,",
          "      CurrentDate = Date.From( DateTime.FixedLocalNow()),",
          "      DayCount = Duration.Days( Duration.From( EndDate - StartDate)) +1,",
          "      Source = List.Dates( StartDate, DayCount, #duration(1,0,0,0)),",
          "      AddToday = if EndDate < CurrentDate then List.Combine( {Source, {CurrentDate}}) else Source,",
          "      ToTable = Table.FromList(AddToday, Splitter.SplitByNothing(), type table [Date = Date.Type] ),",
          "      InsertYear = Table.AddColumn(ToTable, \"Year\", each Date.Year([Date]), type number),",
          "      InsertYearOffset = Table.AddColumn(InsertYear, \"CurrYearOffset\", each Date.Year([Date]) - Date.Year( Date.From(CurrentDate)), type number),",
          "      InsertCompletedYear = Table.AddColumn(InsertYearOffset, \"YearCompleted\", each Date.EndOfYear([Date]) < Date.From( Date.EndOfYear(CurrentDate)), type logical),",
          "",
          "      InsertQuarterNum = Table.AddColumn(InsertCompletedYear, \"Quarter Number\", each Date.QuarterOfYear([Date]), type number),",
          "      InsertQuarter = Table.AddColumn(InsertQuarterNum, \"Quarter\", each \"Q\" & Number.ToText([Quarter Number]), type text),",
          "      InsertStartOfQuarter = Table.AddColumn(InsertQuarter, \"Start of Quarter\", each Date.StartOfQuarter([Date]), type date),",
          "      InsertEndOfQuarter = Table.AddColumn(InsertStartOfQuarter, \"End of Quarter\", each Date.EndOfQuarter([Date]), type date),",
          "      InsertCalendarQtr = Table.AddColumn(InsertEndOfQuarter, \"Quarter & Year\", each \"Q\" & Number.ToText( Date.QuarterOfYear([Date])) & Date.ToText([Date], [Format = \" yyyy\"]), type text),",
          "      InsertQuarternYear = Table.AddColumn(InsertCalendarQtr, \"QuarternYear\", each [Year] * 10 + [Quarter Number], type number),",
          "      InsertQuarterOffset = Table.AddColumn(InsertQuarternYear, \"CurrQuarterOffset\", each ((4 * Date.Year([Date])) +  Date.QuarterOfYear([Date])) - ((4 * Date.Year(Date.From(CurrentDate))) +  Date.QuarterOfYear(Date.From(CurrentDate))), type number),",
          "      InsertCompletedQuarter = Table.AddColumn(InsertQuarterOffset, \"QuarterCompleted\", each Date.EndOfQuarter([Date]) < Date.From(Date.EndOfQuarter(CurrentDate)), type logical),",
          "",
          "      InsertMonth = Table.AddColumn(InsertCompletedQuarter, \"Month\", each Date.Month([Date]), type number),",
          "      InsertStartOfMonth = Table.AddColumn(InsertMonth, \"Start of Month\", each Date.StartOfMonth([Date]), type date),",
          "      InsertEndOfMonth = Table.AddColumn(InsertStartOfMonth, \"End of Month\", each Date.EndOfMonth([Date]), type date),",
          "      InsertCalendarMonth = Table.AddColumn(InsertEndOfMonth, \"Month & Year\", each Text.Proper( Date.ToText([Date], [Format = \"MMM yyyy\"])), type text),",
          "      InsertMonthnYear = Table.AddColumn(InsertCalendarMonth , \"MonthnYear\", each [Year] * 100 + [Month], type number),",
          "      InsertMonthOffset = Table.AddColumn(InsertMonthnYear, \"CurrMonthOffset\", each ((12 * Date.Year([Date])) +  Date.Month([Date])) - ((12 * Date.Year(Date.From(CurrentDate))) +  Date.Month(Date.From(CurrentDate))), type number),",
          "      InsertCompletedMonth = Table.AddColumn(InsertMonthOffset, \"MonthCompleted\", each Date.EndOfMonth([Date]) < Date.From(Date.EndOfMonth(CurrentDate)), type logical),",
          "      InsertMonthName = Table.AddColumn(InsertCompletedMonth, \"Month Name\", each Text.Proper( Date.ToText([Date], \"MMMM\")), type text),",
          "      InsertMonthShort = Table.AddColumn( InsertMonthName, \"Month Short\", each Text.Proper( Date.ToText([Date], \"MMM\")), type text),",
          "      InsertMonthInitial = Table.AddColumn(InsertMonthShort, \"Month Initial\", each Text.Start([Month Name], 1) & Text.Repeat( Character.FromNumber(8203), Date.Month([Date]) ), type text),",
          "      InsertDayOfMonth = Table.AddColumn(InsertMonthInitial, \"Day of Month\", each Date.Day([Date]), type number),",
          "  ",
          "      InsertWeekNumber = Table.AddColumn(InsertDayOfMonth, \"Week Number\", each",
          "        if Number.RoundDown((Date.DayOfYear([Date])-(Date.DayOfWeek([Date], Day.Monday)+1)+10)/7)=0",
          "        then Number.RoundDown((Date.DayOfYear(#date(Date.Year([Date])-1,12,31))-(Date.DayOfWeek(#date(Date.Year([Date])-1,12,31), Day.Monday)+1)+10)/7)",
          "        else if (Number.RoundDown((Date.DayOfYear([Date])-(Date.DayOfWeek([Date], Day.Monday)+1)+10)/7)=53 and (Date.DayOfWeek(#date(Date.Year([Date]),12,31), Day.Monday)+1<4))",
          "        then 1 else Number.RoundDown((Date.DayOfYear([Date])-(Date.DayOfWeek([Date], Day.Monday)+1)+10)/7), type number),",
          "      InsertStartOfWeek = Table.AddColumn(InsertWeekNumber, \"Start of Week\", each Date.StartOfWeek([Date], Day.Monday), type date),",
          "      InsertWeekEnding = Table.AddColumn(InsertStartOfWeek, \"End of Week\", each Date.EndOfWeek( [Date], Day.Monday), type date),",
          "      InsertCalendarWk = Table.AddColumn(InsertWeekEnding, \"Week & Year\", each \"W\" & Text.PadStart( Text.From( [Week Number] ), 2, \"0\") & \" \" & Text.From(Date.Year( Date.AddDays( Date.StartOfWeek([Date], Day.Monday), 3 ))), type text ),",
          "      InsertWeeknYear = Table.AddColumn(InsertCalendarWk, \"WeeknYear\", each Date.Year( Date.AddDays( Date.StartOfWeek([Date], Day.Monday), 3 )) * 100 + [Week Number],  Int64.Type),",
          "      InsertWeekOffset = Table.AddColumn(InsertWeeknYear, \"CurrWeekOffset\", each (Number.From(Date.StartOfWeek([Date], Day.Monday))-Number.From(Date.StartOfWeek(CurrentDate, Day.Monday)))/7, type number),",
          "      InsertCompletedWeek = Table.AddColumn(InsertWeekOffset, \"WeekCompleted\", each Date.EndOfWeek( [Date], Day.Monday) < Date.From(Date.EndOfWeek(CurrentDate, Day.Monday)), type logical),",
          "  ",
          "      InsertDayWeek = Table.AddColumn(InsertCompletedWeek, \"Day of Week Number\", each Date.DayOfWeek([Date], Day.Monday) + WDStart, Int64.Type),",
          "      InsertDayName = Table.AddColumn(InsertDayWeek, \"Day of Week Name\", each Text.Proper( Date.ToText([Date], \"dddd\" )), type text),",
          "      InsertDayInitial = Table.AddColumn(InsertDayName, \"Day of Week Initial\", each Text.Proper(Text.Start([Day of Week Name], 1)) & Text.Repeat( Character.FromNumber(8203), Date.DayOfWeek([Date], Day.Monday) + WDStart ), type text),",
          "      InsertDayOfYear = Table.AddColumn(InsertDayInitial, \"Day of Year\", each Date.DayOfYear([Date]), Int64.Type),",
          "      InsertDayInt = Table.AddColumn(InsertDayOfYear, \"DateInt\", each [Year] * 10000 + [Month] * 100 + [Day of Month], type number),",
          "      InsertDayOffset = Table.AddColumn(InsertDayInt, \"CurrDayOffset\", each Number.From([Date]) - Number.From(CurrentDate), type number),",
          "      InsertIsAfterToday = Table.AddColumn(InsertDayOffset, \"IsAfterToday\", each not ([Date] <= Date.From(CurrentDate)), type logical),",
          "      InsertIsWorkingDay = Table.AddColumn(InsertIsAfterToday, \"IsWeekDay\", each if Date.DayOfWeek([Date], Day.Monday) > 4 then false else true, type logical),",
          "      InsertIsHoliday = Table.AddColumn(InsertIsWorkingDay, \"IsHoliday\", each if Holidays = null then \"Unknown\" else List.Contains( Holidays, [Date] ), if Holidays = null then type text else type logical),",
          "      InsertIsBusinessDay = Table.AddColumn(InsertIsHoliday, \"IsBusinessDay\", each if [IsWeekDay] = true and [IsHoliday] <> true then true else false, type logical),",
          "      InsertDayType = Table.AddColumn(InsertIsBusinessDay, \"Day Type\", each if [IsHoliday] = true then \"Holiday\" else if [IsWeekDay] = false then \"Weekend\" else if [IsWeekDay] = true then \"Weekday\" else null, type text),",
          "",
          "      InsertISOYear = Table.AddColumn( InsertDayType, \"ISO Year\", each Date.Year( Date.AddDays( Date.StartOfWeek([Date], Day.Monday), 3 )), type number),",
          "      InsertISOqNum = Table.AddColumn(InsertISOYear, \"ISO Quarter Number\", each if [Week Number] >39 then 4 else if [Week Number] >26 then 3 else if [Week Number] >13 then 2 else 1, Int64.Type),",
          "      InsertISOqtr = Table.AddColumn(InsertISOqNum, \"ISO Quarter\", each \"Q\" & Number.ToText([ISO Quarter Number]), type text),",
          "      InsertISOQuarter = Table.AddColumn(InsertISOqtr, \"ISO Quarter & Year\", each \"Q\" & Number.ToText([ISO Quarter Number]) & \" \" & Number.ToText([ISO Year]), type text),",
          "      InsertISOqNy = Table.AddColumn(InsertISOQuarter, \"ISO QuarternYear\", each [ISO Year] * 10 + [ISO Quarter Number], type number),",
          "",
          "      // BufferTable = Table.Buffer(Table.Distinct( InsertISOqNy[[ISO Year], [DateInt]])),",
          "      // InsertISOday = Table.AddColumn(InsertISOqNy, \"ISO Day of Year\", (OT) => Table.RowCount( Table.SelectRows( BufferTable, (IT) => IT[DateInt] <= OT[DateInt] and IT[ISO Year] = OT[ISO Year])),  Int64.Type),",
          "      AddFY = Table.AddColumn(InsertISOqNy, \"Fiscal Year\", each \"FY\" & (if [Month] >= FYStartMonth and FYStartMonth >1 then Text.From([Year] +1) else Text.From([Year])), type text),",
          "      //AddFYs = Table.AddColumn(AddFY, \"Fiscal Year short\", each \"FY\" & (if [Month] >= FYStartMonth and FYStartMonth >1 then Text.PadEnd( Text.End( Text.From([Year] +1), 2), 2, \"0\") else Text.End( Text.From([Year]), 2)), type text),",
          "      AddFQ = Table.AddColumn(AddFY, \"Fiscal Quarter\", each \"FQ\" & Text.From( Number.RoundUp( Date.Month( Date.AddMonths( [Date], - (FYStartMonth -1) )) / 3 )) & \" \" & (if [Month] >= FYStartMonth and FYStartMonth >1 then Text.From([Year] +1) else Text.From([Year])), type text),",
          "      AddFQnYr = Table.AddColumn(AddFQ, \"FQuarternYear\", each (if [Month] >= FYStartMonth and FYStartMonth >1 then [Year] +1 else [Year]) * 10 + Number.RoundUp( Date.Month( Date.AddMonths( [Date], - (FYStartMonth -1) )) / 3 ), type number),",
          "      AddFM = Table.AddColumn(AddFQnYr, \"Fiscal Period Number\", each if [Month] >= FYStartMonth and FYStartMonth >1 then [Month] - (FYStartMonth-1) else if [Month] >= FYStartMonth and FYStartMonth =1 then [Month] else [Month] + (12-FYStartMonth+1), type number),",
          "      AddFP = Table.AddColumn(AddFM, \"Fiscal Period\", each \"FP\" & Text.PadStart( Text.From([Fiscal Period Number]), 2, \"0\") & \" \" & (if [Month] >= FYStartMonth and FYStartMonth >1 then Text.From([Year] +1) else Text.From([Year])), type text),",
          "      AddFMnYr = Table.AddColumn(AddFP , \"FPeriodnYear\", each (if [Month] >= FYStartMonth and FYStartMonth >1 then [Year] +1 else [Year]) * 100 + [Fiscal Period Number], type number),",
          "      FYCalendarStart = #date( Date.Year(StartDate)-1, FYStartMonth, 1 ),",
          "      InsertFFD = Table.AddColumn( AddFMnYr, \"FiscalFirstDay\", each if [Month] >= FYStartMonth and FYStartMonth >1 then #date( Date.Year([Date])+1, FYStartMonth, 1) else #date( Date.Year([Date]), FYStartMonth, 1), type date ),",
          "",
          "      InitTable = Table.FromList( List.Transform( {Number.From(FYCalendarStart) .. Number.From(EndDate)}, Date.From), Splitter.SplitByNothing(), type table [DateFW = Date.Type]),",
          "      AddFFD = Table.AddColumn( InitTable, \"FiscalFirstDay\", each if Date.Month([DateFW]) < FYStartMonth then #date(Date.Year([DateFW]), FYStartMonth, 1) else #date(Date.Year([DateFW]) + 1, FYStartMonth, 1)),",
          "      AddFWSD = Table.AddColumn( AddFFD, \"FWStartDate\", each Date.AddYears(Date.StartOfWeek([DateFW], Day.Monday), 1)),",
          "      Group1 = Table.Group( AddFWSD, {\"FiscalFirstDay\", \"FWStartDate\"}, {{\"AllRows\", each _, type table [DateFW = nullable date, FiscalFirstDay = date, FWStartDate = date]}}),",
          "      Group2 = Table.Group( Group1, {\"FiscalFirstDay\"}, {{\"AllRows2\", each _, type table [FiscalFirstDay = date, FWStartDate = date, AllRows = table]}}),",
          "      AddIndex = Table.AddColumn( Group2, \"Custom\", each Table.AddIndexColumn([AllRows2], \"Fiscal Week Number\", 1, 1) )[[Custom]],",
          "      ExpandG2 = Table.ExpandTableColumn( AddIndex, \"Custom\", {\"FiscalFirstDay\", \"FWStartDate\", \"AllRows\", \"Fiscal Week Number\"}, {\"FiscalFirstDay\", \"FWStartDate\", \"AllRows\", \"Fiscal Week Number\"}), ",
          "      ExpandG1 = Table.ExpandTableColumn( ExpandG2, \"AllRows\", {\"DateFW\"}, {\"DateFW\"} )[[DateFW], [Fiscal Week Number]],",
          "      MergeFYW = Table.Join( InsertFFD, {\"Date\"}, ExpandG1, {\"DateFW\"}, JoinKind.LeftOuter, JoinAlgorithm.SortMerge ),",
          "      FWlogic = List.Contains( {null}, FYStartMonthNum),",
          "      UpdateFYWeek = if FWlogic then Table.ReplaceValue(MergeFYW, each [Fiscal Week Number], each if FYStartMonth =1 then [Week Number] else [Fiscal Week Number], Replacer.ReplaceValue, {\"Fiscal Week Number\"}) else MergeFYW,",
          "      AddFYW = Table.AddColumn( UpdateFYWeek, \"Fiscal Week\", each if FWlogic then \"F\" & [#\"Week & Year\"] else if FYStartMonth =1 then \"FW\" & Text.PadStart( Text.From([Fiscal Week Number]), 2, \"0\") & Date.ToText([Date], \" yyyy\") else if Date.Month([Date]) < FYStartMonth then \"FW\" & Text.PadStart( Text.From([Fiscal Week Number]), 2, \"0\") & Date.ToText([Date], \" yyyy\") else \"FW\" & Text.PadStart(Text.From([Fiscal Week Number]), 2, \"0\") & \" \" & Text.From( Date.Year([Date])+1), type text),",
          "      InsertFWeeknYear = Table.AddColumn(AddFYW, \"FWeeknYear\", each if FWlogic then [WeeknYear] else (if FYStartMonth =1 then Date.Year([Date]) else if Date.Month([Date]) < FYStartMonth then Date.Year([Date]) else Date.Year([Date])+1) * 100 + [Fiscal Week Number],  Int64.Type),",
          "      ",
          "      CurrentDateRecord = Table.SelectRows(InsertFWeeknYear, each ([Date] = CurrentDate)),",
          "      CurrentISOyear = CurrentDateRecord{0}[ISO Year],",
          "      CurrentISOqtr = CurrentDateRecord{0}[ISO Quarter Number],",
          "      CurrentYear = CurrentDateRecord{0}[Year],",
          "      CurrentMonth = CurrentDateRecord{0}[Month],",
          "      CurrentFiscalFirstDay = CurrentDateRecord{0}[FiscalFirstDay],",
          "      PrevFiscalFirstDay = Date.AddYears(CurrentFiscalFirstDay, -1),",
          "      CurrentFY = CurrentDateRecord{0}[Fiscal Year],",
          "      CurrentFQ = CurrentDateRecord{0}[FQuarternYear],",
          "      CurrentFP = CurrentDateRecord{0}[FPeriodnYear],",
          "      CurrentFW = CurrentDateRecord{0}[FWeeknYear],",
          "",
          "      InsertISOYrOffset = Table.AddColumn(InsertFWeeknYear, \"ISO CurrYearOffset\", each [ISO Year] - CurrentISOyear, type number),",
          "      InsertISOQtrOffset = Table.AddColumn(InsertISOYrOffset, \"ISO CurrQuarterOffset\", each ((4 * [ISO Year]) +  [ISO Quarter Number]) - ((4 * CurrentISOyear) + CurrentISOqtr), type number),",
          "      InsertFYoffset = Table.AddColumn(InsertISOQtrOffset, \"Fiscal CurrYearOffset\", each try (if [Month] >= FYStartMonth then [Year]+1 else [Year]) - (if CurrentMonth >= FYStartMonth then CurrentYear+1 else CurrentYear) otherwise null, type number),",
          "      InsertCurrentFY = Table.AddColumn(InsertFYoffset, \"IsCurrentFY\", each if [Fiscal Year] = CurrentFY then true else false, type logical),",
          "      InsertCurrentFQ = Table.AddColumn(InsertCurrentFY, \"IsCurrentFQ\", each if [FQuarternYear] = CurrentFQ then true else false, type logical),",
          "      InsertCurrentFP = Table.AddColumn(InsertCurrentFQ, \"IsCurrentFP\", each if [FPeriodnYear] = CurrentFP then true else false, type logical),",
          "      InsertCurrentFW = Table.AddColumn(InsertCurrentFP, \"IsCurrentFW\", each if [FWeeknYear] = InsertISOYrOffset then true else false, type logical),",
          "      InsertPYTD = Table.AddColumn(InsertCurrentFW, \"IsPYTD\", each if CurrentYear-1 = [Year] and [Day of Year] <= CurrentDateRecord{0}[Day of Year] then true else false, type logical),",
          "        ListPrevFYDates = List.Buffer( Table.SelectRows( Table.ExpandTableColumn( Table.NestedJoin(",
          "            Table.AddIndexColumn( Table.RenameColumns( Table.TransformColumnTypes( Table.FromList( List.Dates( PrevFiscalFirstDay, Number.From(CurrentFiscalFirstDay-PrevFiscalFirstDay),#duration(1,0,0,0)), Splitter.SplitByNothing()),{{\"Column1\", type date}}), {{\"Column1\", \"DateFY\"}}), \"Index\", 1, 1), {\"Index\"}, ",
          "            Table.AddIndexColumn( Table.RenameColumns( Table.TransformColumnTypes( Table.FromList( List.Dates( Date.AddYears( PrevFiscalFirstDay, -1), Number.From( PrevFiscalFirstDay - Date.AddYears( PrevFiscalFirstDay, -1)),#duration(1,0,0,0)), Splitter.SplitByNothing()),{{\"Column1\", type date}}), {{\"Column1\", \"DateFY\"}}), \"Index\", 1, 1)",
          "            , {\"Index\"}, \"Table\", JoinKind.LeftOuter), \"Table\", {\"DateFY\"}, {\"PrevDateFY\"}), each [DateFY] <= CurrentDate)[PrevDateFY] ),",
          "      InsertPFYTD = Table.AddColumn(InsertPYTD, \"IsPFYTD\", each if [Fiscal CurrYearOffset] = -1 and List.Contains(ListPrevFYDates, [Date] ) then true else false, type logical),",
          "      InsertNetWorkdays = if AddRelativeNetWorkdays = true then Table.AddColumn(InsertPFYTD, \"Relative Networkdays\", each fxNETWORKDAYS( StartDate, [Date], Holidays ), type number ) else InsertPFYTD,",
          "      fxNETWORKDAYS = (StartDate, EndDate, optional Holidays as list) =>",
          "        let",
          "          ListOfDates = List.Dates( StartDate, Number.From(EndDate-StartDate)+1, Duration.From(1) ),",
          "          DeleteHolidays = if Holidays = null then ListOfDates else List.Difference( ListOfDates, List.Transform(Holidays, Date.From )),",
          "          DeleteWeekends = List.Select( DeleteHolidays, each Date.DayOfWeek( _, Day.Monday) < 5 ),",
          "          CountDays = List.Count( DeleteWeekends)",
          "        in",
          "          CountDays,",
          "      RemoveToday = Table.RemoveColumns( if EndDate < CurrentDate then Table.SelectRows(InsertNetWorkdays, each ([Date] <> CurrentDate)) else InsertNetWorkdays, {\"Day of Year\", \"FiscalFirstDay\"}), ",
          "      ChType = Table.TransformColumnTypes(RemoveToday,{{\"Year\", Int64.Type}, {\"Quarter Number\", Int64.Type}, {\"Month\", Int64.Type}, {\"Day of Month\", Int64.Type}, {\"DateInt\", Int64.Type}, {\"Day of Week Number\", Int64.Type}, {\"ISO CurrYearOffset\", Int64.Type}, {\"ISO QuarternYear\", Int64.Type}, {\"ISO CurrQuarterOffset\", Int64.Type}, {\"Week Number\", Int64.Type}, {\"WeeknYear\", Int64.Type}, {\"MonthnYear\", Int64.Type}, {\"QuarternYear\", Int64.Type}, {\"FQuarternYear\", Int64.Type}, {\"Fiscal Period Number\", Int64.Type}, {\"FPeriodnYear\", Int64.Type}, {\"CurrWeekOffset\", Int64.Type}, {\"CurrMonthOffset\", Int64.Type}, {\"CurrQuarterOffset\", Int64.Type}, {\"CurrYearOffset\", Int64.Type}, {\"Fiscal CurrYearOffset\", Int64.Type}, {\"Fiscal Week Number\", Int64.Type}}),",
          "      ReorderCols = Table.ReorderColumns(ChType,{\"Date\", \"Year\", \"CurrYearOffset\", \"YearCompleted\", \"Quarter Number\", \"Quarter\", \"Start of Quarter\", \"End of Quarter\", \"Quarter & Year\", \"QuarternYear\", \"CurrQuarterOffset\", \"QuarterCompleted\", \"Month\", \"Start of Month\", \"End of Month\", \"Month & Year\", \"MonthnYear\", \"CurrMonthOffset\", \"MonthCompleted\", \"Month Name\", \"Month Short\", \"Month Initial\", \"Day of Month\", \"Week Number\", \"Start of Week\", \"End of Week\", \"Week & Year\", \"WeeknYear\", \"CurrWeekOffset\", \"WeekCompleted\", \"Day of Week Number\", \"Day of Week Name\", \"Day of Week Initial\", \"DateInt\", \"CurrDayOffset\", \"IsAfterToday\", \"IsWeekDay\", \"IsHoliday\", \"IsBusinessDay\", \"Day Type\", \"ISO Year\", \"ISO CurrYearOffset\", \"ISO Quarter Number\", \"ISO Quarter\", \"ISO Quarter & Year\", \"ISO QuarternYear\", \"ISO CurrQuarterOffset\", \"Fiscal Year\", \"Fiscal CurrYearOffset\", \"Fiscal Quarter\", \"FQuarternYear\", \"Fiscal Period Number\", \"Fiscal Period\", \"FPeriodnYear\", \"DateFW\", \"Fiscal Week Number\", \"Fiscal Week\", \"FWeeknYear\", \"IsCurrentFY\", \"IsCurrentFQ\", \"IsCurrentFP\", \"IsCurrentFW\", \"IsPYTD\", \"IsPFYTD\"}),",
          "      ListCols = if FWlogic then Table.RemoveColumns(ReorderCols,{\"ISO Quarter Number\", \"Fiscal Year\", \"Fiscal Quarter\", \"FQuarternYear\", \"Fiscal Period Number\", \"Fiscal Period\", \"FPeriodnYear\", \"DateFW\", \"Fiscal Week Number\", \"Fiscal Week\", \"FWeeknYear\", \"Fiscal CurrYearOffset\", \"IsCurrentFQ\", \"IsCurrentFP\", \"IsCurrentFW\"}) else Table.RemoveColumns(ReorderCols,{\"Fiscal Period Number\", \"DateFW\", \"Fiscal Week Number\", \"ISO Quarter Number\"})",
          "  in",
          "      ListCols,",
          "      Documentation = [",
          "      Documentation.Name =  \" fxCalendar\", ",
          "      Documentation.Description = \" Date table function to create an ISO-8601 calendar\", ",
          "      Documentation.LongDescription = \" Date table function to create an ISO-8601 calendar\", ",
          "      Documentation.Category = \" Table\", ",
          "      Documentation.Version = \" 2.01: full code review\",",
          "      Documentation.Source = \" local\", ",
          "      Documentation.Author = \" Melissa de Korte\", ",
          "      Documentation.Examples = { [Description =  \" See: https://forum.enterprisedna.co/t/extended-date-table-power-query-m-function/6390\", ",
          "        Code = \" Optional paramters: #(lf)",
          "        (FYStartMonthNum) Month number the fiscal year starts, Januari if omitted #(lf) ",
          "        (Holidays) Select a query (and column) that contains a list of holiday dates #(lf) ",
          "        (WDStartNum) Switch default weekday numbering from 0-6 to 1-7 by entering a 1 #(lf)",
          "        (AddRelativeNetWorkdays) if true adds a Relative Networkdays column to the date table #(lf)",
          "        #(lf)",
          "        Important to note: #(lf)",
          "        [Fiscal Week] starts on a Monday and can contain less than 7 days in a First- and/or Last Week of a FY #(lf)",
          "        [IsWeekDay] does not take holiday dates into account  #(lf)",
          "        [IsBusinessDay] does take optional holiday dates into account  #(lf)",
          "        [IsPYTD] and [IsPFYTD] compare Previous [Day of Year] with the Current [Day of Year] number, so dates don't align in leap years #(lf)",
          "        IMPORTANT! No Fiscal columns will be added if the (FYStartMonthNum) is omitted\", ",
          "        Result = \" \" ] }",
          "      ]",
          "  in ",
          "  Value.ReplaceType( fnDateTable, Value.ReplaceMetadata( Value.Type( fnDateTable ), Documentation ))"
        ],
        "kind": "m",
        "lineageTag": "19149475-bf38-4b11-a6d0-bb6940799edc"
      },
      {
        "name": "Imke_function",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Function"
          }
        ],
        "expression": [
          "/**",
          " * no description available",
          " * ",
          " * @categories date",
          " * @author https://github.com/ImkeF",
          " * @source https://github.com/ImkeF/M",
          " * @license MIT (c) 2017 Imke Feldmann",
          " * @version 2021-02-09-1",
          " */",
          "(start as date, end as date, optional culture as text) =>",
          "  let",
          "    /*",
          "    culture = \"de-de\",",
          "    start = #date(2016, 1, 1),",
          "    end = #date(2018,12,31),",
          "    */",
          "    Culture = if culture = null then \"en-US\" else culture,",
          "    Start = start,",
          "    End = end,",
          "    WeekDayLength = try Record.Field([#\"de-de\" = 2], Culture) otherwise 3,",
          "    TodayReference = Date.From(DateTime.LocalNow()),",
          "    FirstYear = Date.Year(Start),",
          "    LastYear = Date.Year(End),",
          "    // For Fiscal 52-53 weeks (start depends on rules)",
          "    FiscalCalendarFirstMonth = 7,",
          "    // Use: 0 - Sunday, 1 - Monday, 2 - Tuesday, ... 5 - Friday, 6 - Saturday",
          "    FirstDayOfWeek = 0,",
          "    // Use: \"Nearest\" or \"Last\" ",
          "    WeeklyType = \"Nearest\",",
          "    // -- Supports only \"445\", \"454\", and \"544\"",
          "    // -- Last:    for last weekday of the month at fiscal year end",
          "    // -- Nearest: for last weekday nearest the end of month ",
          "    // -- Reference for Last/Nearest definition: https://en.wikipedia.org/wiki/4%E2%80%934%E2%80%935_calendar)",
          "    // --",
          "    // -- For ISO calendar use ",
          "    // --   FiscalCalendarFirstMonth = 1 (ISO always starts in January)",
          "    // --   FirstDayOfWeek = 1           (ISO always starts on Monday)",
          "    // --   WeeklyType = \"Nearest\"       (ISO use the nearest week type algorithm)",
          "    // -- For US with last Saturday of the month at fiscal year end",
          "    // --   FirstDayOfWeek = 0           (US weeks start on Sunday)",
          "    // --   WeeklyType = \"Last\"",
          "    // -- For US with last Saturday nearest the end of month",
          "    // --   FirstDayOfWeek = 0           (US weeks start on Sunday)",
          "    // --   WeeklyType = \"Nearest\"",
          "    // --",
          "    QuarterWeekType = \"\"\"445\"\"\",",
          "    // -- Prefix used in columns of standard Gregorian calendar",
          "    CalendarGregorianPrefix = \"\",",
          "    // Prefix used in columns of fiscal Gregorian calendar",
          "    FiscalGregorianPrefix = \"F\",",
          "    // -- Prefix used in columns of fiscal weekly calendar",
          "    FiscalWeeklyPrefix = \"FW \",",
          "    // -- Supports \"Weekly\", \"Custom\"",
          "    // -- Use CustomFiscalPeriods in case you need arbitrary definition of weekly fiscal years ",
          "    // -- The first day of each year must be a weekday corresponding to the definition of FirstDayOfWeek",
          "    WeeklyCalendarType = \"Weekly\",",
          "    CustomFiscalPeriods_ = #table(",
          "      {\"Fiscal YearNumber\", \"FirstDayOfYear\", \"LastDayOfYear\"},",
          "      {",
          "        {2016, \"2016-06-28\", \"2016-07-02\"},",
          "        {2017, \"2016-07-03\", \"2017-07-01\"},",
          "        {2018, \"2017-07-02\", \"2018-06-30\"},",
          "        {2019, \"2018-07-01\", \"2019-06-29\"}",
          "      }",
          "    ),",
          "    CustomFiscalPeriods = Table.TransformColumnTypes(",
          "      CustomFiscalPeriods_,",
          "      {{\"FirstDayOfYear\", type date}, {\"LastDayOfYear\", type date}}",
          "    ),",
          "    FirstDayCalendar = #date(FirstYear, 1, 1),",
          "    LastDayCalendar = #date(LastYear, 12, 31),",
          "    // Überprüfen!!",
          "    WeekDayCalculationType = (FirstDayOfWeek),",
          "    WFP1 = Table.FromColumns({{FirstYear .. LastYear}}, {\"Fiscal YearNumber\"}),",
          "    WFP2 = Table.AddColumn(WFP1, \"CalendarType\", each \"Weekly\"),",
          "    #\"Added Custom\" = Table.AddColumn(",
          "      WFP2,",
          "      \"FirstDayCurrentYear\",",
          "      each #date([Fiscal YearNumber], FiscalCalendarFirstMonth, 1)",
          "    ),",
          "    FirstDayNextYear = Table.AddColumn(",
          "      #\"Added Custom\",",
          "      \"FirstDayNextYear\",",
          "      each #date([Fiscal YearNumber] + 1, FiscalCalendarFirstMonth, 1)",
          "    ),",
          "    DayOfWeekNumberCurrentYear = Table.AddColumn(",
          "      FirstDayNextYear,",
          "      \"DayOfWeekNumberCurrentYear\",",
          "      each Date.DayOfWeek([FirstDayCurrentYear], WeekDayCalculationType)",
          "    ),",
          "    OffsetStartCurrentFiscalYear = Table.AddColumn(",
          "      DayOfWeekNumberCurrentYear,",
          "      \"OffsetStartCurrentFiscalYear\",",
          "      each try",
          "        ",
          "          if WeeklyType = \"Last\" then",
          "            1 - [DayOfWeekNumberCurrentYear]",
          "          else if [DayOfWeekNumberCurrentYear] >= 5 then",
          "            8 - [DayOfWeekNumberCurrentYear]",
          "          else",
          "            1 - [DayOfWeekNumberCurrentYear]",
          "      otherwise",
          "        \"Unknown WeeklyType definition : \"",
          "    ),",
          "    DayOfWeekNumberNextYear = Table.AddColumn(",
          "      OffsetStartCurrentFiscalYear,",
          "      \"DayOfWeekNumberNextYear\",",
          "      each Date.DayOfWeek([FirstDayNextYear], WeekDayCalculationType)",
          "    ),",
          "    OffsetStartNextFiscalYear = Table.AddColumn(",
          "      DayOfWeekNumberNextYear,",
          "      \"OffsetStartNextFiscalYear\",",
          "      each try",
          "        ",
          "          if WeeklyType = \"Last\" then",
          "            [DayOfWeekNumberCurrentYear]",
          "          else if [DayOfWeekNumberCurrentYear] >= 5 then",
          "            7 - [DayOfWeekNumberCurrentYear]",
          "          else",
          "            - [DayOfWeekNumberCurrentYear]",
          "      otherwise",
          "        \"Unknown WeeklyType definition : \"",
          "    ),",
          "    FirstDayOfYear = Table.AddColumn(",
          "      OffsetStartNextFiscalYear,",
          "      \"FirstDayOfYear\",",
          "      each Date.AddDays([FirstDayCurrentYear], [OffsetStartCurrentFiscalYear])",
          "    ),",
          "    WeeklyFiscalPeriods = Table.AddColumn(",
          "      FirstDayOfYear,",
          "      \"LastDayOfYear\",",
          "      each Date.AddDays([FirstDayNextYear], [OffsetStartNextFiscalYear] - 1)",
          "    ),",
          "    CheckFirstDayOfWeek = ",
          "      if Date.DayOfWeek(List.Min(CustomFiscalPeriods[FirstDayOfYear]), 1) <> FirstDayOfWeek + 1 then",
          "        \"Error: CustomFiscalPeriods table does not match FirstDayOfWeek setting\"",
          "      else",
          "        true,",
          "    CustomFiscalPeriodsWithType = ",
          "      if CheckFirstDayOfWeek = true then",
          "        Table.AddColumn(CustomFiscalPeriods, \"CalendarType\", each \"Custom\")",
          "      else",
          "        \"Error\",",
          "    FiscalPeriods_ = Table.SelectColumns(",
          "      Table.SelectRows(",
          "        Table.Combine({WeeklyFiscalPeriods, CustomFiscalPeriodsWithType}),",
          "        each [CalendarType] = WeeklyCalendarType",
          "      ),",
          "      {\"Fiscal YearNumber\", \"FirstDayOfYear\", \"LastDayOfYear\"}",
          "    ),",
          "    FiscalPeriods = Table.RenameColumns(",
          "      FiscalPeriods_,",
          "      {",
          "        {\"LastDayOfYear\", \"FW EndOfYear\"},",
          "        {\"FirstDayOfYear\", \"FW StartOfYear\"},",
          "        {\"Fiscal YearNumber\", \"FW YearNumber\"}",
          "      }",
          "    ),",
          "    WeeksInP1 = Text.ToList(QuarterWeekType){1},",
          "    WeeksInP2 = Text.ToList(QuarterWeekType){2},",
          "    WeeksInP3 = Text.ToList(QuarterWeekType){3},",
          "    FirstSundayReference = #date(1900, 12, 30),",
          "    FirstWeekReference = Date.AddDays(FirstSundayReference, FirstDayOfWeek),",
          "    RawDays = Table.FromColumns(",
          "      {",
          "        List.Transform(",
          "          {Number.From(FirstDayCalendar) .. Number.From(LastDayCalendar)},",
          "          each Date.From(_)",
          "        )",
          "      },",
          "      {\"Date\"}",
          "    ),",
          "    CalendarGregorianPrefixSpace = ",
          "      if CalendarGregorianPrefix <> \"\" then",
          "        CalendarGregorianPrefix & \" \"",
          "      else",
          "        \"\",",
          "    FiscalGregorianPrefixSpace = ",
          "      if FiscalGregorianPrefix <> \"\" then",
          "        FiscalGregorianPrefix & \" \"",
          "      else",
          "        \"\",",
          "    FiscalWeeklyPrefixSpace = if FiscalWeeklyPrefix <> \"\" then FiscalWeeklyPrefix & \" \" else \"\",",
          "    #\"Added Custom1\" = Table.AddColumn(",
          "      FiscalPeriods,",
          "      \"Date\",",
          "      each List.Transform(",
          "        {Number.From([FW StartOfYear]) .. Number.From([FW EndOfYear])},",
          "        each Date.From(_)",
          "      )",
          "    ),",
          "    CustomFiscalRawDays = Table.ExpandListColumn(#\"Added Custom1\", \"Date\"),",
          "    CSGB = Table.Buffer(",
          "      Table.AddColumn(",
          "        RawDays,",
          "        \"CalFields\",",
          "        each [",
          "          DateKey = #\"Calendar YearNumber\" * 10000 + #\"Calendar MonthNumber\" * 100 + #\"Day of Month\",",
          "          #\"Calendar YearNumber\" = Date.Year([Date]),",
          "          #\"Calendar Year\" = CalendarGregorianPrefixSpace & Text.From(#\"Calendar YearNumber\"),",
          "          #\"Calendar QuarterNumber\" = Number.RoundUp(#\"Calendar MonthNumber\" / 3, 0),",
          "          #\"Calendar Quarter\" = CalendarGregorianPrefix",
          "            & \"Q\"",
          "            & Text.From(#\"Calendar QuarterNumber\")",
          "            & \"\",",
          "          #\"Calendar YearQuarterNumber\" = #\"Calendar YearNumber\" * 4 - 1 + #\"Calendar QuarterNumber\",",
          "          #\"Calendar Quarter Year\" = CalendarGregorianPrefix",
          "            & #\"Calendar Quarter\"",
          "            & \"\"",
          "            & Text.From(#\"Calendar Year\"),",
          "          #\"Calendar MonthNumber\" = Date.Month([Date]),",
          "          #\"Calendar Month\" = Text.Start(Date.MonthName([Date], Culture), 3),",
          "          #\"Calendar YearMonthNumber\" = #\"Calendar YearNumber\" * 12 - 1 + #\"Calendar MonthNumber\",",
          "          #\"Calendar Month Year\" = #\"Calendar Month\" & \" \" & #\"Calendar Year\",",
          "          #\"Calendar WeekNumber\" = Date.WeekOfYear([Date], WeekDayCalculationType),",
          "          #\"Calendar Week\" = CalendarGregorianPrefix",
          "            & \"W\"",
          "            & Text.PadStart(Text.From(#\"Calendar WeekNumber\"), 2, \"0\"),",
          "          #\"Calendar YearWeekNumber\" = Number.IntegerDivide(",
          "            (Number.From([Date]) - Number.From(FirstWeekReference)),",
          "            7",
          "          ),",
          "          #\"Calendar Week Year\" = CalendarGregorianPrefix",
          "            & #\"Calendar Week\"",
          "            & \"-\"",
          "            & #\"Calendar Year\",",
          "          #\"Calendar WeekYearOrder\" = #\"Calendar YearNumber\" * 100 + #\"Calendar WeekNumber\",",
          "          #\"Calendar DayOfYearNumber\" = Date.DayOfYear([Date]),",
          "          #\"Day of Month\" = Date.Day([Date]),",
          "          WeekDayNumber = Date.DayOfWeek([Date]) + 1,",
          "          #\"Week Day\" = Text.Start(Date.DayOfWeekName([Date], Culture), WeekDayLength)",
          "        ]",
          "      )",
          "    ),",
          "    CalendarStandardGregorianBase = Table.Buffer(",
          "      Table.ExpandRecordColumn(CSGB, \"CalFields\", Record.FieldNames(CSGB[CalFields]{0}))",
          "    ),",
          "    iCalTodayReference = Table.Buffer(",
          "      Table.SelectRows(CalendarStandardGregorianBase, each [Date] = TodayReference)",
          "    ),",
          "    CSG = Table.Buffer(",
          "      Table.AddColumn(",
          "        CalendarStandardGregorianBase,",
          "        \"CalGregorian\",",
          "        each [",
          "          #\"Calendar RelativeWeekPos\" = List.Average(iCalTodayReference[Calendar YearWeekNumber])",
          "            - [Calendar YearWeekNumber],",
          "          #\"Calendar RelativeMonthPos\" = List.Average(iCalTodayReference[Calendar YearMonthNumber])",
          "            - [Calendar YearMonthNumber],",
          "          #\"Calendar RelativeQuarterPos\" = List.Average(",
          "            iCalTodayReference[Calendar YearQuarterNumber]",
          "          )",
          "            - [Calendar YearQuarterNumber],",
          "          #\"Calendar RelativeYearPos\" = List.Average(iCalTodayReference[Calendar YearNumber])",
          "            - [Calendar YearNumber],",
          "          #\"Calendar StartOfMonth\" = Date.StartOfMonth([Date]),",
          "          #\"Calendar EndOfMonth\" = Date.EndOfMonth([Date]),",
          "          #\"Calendar DayOfMonth\" = Date.Day([Date]),",
          "          #\"Calendar StartOfQuarter\" = #date(",
          "            [Calendar YearNumber],",
          "            Record.Field([Q1 = 1, Q2 = 4, Q3 = 7, Q4 = 10], [Calendar Quarter]),",
          "            1",
          "          ),",
          "          #\"Calendar EndOfQuarter\" = #date(",
          "            [Calendar YearNumber],",
          "            Record.Field([Q1 = 3, Q2 = 6, Q3 = 9, Q4 = 12], [Calendar Quarter]),",
          "            Record.Field([Q1 = 31, Q2 = 30, Q3 = 30, Q4 = 31], [Calendar Quarter])",
          "          ),",
          "          #\"Calendar DayOfQuarter\" = Number.From([Date])",
          "            - Number.From(#\"Calendar StartOfQuarter\")",
          "            + 1",
          "        ]",
          "      )",
          "    ),",
          "    #\"Expanded CalGregorian\" = Table.ExpandRecordColumn(",
          "      CSG,",
          "      \"CalGregorian\",",
          "      {",
          "        \"Calendar RelativeWeekPos\",",
          "        \"Calendar RelativeMonthPos\",",
          "        \"Calendar RelativeQuarterPos\",",
          "        \"Calendar RelativeYearPos\",",
          "        \"Calendar StartOfMonth\",",
          "        \"Calendar EndOfMonth\",",
          "        \"Calendar DayOfMonth\",",
          "        \"Calendar StartOfQuarter\",",
          "        \"Calendar EndOfQuarter\",",
          "        \"Calendar DayOfQuarter\"",
          "      },",
          "      {",
          "        \"Calendar RelativeWeekPos\",",
          "        \"Calendar RelativeMonthPos\",",
          "        \"Calendar RelativeQuarterPos\",",
          "        \"Calendar RelativeYearPos\",",
          "        \"Calendar StartOfMonth\",",
          "        \"Calendar EndOfMonth\",",
          "        \"Calendar DayOfMonth\",",
          "        \"Calendar StartOfQuarter\",",
          "        \"Calendar EndOfQuarter\",",
          "        \"Calendar DayOfQuarter\"",
          "      }",
          "    ),",
          "    #\"Changed Type\" = Table.TransformColumnTypes(",
          "      #\"Expanded CalGregorian\",",
          "      {",
          "        {\"Date\", type date},",
          "        {\"DateKey\", Int64.Type},",
          "        {\"Calendar YearNumber\", Int64.Type},",
          "        {\"Calendar QuarterNumber\", Int64.Type},",
          "        {\"Calendar Quarter\", type text},",
          "        {\"Calendar YearQuarterNumber\", Int64.Type},",
          "        {\"Calendar Quarter Year\", type text},",
          "        {\"Calendar MonthNumber\", Int64.Type},",
          "        {\"Calendar Month\", type text},",
          "        {\"Calendar YearMonthNumber\", Int64.Type},",
          "        {\"Calendar Month Year\", type text},",
          "        {\"Calendar WeekNumber\", Int64.Type},",
          "        {\"Calendar Week\", type text},",
          "        {\"Calendar YearWeekNumber\", Int64.Type},",
          "        {\"Calendar Week Year\", type text},",
          "        {\"Calendar WeekYearOrder\", Int64.Type},",
          "        {\"Calendar DayOfYearNumber\", Int64.Type},",
          "        {\"Day of Month\", Int64.Type},",
          "        {\"WeekDayNumber\", Int64.Type},",
          "        {\"Week Day\", type text},",
          "        {\"Calendar RelativeWeekPos\", Int64.Type},",
          "        {\"Calendar RelativeMonthPos\", Int64.Type},",
          "        {\"Calendar RelativeQuarterPos\", Int64.Type},",
          "        {\"Calendar RelativeYearPos\", Int64.Type},",
          "        {\"Calendar StartOfMonth\", type date},",
          "        {\"Calendar EndOfMonth\", type date},",
          "        {\"Calendar DayOfMonth\", Int64.Type},",
          "        {\"Calendar StartOfQuarter\", type date},",
          "        {\"Calendar EndOfQuarter\", type date},",
          "        {\"Calendar DayOfQuarter\", Int64.Type},",
          "        {\"Calendar Year\", type text}",
          "      }",
          "    )",
          "  in",
          "    #\"Changed Type\""
        ],
        "kind": "m",
        "lineageTag": "641e9efc-c511-4a9d-81db-0c0dc942bcc0"
      },
      {
        "name": "ChatGPT_LatLong_WRONG",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Function"
          }
        ],
        "expression": [
          "//In M, write a function that takes a City value as a parameter and returns 2 separate columns for Latitude and Longitude, using the Bing maps API",
          "",
          "(city as text) =>",
          "let",
          "    apiKey = \"AliM3h_UQRQe1grUQc1CHfAytxQOssQFxQbEsw0bBZ9bfugUGpRdoQfmaoLeTfMF\", //my personal key",
          "    geocode = Json.Document(Web.Contents(\"http://dev.virtualearth.net/REST/v1/Locations\", [Query=[q=city, key=apiKey]])),",
          "    latitude = geocode[resourceSets]{0}[resources]{0}[point][coordinates]{0},",
          "    longitude = geocode[resourceSets]{0}[resources]{0}[point][coordinates]{1},",
          "    result = Table.FromColumns({{latitude}, {longitude}}, {\"Latitude\", \"Longitude\"})",
          "in",
          "    result"
        ],
        "kind": "m",
        "lineageTag": "7a69d387-b2a6-430d-abbf-516c6a9e80fd"
      },
      {
        "name": "Errors in Geography",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "Source = Geography,",
          "  #\"Detected Type Mismatches\" = let",
          "    tableWithOnlyPrimitiveTypes = Table.SelectColumns(Source, Table.ColumnsOfType(Source, {type nullable number, type nullable text, type nullable logical, type nullable date, type nullable datetime, type nullable datetimezone, type nullable time, type nullable duration})),",
          "    recordTypeFields = Type.RecordFields(Type.TableRow(Value.Type(tableWithOnlyPrimitiveTypes))),",
          "    fieldNames = Record.FieldNames(recordTypeFields),",
          "    fieldTypes = List.Transform(Record.ToList(recordTypeFields), each [Type]),",
          "    pairs = List.Transform(List.Positions(fieldNames), (i) => {fieldNames{i}, (v) => if v = null or Value.Is(v, fieldTypes{i}) then v else error [Message = \"The type of the value does not match the type of the column.\", Detail = v], fieldTypes{i}})",
          "in",
          "    Table.TransformColumns(Source, pairs),",
          "  #\"Added Index\" = Table.AddIndexColumn(#\"Detected Type Mismatches\", \"Row Number\" ,1),",
          "  #\"Kept Errors\" = Table.SelectRowsWithErrors(#\"Added Index\", {\"GeographyKey\", \"City\", \"StateProvinceCode\", \"StateProvinceName\", \"CountryRegionCode\", \"EnglishCountryRegionName\", \"PostalCode\", \"SalesTerritoryKey\", \"IpAddressLocator\", \"DimCustomer\", \"DimReseller\", \"DimSalesTerritory\", \"Latitude\", \"Longitude\"}),",
          "  #\"Reordered Columns\" = Table.ReorderColumns(#\"Kept Errors\", {\"Row Number\", \"GeographyKey\", \"City\", \"StateProvinceCode\", \"StateProvinceName\", \"CountryRegionCode\", \"EnglishCountryRegionName\", \"PostalCode\", \"SalesTerritoryKey\", \"IpAddressLocator\", \"DimCustomer\", \"DimReseller\", \"DimSalesTerritory\", \"Latitude\", \"Longitude\"})",
          "in",
          "  #\"Reordered Columns\""
        ],
        "kind": "m",
        "lineageTag": "4608b430-a227-4aaa-9c2c-226679cbed86",
        "queryGroup": "Query Errors - 30/03/2023 13:24:59"
      },
      {
        "name": "ChatGPT_LatLong",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Function"
          }
        ],
        "expression": [
          "//In M, write a function that takes a Country value and a City value as parameters accounting for the possibility that State is blank and returns 2 separate columns for Latitude and Longitude, using the Bing maps API",
          "",
          "(country as text, state as nullable text, city as text) =>",
          "let",
          "    apiKey = \"AliM3h_UQRQe1grUQc1CHfAytxQOssQFxQbEsw0bBZ9bfugUGpRdoQfmaoLeTfMF\",",
          "    location = if state = null then country & \", \" & city else country & \", \" & state & \", \" & city,",
          "    geocode = Json.Document(Web.Contents(\"http://dev.virtualearth.net/REST/v1/Locations\", [Query=[q=location, key=apiKey]])),",
          "    latitude = geocode[resourceSets]{0}[resources]{0}[point][coordinates]{0},",
          "    longitude = geocode[resourceSets]{0}[resources]{0}[point][coordinates]{1},",
          "    result = Table.FromColumns({{latitude}, {longitude}}, {\"Latitude\", \"Longitude\"})",
          "in",
          "    result"
        ],
        "kind": "m",
        "lineageTag": "bd7b0ba2-8cfb-4c12-9965-a0e6896f6f6f"
      },
      {
        "name": "Errors in Geography (2)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "Source = Geography,",
          "  #\"Detected Type Mismatches\" = let",
          "    tableWithOnlyPrimitiveTypes = Table.SelectColumns(Source, Table.ColumnsOfType(Source, {type nullable number, type nullable text, type nullable logical, type nullable date, type nullable datetime, type nullable datetimezone, type nullable time, type nullable duration})),",
          "    recordTypeFields = Type.RecordFields(Type.TableRow(Value.Type(tableWithOnlyPrimitiveTypes))),",
          "    fieldNames = Record.FieldNames(recordTypeFields),",
          "    fieldTypes = List.Transform(Record.ToList(recordTypeFields), each [Type]),",
          "    pairs = List.Transform(List.Positions(fieldNames), (i) => {fieldNames{i}, (v) => if v = null or Value.Is(v, fieldTypes{i}) then v else error [Message = \"The type of the value does not match the type of the column.\", Detail = v], fieldTypes{i}})",
          "in",
          "    Table.TransformColumns(Source, pairs),",
          "  #\"Added Index\" = Table.AddIndexColumn(#\"Detected Type Mismatches\", \"Row Number\" ,1),",
          "  #\"Kept Errors\" = Table.SelectRowsWithErrors(#\"Added Index\", {\"GeographyKey\", \"City\", \"StateProvinceCode\", \"StateProvinceName\", \"CountryRegionCode\", \"EnglishCountryRegionName\", \"PostalCode\", \"SalesTerritoryKey\", \"IpAddressLocator\", \"DimCustomer\", \"DimReseller\", \"DimSalesTerritory\", \"Latitude_WRONG\", \"Longitude_WRONG\", \"Latitude\", \"Longitude\", \"compare WRONG\"}),",
          "  #\"Reordered Columns\" = Table.ReorderColumns(#\"Kept Errors\", {\"Row Number\", \"GeographyKey\", \"City\", \"StateProvinceCode\", \"StateProvinceName\", \"CountryRegionCode\", \"EnglishCountryRegionName\", \"PostalCode\", \"SalesTerritoryKey\", \"IpAddressLocator\", \"DimCustomer\", \"DimReseller\", \"DimSalesTerritory\", \"Latitude_WRONG\", \"Longitude_WRONG\", \"Latitude\", \"Longitude\", \"compare WRONG\"})",
          "in",
          "  #\"Reordered Columns\""
        ],
        "kind": "m",
        "lineageTag": "dae1fdca-584a-4e89-9657-813d92046813",
        "queryGroup": "Query Errors - 30/03/2023 14:07:46"
      },
      {
        "name": "DAX Debugger",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Function"
          }
        ],
        "expression": [
          "let func =   ",
          " (filterExpression as text,",
          " myColumnName as text,",
          " optional MaxFilters as number",
          ") =>",
          "",
          "let",
          "/* Debug parameters",
          "    myColumnName = \"Datum\",",
          "    filterExpression = \"DATESYTD(DimDate[Datum])\",",
          "    MaxFilters = 10,",
          "   */// End of debug parameters",
          "",
          "    maxFilters = Text.From(if MaxFilters = null then 10 else MaxFilters),",
          "    ListOfDelimiters = {\">=\", \"<=\", \"<>\", \"=\", \">\", \"<\"},",
          "    ",
          "    // Splits filterExpression by the first delimiter it finds",
          "    SplittedBoolean = List.Accumulate(  ",
          "                        ListOfDelimiters, ",
          "                        {},",
          "                        (state, current) =>  if List.Count(state) = 2 ",
          "                                                then state ",
          "                                                else Text.Split(filterExpression, current)),",
          "    HasSyntaxSugar = not Text.Contains(",
          "                            List.First(SplittedBoolean), ",
          "                            \")\"),",
          "    FullFilterExpression = if HasSyntaxSugar ",
          "                            then \"Filter(All(\" & SplittedBoolean{0} & \"), \" & filterExpression & \")\" ",
          "                            else filterExpression,",
          "    MeasureString = \"",
          "DAX Debugger = ",
          "VAR FilterTable = \" ",
          "    & FullFilterExpression & \"",
          "VAR TableLength = ",
          "    COUNTROWS(FilterTable)",
          "VAR ColumnMax = ",
          "    MAXX(FilterTable, [\" & myColumnName & \"])",
          "VAR ColumnMin = ",
          "    MINX(FilterTable, [\" & myColumnName & \"])",
          "VAR TOPX = IF(TableLength < \" & maxFilters & \", TableLength, \" & maxFilters &\")",
          "VAR ValuesInColumn = ",
          "    CONCATENATEX(TOPN(TOPX, FilterTable), [\" & myColumnName & \"], \"\", \"\") ",
          "RETURN",
          "    --\"\"TableLength: \"\" & TableLength  & \"\", Min: \"\" & ColumnMin & \"\", Max: \"\" & ColumnMax",
          "     \"\"TableLength: \"\" & TableLength  & \"\", Min: \"\" & ColumnMin & \"\", Max: \"\" & ColumnMax & UNICHAR(13) & UNICHAR(10) & \"\"Top \"\" & TOPX & \"\" Values: \"\" & ValuesInColumn",
          "                \"",
          "in",
          "    MeasureString ,",
          "documentation = [",
          "Documentation.Name =  \" DAX.CalculateDebugger.pq \",",
          "Documentation.Description = \" Produces DAX code to debug a filter argument of CALCULATE. \",",
          "Documentation.LongDescription = \" Produces DAX code to debug a filter argument of CALCULATE. <code>filterExpression</code> holds the code of the CALCULATE filter expression, <code>myColumnName</code> the name of the column whose values to show and optional <code>MaxFilters</code> can modify the default value of the first 10 sample values to show. See https://www.thebiccountant.com/2019/05/19/dax-calculate-debugger/\",",
          "Documentation.Category = \" DAX \",",
          "Documentation.Source = \" www.TheBIccountant.com .  https://wp.me/p6lgsG-1nD . \",",
          "Documentation.Version = \" 1.0 \",",
          "Documentation.Author = \" Imke Feldmann: www.TheBIccountant.com. https://wp.me/p6lgsG-1nD . \",",
          "Documentation.Examples = {[Description =  \"  \",",
          "Code = \"  \",",
          "Result = \"  \"]}]",
          "  ",
          " in  ",
          "  Value.ReplaceType(func, Value.ReplaceMetadata(Value.Type(func), documentation))"
        ],
        "kind": "m",
        "lineageTag": "9dfa57fe-7b5b-422f-aac7-1366565a4f49"
      },
      {
        "name": "Dates_Haq_fn",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Function"
          }
        ],
        "expression": [
          "let",
          "  customFunction =",
          "// 1.0: invoke function & define parameter inputs",
          "  ",
          "    let",
          "     // 4.0: edit function metadata here",
          "      documentation = [",
          "        // Inspired by Enterprise DNA - Melissa de Korte (https://www.youtube.com/watch?v=H8F60sgQZOI)",
          "        Documentation.Name = \" fnDates \", ",
          "        Documentation.Description = \" Dates Table with Fiscal and Academic Year \", ",
          "        Documentation.LongDescription = \"    ",
          "                <p><b>  Date Table Generator  </b></p>",
          "",
          "                <li>------------------------------------------------------</li>",
          "                ",
          "                <li><b>  Creator: </b> Imran Haq  </li>",
          "                <li><b>  Web: </b> https://github.com/PBIQueryous/M-Code/tree/main/Calendars  </li>",
          "                <li><b>  Acknowledgements: </b> Melissa de Korte  </li>",
          "                <li><b>  LinkedIn: </b> (https://www.linkedin.com/in/melissa-de-korte/)  </li>",
          "",
          "                <li>------------------------------------------------------</li>",
          "",
          "                <li><b>  Editor: </b>  Oscar Martinez  </li>",
          "                <li><b>  Web: </b>  https://bibb.pro  </li>",
          "                <li><b>  LinkedIn: </b>  https://www.linkedin.com/in/oscarmartinezv/  </li>",
          "",
          "                <li>------------------------------------------------------</li>",
          "",
          "                <p><b>  Function Description:  </b></p>",
          "                <p>  This function generates a date table with a range of dates from the start year to the end year. Additional parameters are available generate Fiscal/Financial and Academic Year columns.  </p>",
          "                <p><b>  Parameters:  </b></p>",
          "                <ul>",
          "                    <li><b>  StartYearNUM:  </b>  The starting year of the date range. <code> (eg: 2023) </code> </li>",
          "                    <li><b>  EndYearNUM:  </b>  The ending year of the date range. <code> (eg: 2025) </code> </li>",
          "                    <li><b>  FYStartMonthNUM (optional):  </b>  The fiscal year start month.  <code> (eg: 4) </code> </li>",
          "                    <li><b>  AYStartMonthNUM (optional):  </b>  The academic year start month.  <code> (eg: 8) </code> </li>",
          "                    <li><b>  Holidays (optional):  </b>  Provide a list of public holidays.   </li>",
          "                    <li><b>  WDStartNum (optional):  </b>  Weekday start (1 = Monday, 0 = Sunday).  <code> (eg: null) </code> </li>",
          "                    <li><b>  AddRelativeNetworkDays (optional):  </b>  Include Relative Network Days.  <code> (eg: null) </code> </li>",
          "                </ul>",
          "                <p><b>  Returns:  </b></p>",
          "                <p>  A date table.  </p>",
          "",
          "                <li><b>  fx:  </b> <code> = fnDates(2023, 2025, 4, 8, null, null, null) </code> </li>",
          "            \", ",
          "        Documentation.Category = \" Dates / Calendar \", ",
          "        Documentation.Source = \"  PBI Queryous  \", ",
          "        Documentation.Version = \" 4.0: Upated for Oscar Valderock\", ",
          "        Documentation.Author = \" Imran Haq \", ",
          "        Documentation.Examples = {",
          "          [",
          "            Description = \"  Dates Table with Fiscal and Academic Year   \", ",
          "            Code = \" = fnDates(2023, 2025, 4, 8, null, null, null) \", ",
          "            Result = ",
          "\"",
          "  1. Input paramaters",
          "  2. Invoke function",
          "  3. Optional: replace start / end year parameters with dynamic values to automatically extend table",
          "",
          "\"",
          "          ]",
          "        /* ,",
          "            [",
          "            Description = \"  description   \",",
          "            Code    = \" code \", ",
          "            Result  = \" result #(cr,lf) new line",
          "                      #(cr,lf) new line #(cr,lf) 2 \"",
          "            ] */",
          "        }",
          "      ], ",
          "      invokeFunction = (StartYearNUM as number,  // start year             ",
          "      EndYearNUM as number,  // end year           ",
          "      optional FYStartMonthNum as nullable number,  // Fiscal Year Start                    ",
          "      optional AYStartMonthNum as nullable number,  // Academic Year Start                      ",
          "      optional Holidays as list,  // Holidays list                ",
          "      optional WDStartNum as number,  // WeekDay Start                ",
          "      optional AddRelativeNetWorkdays as logical // Network Days               ",
          "      ) as table =>",
          "        // ------------------------------------------------------------------",
          "        // 2.0: function transformations",
          "let",
          "          // // //Parameters",
          "",
          "          // StartDate = #date(2020, 1, 1), // - turn off in custom function",
          "          // EndDate = #date(2024, 12, 31), // -turn off in custom function",
          "          // FYStartMonthNum = 4,",
          "          // AYStartMonthNum  = 8,",
          "          // Holidays = {},",
          "          // WDStartNum = 1,",
          "          // AddRelativeNetWorkdays = true,",
          "",
          "        // //-- Date table code",
          "",
          "          StartDate = #date(StartYearNUM, 01 , 01),  // -- turn ON for CUSTOM FN",
          "          EndDate = #date(EndYearNUM, 12 ,31),  // -- turn ON for CUSTOM FN  ",
          "                                                                             ",
          "          FYStartMonth = List.Select({1 .. 12}, each _ = FYStartMonthNum){0}? ?? 1, ",
          "          AYStartMonth = List.Select({1 .. 12}, each _ = AYStartMonthNum){0}? ?? 1, ",
          "          WDStart = List.Select({0 .. 1}, each _ = WDStartNum){0}? ?? 0, ",
          "          var_CurrentDate = Date.From(DateTime.FixedLocalNow()), ",
          "          var_DayCount = Duration.Days(Duration.From(EndDate - StartDate)) + 1, ",
          "          list_Dates = List.Dates(StartDate, var_DayCount, #duration(1, 0, 0, 0)), ",
          "          tx_AddToday = ",
          "            if EndDate < var_CurrentDate then",
          "              List.Combine({list_Dates, {var_CurrentDate}})",
          "            else",
          "              list_Dates, ",
          "          make_Table = Table.FromList(",
          "            tx_AddToday, ",
          "            Splitter.SplitByNothing(), ",
          "            type table [Date = Date.Type]",
          "          ), ",
          "          ",
          "          // start deriving columns here",
          "",
          "          // Year as integer",
          "          col_Year = Table.AddColumn(make_Table, \"YearNUM\", each Date.Year([Date]), type number),",
          "",
          "          // calendar Year Offset ",
          "          col_YearOFFSET = Table.AddColumn(",
          "            col_Year, ",
          "            \"YearOFFSET\", ",
          "            each Date.Year([Date]) - Date.Year(Date.From(var_CurrentDate)), ",
          "            type number",
          "          ), ",
          "",
          "          // is current calendar year complete as boolean",
          "          col_isYearComplete = Table.AddColumn(",
          "            col_YearOFFSET, ",
          "            \"isYearComplete\", ",
          "            each Date.EndOfYear([Date]) < Date.From(Date.EndOfYear(var_CurrentDate)), ",
          "            type logical",
          "          ),",
          "",
          "",
          "          // calendar quarter as integer ",
          "          col_QuarterNUM = Table.AddColumn(",
          "            col_isYearComplete, ",
          "            \"QuarterNUM\", ",
          "            each Date.QuarterOfYear([Date]), ",
          "            type number",
          "          ),",
          "",
          "          // calendar quart as text ",
          "          col_QuarterTXT = Table.AddColumn(",
          "            col_QuarterNUM, ",
          "            \"Quarter\", ",
          "            each \"Q\" & Number.ToText([QuarterNUM]), ",
          "            type text",
          "          ),",
          "",
          "          // start of calendar quarter as date ",
          "          col_QuarterSTART = Table.AddColumn(",
          "            col_QuarterTXT, ",
          "            \"Quarter Start\", ",
          "            each Date.StartOfQuarter([Date]), ",
          "            type date",
          "          ),",
          "",
          "          // end of calendar quarter as date ",
          "          col_QuarterEND = Table.AddColumn(",
          "            col_QuarterSTART, ",
          "            \"Quarter End\", ",
          "            each Date.EndOfQuarter([Date]), ",
          "            type date",
          "          ),",
          "",
          "          // calendar quarter & year as text (Q1 23) ",
          "          col_Quarter_Year = Table.AddColumn(",
          "            col_QuarterEND, ",
          "            \"Quarter & Year\", ",
          "            each \"Q\"",
          "              & Number.ToText(Date.QuarterOfYear([Date]))",
          "              & Date.ToText([Date], [Format = \" yy\"]), ",
          "            type text",
          "          ), ",
          "",
          "          // calendar quarter and year as integer key (202302)",
          "          col_QuarterYearINT = Table.AddColumn(",
          "            col_Quarter_Year, ",
          "            \"QuarterYearINT\", ",
          "            each [YearNUM] * 10 + [QuarterNUM], ",
          "            type number",
          "          ), ",
          "",
          "          // calendar quarter offset",
          "          col_QuarterOFFSET = Table.AddColumn(",
          "            col_QuarterYearINT, ",
          "            \"QuarterOFFSET\", ",
          "            each ((4 * Date.Year([Date])) + Date.QuarterOfYear([Date]))",
          "              - (",
          "                (4 * Date.Year(Date.From(var_CurrentDate)))",
          "                  + Date.QuarterOfYear(Date.From(var_CurrentDate))",
          "              ), ",
          "            type number",
          "          ), ",
          "",
          "          // is current quarter complete as boolean",
          "          col_isQuarterComplete = Table.AddColumn(",
          "            col_QuarterOFFSET, ",
          "            \"isQuarterComplete\", ",
          "            each ",
          "              let",
          "                qtrEnd        = Date.EndOfQuarter([Date]), ",
          "                currQtrEnd    = Date.From(Date.EndOfQuarter(var_CurrentDate)), ",
          "                isQtrComplete = qtrEnd < currQtrEnd",
          "              in",
          "                isQtrComplete, ",
          "            type logical",
          "          ), ",
          "",
          "          // calendar month num",
          "          col_MonthNUM = Table.AddColumn(",
          "            col_isQuarterComplete, ",
          "            \"MonthNUM\", ",
          "            each Date.Month([Date]), ",
          "            type number",
          "          ), ",
          "",
          "          // calendar month start date",
          "          col_MonthSTART = Table.AddColumn(",
          "            col_MonthNUM, ",
          "            \"Month Start\", ",
          "            each Date.StartOfMonth([Date]), ",
          "            type date",
          "          ), ",
          "",
          "          // calendar month end date",
          "          col_MonthEND = Table.AddColumn(",
          "            col_MonthSTART, ",
          "            \"Month End\", ",
          "            each Date.EndOfMonth([Date]), ",
          "            type date",
          "          ), ",
          "",
          "          // calendar month and year as text",
          "          col_CalendarMONTH = Table.AddColumn(",
          "            col_MonthEND, ",
          "            \"Month & Year\", ",
          "            each Text.Proper(Date.ToText([Date], [Format = \"MMM yy\"])), ",
          "            type text",
          "          ), ",
          "",
          "          // calendar month and year as integer key (20230001)",
          "          col_MonthYearINT = Table.AddColumn(",
          "            col_CalendarMONTH, ",
          "            \"MonthYearINT\", ",
          "            each [YearNUM] * 100 + [MonthNUM], ",
          "            type number",
          "          ), ",
          "",
          "          // calendar month offset",
          "          col_MonthOFFSET = Table.AddColumn(",
          "            col_MonthYearINT, ",
          "            \"MonthOFFSET\", ",
          "            each ((12 * Date.Year([Date])) + Date.Month([Date]))",
          "              - (",
          "                (12 * Date.Year(Date.From(var_CurrentDate)))",
          "                  + Date.Month(Date.From(var_CurrentDate))",
          "              ), ",
          "            type number",
          "          ), ",
          "",
          "          // is month complete as boolean",
          "          col_isMonthComplete = Table.AddColumn(",
          "            col_MonthOFFSET, ",
          "            \"isMonthComplete\", ",
          "            each Date.EndOfMonth([Date]) < Date.From(Date.EndOfMonth(var_CurrentDate)), ",
          "            type logical",
          "          ), ",
          "",
          "          // month long name",
          "          col_MonthNAME = Table.AddColumn(",
          "            col_isMonthComplete, ",
          "            \"Month Name\", ",
          "            each Text.Proper(Date.ToText([Date], \"MMMM\")), ",
          "            type text",
          "          ), ",
          "",
          "          // month short name",
          "          col_MonthNameSHORT = Table.AddColumn(",
          "            col_MonthNAME, ",
          "            \"Month Short\", ",
          "            each Text.Proper(Date.ToText([Date], \"MMM\")), ",
          "            type text",
          "          ), ",
          "",
          "          // month initial",
          "          col_MonthNameINITIAL = Table.AddColumn(",
          "            col_MonthNameSHORT, ",
          "            \"Month Initial\", ",
          "            each Text.Start([Month Name], 1)",
          "              & Text.Repeat(Character.FromNumber(8203), Date.Month([Date])), ",
          "            type text",
          "          ), ",
          "",
          "          // variable (current month name)",
          "          var_CurrentMonthName = Date.MonthName(DateTime.LocalNow()), ",
          "",
          "          // month selection (if month name = variable_crrentMonthName, then \"Current\" else [Month Short] )",
          "          col_MonthSelection = Table.AddColumn(",
          "            col_MonthNameINITIAL, ",
          "            \"Month Selection\", ",
          "            each if [Month Name] = var_CurrentMonthName then \"Current\" else [Month Short], ",
          "            type text",
          "          ), ",
          "",
          "          // fiscal month ( duplicate for report purposes - needs fiscal month sort order)",
          "          col_FiscalMonth = Table.DuplicateColumn(col_MonthSelection, \"Month Short\", \"Fiscal Month\", type text),",
          "",
          "          // academic month ( duplicate for report purposes - needs academic month sort order)",
          "          col_AcademicMonth = Table.DuplicateColumn(col_FiscalMonth, \"Month Short\", \"Academic Month\", type text),",
          "          ",
          "          // add day month number",
          "          col_DayMonthNUM = Table.AddColumn(",
          "            col_AcademicMonth, ",
          "            \"DayMonthNUM\", ",
          "            each Date.Day([Date]), ",
          "            type number",
          "          ), ",
          "",
          "          // calendar week number",
          "          col_WeekNUM = Table.AddColumn(",
          "            col_DayMonthNUM, ",
          "            \"Week Number\", ",
          "            each ",
          "              if Number.RoundDown(",
          "                (Date.DayOfYear([Date]) - (Date.DayOfWeek([Date], Day.Monday) + 1) + 10) / 7",
          "              )",
          "                = 0",
          "              then",
          "                Number.RoundDown(",
          "                  (",
          "                    Date.DayOfYear(#date(Date.Year([Date]) - 1, 12, 31))",
          "                      - (Date.DayOfWeek(#date(Date.Year([Date]) - 1, 12, 31), Day.Monday) + 1)",
          "                      + 10",
          "                  )",
          "                    / 7",
          "                )",
          "              else if (",
          "                Number.RoundDown(",
          "                  (Date.DayOfYear([Date]) - (Date.DayOfWeek([Date], Day.Monday) + 1) + 10) / 7",
          "                )",
          "                  = 53 and (Date.DayOfWeek(#date(Date.Year([Date]), 12, 31), Day.Monday) + 1 < 4)",
          "              )",
          "              then",
          "                1",
          "              else",
          "                Number.RoundDown(",
          "                  (Date.DayOfYear([Date]) - (Date.DayOfWeek([Date], Day.Monday) + 1) + 10) / 7",
          "                ), ",
          "            type number",
          "          ), ",
          "",
          "          // calendar week start date",
          "          col_WeekSTART = Table.AddColumn(",
          "            col_WeekNUM, ",
          "            \"Week Start\", ",
          "            each Date.StartOfWeek([Date], Day.Monday), ",
          "            type date",
          "          ), ",
          "",
          "          // calendar week end date",
          "          col_WeekEND = Table.AddColumn(",
          "            col_WeekSTART, ",
          "            \"Week End\", ",
          "            each Date.EndOfWeek([Date], Day.Monday), ",
          "            type date",
          "          ), ",
          "",
          "          // week and year as text",
          "          col_CalendarWEEK = Table.AddColumn(",
          "            col_WeekEND, ",
          "            \"Week & Year\", ",
          "            each \"W\"",
          "              & Text.PadStart(Text.From([Week Number]), 2, \"0\")",
          "              & \" \"",
          "              & Text.End(",
          "                Text.From(Date.Year(Date.AddDays(Date.StartOfWeek([Date], Day.Monday), 3))), ",
          "                2",
          "              ), ",
          "            type text",
          "          ), ",
          "",
          "          // week year integer",
          "          col_WeekYearINT = Table.AddColumn(",
          "            col_CalendarWEEK, ",
          "            \"WeekYearINT\", ",
          "            each Date.Year(Date.AddDays(Date.StartOfWeek([Date], Day.Monday), 3))",
          "              * 100 + [Week Number], ",
          "            Int64.Type",
          "          ), ",
          "          col_WeekOFFSET = Table.AddColumn(",
          "            col_WeekYearINT, ",
          "            \"WeekOFFSET\", ",
          "            each (",
          "              Number.From(Date.StartOfWeek([Date], Day.Monday))",
          "                - Number.From(Date.StartOfWeek(var_CurrentDate, Day.Monday))",
          "            )",
          "              / 7, ",
          "            type number",
          "          ), ",
          "          col_isWeekComplete = Table.AddColumn(",
          "            col_WeekOFFSET, ",
          "            \"WeekCompleted\", ",
          "            each Date.EndOfWeek([Date], Day.Monday)",
          "              < Date.From(Date.EndOfWeek(var_CurrentDate, Day.Monday)), ",
          "            type logical",
          "          ), ",
          "          col_DayWeekNUM = Table.AddColumn(",
          "            col_isWeekComplete, ",
          "            \"DayWeekNUM\", ",
          "            each Date.DayOfWeek([Date], Day.Monday) + WDStart, ",
          "            Int64.Type",
          "          ), ",
          "          col_DayNAME = Table.AddColumn(",
          "            col_DayWeekNUM, ",
          "            \"Day of Week Name\", ",
          "            each Text.Proper(Date.ToText([Date], \"dddd\")), ",
          "            type text",
          "          ), ",
          "          col_DayINITIAL = Table.AddColumn(",
          "            col_DayNAME, ",
          "            \"Day Initial\", ",
          "            each Text.Proper(Text.Start([Day of Week Name], 1))",
          "              & Text.Repeat(",
          "                Character.FromNumber(8203), ",
          "                Date.DayOfWeek([Date], Day.Monday) + WDStart",
          "              ), ",
          "            type text",
          "          ), ",
          "          col_DayYearNUM = Table.AddColumn(",
          "            col_DayINITIAL, ",
          "            \"DayYearNUM\", ",
          "            each Date.DayOfYear([Date]), ",
          "            Int64.Type",
          "          ), ",
          "          col_DayMonthYearINT = Table.AddColumn(",
          "            col_DayYearNUM, ",
          "            \"DateINT\", ",
          "            each [YearNUM] * 10000 + [MonthNUM] * 100 + [DayMonthNUM], ",
          "            type number",
          "          ), ",
          "          col_DayOFFSET = Table.AddColumn(",
          "            col_DayMonthYearINT, ",
          "            \"DayOffset\", ",
          "            each Number.From([Date]) - Number.From(var_CurrentDate), ",
          "            type number",
          "          ), ",
          "          col_isYTD = Table.AddColumn(",
          "            col_DayOFFSET, ",
          "            \"IsYTD\", ",
          "            each ([Date] <= Date.From(var_CurrentDate)), ",
          "            type logical",
          "          ), ",
          "          col_isFuture = Table.AddColumn(",
          "            col_isYTD, ",
          "            \"IsFuture\", ",
          "            each not ([Date] <= Date.From(var_CurrentDate)), ",
          "            type logical",
          "          ), ",
          "          col_isAfterToday = Table.AddColumn(",
          "            col_isFuture, ",
          "            \"IsAfterToday\", ",
          "            each not ([Date] <= Date.From(var_CurrentDate)), ",
          "            type logical",
          "          ), ",
          "          col_isWeekDay = Table.AddColumn(",
          "            col_isAfterToday, ",
          "            \"IsWeekDay\", ",
          "            each if Date.DayOfWeek([Date], Day.Monday) > 4 then false else true, ",
          "            type logical",
          "          ), ",
          "          col_isHoliday = Table.AddColumn(",
          "            col_isWeekDay, ",
          "            \"IsHoliday\", ",
          "            each if Holidays = null then \"Unknown\" else List.Contains(Holidays, [Date]), ",
          "            if Holidays = null then type text else type logical",
          "          ), ",
          "          col_isBusinessDay = Table.AddColumn(",
          "            col_isHoliday, ",
          "            \"IsBusinessDay\", ",
          "            each if [IsWeekDay] = true and [IsHoliday] <> true then true else false, ",
          "            type logical",
          "          ), ",
          "          col_DayTYPE = Table.AddColumn(",
          "            col_isBusinessDay, ",
          "            \"Day Type\", ",
          "            each ",
          "              if [IsHoliday] = true then",
          "                \"Holiday\"",
          "              else if [IsWeekDay] = false then",
          "                \"Weekend\"",
          "              else if [IsWeekDay] = true then",
          "                \"Weekday\"",
          "              else",
          "                null, ",
          "            type text",
          "          ), ",
          "          col_ISOYear = Table.AddColumn(",
          "            col_DayTYPE, ",
          "            \"ISO Year\", ",
          "            each Date.Year(Date.AddDays(Date.StartOfWeek([Date], Day.Monday), 3)), ",
          "            type number",
          "          ), ",
          "          col_ISOQuarterNUM = Table.AddColumn(",
          "            col_ISOYear, ",
          "            \"ISO QuarterNUM\", ",
          "            each ",
          "              if [Week Number] > 39 then",
          "                4",
          "              else if [Week Number] > 26 then",
          "                3",
          "              else if [Week Number] > 13 then",
          "                2",
          "              else",
          "                1, ",
          "            Int64.Type",
          "          ), ",
          "          col_ISOQuarterNAME = Table.AddColumn(",
          "            col_ISOQuarterNUM, ",
          "            \"ISO Quarter\", ",
          "            each \"Q\" & Number.ToText([ISO QuarterNUM]), ",
          "            type text",
          "          ), ",
          "          col_ISOQuarterYearNAME = Table.AddColumn(",
          "            col_ISOQuarterNAME, ",
          "            \"ISO Quarter & Year\", ",
          "            each \"Q\" & Number.ToText([ISO QuarterNUM]) & \" \" & Number.ToText([ISO Year]), ",
          "            type text",
          "          ), ",
          "          col_ISOQuarterYearINT = Table.AddColumn(",
          "            col_ISOQuarterYearNAME, ",
          "            \"ISO QuarterYearINT\", ",
          "            each [ISO Year] * 10 + [ISO QuarterNUM], ",
          "            type number",
          "          ), ",
          "          // BufferTable = Table.Buffer(Table.Distinct( col_ISOQuarterYearINT[[ISO Year], [DateInt]])),",
          "          // InsertISOday = Table.AddColumn(col_ISOQuarterYearINT, \"ISO Day of Year\", (OT) => Table.RowCount( Table.SelectRows( BufferTable, (IT) => IT[DateInt] <= OT[DateInt] and IT[ISO Year] = OT[ISO Year])),  Int64.Type),",
          "          col_FY = Table.AddColumn(",
          "            col_ISOQuarterYearINT, ",
          "            \"Fiscal Year\", ",
          "            each ",
          "              let",
          "                arg1     = ([MonthNUM] >= FYStartMonth and FYStartMonth > 1), ",
          "                yearNum1 = Text.End(Text.From([YearNUM] + 0), 2), ",
          "                yearNum0 = Text.End(Text.From([YearNUM] - 1), 2), ",
          "                result1  = if arg1 then yearNum1 else yearNum0",
          "              in",
          "                \"FY\" & result1, ",
          "            type text",
          "          ),",
          "          col_FY1 = Table.AddColumn(",
          "            col_FY, ",
          "            \"Fiscal_Year\", ",
          "            each ",
          "              let",
          "                ",
          "                yearNum1 = Number.From(Text.End([Fiscal Year], 2)), ",
          "                 ",
          "                result1  = Text.From(yearNum1) & \"/\" & Text.From(yearNum1+1)",
          "              in",
          "                result1, ",
          "            type text",
          "          ), ",
          "          col_AY = Table.AddColumn(",
          "            col_FY1, ",
          "            \"Academic Year\", ",
          "            each ",
          "              let",
          "                arg1     = ([MonthNUM] >= AYStartMonth and AYStartMonth > 1), ",
          "                yearNum1 = Text.End(Text.From([YearNUM] + 0), 2), ",
          "                yearNum0 = Text.End(Text.From([YearNUM] - 1), 2), ",
          "                result1  = if arg1 then yearNum1 else yearNum0",
          "              in",
          "                \"AY\" & result1, ",
          "            type text",
          "          ),",
          "          col_AY1 = Table.AddColumn(",
          "            col_AY, ",
          "            \"Academic_Year\", ",
          "            each ",
          "              let",
          "                ",
          "                yearNum1 = Number.From(Text.End([Academic Year], 2)), ",
          "                 ",
          "                result1  = Text.From(yearNum1) & \"/\" & Text.From(yearNum1+1)",
          "              in",
          "                result1, ",
          "            type text",
          "          ),  ",
          "          //col_FYs = Table.AddColumn(col_FY, \"Fiscal Year short\", each \"FY\" & (if [MonthNUM] >= FYStartMonth and FYStartMonth >1 then Text.PadEnd( Text.End( Text.From([YearNUM] +1), 2), 2, \"0\") else Text.End( Text.From([YearNUM]), 2)), type text),",
          "          col_FQ = Table.AddColumn(",
          "            col_AY1, ",
          "            \"Fiscal Quarter\", ",
          "            each \"FQ\"",
          "              & Text.From(",
          "                Number.RoundUp(Date.Month(Date.AddMonths([Date], - (FYStartMonth - 1))) / 3)",
          "              )",
          "              & \" \"",
          "              & (",
          "                if [MonthNUM] >= FYStartMonth and FYStartMonth > 1 then",
          "                  Text.End(Text.From([YearNUM] + 0), 2)",
          "                else",
          "                  Text.End(Text.From([YearNUM] - 1), 2)",
          "              ), ",
          "            type text",
          "          ), ",
          "          col_AQ = Table.AddColumn(",
          "            col_FQ, ",
          "            \"Academic Quarter\", ",
          "            each \"AQ\"",
          "              & Text.From(",
          "                Number.RoundUp(Date.Month(Date.AddMonths([Date], - (AYStartMonth - 1))) / 3)",
          "              )",
          "              & \" \"",
          "              & (",
          "                if [MonthNUM] >= AYStartMonth and AYStartMonth > 1 then",
          "                  Text.End(Text.From([YearNUM] + 0), 2)",
          "                else",
          "                  Text.End(Text.From([YearNUM] - 1), 2)",
          "              ), ",
          "            type text",
          "          ), ",
          "          col_FQtrYrINT = Table.AddColumn(",
          "            col_AQ, ",
          "            \"FiscalQuarterYearINT\", ",
          "            each (",
          "              if [MonthNUM] >= FYStartMonth and FYStartMonth > 1 then",
          "                [YearNUM] + 0",
          "              else",
          "                [YearNUM] - 1",
          "            )",
          "              * 10 + Number.RoundUp(Date.Month(Date.AddMonths([Date], - (FYStartMonth - 1))) / 3), ",
          "            type number",
          "          ), ",
          "          col_AQtrYrINT = Table.AddColumn(",
          "            col_FQtrYrINT, ",
          "            \"AcademicQuarterYearINT\", ",
          "            each (",
          "              if [MonthNUM] >= AYStartMonth and AYStartMonth > 1 then",
          "                [YearNUM] + 0",
          "              else",
          "                [YearNUM] - 1",
          "            )",
          "              * 10 + Number.RoundUp(Date.Month(Date.AddMonths([Date], - (AYStartMonth - 1))) / 3), ",
          "            type number",
          "          ), ",
          "          col_FPNUM = Table.AddColumn(",
          "            col_AQtrYrINT, ",
          "            \"FiscalPeriodNUM\", ",
          "            each ",
          "              let",
          "                arg1   = [MonthNUM] >= FYStartMonth and FYStartMonth > 1, ",
          "                res1   = [MonthNUM] - (FYStartMonth - 1), ",
          "                arg2   = [MonthNUM] >= FYStartMonth and FYStartMonth = 1, ",
          "                res2   = [MonthNUM], ",
          "                res3   = [MonthNUM] + (12 - FYStartMonth + 1), ",
          "                result = if arg1 then res1 else if arg2 then res2 else res3",
          "              in",
          "                result, ",
          "            type number",
          "          ), ",
          "          col_APNUM = Table.AddColumn(",
          "            col_FPNUM, ",
          "            \"AcademicPeriodNUM\", ",
          "            each ",
          "              let",
          "                arg1   = [MonthNUM] >= AYStartMonth and AYStartMonth > 1, ",
          "                res1   = [MonthNUM] - (AYStartMonth - 1), ",
          "                arg2   = [MonthNUM] >= AYStartMonth and AYStartMonth = 1, ",
          "                res2   = [MonthNUM], ",
          "                res3   = [MonthNUM] + (12 - AYStartMonth + 1), ",
          "                result = if arg1 then res1 else if arg2 then res2 else res3",
          "              in",
          "                result, ",
          "            type number",
          "          ), ",
          "          col_FYPeriod = Table.AddColumn(",
          "            col_APNUM, ",
          "            \"Fiscal Period\", ",
          "            each \"FP\"",
          "              & Text.PadStart(Text.From([FiscalPeriodNUM]), 2, \"0\")",
          "              & \" \"",
          "              & (",
          "                if [MonthNUM] >= FYStartMonth and FYStartMonth > 1 then",
          "                  Text.End(Text.From([YearNUM] + 0), 2)",
          "                else",
          "                  Text.End(Text.From([YearNUM] - 1), 2)",
          "              ), ",
          "            type text",
          "          ), ",
          "          col_AYPeriod = Table.AddColumn(",
          "            col_FYPeriod, ",
          "            \"Academic Period\", ",
          "            each \"AP\"",
          "              & Text.PadStart(Text.From([AcademicPeriodNUM]), 2, \"0\")",
          "              & \" \"",
          "              & (",
          "                if [MonthNUM] >= AYStartMonth and AYStartMonth > 1 then",
          "                  Text.End(Text.From([YearNUM] + 0), 2)",
          "                else",
          "                  Text.End(Text.From([YearNUM] - 1), 2)",
          "              ), ",
          "            type text",
          "          ), ",
          "          col_FPYrINT = Table.AddColumn(",
          "            col_AYPeriod, ",
          "            \"FiscalPeriodYearINT\", ",
          "            each (",
          "              if [MonthNUM] >= FYStartMonth and FYStartMonth > 1 then",
          "                [YearNUM] + 0",
          "              else",
          "                [YearNUM] - 1",
          "            )",
          "              * 100 + [FiscalPeriodNUM], ",
          "            type number",
          "          ), ",
          "          col_APYrINT = Table.AddColumn(",
          "            col_FPYrINT, ",
          "            \"AcademicPeriodYearINT\", ",
          "            each (",
          "              if [MonthNUM] >= AYStartMonth and AYStartMonth > 1 then",
          "                [YearNUM] + 0",
          "              else",
          "                [YearNUM] - 1",
          "            )",
          "              * 100 + [AcademicPeriodNUM], ",
          "            type number",
          "          ), ",
          "          var_FiscalCalendarSTART = #date(Date.Year(StartDate) - 1, FYStartMonth, 1), ",
          "          var_AcademicCalendarSTART = #date(Date.Year(StartDate) - 1, AYStartMonth, 1), ",
          "          col_FiscalFirstDay = Table.AddColumn(",
          "            col_APYrINT, ",
          "            \"FiscalFirstDate\", ",
          "            each ",
          "              if [MonthNUM] >= FYStartMonth and FYStartMonth > 1 then",
          "                #date(Date.Year([Date]) + 0, FYStartMonth, 1)",
          "              else",
          "                #date(Date.Year([Date]) - 1, FYStartMonth, 1), ",
          "            type date",
          "          ), ",
          "          col_AYStartDate = Table.AddColumn(",
          "            col_FiscalFirstDay, ",
          "            \"AYStartDate\", ",
          "            each ",
          "              if [MonthNUM] >= AYStartMonth and AYStartMonth > 1 then",
          "                #date(Date.Year([Date]) + 0, AYStartMonth, 1)",
          "              else",
          "                #date(Date.Year([Date]) - 1, AYStartMonth, 1), ",
          "            type date",
          "          ), ",
          "          col_AYEndDate = Table.AddColumn(",
          "            col_AYStartDate, ",
          "            \"AYEndDate\", ",
          "            each ",
          "              if [MonthNUM] >= AYStartMonth and AYStartMonth > 1 then",
          "                Date.AddDays(#date(Date.Year([Date]) + 1, AYStartMonth, 1),-1)",
          "              else",
          "                Date.AddDays(#date(Date.Year([Date]) - 0, AYStartMonth, 1),-1), ",
          "            type date",
          "          ), ",
          "          col_FYStartDate = Table.AddColumn(",
          "            col_AYEndDate, ",
          "            \"FYStartDate\", ",
          "            each ",
          "              if [MonthNUM] >= FYStartMonth and FYStartMonth > 1 then",
          "                #date(Date.Year([Date]) + 0, FYStartMonth, 1)",
          "              else",
          "                #date(Date.Year([Date]) - 1, FYStartMonth, 1), ",
          "            type date",
          "          ), ",
          "          col_FYEndDate = Table.AddColumn(",
          "            col_FYStartDate, ",
          "            \"FYEndDate\", ",
          "            each ",
          "              if [MonthNUM] >= FYStartMonth and FYStartMonth > 1 then",
          "                Date.AddDays(#date(Date.Year([Date]) + 1, FYStartMonth, 1),-1)",
          "              else",
          "                Date.AddDays(#date(Date.Year([Date]) - 0, FYStartMonth, 1),-1), ",
          "            type date",
          "          ),",
          "          //------------------------------------------\\\\ ",
          "          //----- begin sub-ETL stages and return later ----\\\\",
          "          var_Table = Table.FromList(",
          "            List.Transform(",
          "              {Number.From(var_AcademicCalendarSTART) .. Number.From(EndDate)}, ",
          "              Date.From",
          "            ), ",
          "            Splitter.SplitByNothing(), ",
          "            type table [DateFW = Date.Type]",
          "          ), ",
          "          col_FFD = Table.AddColumn(",
          "            var_Table, ",
          "            \"FiscalFirstDay\", ",
          "            each ",
          "              if Date.Month([DateFW]) < FYStartMonth then",
          "                #date(Date.Year([DateFW]) - 1, FYStartMonth, 1)",
          "              else",
          "                #date(Date.Year([DateFW]) + 0, FYStartMonth, 1)",
          "          ), ",
          "          col_FWSD = Table.AddColumn(",
          "            col_FFD, ",
          "            \"FWStartDate\", ",
          "            each Date.AddYears(Date.StartOfWeek([DateFW], Day.Monday), 0)",
          "          ), ",
          "          tbl_Group1 = Table.Group(",
          "            col_FWSD, ",
          "            {\"FiscalFirstDay\", \"FWStartDate\"}, ",
          "            {",
          "              {",
          "                \"AllRows\", ",
          "                each _, ",
          "                type table [DateFW = nullable date, FiscalFirstDay = date, FWStartDate = date]",
          "              }",
          "            }",
          "          ), ",
          "          tbl_Group2 = Table.Group(",
          "            tbl_Group1, ",
          "            {\"FiscalFirstDay\"}, ",
          "            {",
          "              {",
          "                \"AllRows2\", ",
          "                each _, ",
          "                type table [FiscalFirstDay = date, FWStartDate = date, AllRows = table]",
          "              }",
          "            }",
          "          ), ",
          "          col_Index = Table.AddColumn(",
          "            tbl_Group2, ",
          "            \"Custom\", ",
          "            each Table.AddIndexColumn([AllRows2], \"Fiscal Week Number\", 1, 1)",
          "          )[[Custom]], ",
          "          cols_Expand1 = Table.ExpandTableColumn(",
          "            col_Index, ",
          "            \"Custom\", ",
          "            {\"FiscalFirstDay\", \"FWStartDate\", \"AllRows\", \"Fiscal Week Number\"}, ",
          "            {\"FiscalFirstDay\", \"FWStartDate\", \"AllRows\", \"Fiscal Week Number\"}",
          "          ), ",
          "          cols_Expand2 = Table.ExpandTableColumn(cols_Expand1, \"AllRows\", {\"DateFW\"}, {\"DateFW\"})[",
          "            [DateFW], ",
          "            [Fiscal Week Number]",
          "          ], ",
          "          //------ return here to begin ETL steps again",
          "          join_Date_DateFW = Table.Join(",
          "            col_FYEndDate, ",
          "            {\"Date\"}, ",
          "            cols_Expand2, ",
          "            {\"DateFW\"}, ",
          "            JoinKind.LeftOuter, ",
          "            JoinAlgorithm.SortMerge",
          "          ), ",
          "          var_FYLogicTest = List.Contains({null}, FYStartMonthNum), ",
          "          var_AYLogicTest = List.Contains({null}, AYStartMonthNum), ",
          "          var_FYAYTest = var_FYLogicTest = true and var_AYLogicTest = true, ",
          "          txt_Replace = ",
          "            if var_AYLogicTest then",
          "              Table.ReplaceValue(",
          "                join_Date_DateFW, ",
          "                each [Fiscal Week Number], ",
          "                each if FYStartMonth = 1 then [Week Number] else [Fiscal Week Number], ",
          "                Replacer.ReplaceValue, ",
          "                {\"Fiscal Week Number\"}",
          "              )",
          "            else",
          "              join_Date_DateFW, ",
          "          col_FYW = Table.AddColumn(",
          "            txt_Replace, ",
          "            \"Fiscal Week\", ",
          "            each ",
          "              if var_AYLogicTest then",
          "                \"F\" & [#\"Week & Year\"]",
          "              else if FYStartMonth = 1 then",
          "                \"FW\"",
          "                  & Text.PadStart(Text.From([Fiscal Week Number]), 2, \"0\")",
          "                  & Date.ToText(Date.AddYears([Date], 0), \" yy\")",
          "              else if Date.Month([Date]) < FYStartMonth then",
          "                \"FW\"",
          "                  & Text.PadStart(Text.From([Fiscal Week Number]), 2, \"0\")",
          "                  & Date.ToText(Date.AddYears([Date], - 1), \" yy\")",
          "              else",
          "                \"FW\"",
          "                  & Text.PadStart(Text.From([Fiscal Week Number]), 2, \"0\")",
          "                  & \" \"",
          "                  & Text.End(Text.From(Date.Year([Date]) + 0), 2), ",
          "            type text",
          "          ), ",
          "          col_FWYearINT = Table.AddColumn(",
          "            col_FYW, ",
          "            \"FiscalWeekYearINT\", ",
          "            each ",
          "              if var_FYLogicTest then",
          "                [WeeknYear]",
          "              else",
          "                (",
          "                  if FYStartMonth = 1 then",
          "                    Date.Year([Date])",
          "                  else if Date.Month([Date]) < FYStartMonth then",
          "                    Date.Year([Date]) - 1",
          "                  else",
          "                    Date.Year([Date]) + 0",
          "                )",
          "                  * 100 + [Fiscal Week Number], ",
          "            Int64.Type",
          "          ), ",
          "          rec_CurrentDate = Table.SelectRows(col_FWYearINT, each ([Date] = var_CurrentDate)), ",
          "          var_CurrISOYear = rec_CurrentDate{0}[ISO Year], ",
          "          var_CurrISOQtr = rec_CurrentDate{0}[ISO QuarterNUM], ",
          "          var_CurrYear = rec_CurrentDate{0}[YearNUM], ",
          "          var_CurrMonth = rec_CurrentDate{0}[MonthNUM], ",
          "          var_FFD = rec_CurrentDate{0}[FiscalFirstDate], ",
          "          var_AFD = rec_CurrentDate{0}[AYStartDate], ",
          "          var_PFFD = Date.AddYears(var_FFD, - 1), ",
          "          var_PAFD = Date.AddYears(var_AFD, - 1), ",
          "          var_CurrFY = rec_CurrentDate{0}[Fiscal Year], ",
          "          var_CurrAY = rec_CurrentDate{0}[Academic Year], ",
          "          var_CurrFQ = rec_CurrentDate{0}[FiscalQuarterYearINT], ",
          "          var_CurrAQ = rec_CurrentDate{0}[AcademicQuarterYearINT], ",
          "          var_CurrFP = rec_CurrentDate{0}[FiscalPeriodYearINT], ",
          "          var_CurrAP = rec_CurrentDate{0}[AcademicPeriodYearINT], ",
          "          var_CurrFW = rec_CurrentDate{0}[FiscalWeekYearINT], ",
          "          col_ISOYearOFFSET = Table.AddColumn(",
          "            col_FWYearINT, ",
          "            \"ISO YearOFFSET\", ",
          "            each [ISO Year] - var_CurrISOYear, ",
          "            type number",
          "          ), ",
          "          col_ISOQuarterOFFSET = Table.AddColumn(",
          "            col_ISOYearOFFSET, ",
          "            \"ISO QuarterOFFSET\", ",
          "            each ((4 * [ISO Year]) + [ISO QuarterNUM]) - ((4 * var_CurrISOYear) + var_CurrISOQtr), ",
          "            type number",
          "          ), ",
          "          col_FiscalYearOFFSET = Table.AddColumn(",
          "            col_ISOQuarterOFFSET, ",
          "            \"FiscalYearOFFSET\", ",
          "            each try",
          "              (if [MonthNUM] >= FYStartMonth then [YearNUM] + 1 else [YearNUM])",
          "                - (if var_CurrMonth >= FYStartMonth then var_CurrYear + 1 else var_CurrYear)",
          "            otherwise",
          "              null, ",
          "            type number",
          "          ), ",
          "          col_AcademicYearOFFSET = Table.AddColumn(",
          "            col_FiscalYearOFFSET, ",
          "            \"AcademicYearOFFSET\", ",
          "            each try",
          "              (if [MonthNUM] >= AYStartMonth then [YearNUM] + 1 else [YearNUM])",
          "                - (if var_CurrMonth >= AYStartMonth then var_CurrYear + 1 else var_CurrYear)",
          "            otherwise",
          "              null, ",
          "            type number",
          "          ), ",
          "          col_CYSelection = Table.AddColumn(",
          "            col_AcademicYearOFFSET, ",
          "            \"CY Selection\", ",
          "            each if [YearOFFSET] = 0 then \"Current CY\" else Text.From([YearNUM]), ",
          "            type text",
          "          ),",
          "          col_AYSelection = Table.AddColumn(",
          "            col_CYSelection, ",
          "            \"AY Selection\", ",
          "            each if [AcademicYearOFFSET] = 0 then \"Current AY\" else [Academic_Year], ",
          "            type text",
          "          ),",
          "          col_FYSelection = Table.AddColumn(",
          "            col_AYSelection, ",
          "            \"FY Selection\", ",
          "            each if [FiscalYearOFFSET] = 0 then \"Current FY\" else [Fiscal_Year], ",
          "            type text",
          "          ),",
          "",
          "          //-- enter function here",
          "          fn_GetAcQtrOFFSET = ",
          "            let",
          "              fxAddFiscalQuarterOFFSET = (Date as date, FiscalYearStartMonth as number) as number =>",
          "                let",
          "                  CurrentDate = Date.From(DateTime.LocalNow()), ",
          "                  n = ",
          "                    if List.Contains({1 .. 12}, FiscalYearStartMonth) and FiscalYearStartMonth > 1 then",
          "                      FiscalYearStartMonth - 1",
          "                    else",
          "                      0, ",
          "                  FiscalQuarterOFFSET = (",
          "                    (4 * Date.Year(Date.AddMonths(Date.StartOfMonth(Date), - n)))",
          "                      + Date.QuarterOfYear(Date.AddMonths(Date.StartOfMonth(Date), - n))",
          "                  )",
          "                    - (",
          "                      (4 * Date.Year(Date.AddMonths(Date.StartOfMonth(CurrentDate), - n)))",
          "                        + Date.QuarterOfYear(Date.AddMonths(Date.StartOfMonth(CurrentDate), - n))",
          "                    )",
          "                in",
          "                  FiscalQuarterOFFSET",
          "            in",
          "              fxAddFiscalQuarterOFFSET, ",
          "",
          "          //-- Restart table here",
          "          col_AYQtrOFFSET = Table.AddColumn(",
          "            col_FYSelection, ",
          "            \"AcademicQuarterOFFSET\", ",
          "            each fn_GetAcQtrOFFSET([Date], AYStartMonth), ",
          "            Int64.Type",
          "          ), ",
          "          col_FYQtrOFFSET = Table.AddColumn(",
          "            col_AYQtrOFFSET, ",
          "            \"FiscalQuarterOFFSET\", ",
          "            each fn_GetAcQtrOFFSET([Date], FYStartMonth), ",
          "            Int64.Type",
          "          ), ",
          "          col_isCurrFY = Table.AddColumn(",
          "            col_FYQtrOFFSET, ",
          "            \"IsCurrentFY\", ",
          "            each if [Fiscal Year] = var_CurrFY then true else false, ",
          "            type logical",
          "          ), ",
          "          col_isCurrAY = Table.AddColumn(",
          "            col_isCurrFY, ",
          "            \"IsCurrentAY\", ",
          "            each if [Academic Year] = var_CurrAY then true else false, ",
          "            type logical",
          "          ), ",
          "          col_isCurrFQ = Table.AddColumn(",
          "            col_isCurrAY, ",
          "            \"IsCurrentFQ\", ",
          "            each if [FiscalQuarterYearINT] = var_CurrFQ then true else false, ",
          "            type logical",
          "          ), ",
          "          col_isCurrAQ = Table.AddColumn(",
          "            col_isCurrFQ, ",
          "            \"IsCurrentAQ\", ",
          "            each if [AcademicQuarterYearINT] = var_CurrAQ then true else false, ",
          "            type logical",
          "          ), ",
          "          col_isCurrFP = Table.AddColumn(",
          "            col_isCurrAQ, ",
          "            \"IsCurrentFP\", ",
          "            each if [FiscalPeriodYearINT] = var_CurrFP then true else false, ",
          "            type logical",
          "          ), ",
          "          col_isCurrAP = Table.AddColumn(",
          "            col_isCurrFP, ",
          "            \"IsCurrentAP\", ",
          "            each if [AcademicPeriodYearINT] = var_CurrAP then true else false, ",
          "            type logical",
          "          ), ",
          "          col_isCurrFW = Table.AddColumn(",
          "            col_isCurrAP, ",
          "            \"IsCurrentFW\", ",
          "            each if [FiscalWeekYearINT] = var_CurrFW then true else false, ",
          "            type logical",
          "          ), ",
          "          col_isPrevYTD = Table.AddColumn(",
          "            col_isCurrFW, ",
          "            \"IsPreviousYTD\", ",
          "            each ",
          "              if var_CurrYear - 1 = [YearNUM] and [DayYearNUM] <= rec_CurrentDate{0}[DayYearNUM] then",
          "                true",
          "              else",
          "                false, ",
          "            type logical",
          "          ), ",
          "          list_PrevFiscalYearDates = List.Buffer(",
          "            Table.SelectRows(",
          "              Table.ExpandTableColumn(",
          "                Table.NestedJoin(",
          "                  Table.AddIndexColumn(",
          "                    Table.RenameColumns(",
          "                      Table.TransformColumnTypes(",
          "                        Table.FromList(",
          "                          List.Dates(",
          "                            var_PFFD, ",
          "                            Number.From(var_FFD - var_PFFD), ",
          "                            #duration(1, 0, 0, 0)",
          "                          ), ",
          "                          Splitter.SplitByNothing()",
          "                        ), ",
          "                        {{\"Column1\", type date}}",
          "                      ), ",
          "                      {{\"Column1\", \"DateFY\"}}",
          "                    ), ",
          "                    \"Index\", ",
          "                    1, ",
          "                    1",
          "                  ), ",
          "                  {\"Index\"}, ",
          "                  Table.AddIndexColumn(",
          "                    Table.RenameColumns(",
          "                      Table.TransformColumnTypes(",
          "                        Table.FromList(",
          "                          List.Dates(",
          "                            Date.AddYears(var_PFFD, + 0), ",
          "                            Number.From(var_PFFD - Date.AddYears(var_PFFD, - 1)), ",
          "                            #duration(1, 0, 0, 0)",
          "                          ), ",
          "                          Splitter.SplitByNothing()",
          "                        ), ",
          "                        {{\"Column1\", type date}}",
          "                      ), ",
          "                      {{\"Column1\", \"DateFY\"}}",
          "                    ), ",
          "                    \"Index\", ",
          "                    1, ",
          "                    1",
          "                  ), ",
          "                  {\"Index\"}, ",
          "                  \"Table\", ",
          "                  JoinKind.LeftOuter",
          "                ), ",
          "                \"Table\", ",
          "                {\"DateFY\"}, ",
          "                {\"PrevDateFY\"}",
          "              ), ",
          "              each [DateFY] <= var_CurrentDate",
          "            )[PrevDateFY]",
          "          ), ",
          "          col_isPrevFY = Table.AddColumn(",
          "            col_isPrevYTD, ",
          "            \"IsPreviousFY\", ",
          "            each ",
          "              if [FiscalYearOFFSET] = - 1 and List.Contains(list_PrevFiscalYearDates, [Date]) then",
          "                true",
          "              else",
          "                false, ",
          "            type logical",
          "          ), ",
          "          col_isPrevAY = Table.AddColumn(",
          "            col_isPrevFY, ",
          "            \"IsPreviousAY\", ",
          "            each if [AcademicYearOFFSET] = - 1 then true else false, ",
          "            type logical",
          "          ), ",
          "          ",
          "          col_NetWorkDays = ",
          "            if AddRelativeNetWorkdays = true then",
          "              Table.AddColumn(",
          "                col_isPrevAY, ",
          "                \"Relative Networkdays\", ",
          "                each fxNETWORKDAYS(StartDate, [Date], Holidays), ",
          "                type number",
          "              )",
          "            else",
          "              col_isPrevAY, ",
          "      extend_calendar = ",
          "      let",
          "",
          "date_periods = let",
          "tbl_weekly = Table.AddColumn( col_NetWorkDays, \"2W Date\", each if Number.Mod(Date.WeekOfYear([Date]), 2) = 1 then Date.EndOfWeek([Date], Day.Monday) else Date.EndOfWeek(Date.AddDays([Date], - 7), Day.Monday), type date ),",
          "tbl_fortnightly = Table.AddColumn(tbl_weekly, \"2M Date\", each Date.EndOfMonth(Date.AddMonths([Date], - (Number.Mod(Date.Month([Date]) - 1, 2)))), type date),",
          "tbl_quarterly = Table.AddColumn(tbl_fortnightly, \"3W Date\", each Date.EndOfMonth(Date.AddMonths([Date], - (Number.Mod(Date.Month([Date]) - 1, 3)))), type date),",
          "tbl_biannually = Table.AddColumn(tbl_fortnightly, \"6M Date\", each Date.EndOfMonth(Date.AddMonths([Date], - (Number.Mod(Date.Month([Date]) - 1, 6)))), type date),",
          "tbl_ouputs = tbl_biannually",
          "in tbl_ouputs,",
          "",
          "",
          "fiscal_academic_periods = let",
          "     FY_TBL = Table.RenameColumns( Table.Group(  Table.Distinct( Table.SelectColumns(date_periods,{\"Month Start\", \"Month End\", \"FiscalPeriodYearINT\", \"FiscalQuarterYearINT\"}) , {\"FiscalPeriodYearINT\"}) , {\"FiscalQuarterYearINT\"}, {{\"Fiscal Quarter Month Start\", each List.Min([Month Start]), type date}, {\"Fiscal Quarter Month End\", each List.Max([Month End]), type date}}) ,{{\"FiscalQuarterYearINT\", \"FiscalKey\"}}),",
          "     AY_TBL = Table.RenameColumns( Table.Group(  Table.Distinct( Table.SelectColumns(date_periods,{\"Month Start\", \"Month End\", \"AcademicPeriodYearINT\", \"AcademicQuarterYearINT\"}) , {\"AcademicPeriodYearINT\"}) , {\"AcademicQuarterYearINT\"}, {{\"Academic Quarter Month Start\", each List.Min([Month Start]), type date}, {\"Academic Quarter Month End\", each List.Max([Month End]), type date}}) ,{{\"AcademicQuarterYearINT\", \"AcademicKey\"}}),",
          "     tbl_fiscal = Table.Join(date_periods, {\"FiscalQuarterYearINT\"}, FY_TBL, {\"FiscalKey\"}, JoinKind.LeftOuter, JoinAlgorithm.SortMerge ) ,",
          "     tbl_academic = Table.Join(tbl_fiscal, {\"AcademicQuarterYearINT\"}, AY_TBL, {\"AcademicKey\"}, JoinKind.LeftOuter, JoinAlgorithm.SortMerge ),",
          "     tbl_merges = Table.RemoveColumns( tbl_academic, {\"FiscalKey\", \"AcademicKey\"} )",
          "in tbl_merges",
          "",
          "in fiscal_academic_periods,",
          "",
          "          // function starts here",
          "          fxNETWORKDAYS = (StartDate, EndDate, optional Holidays as list) =>",
          "            let",
          "              list_Dates = List.Dates(",
          "                StartDate, ",
          "                Number.From(EndDate - StartDate) + 1, ",
          "                Duration.From(1)",
          "              ), ",
          "              DeleteHolidays = ",
          "                if Holidays = null then",
          "                  list_Dates",
          "                else",
          "                  List.Difference(list_Dates, List.Transform(Holidays, Date.From)), ",
          "              DeleteWeekends = List.Select(DeleteHolidays, each Date.DayOfWeek(_, Day.Monday) < 5), ",
          "              CountDays = List.Count(DeleteWeekends)",
          "            in",
          "              CountDays,",
          "",
          "          // function ends here",
          "",
          "",
          "          cols_RemoveToday = Table.RemoveColumns(",
          "            if EndDate < var_CurrentDate then",
          "              Table.SelectRows(extend_calendar, each ([Date] <> var_CurrentDate))",
          "            else",
          "              extend_calendar, ",
          "            {\"DayYearNUM\", \"FiscalFirstDate\"}",
          "          ), ",
          "          cols_Format = Table.TransformColumnTypes(",
          "            cols_RemoveToday, ",
          "            {",
          "              {\"YearNUM\", Int64.Type}, ",
          "              {\"QuarterNUM\", Int64.Type}, ",
          "              {\"MonthNUM\", Int64.Type}, ",
          "              {\"DayMonthNUM\", Int64.Type}, ",
          "              {\"DateINT\", Int64.Type}, ",
          "              {\"DayWeekNUM\", Int64.Type}, ",
          "              {\"ISO YearOFFSET\", Int64.Type}, ",
          "              {\"ISO QuarterYearINT\", Int64.Type}, ",
          "              {\"ISO QuarterOFFSET\", Int64.Type}, ",
          "              {\"Week Number\", Int64.Type}, ",
          "              {\"WeekYearINT\", Int64.Type}, ",
          "              {\"MonthYearINT\", Int64.Type}, ",
          "              {\"QuarterYearINT\", Int64.Type}, ",
          "              {\"FiscalQuarterYearINT\", Int64.Type}, ",
          "              {\"FiscalPeriodNUM\", Int64.Type}, ",
          "              {\"FiscalPeriodYearINT\", Int64.Type}, ",
          "              {\"WeekOFFSET\", Int64.Type}, ",
          "              {\"MonthOFFSET\", Int64.Type}, ",
          "              {\"QuarterOFFSET\", Int64.Type}, ",
          "              {\"YearOFFSET\", Int64.Type}, ",
          "              {\"FiscalYearOFFSET\", Int64.Type}, ",
          "              {\"FiscalWeekYearINT\", Int64.Type},",
          "              {\"Fiscal Week Number\", Int64.Type},",
          "              {\"DateFW\", type date}",
          "            }",
          "          ), ",
          "          cols_Reorder = Table.ReorderColumns(",
          "            cols_Format, ",
          "            {",
          "              \"Date\",",
          "              \"CY Selection\", ",
          "              \"isYearComplete\", ",
          "              \"IsYTD\",",
          "              \"YearNUM\", ",
          "              \"YearOFFSET\", ",
          "              \"Academic Year\",",
          "              \"Academic_Year\",",
          "              \"AY Selection\",",
          "              \"Fiscal Year\", ",
          "              \"Fiscal_Year\",",
          "              \"FY Selection\", ",
          "              \"IsFuture\",",
          "              \"QuarterNUM\", ",
          "              \"Quarter\", ",
          "              \"Quarter Start\", ",
          "              \"Quarter End\", ",
          "              \"Quarter & Year\", ",
          "              \"QuarterYearINT\", ",
          "              \"QuarterOFFSET\", ",
          "              \"isQuarterComplete\", ",
          "              \"MonthNUM\",",
          "              \"FiscalPeriodNUM\",",
          "              \"Fiscal Month\",",
          "              \"AcademicPeriodNUM\", ",
          "              \"Academic Month\",",
          "              \"Month Start\", ",
          "              \"Month End\", ",
          "              \"Month & Year\", ",
          "              \"MonthYearINT\", ",
          "              \"MonthOFFSET\", ",
          "              \"isMonthComplete\", ",
          "              \"Month Name\", ",
          "              \"Month Short\", ",
          "              \"Month Initial\", ",
          "              \"DayMonthNUM\", ",
          "              \"Week Number\", ",
          "              \"Week Start\", ",
          "              \"Week End\", ",
          "              \"Week & Year\", ",
          "              \"WeekYearINT\", ",
          "              \"WeekOFFSET\", ",
          "              \"WeekCompleted\", ",
          "              \"DayWeekNUM\", ",
          "              \"Day of Week Name\", ",
          "              \"Day Initial\", ",
          "              \"DateINT\", ",
          "              \"DayOffset\", ",
          "              \"IsAfterToday\", ",
          "              \"IsWeekDay\", ",
          "              \"IsHoliday\", ",
          "              \"IsBusinessDay\", ",
          "              \"Day Type\", ",
          "              \"ISO Year\", ",
          "              \"ISO YearOFFSET\", ",
          "              \"ISO QuarterNUM\", ",
          "              \"ISO Quarter\", ",
          "              \"ISO Quarter & Year\", ",
          "              \"ISO QuarterYearINT\", ",
          "              \"ISO QuarterOFFSET\", ",
          "              \"FiscalYearOFFSET\",",
          "              \"FiscalQuarterOFFSET\", ",
          "              \"Fiscal Quarter\", ",
          "              \"FiscalQuarterYearINT\", ",
          "              \"Fiscal Quarter Month Start\",",
          "              \"Fiscal Quarter Month End\",",
          "              \"Fiscal Period\", ",
          "              \"FiscalPeriodYearINT\", ",
          "              \"DateFW\", ",
          "              \"Fiscal Week Number\", ",
          "              \"Fiscal Week\", ",
          "              \"FiscalWeekYearINT\",",
          "              \"AcademicYearOFFSET\", ",
          "              \"AcademicQuarterOFFSET\",",
          "              \"Academic Quarter Month Start\",",
          "              \"Academic Quarter Month End\", ",
          "              \"IsCurrentFY\", ",
          "              \"IsCurrentFQ\", ",
          "              \"IsCurrentFP\", ",
          "              \"IsCurrentFW\", ",
          "              \"IsPreviousYTD\", ",
          "              \"IsPreviousFY\",",
          "              \"2W Date\",",
          "              \"2M Date\",",
          "              \"6M Date\"",
          "            }",
          "          ), ",
          "          AYCols = {",
          "            \"Academic Year\",",
          "            \"Academic_Year\",",
          "            \"AY Selection\",",
          "            \"Academic Quarter\", ",
          "            \"AcademicQuarterYearINT\",",
          "            \"Academic Quarter Month Start\",",
          "            \"Academic Quarter Month End\", ",
          "            \"Academic Month\", ",
          "            \"AcademicPeriodNUM\", ",
          "            \"Academic Period\", ",
          "            \"AcademicPeriodYearINT\", ",
          "            \"AcademicYearOFFSET\", ",
          "            \"AcademicQuarterOFFSET\",",
          "            \"IsCurrentAQ\", ",
          "            \"IsCurrentAP\", ",
          "            \"IsPreviousAY\", ",
          "            \"IsCurrentAY\", ",
          "            \"AYStartDate\",",
          "            \"AYEndDate\"",
          "",
          "          }, ",
          "          FYCols = {",
          "            \"ISO QuarterNUM\", ",
          "            \"Fiscal Year\",",
          "            \"Fiscal_Year\",",
          "            \"FY Selection\", ",
          "            \"Fiscal Quarter\", ",
          "            \"FiscalQuarterYearINT\",",
          "            \"Fiscal Quarter Month Start\",",
          "            \"Fiscal Quarter Month End\",",
          "            \"Fiscal Month\", ",
          "            \"FiscalPeriodNUM\", ",
          "            \"Fiscal Period\", ",
          "            \"FiscalPeriodYearINT\", ",
          "            \"DateFW\", ",
          "            \"Fiscal Week Number\", ",
          "            \"Fiscal Week\", ",
          "            \"FiscalWeekYearINT\", ",
          "            \"FiscalYearOFFSET\",",
          "            \"FiscalQuarterOFFSET\",",
          "            \"IsCurrentFQ\", ",
          "            \"IsCurrentFP\", ",
          "            \"IsCurrentFW\", ",
          "            \"IsPreviousFY\", ",
          "            \"IsCurrentFY\"",
          "          }, ",
          "          AllCols = List.Union({FYCols, AYCols}), ",
          "          ListCols = ",
          "            if var_FYAYTest then",
          "              Table.RemoveColumns(cols_Reorder, AllCols)",
          "            else if var_AYLogicTest then",
          "              Table.RemoveColumns(cols_Reorder, AYCols)",
          "            else if var_FYLogicTest then",
          "              Table.RemoveColumns(cols_Reorder, FYCols)",
          "            else",
          "              Table.RemoveColumns(",
          "                cols_Reorder, ",
          "                {\"DateFW\", \"FiscalWeekYearINT\", \"ISO QuarterNUM\" /* \"FiscalPeriodNUM\",  */                         }",
          "              )",
          "in",
          "    ListCols",
          "        , ",
          "      // ------------------------------------------------------------------     ",
          "      /*",
          "  invokeFunction = (",
          "    StartYearNUM as number, ",
          "    EndYearNUM as number, ",
          "    optional FYStartMonthNum as number, ",
          "    optional AYStartMonthNum as number, ",
          "    optional Holidays as list, ",
          "    optional WDStartNum as number, ",
          "    optional AddRelativeNetWorkdays as logical",
          "  ) as table =>",
          "*/",
          "      // 3.0: change parameter metadata here",
          "      fnType = type function (",
          "        // 3.0.1: Calendar Start Year parameter",
          "        StartYearNUM as (",
          "          type number",
          "            meta [",
          "              Documentation.FieldCaption     = \" Start Year: #(lf) 4-digit integer \", ",
          "              Documentation.FieldDescription = \" 4-digit integer: #(cr,lf) YYYY \", ",
          "              Documentation.SampleValues     = {2021}",
          "            ]",
          "        ), ",
          "        // 3.0.2: Calendar End Year parameter",
          "        EndYearNUM as (",
          "          type number",
          "            meta [",
          "              Documentation.FieldCaption     = \" End Year: #(lf) 4-digit integer \", ",
          "              Documentation.FieldDescription = \" 4-digit integer: #(cr,lf) YYYY \", ",
          "              Documentation.SampleValues     = {2023}",
          "            ]",
          "        ), ",
          "        // 3.0.3: Fiscal Start Month parameter",
          "        optional FYStartMonthNum as (",
          "          type number",
          "            meta [",
          "              Documentation.FieldCaption     = \" Fiscal Month Start: #(lf) Feb = 2 \", ",
          "              Documentation.FieldDescription = \" Fiscal Month Start: #(lf) Feb = 2 \", ",
          "              Documentation.SampleValues     = {02}",
          "            ]",
          "        )// 3.0.4: Academic Start Month parameter",
          "        , ",
          "        optional AYStartMonthNum as (",
          "          type number",
          "            meta [",
          "              Documentation.FieldCaption     = \" Academic Month Start: #(lf) Aug = 8 \", ",
          "              Documentation.FieldDescription = \" Academic Month Start: #(lf) Aug = 8 \", ",
          "              Documentation.SampleValues     = {08}",
          "            ]",
          "        )// 3.0.5: Holidays list parameter",
          "        , ",
          "        optional Holidays as (",
          "          type list",
          "            meta [",
          "              Documentation.FieldCaption     = \" Choose holidays as a list \", ",
          "              Documentation.FieldDescription = \" Choose holidays as a list \", ",
          "              Documentation.SampleValues     = {\"List\"}",
          "            ]",
          "        )// 3.0.6: Weekday Start parameter ",
          "        , ",
          "        optional WDStartNum as (",
          "          type number",
          "            meta [",
          "              Documentation.FieldCaption     = \" Input weekday start number  \", ",
          "              Documentation.FieldDescription = \" Input weekday start number \", ",
          "              Documentation.SampleValues     = {01}",
          "            ]",
          "        )// 3.0.7: AddRelativeNetWorkdays parameter ",
          "        , ",
          "        optional AddRelativeNetWorkdays as (",
          "          type logical",
          "            meta [",
          "              Documentation.FieldCaption     = \" Input relative network days as boolean \", ",
          "              Documentation.FieldDescription = \" Input relative network days as boolean \", ",
          "              Documentation.SampleValues     = {\"True/False\"}",
          "            ]",
          "        )",
          "      // 3.1: parameter return type   ",
          "      ) as list, ",
          "      // ------------------------------------------------------------------",
          "     ",
          "      // ------------------------------------------------------------------",
          "      // 5.0: Choose between Parameter Documentation or Function Documentation",
          "      functionDocumentation =  // -- function metadata                       ",
          "      Value.ReplaceType(",
          "        invokeFunction, ",
          "        Value.ReplaceMetadata(Value.Type(invokeFunction), documentation)",
          "      ), ",
          "      parameterDocumentation =  // -- parameter metadata                        ",
          "      Value.ReplaceType(functionDocumentation, fnType)",
          "    in",
          "      // ------------------------------------------------------------------",
          "      // select one of the above steps and paste below",
          "      functionDocumentation /* <-- Choose final documentation type */                                         ",
          "in",
          "  customFunction"
        ],
        "kind": "m",
        "lineageTag": "1fadb2e5-7722-448f-98af-6fb87705bcf2"
      }
    ],
    "maxParallelismPerRefresh": 1,
    "queryGroups": [
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "0"
          }
        ],
        "description": "Errors in queries that were loaded on 30/03/2023 13:24:59.",
        "folder": "Query Errors - 30/03/2023 13:24:59"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "1"
          }
        ],
        "description": "Errors in queries that were loaded on 30/03/2023 14:07:46.",
        "folder": "Query Errors - 30/03/2023 14:07:46"
      }
    ],
    "relationships": [
      {
        "name": "4bf2c5c2-0dc8-4763-9ef0-71ab771d5231",
        "fromColumn": "GeographyKey",
        "fromTable": "Customer",
        "toColumn": "GeographyKey",
        "toTable": "Geography"
      },
      {
        "name": "2e907299-e054-4229-8e2d-9435cf91503e",
        "fromColumn": "CustomerKey",
        "fromTable": "InternetSales 😀",
        "toColumn": "CustomerKey",
        "toTable": "Customer"
      },
      {
        "name": "01abb34d-996e-4946-8669-d6f980f4091f",
        "fromColumn": "DueDateKey",
        "fromTable": "InternetSales 😀",
        "isActive": false,
        "toColumn": "DateKey",
        "toTable": "Date 👍"
      },
      {
        "name": "c513c838-3f74-4e8f-8e99-28c269fb1500",
        "fromColumn": "OrderDateKey",
        "fromTable": "InternetSales 😀",
        "toColumn": "DateKey",
        "toTable": "Date 👍"
      },
      {
        "name": "1f31bcae-dd80-44bf-9b82-add0a4cc2162",
        "fromColumn": "ShipDateKey",
        "fromTable": "InternetSales 😀",
        "isActive": false,
        "toColumn": "DateKey",
        "toTable": "Date 👍"
      },
      {
        "name": "a481feb9-6702-4815-89a7-e044b9c573b8",
        "fromColumn": "ProductCategoryKey",
        "fromTable": "ProductSubcategory",
        "toColumn": "ProductCategoryKey",
        "toTable": "ProductCategory 😀"
      },
      {
        "name": "728a4b70-6bb4-4a25-92e3-4a9efe2aabbf",
        "fromColumn": "ProductSubcategoryKey",
        "fromTable": "Product",
        "toColumn": "ProductSubcategoryKey",
        "toTable": "ProductSubcategory"
      },
      {
        "name": "4fb5a40e-96b6-4565-a16a-ae0d3445b7ce",
        "fromColumn": "ProductKey",
        "fromTable": "InternetSales 😀",
        "toColumn": "ProductKey",
        "toTable": "Product"
      },
      {
        "name": "ded94825-7b0b-4009-a66d-2b4306e2d8d8",
        "fromColumn": "OrderDateKey",
        "fromTable": "InternetSales 😀",
        "toColumn": "DateKey",
        "toTable": "Calendar"
      },
      {
        "name": "76febe2e-27eb-49cd-b0cf-f0f1ffbbf92a",
        "fromColumn": "ProductCategoryKey",
        "fromTable": "ProductSubcategory",
        "toColumn": "ProductCategoryKey",
        "toTable": "ProductCategory2"
      },
      {
        "name": "7497438b-23d4-4d0e-895d-e8c477365bc3",
        "crossFilteringBehavior": "bothDirections",
        "fromCardinality": "one",
        "fromColumn": "ProductCategoryKey",
        "fromTable": "ProductCategory_BUDGET_Left",
        "isActive": false,
        "toColumn": "ProductCategoryKey",
        "toTable": "ProductCategory2"
      },
      {
        "name": "0b65fbbe-f8f8-4115-b9af-a7cb57c040fc",
        "fromColumn": "CustomerKey",
        "fromTable": "InternetSales_Current",
        "toColumn": "CustomerKey",
        "toTable": "Customer"
      },
      {
        "name": "7e36e957-c602-4011-98c5-b4f39e16509b",
        "fromColumn": "ProductKey",
        "fromTable": "InternetSales_Current",
        "toColumn": "ProductKey",
        "toTable": "Product"
      },
      {
        "name": "948fca29-e056-4a30-bf76-b8229ead19a7",
        "fromColumn": "OrderDateKey",
        "fromTable": "InternetSales_Current",
        "toColumn": "DateKey",
        "toTable": "Calendar_Current"
      },
      {
        "name": "c3ecd690-caeb-46b2-b0dc-f5c3802b72cd",
        "fromColumn": "OrderDate",
        "fromTable": "InternetSales 😀",
        "toColumn": "Date",
        "toTable": "Dates_EDNA"
      },
      {
        "name": "ee935f8a-ff06-48f0-bb68-02357b4fccca",
        "crossFilteringBehavior": "bothDirections",
        "fromCardinality": "one",
        "fromColumn": "DateKey",
        "fromTable": "Date 👍",
        "toColumn": "DateKey",
        "toTable": "Dates_IMKE"
      },
      {
        "name": "cf112a52-44de-4b62-b795-a24fb4a1e2e8",
        "fromColumn": "MeasureName",
        "fromTable": "PageDetailsForMeasures",
        "toColumn": "MEASURE_NAME",
        "toTable": "dax"
      },
      {
        "name": "81ee2108-a1fe-435b-8574-aa66be3c6db1",
        "crossFilteringBehavior": "bothDirections",
        "fromCardinality": "one",
        "fromColumn": "EmailAddress",
        "fromTable": "Customer earliest order per year",
        "toColumn": "EmailAddress",
        "toTable": "Customer"
      }
    ],
    "roles": [
      {
        "name": "OLS SalesAmount column",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "e1ff77bc160349d1b3cfe92dbe11531b"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "InternetSales 😀",
            "columnPermissions": [
              {
                "name": "SalesAmount",
                "metadataPermission": "none"
              }
            ]
          }
        ]
      },
      {
        "name": "New role",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "0a6db84eaf984183bb2ffe568716c3e3"
          }
        ],
        "modelPermission": "read"
      },
      {
        "name": "OLS ALL Measures table",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "c1df1f95f9064db69c9ee4fd0560e436"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "All Measures 😀",
            "metadataPermission": "none"
          }
        ]
      }
    ],
    "sourceQueryCulture": "en-GB",
    "tables": [
      {
        "name": "Customer",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "CustomerKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2bd0359d-00f3-4d2c-a78e-08358ea8e7a2",
            "sourceColumn": "CustomerKey",
            "summarizeBy": "none"
          },
          {
            "name": "GeographyKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "44a5cae4-e1b8-4717-b700-91bcdb2afdd8",
            "sourceColumn": "GeographyKey",
            "summarizeBy": "none"
          },
          {
            "name": "CustomerAlternateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "43d7a99c-4642-4645-be11-1adb650028ca",
            "sourceColumn": "CustomerAlternateKey",
            "summarizeBy": "none"
          },
          {
            "name": "FirstName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "138fd634-6be5-4c79-8330-53f8ec2cc982",
            "sourceColumn": "FirstName",
            "summarizeBy": "none"
          },
          {
            "name": "MiddleName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "0b4c8929-3048-4b7b-b1c0-e2d01e92ad53",
            "sourceColumn": "MiddleName",
            "summarizeBy": "none"
          },
          {
            "name": "LastName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "09f20a62-5448-4eec-ae83-e38dcab15c05",
            "sourceColumn": "LastName",
            "summarizeBy": "none"
          },
          {
            "name": "BirthDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "a4a413b4-4068-44de-aa1b-1e835168caa7",
            "sourceColumn": "BirthDate",
            "summarizeBy": "none"
          },
          {
            "name": "MaritalStatus",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "b9e4379e-0fda-4e4e-b09b-58d236656685",
            "sourceColumn": "MaritalStatus",
            "summarizeBy": "none"
          },
          {
            "name": "Gender",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "7999d891-22c7-4227-a2c0-017fd990fd79",
            "sourceColumn": "Gender",
            "summarizeBy": "none"
          },
          {
            "name": "EmailAddress",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "2f78664b-b739-43df-b8e2-66b8c0ea2e4f",
            "sourceColumn": "EmailAddress",
            "summarizeBy": "none"
          },
          {
            "name": "FullName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "Customer[FirstName] & \" \" & Customer[LastName]",
            "isDataTypeInferred": true,
            "lineageTag": "be1dfbb2-378a-4464-9461-7beb8bc67241",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "401c9b3e-bc12-4d2a-a6bb-aab76fb3e95a",
        "partitions": [
          {
            "name": "Customer-d2616a85-1984-4c3e-8ce4-88b09b1fd243",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\"localhost\", \"adventureworksdw2019\"),",
                "    dbo_DimCustomer = Source{[Schema=\"dbo\",Item=\"DimCustomer\"]}[Data],",
                "    #\"Removed Columns\" = Table.RemoveColumns(dbo_DimCustomer,{\"SpanishEducation\", \"FrenchEducation\", \"SpanishOccupation\", \"FrenchOccupation\", \"NameStyle\", \"Title\", \"Suffix\", \"TotalChildren\", \"NumberChildrenAtHome\", \"EnglishEducation\", \"EnglishOccupation\", \"HouseOwnerFlag\", \"NumberCarsOwned\", \"AddressLine1\", \"AddressLine2\", \"Phone\", \"DateFirstPurchase\", \"CommuteDistance\", \"FactSurveyResponse\", \"YearlyIncome\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Date 👍",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "DateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c322cde9-09ff-40e3-85de-495a39aeea1a",
            "sourceColumn": "DateKey",
            "summarizeBy": "none"
          },
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "isKey": true,
            "lineageTag": "2b0c9f70-22b1-4201-b08e-540ec669fd55",
            "sourceColumn": "Date",
            "summarizeBy": "none"
          },
          {
            "name": "DayNumberOfWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isHidden": true,
            "lineageTag": "2d71e577-e85e-4635-9b53-9ce3202611fc",
            "sourceColumn": "DayNumberOfWeek",
            "summarizeBy": "none"
          },
          {
            "name": "EnglishDayNameOfWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              },
              {
                "property": "SortByColumn"
              }
            ],
            "dataType": "string",
            "lineageTag": "fd461557-010e-4ae6-812a-3841f1cb688a",
            "sortByColumn": "DayNumberOfWeek",
            "sourceColumn": "EnglishDayNameOfWeek",
            "summarizeBy": "none"
          },
          {
            "name": "DayNumberOfMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "35af6e39-d801-4c89-8935-aec93be382fa",
            "sourceColumn": "DayNumberOfMonth",
            "summarizeBy": "none"
          },
          {
            "name": "DayNumberOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4d368dd1-5455-464c-8e0d-a99784ec1b2b",
            "sourceColumn": "DayNumberOfYear",
            "summarizeBy": "none"
          },
          {
            "name": "WeekNumberOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "87cfb93c-6669-4d8e-9224-b5bb1a6bf580",
            "sourceColumn": "WeekNumberOfYear",
            "summarizeBy": "none"
          },
          {
            "name": "EnglishMonthName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              },
              {
                "property": "SortByColumn"
              }
            ],
            "dataType": "string",
            "lineageTag": "acaea340-cc62-484f-a166-9eb06a6271bd",
            "sortByColumn": "MonthNumberOfYear",
            "sourceColumn": "EnglishMonthName",
            "summarizeBy": "none"
          },
          {
            "name": "MonthNumberOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isHidden": true,
            "lineageTag": "eca28f0e-1050-4520-8e1b-58f56acd367f",
            "sourceColumn": "MonthNumberOfYear",
            "summarizeBy": "none"
          },
          {
            "name": "CalendarQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ea5bb757-7517-41ce-89eb-388753c04cde",
            "sourceColumn": "CalendarQuarter",
            "summarizeBy": "none"
          },
          {
            "name": "CalendarYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "41a20048-a0c2-4756-9e8a-908a2cabb0ab",
            "sourceColumn": "CalendarYear",
            "summarizeBy": "none"
          },
          {
            "name": "CalendarSemester",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "6eef0a2d-1ddc-4698-8b19-956ee39db0a8",
            "sourceColumn": "CalendarSemester",
            "summarizeBy": "none"
          },
          {
            "name": "FiscalQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d85e088a-63e4-4cf9-a28f-78972e979843",
            "sourceColumn": "FiscalQuarter",
            "summarizeBy": "none"
          },
          {
            "name": "FiscalYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "61108505-f500-4397-86f5-32fc50a3507a",
            "sourceColumn": "FiscalYear",
            "summarizeBy": "none"
          },
          {
            "name": "FiscalSemester",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e5a5fd1b-8f06-4de2-be5e-c013edfdf397",
            "sourceColumn": "FiscalSemester",
            "summarizeBy": "none"
          },
          {
            "name": "QYYYY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "\"Q\"",
              "    & FORMAT (",
              "        'Date 👍'[Date],",
              "        \"q YYYY\"",
              "    )"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "f77dc13b-8b7e-49cb-ae91-483e5d2265d6",
            "sortByColumn": "QYYYY sort",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "QYYYY sort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "FORMAT (",
              "    'Date 👍'[Date],",
              "    \"YYYYq\"",
              ")"
            ],
            "isDataTypeInferred": true,
            "isHidden": true,
            "lineageTag": "daed74ba-6dce-4dd1-8ba9-a10fcf2bd731",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "MMMYYYY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "FORMAT (",
              "    'Date 👍'[Date],",
              "    \"mmm YYYY\"",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "d9a49df1-cfc3-4354-a332-4917d7f31af0",
            "sortByColumn": "MMMYYYY sort",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "MMMYYYY sort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              },
              {
                "property": "DataType"
              }
            ],
            "dataType": "string",
            "expression": [
              "FORMAT (",
              "    'Date 👍'[Date],",
              "    \"YYYYmm\"",
              ")"
            ],
            "lineageTag": "2e41d889-4ba2-43e1-8fb7-99b48a424907",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "IsPast",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "expression": [
              "'Date 👍'[Date]",
              "    <= MAX ( 'InternetSales 😀'[OrderDate] )"
            ],
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "isDataTypeInferred": true,
            "lineageTag": "e9044ce3-813b-4515-a47c-c2aec90944bc",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "EnglishMonthName**",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "REPT (",
              "    //repeat",
              "    UNICHAR ( 0032 ),",
              "    //non breaking space",
              "    12 - 'Date 👍'[MonthNumberOfYear] //11 to 0",
              ") & 'Date 👍'[EnglishMonthName]"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "6a5b991a-d7db-4d49-9e1c-14ff3c8689b4",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "EnglishMonthName*",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "SortByColumn"
              },
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "'Date 👍'[EnglishMonthName]",
              "//sorted by MNOY"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "765690dc-6685-46fd-a796-49283aa43d25",
            "sortByColumn": "MonthNumberOfYear",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Month_nosort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "REPT (",
              "    UNICHAR ( 8203 ),",
              "    12",
              "        - MONTH ( [Date] )",
              ")",
              "    & FORMAT (",
              "        [Date],",
              "        \"MMM\"",
              "    )"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "1c92eea5-0e09-4875-a83b-aa0245942ef0",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "DayName_nosort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "REPT (",
              "    UNICHAR ( 8203 ),",
              "    7",
              "        - WEEKDAY ( [Date] )",
              ")",
              "    & FORMAT (",
              "        [Date],",
              "        \"ddd\"",
              "    )"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "adf95cc0-ffc2-407c-bfd1-680d638f0b3a",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "YearMonth_nosort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "YEAR ( [Date] ) & \" \"",
              "    & REPT (",
              "        UNICHAR ( 8203 ),",
              "        12",
              "            - MONTH ( [Date] )",
              "    )",
              "    & FORMAT (",
              "        [Date],",
              "        \"MMM\"",
              "    )"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "152a73e0-a41d-4d7a-af4f-7d16fabc2074",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "YearQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "YEAR ( [Date] ) & \"Q\"",
              "    & QUARTER ( [Date] )"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "8d75b8dd-f610-4638-bf5b-43ee60e8863c",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "YearWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "YEAR ( [Date] )",
              "    & FORMAT (",
              "        WEEKNUM ( [Date] ),",
              "        \"00\"",
              "    )"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "0ff72876-5586-4303-b9c3-e514af0e8b1a",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "WorkingDay",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "IF (",
              "    WEEKDAY ( [Date] )",
              "        IN {",
              "        1,",
              "        7",
              "    },",
              "    \"N\",",
              "    \"Y\"",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "bc750eae-fc0c-448d-a598-c2470d1a504e",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "DaysFromNow",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "expression": [
              "DATEDIFF (",
              "    TODAY (),",
              "    [Date],",
              "    DAY",
              ")"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "c4fbf0c5-7ba0-42db-a7eb-92c9beace711",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "WeeksFromNow",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "expression": [
              "DATEDIFF (",
              "    TODAY (),",
              "    [Date],",
              "    WEEK",
              ")"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "d65a6580-b4a9-478a-aba0-b85000f03e41",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "MonthsFromNow",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "expression": [
              "DATEDIFF (",
              "    TODAY (),",
              "    [Date],",
              "    MONTH",
              ")"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "aed0c292-9c58-4334-ae29-8efd5bd2893e",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "QuartersFromNow",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "expression": [
              "DATEDIFF (",
              "    TODAY (),",
              "    [Date],",
              "    QUARTER",
              ")"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "a96da1e6-04dc-4a5e-ad6d-18b0f499bcb8",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "YearsFromNow",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "expression": [
              "DATEDIFF (",
              "    TODAY (),",
              "    [Date],",
              "    YEAR",
              ")"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "19ca8717-07dc-4c4a-8d91-f5d59283508b",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Daylight savings Offset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "expression": [
              "",
              "",
              "//https://community.powerbi.com/t5/Desktop/Daylight-Savings-Time/m-p/1413132#M597703",
              "",
              "VAR currentYear_ =",
              "    YEAR ( 'Date 👍'[Date] )",
              "VAR lastMarchSunday_ =",
              "    CALCULATE (",
              "        MAX ( 'Date 👍'[Date] ),",
              "        MONTH ( 'Date 👍'[Date] ) = 3,",
              "        WEEKDAY ( 'Date 👍'[Date], 2 ) = 7,",
              "        YEAR ( 'Date 👍'[Date] ) = currentYear_,",
              "        ALL( 'Date 👍')",
              "    )",
              "VAR lastOctoberSunday_ =",
              "    CALCULATE (",
              "        MAX ( 'Date 👍'[Date] ),",
              "        MONTH ( 'Date 👍'[Date] ) = 10,",
              "        WEEKDAY ( 'Date 👍'[Date], 2 ) = 7,",
              "        YEAR ( 'Date 👍'[Date] ) = currentYear_,",
              "        ALL( 'Date 👍')",
              "    )",
              "RETURN",
              "    IF (",
              "        'Date 👍'[Date] >= lastMarchSunday_",
              "            && 'Date 👍'[Date] < lastOctoberSunday_,",
              "        1,",
              "        0",
              "    )"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "7cca5416-a949-41ed-9f2d-8b458286638a",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Sales Check",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "expression": [
              "",
              "'Date 👍'[Date]<=EOMONTH(MAX('InternetSales 😀'[OrderDate]),0) //end of month for last sales date (July 2008)"
            ],
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "isDataTypeInferred": true,
            "lineageTag": "80578b39-6860-4ba5-a0d4-ba3030efac04",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Dates With Sales",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "IF ( [Total Sales], 1, 0 ) ",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "601bd5cb-47ec-47ad-b949-de7f71813c75",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "DateWithTransactions",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "expression": [
              "",
              "VAR __LastTransactionDate =",
              "    MAXX (",
              "        {",
              "            MAX ( 'InternetSales 😀'[OrderDate]),",
              "            MAX ( 'InternetSales 😀'[DueDate] ),",
              "            MAX ( 'InternetSales 😀'[ShipDate] )",
              "        },",
              "        [Value]",
              "    )",
              "RETURN",
              "    'Date 👍'[Date] <= __LastTransactionDate"
            ],
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "isDataTypeInferred": true,
            "lineageTag": "c890b563-1cdf-40af-a789-741140d17362",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "LastDateWithData",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "VAR LastDateWithData =",
              "    CALCULATE (",
              "        MAX ( 'Date 👍'[Date] ),",
              "        'Date 👍'[DateWithTransactions] = TRUE,",
              "        REMOVEFILTERS ()",
              "    )",
              "RETURN",
              "    IF (",
              "        LastDateWithData == 'Date 👍'[Date],",
              "        \"LastDateWithData\"",
              "    )"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "c28d9f41-a637-4da1-9a69-f05431682bdb",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "dataCategory": "Time",
        "hierarchies": [
          {
            "name": "Calendar Dates",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "levels": [
              {
                "name": "CalendarYear",
                "column": "CalendarYear",
                "lineageTag": "ec6a1a95-245e-4d38-bacc-6675daac383e",
                "ordinal": 0
              },
              {
                "name": "QYYYY",
                "column": "QYYYY",
                "lineageTag": "8ced6be6-d9f9-4309-a6d9-d0a158180444",
                "ordinal": 1
              },
              {
                "name": "MMMYYYY",
                "column": "MMMYYYY",
                "lineageTag": "811fae3e-e689-44fe-aa25-aaddcc9d2252",
                "ordinal": 2
              },
              {
                "name": "Date",
                "column": "Date",
                "lineageTag": "51015f49-cf11-4d67-a112-3da29132a011",
                "ordinal": 3
              }
            ],
            "lineageTag": "cfa41998-9fbc-4232-946c-61a839866b6c"
          }
        ],
        "lineageTag": "9fca8fb3-eb97-4b37-a340-637bea563557",
        "measures": [
          {
            "name": "selectedyear",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": "SELECTEDVALUE ( 'Date 👍'[CalendarYear] )",
            "expression": "SELECTEDVALUE ( 'Date 👍'[CalendarYear] )",
            "formatString": "0",
            "lineageTag": "5ad64e27-1ae9-4ddf-bff8-e5e8addaa3d6"
          }
        ],
        "partitions": [
          {
            "name": "Date 👍-0a76c059-e611-46a3-afbe-517b9662077e",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\"192.168.1.116\\sql2017\", \"adventureworksdw\"),",
                "    dbo_DimDate = Source{[Schema=\"dbo\",Item=\"DimDate\"]}[Data],",
                "    #\"Removed Columns\" = Table.RemoveColumns(dbo_DimDate,{\"SpanishDayNameOfWeek\", \"FrenchDayNameOfWeek\", \"SpanishMonthName\", \"FrenchMonthName\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"FullDateAlternateKey\", \"Date\"}}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Renamed Columns\", each [DateKey] >= 20050701 and [DateKey] < 20090101)",
                "in",
                "    #\"Filtered Rows\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Employee",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "EmployeeKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "9a912e2c-d8a9-4a21-9cb2-2fee3b1dc1a9",
            "sourceColumn": "EmployeeKey",
            "summarizeBy": "count"
          },
          {
            "name": "ParentEmployeeKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "03b10000-b237-442f-af68-955ea0cb5a12",
            "sourceColumn": "ParentEmployeeKey",
            "summarizeBy": "count"
          },
          {
            "name": "EmployeeNationalIDAlternateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "39fdf4dd-5da9-451b-abb1-26dacba08bb2",
            "sourceColumn": "EmployeeNationalIDAlternateKey",
            "summarizeBy": "none"
          },
          {
            "name": "ParentEmployeeNationalIDAlternateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "289b3864-d1f9-4195-a156-e0f40fefa280",
            "sourceColumn": "ParentEmployeeNationalIDAlternateKey",
            "summarizeBy": "none"
          },
          {
            "name": "SalesTerritoryKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ae870256-e12c-4a50-a2d9-b644c24d2f01",
            "sourceColumn": "SalesTerritoryKey",
            "summarizeBy": "count"
          },
          {
            "name": "FirstName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "8585def9-ebf4-49a5-9279-4d6074be1b6d",
            "sourceColumn": "FirstName",
            "summarizeBy": "none"
          },
          {
            "name": "LastName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "51d08236-aaba-44be-a769-b7d5f0700165",
            "sourceColumn": "LastName",
            "summarizeBy": "none"
          },
          {
            "name": "MiddleName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "4ca3b4e1-75dc-4567-bfb3-04641a310dd6",
            "sourceColumn": "MiddleName",
            "summarizeBy": "none"
          },
          {
            "name": "NameStyle",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "6a318f5b-2bd3-4a26-b13b-b671eba3888a",
            "sourceColumn": "NameStyle",
            "summarizeBy": "none"
          },
          {
            "name": "Title",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "3060a523-044c-4ee7-b2e8-8313b5dab5cc",
            "sourceColumn": "Title",
            "summarizeBy": "none"
          },
          {
            "name": "HireDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "2a8c259e-3f8c-40b7-9aab-712547ccc48d",
            "sourceColumn": "HireDate",
            "summarizeBy": "none"
          },
          {
            "name": "BirthDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "b1b28460-4f18-4349-9152-ea5e726b6a92",
            "sourceColumn": "BirthDate",
            "summarizeBy": "none"
          },
          {
            "name": "LoginID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "12eac0bf-5376-4d82-b284-a1e097c8e85c",
            "sourceColumn": "LoginID",
            "summarizeBy": "none"
          },
          {
            "name": "EmailAddress",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "ef889952-a90e-45b3-87a8-cd0d30be71c8",
            "sourceColumn": "EmailAddress",
            "summarizeBy": "none"
          },
          {
            "name": "Phone",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "9732d188-66a5-4bcf-8ab2-ef9e5c274fd3",
            "sourceColumn": "Phone",
            "summarizeBy": "none"
          },
          {
            "name": "MaritalStatus",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "5842b498-012b-4156-8460-36318addb3be",
            "sourceColumn": "MaritalStatus",
            "summarizeBy": "none"
          },
          {
            "name": "SalariedFlag",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "2745b383-15b4-4488-af0f-a546aa31d87d",
            "sourceColumn": "SalariedFlag",
            "summarizeBy": "none"
          },
          {
            "name": "Gender",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "0488cba7-a58e-4909-9ff2-b8ea986114e9",
            "sourceColumn": "Gender",
            "summarizeBy": "none"
          },
          {
            "name": "PayFrequency",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0d427e2c-bc3e-4d10-a17f-f930581b2970",
            "sourceColumn": "PayFrequency",
            "summarizeBy": "sum"
          },
          {
            "name": "BaseRate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "674bc601-4c2d-4f56-96c6-359040589a7a",
            "sourceColumn": "BaseRate",
            "summarizeBy": "sum"
          },
          {
            "name": "VacationHours",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0fd243fa-4534-4adb-99ab-6056f996e640",
            "sourceColumn": "VacationHours",
            "summarizeBy": "sum"
          },
          {
            "name": "SickLeaveHours",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c7c18850-230c-44c6-b709-6e24d67a9567",
            "sourceColumn": "SickLeaveHours",
            "summarizeBy": "sum"
          },
          {
            "name": "CurrentFlag",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "d7aaac79-52ab-4200-b2dc-54db448ad03d",
            "sourceColumn": "CurrentFlag",
            "summarizeBy": "none"
          },
          {
            "name": "SalesPersonFlag",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "462d776a-d373-426e-bc56-ddacb809bce3",
            "sourceColumn": "SalesPersonFlag",
            "summarizeBy": "none"
          },
          {
            "name": "DepartmentName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "9e775e4c-c1c7-4d08-a4bf-03c50005e264",
            "sourceColumn": "DepartmentName",
            "summarizeBy": "none"
          },
          {
            "name": "StartDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "fcdc7bd4-5098-417a-a554-552b06480aa4",
            "sourceColumn": "StartDate",
            "summarizeBy": "none"
          },
          {
            "name": "EndDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "1f8303f6-fd0e-443f-8e71-46dee3fc1550",
            "sourceColumn": "EndDate",
            "summarizeBy": "none"
          },
          {
            "name": "Status",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "7b325fc2-2a31-4cb1-9759-ef5fa3f98c2c",
            "sourceColumn": "Status",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "f56b4b4f-75cc-4a27-b9ec-8834fac35763",
        "partitions": [
          {
            "name": "Employee-b08d9d2c-5bc4-471d-bda2-7f4b766860f7",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\"192.168.1.116\\sql2017\", \"adventureworksdw\"),",
                "    dbo_DimEmployee = Source{[Schema=\"dbo\",Item=\"DimEmployee\"]}[Data],",
                "    #\"Removed Columns\" = Table.RemoveColumns(dbo_DimEmployee,{\"EmergencyContactName\", \"EmergencyContactPhone\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Geography",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "GeographyKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "dd5a784e-494e-4e02-871f-7eb7ee53d8f3",
            "sourceColumn": "GeographyKey",
            "summarizeBy": "none"
          },
          {
            "name": "City",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "a9c3a82e-4066-485f-b715-6639b963deff",
            "sourceColumn": "City",
            "summarizeBy": "none"
          },
          {
            "name": "StateProvinceCode",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "97a9ac27-d6ce-4497-994e-ec5b1b2b0e50",
            "sourceColumn": "StateProvinceCode",
            "summarizeBy": "none"
          },
          {
            "name": "StateProvinceName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "a19afae9-c2c7-43ec-9fe4-fe94e9ae4ee9",
            "sourceColumn": "StateProvinceName",
            "summarizeBy": "none"
          },
          {
            "name": "CountryRegionCode",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "703c73ed-b7d6-4d57-b34a-c6761bdcb8e1",
            "sourceColumn": "CountryRegionCode",
            "summarizeBy": "none"
          },
          {
            "name": "EnglishCountryRegionName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "ed342f83-5c5c-4952-a50b-c3764cfd5035",
            "sourceColumn": "EnglishCountryRegionName",
            "summarizeBy": "none"
          },
          {
            "name": "PostalCode",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "1eafe6ef-41cc-4c49-bd2b-2855ccc831f6",
            "sourceColumn": "PostalCode",
            "summarizeBy": "none"
          },
          {
            "name": "SalesTerritoryKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c5128714-4888-4eb8-b862-937070679921",
            "sourceColumn": "SalesTerritoryKey",
            "summarizeBy": "none"
          },
          {
            "name": "IpAddressLocator",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "2e0b26e1-4f99-4a18-8dd3-8640112e141a",
            "sourceColumn": "IpAddressLocator",
            "summarizeBy": "none"
          },
          {
            "name": "Latitude_WRONG",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "bd2d90f1-26d0-4d06-9bb4-704568a49a6d",
            "sourceColumn": "Latitude_WRONG",
            "summarizeBy": "none"
          },
          {
            "name": "Longitude_WRONG",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "3c3103cb-ac85-46db-b594-9a20aadb99d2",
            "sourceColumn": "Longitude_WRONG",
            "summarizeBy": "none"
          },
          {
            "name": "Latitude",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "bb276e95-b4c1-4fa7-9f47-a935442af5a9",
            "sourceColumn": "Latitude",
            "summarizeBy": "none"
          },
          {
            "name": "Longitude",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "9b35a2e7-af5a-4149-8d41-827940a7ce3e",
            "sourceColumn": "Longitude",
            "summarizeBy": "none"
          },
          {
            "name": "compare WRONG",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "a9d9541e-1b16-4fbc-9322-43cffb6014af",
            "sourceColumn": "compare WRONG",
            "summarizeBy": "none"
          },
          {
            "name": "Country Switch DAX",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "SWITCH(Geography[EnglishCountryRegionName],",
              "\"United States\",\"North America\",",
              "\"Canada\",\"North America\",",
              "\"France\",\"Europe\",",
              "\"Germany\",\"Europe\",",
              "\"United Kingdom\",\"Europe\",",
              "Geography[EnglishCountryRegionName]",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "a5e1cdbd-e0b6-445f-9f76-ad6d75e75b2f",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "2a8a2bd3-c243-4bbe-9c85-0a3b126b01c9",
        "partitions": [
          {
            "name": "Geography-2f5dd496-5b98-4757-a349-4a0dabd7a22e",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\"localhost\", \"adventureworksdw2019\"),",
                "    dbo_DimGeography = Source{[Schema=\"dbo\",Item=\"DimGeography\"]}[Data],",
                "    #\"Removed Columns\" = Table.RemoveColumns(dbo_DimGeography,{\"SpanishCountryRegionName\", \"FrenchCountryRegionName\"}),",
                "    #\"Invoked Custom Function\" = Table.AddColumn(#\"Removed Columns\", \"custom\", each ChatGPT_LatLong_WRONG([City])),",
                "    #\"Expanded custom\" = Table.ExpandTableColumn(#\"Invoked Custom Function\", \"custom\", {\"Latitude\", \"Longitude\"}, {\"Latitude\", \"Longitude\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Expanded custom\",{{\"Latitude\", \"Latitude_WRONG\"}, {\"Longitude\", \"Longitude_WRONG\"}}),",
                "    #\"Invoked Custom Function1\" = Table.AddColumn(#\"Renamed Columns\", \"ChatGPT_LatLong\", each ChatGPT_LatLong([EnglishCountryRegionName], [StateProvinceName], [City])),",
                "    #\"Expanded ChatGPT_LatLong\" = Table.ExpandTableColumn(#\"Invoked Custom Function1\", \"ChatGPT_LatLong\", {\"Latitude\", \"Longitude\"}, {\"Latitude\", \"Longitude\"}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Expanded ChatGPT_LatLong\", \"WRONG\", each if [Latitude_WRONG] <> [Latitude] then 1 else if [Longitude_WRONG] <> [Longitude] then 1 else 0),",
                "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Added Conditional Column\",{{\"WRONG\", \"compare WRONG\"}})",
                "in",
                "    #\"Renamed Columns1\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "ProductCategory 😀",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "ProductCategoryKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "bce29224-de7c-4ca2-a94c-e7d0d07892ee",
            "sourceColumn": "ProductCategoryKey",
            "summarizeBy": "none"
          },
          {
            "name": "ProductCategoryAlternateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c37d514b-95d8-459f-8c6f-7f45dc2e0802",
            "sourceColumn": "ProductCategoryAlternateKey",
            "summarizeBy": "none"
          },
          {
            "name": "ProductCategoryName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "ae6d2119-5732-4438-9789-4d3267a48c7d",
            "sourceColumn": "ProductCategoryName",
            "summarizeBy": "none"
          },
          {
            "name": "Category Sales",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "[Total Sales]",
              "//[Total Sales] being a measure, this has natural filter context ie you can slice it by anything the model allows - in this case, per category."
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "27cc8310-38ca-47b2-ab5d-40707e3aecb0",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "CALCULATE (",
              "    [Total Sales]",
              ")",
              "// CALCULATE provides filter context but a measure naturally does it anyway so is not required here"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "af2c2000-ef79-4b3d-8f11-8f4a8c88a872",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "SUM ( 'InternetSales 😀'[SalesAmount] )",
              "//no filter context so each row has the grand total"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "d1341854-9ae0-4bcd-989b-1a4185d28275",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales4",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "CALCULATE (",
              "    SUM ( 'InternetSales 😀'[SalesAmount] )",
              ")",
              "//CALCULATE provides the filter context against the (non measure) aggregate"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "733251bb-6ca9-4c8a-a04e-e56c0e1d2659",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Silver Sales",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    'Product'[Color] = \"Silver\"",
              ")",
              "//CALCULATE results in a filter context on the measure [Total Sales] but also an initial row filter on [Color]=Silver ie CALCULATE provides context transition"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "6633e20d-7b56-4e03-92ae-b0164470af18",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales5",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "SUMX (",
              "    RELATEDTABLE ( 'InternetSales 😀' ),",
              "    'InternetSales 😀'[SalesAmount]",
              ")",
              "//REALATEDTABLE also performs context transition",
              "// X = expression = row context, then SUM for filtered row"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "4a4d1835-9694-47d1-b610-34432faaf1d1",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Sales Rank",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "expression": [
              "RANKX (",
              "    'ProductCategory 😀',",
              "    'ProductCategory 😀'[Category Sales],",
              "    ,",
              "    DESC",
              ")"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "89a5c38c-62d7-4b90-9fc2-eb0392d75290",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Sales Rank helper",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "// see https://radacad.com/how-to-use-rankx-in-dax-part-2-of-3-calculated-measures",
              "//encapsulate this in CALCULATE, just to prove that CALCULATE provides the filter context",
              "CONCATENATEX (",
              "    'ProductCategory 😀',",
              "    'ProductCategory 😀'[Category Sales],",
              "    \",\",",
              "    'ProductCategory 😀'[Category Sales], ASC",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "04a5f1bb-393b-48ad-a932-8c7c92d7e892",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales Ratio",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "expression": [
              "//highlights variables",
              "VAR CategorySales =",
              "    CALCULATE (",
              "        SUM ( 'InternetSales 😀'[SalesAmount] )",
              "    ) //filter context ",
              "VAR TotalSales =",
              "    SUM ( 'InternetSales 😀'[SalesAmount] ) //no filter",
              "RETURN",
              "    DIVIDE (",
              "        CategorySales,",
              "        TotalSales,",
              "        0",
              "    )"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "isDataTypeInferred": true,
            "lineageTag": "89a29292-88ef-4347-9fce-7edb63701a9c",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "HProductCategoryName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "'ProductCategory 😀'[ProductCategoryName]",
            "isDataTypeInferred": true,
            "lineageTag": "11dd2a05-8aaa-4121-979f-e47089ccd3ab",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales3.1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "SUMX (",
              "    'InternetSales 😀',",
              "    'InternetSales 😀'[OrderQuantity]",
              "        * RELATED ( 'Product'[ListPrice] )",
              ")",
              "//RELATED does NOT perform context transition so no filter (slicing) context thereby returning grand total on all rows"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "751ed49a-627f-4e41-92d4-3b9338c62c03",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales4.1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "CALCULATE (",
              "    SUMX (",
              "        'InternetSales 😀',",
              "        'InternetSales 😀'[OrderQuantity]",
              "            * RELATED ( 'Product'[ListPrice] )",
              "    )",
              ")",
              "//CALCULATE provides filter context"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "83c3070a-0091-4335-8197-b5a84aec4cb3",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales3.2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "SUM ( 'ProductCategory 😀'[Category Sales] )",
              "//a simple row context i.e. no filter (slicing) context against the [Category Sales] COLUMN"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "86159d31-492c-4356-b975-11a30436e94d",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales3.3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "CALCULATE (",
              "    SUM ( 'ProductCategory 😀'[Category Sales] )",
              ")",
              "//filter context - CALCULATE providing the transition"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "8cf5c1cc-f056-4f7f-8168-d254d269c73d",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales2.1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'InternetSales 😀' )",
              ")",
              "//ALL=remove filters (see later)"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "31907a4f-413d-41c5-af09-794cf39221ad",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Silver Sales (old school)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "SUMX (",
              "    FILTER (",
              "        RELATEDTABLE ( 'Product' ),",
              "        [Color] = \"Silver\"",
              "    ),",
              "    [Total Sales]",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "901a9546-2426-4251-a72f-3d0503cc022e",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Silver Sales 2007",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    'Product'[Color] = \"Silver\",",
              "    'Date 👍'[CalendarYear] = 2007",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "322b8a20-03fa-42f4-970e-99cdc8690183",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales Ratio2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "expression": [
              "VAR catsales = [Total Sales] //will slice",
              "VAR totalsales =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        REMOVEFILTERS ( 'ProductCategory 😀' )",
              "    ) //no slicers from ProductCategory table ie grand total",
              "RETURN",
              "    DIVIDE (",
              "        catsales,",
              "        totalsales,",
              "        0",
              "    )"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "isDataTypeInferred": true,
            "lineageTag": "8ed06161-c715-44d4-b901-010b49b55ec9",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "7d21f573-c143-46da-864d-29bde54ff20f",
        "partitions": [
          {
            "name": "ProductCategory 😀-1603d0b4-156b-4402-b82d-d2c1274b8544",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\"192.168.1.116\\sql2017\", \"adventureworksdw\"),",
                "    dbo_DimProductCategory = Source{[Schema=\"dbo\",Item=\"DimProductCategory\"]}[Data],",
                "    #\"Removed Columns\" = Table.RemoveColumns(dbo_DimProductCategory,{\"SpanishProductCategoryName\", \"FrenchProductCategoryName\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"EnglishProductCategoryName\", \"ProductCategoryName\"}})",
                "in",
                "    #\"Renamed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "ProductSubcategory",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "ProductSubcategoryKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "feadc0fa-d28a-4cbc-ab4c-b8a9ef997b54",
            "sourceColumn": "ProductSubcategoryKey",
            "summarizeBy": "none"
          },
          {
            "name": "ProductSubcategoryAlternateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d4b44a44-9f95-4046-97e1-089e0cd940c3",
            "sourceColumn": "ProductSubcategoryAlternateKey",
            "summarizeBy": "count"
          },
          {
            "name": "ProductSubcategoryName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "71615178-a703-4d00-8fd5-116908e26dd1",
            "sourceColumn": "ProductSubcategoryName",
            "summarizeBy": "none"
          },
          {
            "name": "ProductCategoryKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "99b2f05f-4532-4ba3-a87d-54d7210b1284",
            "sourceColumn": "ProductCategoryKey",
            "summarizeBy": "none"
          },
          {
            "name": "HProductSubCategoryName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "ProductSubcategory[ProductSubcategoryName]",
            "isDataTypeInferred": true,
            "lineageTag": "cbcc847a-5640-4028-9130-e4b211c6b4a9",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "92eb9aa5-c354-4e65-aae7-1d3a7ccea936",
        "measures": [
          {
            "name": "SelectedSubCategoryValue",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//SELECTEDVALUE(ProductSubcategory[EnglishProductSubcategoryName]) - is the modern way",
              "IF (",
              "    HASONEVALUE ( ProductSubcategory[ProductSubcategoryKey] ),",
              "    VALUES ( ProductSubcategory[ProductSubcategoryName] ),",
              "    BLANK ()",
              ")",
              "//Why do we need it as a measure? So that it can be embedded into other formulae where a measure is required."
            ],
            "expression": [
              "//SELECTEDVALUE(ProductSubcategory[EnglishProductSubcategoryName]) - is the modern way",
              "IF (",
              "    HASONEVALUE ( ProductSubcategory[ProductSubcategoryKey] ),",
              "    VALUES ( ProductSubcategory[ProductSubcategoryName] ),",
              "    BLANK ()",
              ")",
              "//Why do we need it as a measure? So that it can be embedded into other formulae where a measure is required."
            ],
            "lineageTag": "7aedddfd-a51c-465a-bcec-1946fb5d79f0"
          }
        ],
        "partitions": [
          {
            "name": "ProductSubcategory-f431ecf4-acc2-4d81-878a-5895fd07b930",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\"192.168.1.116\\sql2017\", \"adventureworksdw\"),",
                "    dbo_DimProductSubcategory = Source{[Schema=\"dbo\",Item=\"DimProductSubcategory\"]}[Data],",
                "    #\"Removed Columns\" = Table.RemoveColumns(dbo_DimProductSubcategory,{\"SpanishProductSubcategoryName\", \"FrenchProductSubcategoryName\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"EnglishProductSubcategoryName\", \"ProductSubcategoryName\"}})",
                "in",
                "    #\"Renamed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Product",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "ProductKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "8972003f-ec75-4631-8982-7751172bd12d",
            "sourceColumn": "ProductKey",
            "summarizeBy": "none"
          },
          {
            "name": "ProductAlternateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "040b0cf4-a729-405f-b60e-e07e27a54fe5",
            "sourceColumn": "ProductAlternateKey",
            "summarizeBy": "none"
          },
          {
            "name": "ProductSubcategoryKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b61d4e15-d49a-44d1-a547-a46fb0db9abe",
            "sourceColumn": "ProductSubcategoryKey",
            "summarizeBy": "none"
          },
          {
            "name": "WeightUnitMeasureCode",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "2329355b-5e1a-4278-a13b-7834dc3def7e",
            "sourceColumn": "WeightUnitMeasureCode",
            "summarizeBy": "none"
          },
          {
            "name": "SizeUnitMeasureCode",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "13d94377-e6d9-4c4f-b57e-54571aebaa1b",
            "sourceColumn": "SizeUnitMeasureCode",
            "summarizeBy": "none"
          },
          {
            "name": "ProductName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "be0251e3-7b5c-476b-9941-b2e995925d72",
            "sourceColumn": "ProductName",
            "summarizeBy": "none"
          },
          {
            "name": "StandardCost",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "8e0a0103-a5fd-4988-89a1-fcc1b6799ee0",
            "sourceColumn": "StandardCost",
            "summarizeBy": "sum"
          },
          {
            "name": "FinishedGoodsFlag",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "eebd0462-26ae-43a7-a17c-de28068b8331",
            "sourceColumn": "FinishedGoodsFlag",
            "summarizeBy": "none"
          },
          {
            "name": "Color",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "a52b6af8-e478-43e0-af22-511095b90f79",
            "sourceColumn": "Color",
            "summarizeBy": "none"
          },
          {
            "name": "SafetyStockLevel",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "9a073ece-e41b-43de-a819-c22b9f9649c5",
            "sourceColumn": "SafetyStockLevel",
            "summarizeBy": "sum"
          },
          {
            "name": "ReorderPoint",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "1edb0278-91ba-4691-972f-919315ff9c58",
            "sourceColumn": "ReorderPoint",
            "summarizeBy": "sum"
          },
          {
            "name": "ListPrice",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "290c6847-0f4b-4a1c-9c7c-fbb7fab5940a",
            "sourceColumn": "ListPrice",
            "summarizeBy": "none"
          },
          {
            "name": "Size",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "8424d899-acc6-4e59-ad0f-18b29732038b",
            "sourceColumn": "Size",
            "summarizeBy": "none"
          },
          {
            "name": "SizeRange",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "d770e6d4-67a9-4e74-963f-2619896996cd",
            "sourceColumn": "SizeRange",
            "summarizeBy": "none"
          },
          {
            "name": "Weight",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "5d901d7e-d4ad-454e-912c-2bd4398ecbb2",
            "sourceColumn": "Weight",
            "summarizeBy": "sum"
          },
          {
            "name": "DaysToManufacture",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "f7f41228-cee6-4f1b-80d6-6a7462cd2be3",
            "sourceColumn": "DaysToManufacture",
            "summarizeBy": "sum"
          },
          {
            "name": "ProductLine",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "c9034ac0-81ef-46ee-84be-a2f633718063",
            "sourceColumn": "ProductLine",
            "summarizeBy": "none"
          },
          {
            "name": "DealerPrice",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "be11f490-b5af-44ab-a343-f31300a50292",
            "sourceColumn": "DealerPrice",
            "summarizeBy": "sum"
          },
          {
            "name": "Class",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "b532bc6b-0fcc-453b-8bb3-b2b007693f77",
            "sourceColumn": "Class",
            "summarizeBy": "none"
          },
          {
            "name": "Style",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "759be1de-3924-4606-8419-28cc080d2c64",
            "sourceColumn": "Style",
            "summarizeBy": "none"
          },
          {
            "name": "ModelName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "9e335368-05d9-40d9-beb4-664d3f5a3f42",
            "sourceColumn": "ModelName",
            "summarizeBy": "none"
          },
          {
            "name": "EnglishDescription",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "9bac77b4-b6a6-471c-b645-85b74498d85a",
            "sourceColumn": "EnglishDescription",
            "summarizeBy": "none"
          },
          {
            "name": "StartDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "94860c4a-457d-49e4-92db-0c51c1cd83be",
            "sourceColumn": "StartDate",
            "summarizeBy": "none"
          },
          {
            "name": "EndDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "4c626195-5bc5-43a6-93d9-9d6ff5dcfb56",
            "sourceColumn": "EndDate",
            "summarizeBy": "none"
          },
          {
            "name": "Status",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "91fd203d-a213-4f18-9c06-e8f020f7051f",
            "sourceColumn": "Status",
            "summarizeBy": "none"
          },
          {
            "name": "HProductName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "'Product'[ProductName]",
            "isDataTypeInferred": true,
            "lineageTag": "aae2997d-1120-4246-b618-5ad770d97aa1",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "HSubCat",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "RELATED ( ProductSubcategory[ProductSubcategoryName] )",
            "isDataTypeInferred": true,
            "lineageTag": "9bd85fb6-7614-4ccf-94ef-753dfde8e71a",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "HCat",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "RELATED ( 'ProductCategory 😀'[ProductCategoryName] )",
            "isDataTypeInferred": true,
            "lineageTag": "cdd50982-60ce-4dcc-8e21-8421eca626c7",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Grand Total at Top",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": "\"Grand Total Top\"",
            "isDataTypeInferred": true,
            "lineageTag": "5d60f4b1-2eb4-4459-b355-cd261d69d6a0",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "NoSales",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "if([HasNoSales Sales Amount]=TRUE(),\"True\",\"False\")",
            "isDataTypeInferred": true,
            "lineageTag": "2fbe0d7d-e2c9-4cbb-902e-1140e7ce324f",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "hierarchies": [
          {
            "name": "ProductKey Hierarchy",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "levels": [
              {
                "name": "ProductKey",
                "column": "ProductKey",
                "lineageTag": "cd24c732-fcba-4bf0-b5de-e032641336e6",
                "ordinal": 0
              },
              {
                "name": "ProductName",
                "column": "ProductName",
                "lineageTag": "9754ce17-96d6-4676-ad01-5ee3a92cd804",
                "ordinal": 1
              }
            ],
            "lineageTag": "99718477-8d63-4b55-9ef3-5ddd6ffe4c38"
          },
          {
            "name": "HCat Hierarchy",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "levels": [
              {
                "name": "HCat",
                "column": "HCat",
                "lineageTag": "e1be4f92-b1bc-4d8b-8f85-c0e439fb9200",
                "ordinal": 0
              },
              {
                "name": "HSubCat",
                "column": "HSubCat",
                "lineageTag": "0d85b9fd-8717-4d25-9b92-925e039cc042",
                "ordinal": 1
              },
              {
                "name": "HProductName",
                "column": "HProductName",
                "lineageTag": "7e3c48b2-8bbb-4779-b74d-fcd271806eae",
                "ordinal": 2
              }
            ],
            "lineageTag": "3e412fa0-fa62-4e40-8f60-4442fb19a4b6"
          }
        ],
        "lineageTag": "e858b828-a648-47d1-82ee-af2b4bcfe520",
        "partitions": [
          {
            "name": "Product-a8edc397-152f-49aa-9dc4-6f4daae0fb1d",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\"192.168.1.116\\sql2017\", \"adventureworksdw\"),",
                "    dbo_DimProduct = Source{[Schema=\"dbo\",Item=\"DimProduct\"]}[Data],",
                "    #\"Removed Columns\" = Table.RemoveColumns(dbo_DimProduct,{\"SpanishProductName\", \"FrenchProductName\", \"FrenchDescription\", \"ChineseDescription\", \"ArabicDescription\", \"HebrewDescription\", \"ThaiDescription\", \"GermanDescription\", \"JapaneseDescription\", \"TurkishDescription\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"EnglishProductName\", \"ProductName\"}})",
                "in",
                "    #\"Renamed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "InternetSales 😀",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "ProductKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ab397dc2-b02d-4115-a314-63a97cc729e2",
            "sourceColumn": "ProductKey",
            "summarizeBy": "none"
          },
          {
            "name": "OrderDateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "73c07e77-7105-4966-9fa2-227db9fe0182",
            "sourceColumn": "OrderDateKey",
            "summarizeBy": "none"
          },
          {
            "name": "DueDateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b2af1999-7e16-46c3-a61e-047a1db9b6ce",
            "sourceColumn": "DueDateKey",
            "summarizeBy": "count"
          },
          {
            "name": "ShipDateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "f458fbb3-335d-450a-a3ae-c92a6f4bc1f7",
            "sourceColumn": "ShipDateKey",
            "summarizeBy": "count"
          },
          {
            "name": "CustomerKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "aec657b9-c51c-4b78-b3d6-3a363673af18",
            "sourceColumn": "CustomerKey",
            "summarizeBy": "none"
          },
          {
            "name": "PromotionKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e18db5c0-ee2e-4014-b862-b31a63e9cb90",
            "sourceColumn": "PromotionKey",
            "summarizeBy": "count"
          },
          {
            "name": "CurrencyKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "de3511f2-d172-488a-84b4-c95ebaa0b3c1",
            "sourceColumn": "CurrencyKey",
            "summarizeBy": "count"
          },
          {
            "name": "SalesTerritoryKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e4ec21b9-b9a3-4847-9c80-3d299c0424d3",
            "sourceColumn": "SalesTerritoryKey",
            "summarizeBy": "count"
          },
          {
            "name": "SalesOrderNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "8a7b574a-4b74-4bb6-9982-76a456bb64ad",
            "sourceColumn": "SalesOrderNumber",
            "summarizeBy": "none"
          },
          {
            "name": "SalesOrderLineNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "73d0dda9-ded1-48a7-bcfc-41a7e42b812f",
            "sourceColumn": "SalesOrderLineNumber",
            "summarizeBy": "count"
          },
          {
            "name": "RevisionNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "3bcc4599-d00e-40a3-beba-2b3bf96b916c",
            "sourceColumn": "RevisionNumber",
            "summarizeBy": "sum"
          },
          {
            "name": "OrderQuantity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "1239deda-890d-4e2e-9b29-c7d06be539f4",
            "sourceColumn": "OrderQuantity",
            "summarizeBy": "sum"
          },
          {
            "name": "UnitPrice",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "0b9d840b-e9d5-426d-a29e-cc714c6a342a",
            "sourceColumn": "UnitPrice",
            "summarizeBy": "sum"
          },
          {
            "name": "ExtendedAmount",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "7d9e5651-02af-448b-a4da-5b6dec95cdd0",
            "sourceColumn": "ExtendedAmount",
            "summarizeBy": "sum"
          },
          {
            "name": "UnitPriceDiscountPct",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "a6070ae3-aba2-4ca7-a808-d5078b880768",
            "sourceColumn": "UnitPriceDiscountPct",
            "summarizeBy": "sum"
          },
          {
            "name": "DiscountAmount",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "1bf696ff-1ac1-4ee1-9030-ac7c4f3c44e3",
            "sourceColumn": "DiscountAmount",
            "summarizeBy": "sum"
          },
          {
            "name": "ProductStandardCost",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "5d0d0bae-eb24-4cb2-8474-adf5d0fa4c2d",
            "sourceColumn": "ProductStandardCost",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalProductCost",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "65b53596-4d4a-4ff7-9858-1ecafa32a6f7",
            "sourceColumn": "TotalProductCost",
            "summarizeBy": "sum"
          },
          {
            "name": "SalesAmount",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "c45c81b0-dd23-419a-b0a7-4b30c392e0a3",
            "sourceColumn": "SalesAmount",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxAmt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "eeb4f8d5-7817-4fcf-9f88-13e092b6e358",
            "sourceColumn": "TaxAmt",
            "summarizeBy": "sum"
          },
          {
            "name": "Freight",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "1d24d381-6d0d-4029-b346-b79ec8aadd0c",
            "sourceColumn": "Freight",
            "summarizeBy": "sum"
          },
          {
            "name": "CarrierTrackingNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "c9c81ab7-ed7f-491c-b45a-21aded4c84be",
            "sourceColumn": "CarrierTrackingNumber",
            "summarizeBy": "none"
          },
          {
            "name": "CustomerPONumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "176fcf39-13e7-494b-b539-e54a35af8496",
            "sourceColumn": "CustomerPONumber",
            "summarizeBy": "none"
          },
          {
            "name": "OrderDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "74def71d-fb5c-48e9-829e-80ed1a3c02d3",
            "sourceColumn": "OrderDate",
            "summarizeBy": "none"
          },
          {
            "name": "DueDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "18fad14b-5c4b-4f81-ad2a-042931dd583d",
            "sourceColumn": "DueDate",
            "summarizeBy": "none"
          },
          {
            "name": "ShipDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "409712da-d467-4120-83ad-a46ed572b37d",
            "sourceColumn": "ShipDate",
            "summarizeBy": "none"
          },
          {
            "name": "Missing its Category?",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "expression": [
              "",
              "//integrity check",
              "ISBLANK(RELATED('ProductCategory 😀'[ProductCategoryName]))"
            ],
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "isDataTypeInferred": true,
            "lineageTag": "33abc5cc-b576-4259-b3e2-63736f02075c",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "7ebda6da-b0a8-4a42-bee5-8fa05b147e48",
        "measures": [
          {
            "name": "DumpFilters everywhere",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR MaxFilters = 3",
              "RETURN",
              "    IF (",
              "        ISFILTERED ( 'All Measures 😀'[Column] ),",
              "        VAR ___f =",
              "            FILTERS ( 'All Measures 😀'[Column] )",
              "        VAR ___r =",
              "            COUNTROWS ( ___f )",
              "        VAR ___t =",
              "            TOPN (",
              "                MaxFilters,",
              "                ___f,",
              "                'All Measures 😀'[Column]",
              "            )",
              "        VAR ___d =",
              "            CONCATENATEX (",
              "                ___t,",
              "                'All Measures 😀'[Column],",
              "                \", \"",
              "            )",
              "        VAR ___x =",
              "            \"'All Measures 😀'[Column] = \" & ___d",
              "                & IF (",
              "                    ___r > MaxFilters,",
              "                    \", ... [\" & ___r & \" items selected]\"",
              "                ) & \" \"",
              "        RETURN",
              "            ___x",
              "                & UNICHAR ( 13 )",
              "                & UNICHAR ( 10 )",
              "    )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Date] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Date] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Date]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Date],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Date] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[DateIsPassed] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[DateIsPassed] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[DateIsPassed]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[DateIsPassed],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[DateIsPassed] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[DateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[DateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[DateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[DateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[DateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[DayIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[DayIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[DayIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[DayIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[DayIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[DayofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[DayofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[DayofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[DayofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[DayofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[EndofMonth] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[EndofMonth] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[EndofMonth]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[EndofMonth],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[EndofMonth] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[EndofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[EndofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[EndofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[EndofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[EndofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Iso Week] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Iso Week] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Iso Week]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Iso Week],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Iso Week] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Iso Year] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Iso Year] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Iso Year]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Iso Year],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Iso Year] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Iso Year Week] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Iso Year Week] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Iso Year Week]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Iso Year Week],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Iso Year Week] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Month] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Month] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Month]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Month],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Month] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[MonthDay] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[MonthDay] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[MonthDay]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[MonthDay],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[MonthDay] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[MonthIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[MonthIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[MonthIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[MonthIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[MonthIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[MonthsortinYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[MonthsortinYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[MonthsortinYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[MonthsortinYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[MonthsortinYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[MonthYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[MonthYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[MonthYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[MonthYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[MonthYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[MonthYearsortbyYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[MonthYearsortbyYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[MonthYearsortbyYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[MonthYearsortbyYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[MonthYearsortbyYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Quarter] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Quarter] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Quarter]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Quarter],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Quarter] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[StartofMonth] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[StartofMonth] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[StartofMonth]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[StartofMonth],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[StartofMonth] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[StartofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[StartofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[StartofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[StartofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[StartofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Week Day starting Jan 1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Week Day starting Jan 1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Week Day starting Jan 1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Week Day starting Jan 1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Week Day starting Jan 1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Week No starting Jan 1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Week No starting Jan 1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Week No starting Jan 1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Week No starting Jan 1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Week No starting Jan 1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Week Start Date with Year] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Week Start Date with Year] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Week Start Date with Year]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Week Start Date with Year],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Week Start Date with Year] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[WeekDay] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[WeekDay] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[WeekDay]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[WeekDay],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[WeekDay] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[WeekDaysort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[WeekDaysort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[WeekDaysort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[WeekDaysort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[WeekDaysort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[WeekIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[WeekIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[WeekIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[WeekIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[WeekIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[WeekNum] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[WeekNum] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[WeekNum]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[WeekNum],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[WeekNum] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Year] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Year] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Year]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Year],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Year] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[YearIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[YearIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[YearIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[YearIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[YearIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[YearWeek] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[YearWeek] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[YearWeek]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[YearWeek],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[YearWeek] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[12monthrange] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[12monthrange] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[12monthrange]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[12monthrange],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[12monthrange] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[Date] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[Date] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[Date]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[Date],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[Date] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[DateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[DateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[DateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[DateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[DateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[DayIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[DayIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[DayIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[DayIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[DayIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[DayofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[DayofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[DayofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[DayofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[DayofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[EndofMonth] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[EndofMonth] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[EndofMonth]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[EndofMonth],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[EndofMonth] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[EndofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[EndofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[EndofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[EndofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[EndofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[Month] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[Month] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[Month]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[Month],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[Month] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[MonthDay] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[MonthDay] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[MonthDay]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[MonthDay],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[MonthDay] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[MonthIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[MonthIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[MonthIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[MonthIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[MonthIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[MonthsortinYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[MonthsortinYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[MonthsortinYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[MonthsortinYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[MonthsortinYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[MonthYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[MonthYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[MonthYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[MonthYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[MonthYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[MonthYearsortbyYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[MonthYearsortbyYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[MonthYearsortbyYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[MonthYearsortbyYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[MonthYearsortbyYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[Quarter] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[Quarter] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[Quarter]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[Quarter],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[Quarter] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[RelativeWeek] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[RelativeWeek] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[RelativeWeek]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[RelativeWeek],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[RelativeWeek] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[StartofMonth] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[StartofMonth] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[StartofMonth]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[StartofMonth],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[StartofMonth] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[StartofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[StartofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[StartofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[StartofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[StartofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[WeekDay] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[WeekDay] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[WeekDay]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[WeekDay],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[WeekDay] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[WeekDaysort] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[WeekDaysort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[WeekDaysort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[WeekDaysort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[WeekDaysort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[WeekIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[WeekIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[WeekIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[WeekIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[WeekIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[WeekNum] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[WeekNum] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[WeekNum]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[WeekNum],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[WeekNum] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[Year] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[Year] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[Year]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[Year],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[Year] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[YearIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[YearIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[YearIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[YearIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[YearIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[YearWeek] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[YearWeek] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[YearWeek]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[YearWeek],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[YearWeek] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[BirthDate] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[BirthDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[BirthDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[BirthDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[BirthDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[CustomerAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[CustomerAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[CustomerAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[CustomerAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[CustomerAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[CustomerKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[CustomerKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[CustomerKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[CustomerKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[CustomerKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[EmailAddress] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[EmailAddress] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[EmailAddress]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[EmailAddress],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[EmailAddress] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[FirstName] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[FirstName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[FirstName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[FirstName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[FirstName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[FullName] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[FullName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[FullName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[FullName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[FullName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[Gender] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[Gender] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[Gender]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[Gender],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[Gender] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[GeographyKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[GeographyKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[GeographyKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[GeographyKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[GeographyKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[LastName] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[LastName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[LastName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[LastName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[LastName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[MaritalStatus] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[MaritalStatus] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[MaritalStatus]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[MaritalStatus],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[MaritalStatus] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[MiddleName] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[MiddleName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[MiddleName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[MiddleName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[MiddleName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[CalendarQuarter] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[CalendarQuarter] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[CalendarQuarter]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[CalendarQuarter],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[CalendarQuarter] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[CalendarSemester] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[CalendarSemester] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[CalendarSemester]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[CalendarSemester],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[CalendarSemester] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[CalendarYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[CalendarYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[CalendarYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[CalendarYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[CalendarYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[Date] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[Date] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[Date]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[Date],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[Date] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[DateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[DateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[DateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[DateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[DateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[DayNumberOfMonth] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[DayNumberOfMonth] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[DayNumberOfMonth]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[DayNumberOfMonth],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[DayNumberOfMonth] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[DayNumberOfWeek] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[DayNumberOfWeek] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[DayNumberOfWeek]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[DayNumberOfWeek],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[DayNumberOfWeek] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[DayNumberOfYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[DayNumberOfYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[DayNumberOfYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[DayNumberOfYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[DayNumberOfYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[EnglishDayNameOfWeek] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[EnglishDayNameOfWeek] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[EnglishDayNameOfWeek]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[EnglishDayNameOfWeek],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[EnglishDayNameOfWeek] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[EnglishMonthName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[EnglishMonthName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[EnglishMonthName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[EnglishMonthName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[EnglishMonthName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[FiscalQuarter] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[FiscalQuarter] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[FiscalQuarter]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[FiscalQuarter],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[FiscalQuarter] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[FiscalSemester] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[FiscalSemester] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[FiscalSemester]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[FiscalSemester],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[FiscalSemester] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[FiscalYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[FiscalYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[FiscalYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[FiscalYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[FiscalYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[IsPast] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[IsPast] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[IsPast]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[IsPast],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[IsPast] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[MMMYYYY] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[MMMYYYY] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[MMMYYYY]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[MMMYYYY],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[MMMYYYY] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[MMMYYYY sort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[MMMYYYY sort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[MMMYYYY sort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[MMMYYYY sort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[MMMYYYY sort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[MonthNumberOfYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[MonthNumberOfYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[MonthNumberOfYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[MonthNumberOfYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[MonthNumberOfYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[QYYYY] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[QYYYY] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[QYYYY]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[QYYYY],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[QYYYY] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[QYYYY sort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[QYYYY sort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[QYYYY sort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[QYYYY sort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[QYYYY sort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[WeekNumberOfYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[WeekNumberOfYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[WeekNumberOfYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[WeekNumberOfYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[WeekNumberOfYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( datehelper[datename] ),",
              "            VAR ___f =",
              "                FILTERS ( datehelper[datename] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    datehelper[datename]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    datehelper[datename],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"datehelper[datename] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( datehelper[datenum] ),",
              "            VAR ___f =",
              "                FILTERS ( datehelper[datenum] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    datehelper[datenum]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    datehelper[datenum],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"datehelper[datenum] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'days average1'[days average1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'days average1'[days average1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'days average1'[days average1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'days average1'[days average1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'days average1'[days average1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'days average2'[days average2] ),",
              "            VAR ___f =",
              "                FILTERS ( 'days average2'[days average2] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'days average2'[days average2]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'days average2'[days average2],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'days average2'[days average2] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[DataType] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[DataType] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[DataType]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[DataType],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[DataType] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[Expression] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[Expression] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[Expression]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[Expression],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[Expression] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[FormatString] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[FormatString] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[FormatString]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[FormatString],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[FormatString] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[Name] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[Name] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[Name]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[Name],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[Name] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[ObjectType] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[ObjectType] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[ObjectType]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[ObjectType],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[ObjectType] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[Parent] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[Parent] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[Parent]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[Parent],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[Parent] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[BaseRate] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[BaseRate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[BaseRate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[BaseRate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[BaseRate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[BirthDate] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[BirthDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[BirthDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[BirthDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[BirthDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[CurrentFlag] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[CurrentFlag] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[CurrentFlag]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[CurrentFlag],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[CurrentFlag] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[DepartmentName] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[DepartmentName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[DepartmentName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[DepartmentName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[DepartmentName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[EmailAddress] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[EmailAddress] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[EmailAddress]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[EmailAddress],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[EmailAddress] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[EmployeeKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[EmployeeKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[EmployeeKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[EmployeeKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[EmployeeKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[EmployeeNationalIDAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[EmployeeNationalIDAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[EmployeeNationalIDAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[EmployeeNationalIDAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[EmployeeNationalIDAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[EndDate] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[EndDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[EndDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[EndDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[EndDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[FirstName] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[FirstName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[FirstName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[FirstName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[FirstName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[Gender] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[Gender] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[Gender]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[Gender],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[Gender] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[HireDate] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[HireDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[HireDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[HireDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[HireDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[LastName] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[LastName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[LastName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[LastName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[LastName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[LoginID] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[LoginID] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[LoginID]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[LoginID],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[LoginID] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[MaritalStatus] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[MaritalStatus] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[MaritalStatus]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[MaritalStatus],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[MaritalStatus] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[MiddleName] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[MiddleName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[MiddleName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[MiddleName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[MiddleName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[NameStyle] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[NameStyle] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[NameStyle]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[NameStyle],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[NameStyle] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[ParentEmployeeKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[ParentEmployeeKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[ParentEmployeeKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[ParentEmployeeKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[ParentEmployeeKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[ParentEmployeeNationalIDAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[ParentEmployeeNationalIDAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[ParentEmployeeNationalIDAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[ParentEmployeeNationalIDAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[ParentEmployeeNationalIDAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[PayFrequency] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[PayFrequency] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[PayFrequency]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[PayFrequency],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[PayFrequency] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[Phone] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[Phone] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[Phone]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[Phone],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[Phone] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[SalariedFlag] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[SalariedFlag] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[SalariedFlag]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[SalariedFlag],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[SalariedFlag] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[SalesPersonFlag] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[SalesPersonFlag] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[SalesPersonFlag]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[SalesPersonFlag],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[SalesPersonFlag] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[SalesTerritoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[SalesTerritoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[SalesTerritoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[SalesTerritoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[SalesTerritoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[SickLeaveHours] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[SickLeaveHours] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[SickLeaveHours]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[SickLeaveHours],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[SickLeaveHours] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[StartDate] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[StartDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[StartDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[StartDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[StartDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[Status] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[Status] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[Status]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[Status],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[Status] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[Title] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[Title] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[Title]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[Title],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[Title] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[VacationHours] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[VacationHours] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[VacationHours]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[VacationHours],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[VacationHours] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[City] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[City] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[City]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[City],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[City] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[CountryRegionCode] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[CountryRegionCode] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[CountryRegionCode]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[CountryRegionCode],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[CountryRegionCode] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[EnglishCountryRegionName] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[EnglishCountryRegionName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[EnglishCountryRegionName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[EnglishCountryRegionName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[EnglishCountryRegionName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[GeographyKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[GeographyKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[GeographyKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[GeographyKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[GeographyKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[IpAddressLocator] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[IpAddressLocator] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[IpAddressLocator]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[IpAddressLocator],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[IpAddressLocator] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[PostalCode] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[PostalCode] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[PostalCode]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[PostalCode],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[PostalCode] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[SalesTerritoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[SalesTerritoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[SalesTerritoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[SalesTerritoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[SalesTerritoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[StateProvinceCode] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[StateProvinceCode] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[StateProvinceCode]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[StateProvinceCode],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[StateProvinceCode] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[StateProvinceName] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[StateProvinceName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[StateProvinceName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[StateProvinceName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[StateProvinceName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[CarrierTrackingNumber] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[CarrierTrackingNumber] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[CarrierTrackingNumber]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[CarrierTrackingNumber],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[CarrierTrackingNumber] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[CurrencyKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[CurrencyKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[CurrencyKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[CurrencyKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[CurrencyKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[CustomerKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[CustomerKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[CustomerKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[CustomerKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[CustomerKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[CustomerPONumber] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[CustomerPONumber] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[CustomerPONumber]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[CustomerPONumber],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[CustomerPONumber] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[DiscountAmount] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[DiscountAmount] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[DiscountAmount]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[DiscountAmount],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[DiscountAmount] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[DueDate] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[DueDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[DueDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[DueDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[DueDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[DueDateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[DueDateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[DueDateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[DueDateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[DueDateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[ExtendedAmount] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[ExtendedAmount] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[ExtendedAmount]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[ExtendedAmount],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[ExtendedAmount] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[Freight] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[Freight] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[Freight]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[Freight],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[Freight] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[OrderDate] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[OrderDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[OrderDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[OrderDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[OrderDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[OrderDateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[OrderDateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[OrderDateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[OrderDateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[OrderDateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[OrderQuantity] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[OrderQuantity] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[OrderQuantity]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[OrderQuantity],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[OrderQuantity] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[ProductKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[ProductKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[ProductKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[ProductKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[ProductKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[ProductStandardCost] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[ProductStandardCost] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[ProductStandardCost]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[ProductStandardCost],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[ProductStandardCost] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[PromotionKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[PromotionKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[PromotionKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[PromotionKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[PromotionKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[RevisionNumber] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[RevisionNumber] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[RevisionNumber]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[RevisionNumber],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[RevisionNumber] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[SalesAmount] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[SalesAmount] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[SalesAmount]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[SalesAmount],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[SalesAmount] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[SalesOrderLineNumber] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[SalesOrderLineNumber] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[SalesOrderLineNumber]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[SalesOrderLineNumber],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[SalesOrderLineNumber] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[SalesOrderNumber] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[SalesOrderNumber] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[SalesOrderNumber]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[SalesOrderNumber],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[SalesOrderNumber] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[SalesTerritoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[SalesTerritoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[SalesTerritoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[SalesTerritoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[SalesTerritoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[ShipDate] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[ShipDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[ShipDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[ShipDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[ShipDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[ShipDateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[ShipDateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[ShipDateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[ShipDateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[ShipDateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[TaxAmt] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[TaxAmt] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[TaxAmt]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[TaxAmt],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[TaxAmt] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[TotalProductCost] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[TotalProductCost] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[TotalProductCost]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[TotalProductCost],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[TotalProductCost] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[UnitPrice] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[UnitPrice] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[UnitPrice]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[UnitPrice],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[UnitPrice] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[UnitPriceDiscountPct] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[UnitPriceDiscountPct] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[UnitPriceDiscountPct]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[UnitPriceDiscountPct],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[UnitPriceDiscountPct] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[CustomerKey] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[CustomerKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[CustomerKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[CustomerKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[CustomerKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[Freight] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[Freight] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[Freight]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[Freight],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[Freight] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[OrderDate] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[OrderDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[OrderDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[OrderDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[OrderDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[OrderDate_Original] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[OrderDate_Original] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[OrderDate_Original]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[OrderDate_Original],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[OrderDate_Original] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[OrderDateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[OrderDateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[OrderDateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[OrderDateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[OrderDateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[OrderDateKey_Original] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[OrderDateKey_Original] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[OrderDateKey_Original]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[OrderDateKey_Original],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[OrderDateKey_Original] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[OrderQuantity] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[OrderQuantity] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[OrderQuantity]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[OrderQuantity],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[OrderQuantity] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[ProductKey] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[ProductKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[ProductKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[ProductKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[ProductKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[SalesAmount] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[SalesAmount] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[SalesAmount]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[SalesAmount],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[SalesAmount] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[TaxAmt] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[TaxAmt] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[TaxAmt]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[TaxAmt],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[TaxAmt] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[TotalProductCost] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[TotalProductCost] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[TotalProductCost]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[TotalProductCost],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[TotalProductCost] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[UnitPrice] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[UnitPrice] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[UnitPrice]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[UnitPrice],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[UnitPrice] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( measurehelper[measurename] ),",
              "            VAR ___f =",
              "                FILTERS ( measurehelper[measurename] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    measurehelper[measurename]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    measurehelper[measurename],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"measurehelper[measurename] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Class] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Class] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Class]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Class],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Class] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Color] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Color] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Color]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Color],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Color] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[DaysToManufacture] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[DaysToManufacture] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[DaysToManufacture]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[DaysToManufacture],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[DaysToManufacture] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[DealerPrice] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[DealerPrice] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[DealerPrice]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[DealerPrice],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[DealerPrice] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[EndDate] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[EndDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[EndDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[EndDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[EndDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[EnglishDescription] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[EnglishDescription] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[EnglishDescription]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[EnglishDescription],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[EnglishDescription] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[FinishedGoodsFlag] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[FinishedGoodsFlag] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[FinishedGoodsFlag]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[FinishedGoodsFlag],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[FinishedGoodsFlag] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Grand Total at Top] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Grand Total at Top] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Grand Total at Top]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Grand Total at Top],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Grand Total at Top] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[HCat] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[HCat] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[HCat]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[HCat],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[HCat] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[HProductName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[HProductName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[HProductName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[HProductName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[HProductName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[HSubCat] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[HSubCat] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[HSubCat]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[HSubCat],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[HSubCat] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ListPrice] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ListPrice] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ListPrice]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ListPrice],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ListPrice] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ModelName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ModelName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ModelName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ModelName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ModelName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ProductAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ProductAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ProductAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ProductAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ProductAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ProductKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ProductKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ProductKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ProductKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ProductKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ProductLine] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ProductLine] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ProductLine]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ProductLine],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ProductLine] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ProductName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ProductName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ProductName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ProductName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ProductName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ProductSubcategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ProductSubcategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ProductSubcategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ProductSubcategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ProductSubcategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ReorderPoint] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ReorderPoint] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ReorderPoint]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ReorderPoint],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ReorderPoint] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[SafetyStockLevel] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[SafetyStockLevel] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[SafetyStockLevel]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[SafetyStockLevel],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[SafetyStockLevel] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Size] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Size] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Size]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Size],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Size] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[SizeRange] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[SizeRange] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[SizeRange]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[SizeRange],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[SizeRange] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[SizeUnitMeasureCode] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[SizeUnitMeasureCode] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[SizeUnitMeasureCode]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[SizeUnitMeasureCode],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[SizeUnitMeasureCode] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[StandardCost] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[StandardCost] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[StandardCost]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[StandardCost],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[StandardCost] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[StartDate] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[StartDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[StartDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[StartDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[StartDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Status] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Status] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Status]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Status],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Status] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Style] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Style] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Style]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Style],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Style] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Weight] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Weight] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Weight]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Weight],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Weight] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[WeightUnitMeasureCode] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[WeightUnitMeasureCode] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[WeightUnitMeasureCode]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[WeightUnitMeasureCode],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[WeightUnitMeasureCode] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales Ratio] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales Ratio] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales Ratio]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales Ratio],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales Ratio] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales Ratio2] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales Ratio2] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales Ratio2]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales Ratio2],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales Ratio2] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales2] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales2] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales2]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales2],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales2] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales2.1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales2.1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales2.1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales2.1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales2.1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales3] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales3] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales3]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales3],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales3] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales3.1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales3.1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales3.1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales3.1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales3.1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales3.2] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales3.2] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales3.2]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales3.2],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales3.2] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales3.3] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales3.3] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales3.3]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales3.3],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales3.3] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales4] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales4] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales4]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales4],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales4] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales4.1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales4.1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales4.1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales4.1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales4.1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales5] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales5] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales5]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales5],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales5] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[HProductCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[HProductCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[HProductCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[HProductCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[HProductCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[ProductCategoryAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[ProductCategoryAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[ProductCategoryAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[ProductCategoryAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[ProductCategoryAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[ProductCategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[ProductCategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[ProductCategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[ProductCategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[ProductCategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[ProductCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[ProductCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[ProductCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[ProductCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[ProductCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Sales Rank] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Sales Rank] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Sales Rank]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Sales Rank],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Sales Rank] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Sales Rank helper] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Sales Rank helper] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Sales Rank helper]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Sales Rank helper],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Sales Rank helper] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Silver Sales] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Silver Sales] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Silver Sales]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Silver Sales],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Silver Sales] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Silver Sales (old school)] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Silver Sales (old school)] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Silver Sales (old school)]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Silver Sales (old school)],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Silver Sales (old school)] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Silver Sales 2007] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Silver Sales 2007] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Silver Sales 2007]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Silver Sales 2007],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Silver Sales 2007] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Left[Category Sales] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Left[Category Sales] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Left[Category Sales]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Left[Category Sales],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Left[Category Sales] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Left[Category Sales BUDGET] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Left[Category Sales BUDGET] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Left[Category Sales BUDGET]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Left[Category Sales BUDGET],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Left[Category Sales BUDGET] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Left[ProductCategoryAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Left[ProductCategoryAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Left[ProductCategoryAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Left[ProductCategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Left[ProductCategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Left[ProductCategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Left[ProductCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Left[ProductCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Left[ProductCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Right[Category Sales] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Right[Category Sales] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Right[Category Sales]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Right[Category Sales],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Right[Category Sales] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Right[Category Sales BUDGET] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Right[Category Sales BUDGET] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Right[Category Sales BUDGET]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Right[Category Sales BUDGET],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Right[Category Sales BUDGET] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Right[ProductCategoryAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Right[ProductCategoryAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Right[ProductCategoryAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Right[ProductCategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Right[ProductCategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Right[ProductCategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Right[ProductCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Right[ProductCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Right[ProductCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory2[Category Sales] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory2[Category Sales] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory2[Category Sales]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory2[Category Sales],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory2[Category Sales] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory2[Category Sales BUDGET] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory2[Category Sales BUDGET] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory2[Category Sales BUDGET]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory2[Category Sales BUDGET],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory2[Category Sales BUDGET] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory2[ProductCategoryAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory2[ProductCategoryAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory2[ProductCategoryAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory2[ProductCategoryAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory2[ProductCategoryAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory2[ProductCategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory2[ProductCategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory2[ProductCategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory2[ProductCategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory2[ProductCategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory2[ProductCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory2[ProductCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory2[ProductCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory2[ProductCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory2[ProductCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductSubcategory[HProductSubCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductSubcategory[HProductSubCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductSubcategory[HProductSubCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductSubcategory[HProductSubCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductSubcategory[HProductSubCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductSubcategory[ProductCategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductSubcategory[ProductCategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductSubcategory[ProductCategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductSubcategory[ProductCategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductSubcategory[ProductCategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductSubcategory[ProductSubcategoryAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductSubcategory[ProductSubcategoryAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductSubcategory[ProductSubcategoryAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductSubcategory[ProductSubcategoryAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductSubcategory[ProductSubcategoryAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductSubcategory[ProductSubcategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductSubcategory[ProductSubcategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductSubcategory[ProductSubcategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductSubcategory[ProductSubcategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductSubcategory[ProductSubcategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductSubcategory[ProductSubcategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductSubcategory[ProductSubcategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductSubcategory[ProductSubcategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductSubcategory[ProductSubcategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductSubcategory[ProductSubcategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( rankhelper[rankname] ),",
              "            VAR ___f =",
              "                FILTERS ( rankhelper[rankname] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    rankhelper[rankname]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    rankhelper[rankname],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"rankhelper[rankname] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( rankhelper[ranknum] ),",
              "            VAR ___f =",
              "                FILTERS ( rankhelper[ranknum] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    rankhelper[ranknum]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    rankhelper[ranknum],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"rankhelper[ranknum] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Sales Amount slider'[Sales Amount slider] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Sales Amount slider'[Sales Amount slider] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Sales Amount slider'[Sales Amount slider]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Sales Amount slider'[Sales Amount slider],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Sales Amount slider'[Sales Amount slider] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'TE Date Selector'[DateToUse] ),",
              "            VAR ___f =",
              "                FILTERS ( 'TE Date Selector'[DateToUse] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'TE Date Selector'[DateToUse]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'TE Date Selector'[DateToUse],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TE Date Selector'[DateToUse] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'TE Date Selector'[Ordinal] ),",
              "            VAR ___f =",
              "                FILTERS ( 'TE Date Selector'[Ordinal] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'TE Date Selector'[Ordinal]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'TE Date Selector'[Ordinal],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TE Date Selector'[Ordinal] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'TE Many Measures at once'[Name] ),",
              "            VAR ___f =",
              "                FILTERS ( 'TE Many Measures at once'[Name] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'TE Many Measures at once'[Name]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'TE Many Measures at once'[Name],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TE Many Measures at once'[Name] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'TE Many Measures at once'[Ordinal] ),",
              "            VAR ___f =",
              "                FILTERS ( 'TE Many Measures at once'[Ordinal] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'TE Many Measures at once'[Ordinal]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'TE Many Measures at once'[Ordinal],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TE Many Measures at once'[Ordinal] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'TE Measure Selector'[TE Measure] ),",
              "            VAR ___f =",
              "                FILTERS ( 'TE Measure Selector'[TE Measure] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'TE Measure Selector'[TE Measure]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'TE Measure Selector'[TE Measure],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TE Measure Selector'[TE Measure] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Top or Other'[Sort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Top or Other'[Sort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Top or Other'[Sort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Top or Other'[Sort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Top or Other'[Sort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Top or Other'[Top/Other] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Top or Other'[Top/Other] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Top or Other'[Top/Other]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Top or Other'[Top/Other],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Top or Other'[Top/Other] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Top3orLess[Top3orLess] ),",
              "            VAR ___f =",
              "                FILTERS ( Top3orLess[Top3orLess] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Top3orLess[Top3orLess]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Top3orLess[Top3orLess],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Top3orLess[Top3orLess] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'TopN'[TopN] ),",
              "            VAR ___f =",
              "                FILTERS ( 'TopN'[TopN] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'TopN'[TopN]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'TopN'[TopN],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TopN'[TopN] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'X axis'[Sort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'X axis'[Sort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'X axis'[Sort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'X axis'[Sort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'X axis'[Sort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'X axis'[xMeasure] ),",
              "            VAR ___f =",
              "                FILTERS ( 'X axis'[xMeasure] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'X axis'[xMeasure]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'X axis'[xMeasure],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'X axis'[xMeasure] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Y axis'[Sort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Y axis'[Sort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Y axis'[Sort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Y axis'[Sort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Y axis'[Sort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Y axis'[yMeasure] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Y axis'[yMeasure] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Y axis'[yMeasure]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Y axis'[yMeasure],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Y axis'[yMeasure] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )"
            ],
            "expression": [
              "VAR MaxFilters = 3",
              "RETURN",
              "    IF (",
              "        ISFILTERED ( 'All Measures 😀'[Column] ),",
              "        VAR ___f =",
              "            FILTERS ( 'All Measures 😀'[Column] )",
              "        VAR ___r =",
              "            COUNTROWS ( ___f )",
              "        VAR ___t =",
              "            TOPN (",
              "                MaxFilters,",
              "                ___f,",
              "                'All Measures 😀'[Column]",
              "            )",
              "        VAR ___d =",
              "            CONCATENATEX (",
              "                ___t,",
              "                'All Measures 😀'[Column],",
              "                \", \"",
              "            )",
              "        VAR ___x =",
              "            \"'All Measures 😀'[Column] = \" & ___d",
              "                & IF (",
              "                    ___r > MaxFilters,",
              "                    \", ... [\" & ___r & \" items selected]\"",
              "                ) & \" \"",
              "        RETURN",
              "            ___x",
              "                & UNICHAR ( 13 )",
              "                & UNICHAR ( 10 )",
              "    )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Date] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Date] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Date]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Date],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Date] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[DateIsPassed] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[DateIsPassed] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[DateIsPassed]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[DateIsPassed],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[DateIsPassed] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[DateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[DateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[DateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[DateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[DateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[DayIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[DayIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[DayIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[DayIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[DayIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[DayofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[DayofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[DayofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[DayofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[DayofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[EndofMonth] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[EndofMonth] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[EndofMonth]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[EndofMonth],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[EndofMonth] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[EndofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[EndofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[EndofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[EndofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[EndofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Iso Week] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Iso Week] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Iso Week]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Iso Week],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Iso Week] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Iso Year] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Iso Year] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Iso Year]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Iso Year],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Iso Year] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Iso Year Week] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Iso Year Week] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Iso Year Week]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Iso Year Week],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Iso Year Week] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Month] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Month] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Month]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Month],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Month] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[MonthDay] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[MonthDay] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[MonthDay]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[MonthDay],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[MonthDay] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[MonthIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[MonthIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[MonthIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[MonthIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[MonthIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[MonthsortinYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[MonthsortinYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[MonthsortinYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[MonthsortinYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[MonthsortinYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[MonthYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[MonthYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[MonthYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[MonthYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[MonthYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[MonthYearsortbyYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[MonthYearsortbyYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[MonthYearsortbyYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[MonthYearsortbyYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[MonthYearsortbyYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Quarter] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Quarter] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Quarter]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Quarter],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Quarter] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[StartofMonth] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[StartofMonth] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[StartofMonth]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[StartofMonth],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[StartofMonth] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[StartofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[StartofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[StartofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[StartofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[StartofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Week Day starting Jan 1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Week Day starting Jan 1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Week Day starting Jan 1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Week Day starting Jan 1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Week Day starting Jan 1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Week No starting Jan 1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Week No starting Jan 1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Week No starting Jan 1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Week No starting Jan 1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Week No starting Jan 1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Week Start Date with Year] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Week Start Date with Year] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Week Start Date with Year]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Week Start Date with Year],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Week Start Date with Year] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[WeekDay] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[WeekDay] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[WeekDay]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[WeekDay],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[WeekDay] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[WeekDaysort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[WeekDaysort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[WeekDaysort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[WeekDaysort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[WeekDaysort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[WeekIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[WeekIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[WeekIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[WeekIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[WeekIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[WeekNum] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[WeekNum] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[WeekNum]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[WeekNum],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[WeekNum] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[Year] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[Year] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[Year]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[Year],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[Year] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[YearIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[YearIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[YearIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[YearIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[YearIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Calendar'[YearWeek] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Calendar'[YearWeek] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Calendar'[YearWeek]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Calendar'[YearWeek],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Calendar'[YearWeek] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[12monthrange] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[12monthrange] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[12monthrange]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[12monthrange],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[12monthrange] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[Date] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[Date] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[Date]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[Date],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[Date] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[DateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[DateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[DateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[DateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[DateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[DayIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[DayIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[DayIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[DayIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[DayIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[DayofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[DayofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[DayofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[DayofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[DayofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[EndofMonth] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[EndofMonth] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[EndofMonth]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[EndofMonth],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[EndofMonth] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[EndofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[EndofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[EndofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[EndofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[EndofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[Month] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[Month] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[Month]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[Month],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[Month] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[MonthDay] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[MonthDay] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[MonthDay]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[MonthDay],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[MonthDay] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[MonthIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[MonthIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[MonthIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[MonthIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[MonthIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[MonthsortinYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[MonthsortinYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[MonthsortinYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[MonthsortinYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[MonthsortinYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[MonthYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[MonthYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[MonthYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[MonthYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[MonthYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[MonthYearsortbyYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[MonthYearsortbyYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[MonthYearsortbyYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[MonthYearsortbyYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[MonthYearsortbyYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[Quarter] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[Quarter] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[Quarter]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[Quarter],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[Quarter] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[RelativeWeek] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[RelativeWeek] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[RelativeWeek]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[RelativeWeek],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[RelativeWeek] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[StartofMonth] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[StartofMonth] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[StartofMonth]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[StartofMonth],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[StartofMonth] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[StartofYear] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[StartofYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[StartofYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[StartofYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[StartofYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[WeekDay] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[WeekDay] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[WeekDay]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[WeekDay],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[WeekDay] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[WeekDaysort] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[WeekDaysort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[WeekDaysort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[WeekDaysort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[WeekDaysort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[WeekIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[WeekIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[WeekIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[WeekIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[WeekIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[WeekNum] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[WeekNum] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[WeekNum]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[WeekNum],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[WeekNum] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[Year] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[Year] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[Year]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[Year],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[Year] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[YearIndex] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[YearIndex] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[YearIndex]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[YearIndex],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[YearIndex] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Calendar_Current[YearWeek] ),",
              "            VAR ___f =",
              "                FILTERS ( Calendar_Current[YearWeek] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Calendar_Current[YearWeek]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Calendar_Current[YearWeek],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Calendar_Current[YearWeek] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[BirthDate] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[BirthDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[BirthDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[BirthDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[BirthDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[CustomerAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[CustomerAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[CustomerAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[CustomerAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[CustomerAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[CustomerKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[CustomerKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[CustomerKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[CustomerKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[CustomerKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[EmailAddress] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[EmailAddress] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[EmailAddress]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[EmailAddress],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[EmailAddress] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[FirstName] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[FirstName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[FirstName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[FirstName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[FirstName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[FullName] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[FullName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[FullName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[FullName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[FullName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[Gender] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[Gender] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[Gender]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[Gender],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[Gender] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[GeographyKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[GeographyKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[GeographyKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[GeographyKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[GeographyKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[LastName] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[LastName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[LastName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[LastName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[LastName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[MaritalStatus] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[MaritalStatus] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[MaritalStatus]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[MaritalStatus],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[MaritalStatus] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Customer[MiddleName] ),",
              "            VAR ___f =",
              "                FILTERS ( Customer[MiddleName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Customer[MiddleName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Customer[MiddleName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Customer[MiddleName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[CalendarQuarter] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[CalendarQuarter] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[CalendarQuarter]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[CalendarQuarter],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[CalendarQuarter] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[CalendarSemester] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[CalendarSemester] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[CalendarSemester]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[CalendarSemester],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[CalendarSemester] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[CalendarYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[CalendarYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[CalendarYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[CalendarYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[CalendarYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[Date] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[Date] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[Date]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[Date],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[Date] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[DateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[DateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[DateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[DateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[DateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[DayNumberOfMonth] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[DayNumberOfMonth] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[DayNumberOfMonth]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[DayNumberOfMonth],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[DayNumberOfMonth] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[DayNumberOfWeek] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[DayNumberOfWeek] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[DayNumberOfWeek]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[DayNumberOfWeek],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[DayNumberOfWeek] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[DayNumberOfYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[DayNumberOfYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[DayNumberOfYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[DayNumberOfYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[DayNumberOfYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[EnglishDayNameOfWeek] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[EnglishDayNameOfWeek] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[EnglishDayNameOfWeek]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[EnglishDayNameOfWeek],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[EnglishDayNameOfWeek] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[EnglishMonthName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[EnglishMonthName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[EnglishMonthName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[EnglishMonthName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[EnglishMonthName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[FiscalQuarter] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[FiscalQuarter] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[FiscalQuarter]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[FiscalQuarter],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[FiscalQuarter] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[FiscalSemester] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[FiscalSemester] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[FiscalSemester]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[FiscalSemester],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[FiscalSemester] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[FiscalYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[FiscalYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[FiscalYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[FiscalYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[FiscalYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[IsPast] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[IsPast] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[IsPast]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[IsPast],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[IsPast] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[MMMYYYY] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[MMMYYYY] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[MMMYYYY]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[MMMYYYY],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[MMMYYYY] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[MMMYYYY sort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[MMMYYYY sort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[MMMYYYY sort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[MMMYYYY sort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[MMMYYYY sort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[MonthNumberOfYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[MonthNumberOfYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[MonthNumberOfYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[MonthNumberOfYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[MonthNumberOfYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[QYYYY] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[QYYYY] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[QYYYY]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[QYYYY],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[QYYYY] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[QYYYY sort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[QYYYY sort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[QYYYY sort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[QYYYY sort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[QYYYY sort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Date 👍'[WeekNumberOfYear] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Date 👍'[WeekNumberOfYear] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Date 👍'[WeekNumberOfYear]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Date 👍'[WeekNumberOfYear],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Date 👍'[WeekNumberOfYear] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( datehelper[datename] ),",
              "            VAR ___f =",
              "                FILTERS ( datehelper[datename] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    datehelper[datename]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    datehelper[datename],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"datehelper[datename] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( datehelper[datenum] ),",
              "            VAR ___f =",
              "                FILTERS ( datehelper[datenum] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    datehelper[datenum]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    datehelper[datenum],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"datehelper[datenum] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'days average1'[days average1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'days average1'[days average1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'days average1'[days average1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'days average1'[days average1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'days average1'[days average1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'days average2'[days average2] ),",
              "            VAR ___f =",
              "                FILTERS ( 'days average2'[days average2] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'days average2'[days average2]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'days average2'[days average2],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'days average2'[days average2] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[DataType] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[DataType] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[DataType]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[DataType],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[DataType] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[Expression] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[Expression] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[Expression]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[Expression],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[Expression] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[FormatString] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[FormatString] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[FormatString]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[FormatString],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[FormatString] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[Name] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[Name] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[Name]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[Name],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[Name] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[ObjectType] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[ObjectType] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[ObjectType]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[ObjectType],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[ObjectType] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'DOCUMENTATION 👍😎'[Parent] ),",
              "            VAR ___f =",
              "                FILTERS ( 'DOCUMENTATION 👍😎'[Parent] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'DOCUMENTATION 👍😎'[Parent]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'DOCUMENTATION 👍😎'[Parent],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'DOCUMENTATION 👍😎'[Parent] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[BaseRate] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[BaseRate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[BaseRate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[BaseRate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[BaseRate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[BirthDate] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[BirthDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[BirthDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[BirthDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[BirthDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[CurrentFlag] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[CurrentFlag] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[CurrentFlag]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[CurrentFlag],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[CurrentFlag] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[DepartmentName] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[DepartmentName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[DepartmentName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[DepartmentName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[DepartmentName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[EmailAddress] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[EmailAddress] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[EmailAddress]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[EmailAddress],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[EmailAddress] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[EmployeeKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[EmployeeKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[EmployeeKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[EmployeeKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[EmployeeKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[EmployeeNationalIDAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[EmployeeNationalIDAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[EmployeeNationalIDAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[EmployeeNationalIDAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[EmployeeNationalIDAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[EndDate] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[EndDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[EndDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[EndDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[EndDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[FirstName] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[FirstName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[FirstName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[FirstName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[FirstName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[Gender] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[Gender] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[Gender]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[Gender],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[Gender] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[HireDate] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[HireDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[HireDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[HireDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[HireDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[LastName] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[LastName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[LastName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[LastName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[LastName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[LoginID] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[LoginID] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[LoginID]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[LoginID],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[LoginID] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[MaritalStatus] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[MaritalStatus] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[MaritalStatus]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[MaritalStatus],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[MaritalStatus] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[MiddleName] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[MiddleName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[MiddleName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[MiddleName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[MiddleName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[NameStyle] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[NameStyle] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[NameStyle]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[NameStyle],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[NameStyle] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[ParentEmployeeKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[ParentEmployeeKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[ParentEmployeeKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[ParentEmployeeKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[ParentEmployeeKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[ParentEmployeeNationalIDAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[ParentEmployeeNationalIDAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[ParentEmployeeNationalIDAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[ParentEmployeeNationalIDAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[ParentEmployeeNationalIDAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[PayFrequency] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[PayFrequency] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[PayFrequency]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[PayFrequency],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[PayFrequency] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[Phone] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[Phone] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[Phone]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[Phone],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[Phone] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[SalariedFlag] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[SalariedFlag] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[SalariedFlag]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[SalariedFlag],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[SalariedFlag] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[SalesPersonFlag] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[SalesPersonFlag] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[SalesPersonFlag]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[SalesPersonFlag],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[SalesPersonFlag] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[SalesTerritoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[SalesTerritoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[SalesTerritoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[SalesTerritoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[SalesTerritoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[SickLeaveHours] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[SickLeaveHours] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[SickLeaveHours]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[SickLeaveHours],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[SickLeaveHours] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[StartDate] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[StartDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[StartDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[StartDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[StartDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[Status] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[Status] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[Status]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[Status],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[Status] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[Title] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[Title] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[Title]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[Title],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[Title] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Employee[VacationHours] ),",
              "            VAR ___f =",
              "                FILTERS ( Employee[VacationHours] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Employee[VacationHours]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Employee[VacationHours],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Employee[VacationHours] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[City] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[City] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[City]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[City],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[City] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[CountryRegionCode] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[CountryRegionCode] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[CountryRegionCode]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[CountryRegionCode],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[CountryRegionCode] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[EnglishCountryRegionName] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[EnglishCountryRegionName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[EnglishCountryRegionName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[EnglishCountryRegionName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[EnglishCountryRegionName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[GeographyKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[GeographyKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[GeographyKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[GeographyKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[GeographyKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[IpAddressLocator] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[IpAddressLocator] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[IpAddressLocator]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[IpAddressLocator],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[IpAddressLocator] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[PostalCode] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[PostalCode] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[PostalCode]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[PostalCode],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[PostalCode] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[SalesTerritoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[SalesTerritoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[SalesTerritoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[SalesTerritoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[SalesTerritoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[StateProvinceCode] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[StateProvinceCode] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[StateProvinceCode]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[StateProvinceCode],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[StateProvinceCode] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Geography[StateProvinceName] ),",
              "            VAR ___f =",
              "                FILTERS ( Geography[StateProvinceName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Geography[StateProvinceName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Geography[StateProvinceName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Geography[StateProvinceName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[CarrierTrackingNumber] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[CarrierTrackingNumber] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[CarrierTrackingNumber]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[CarrierTrackingNumber],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[CarrierTrackingNumber] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[CurrencyKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[CurrencyKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[CurrencyKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[CurrencyKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[CurrencyKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[CustomerKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[CustomerKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[CustomerKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[CustomerKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[CustomerKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[CustomerPONumber] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[CustomerPONumber] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[CustomerPONumber]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[CustomerPONumber],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[CustomerPONumber] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[DiscountAmount] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[DiscountAmount] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[DiscountAmount]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[DiscountAmount],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[DiscountAmount] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[DueDate] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[DueDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[DueDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[DueDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[DueDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[DueDateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[DueDateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[DueDateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[DueDateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[DueDateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[ExtendedAmount] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[ExtendedAmount] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[ExtendedAmount]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[ExtendedAmount],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[ExtendedAmount] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[Freight] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[Freight] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[Freight]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[Freight],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[Freight] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[OrderDate] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[OrderDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[OrderDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[OrderDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[OrderDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[OrderDateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[OrderDateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[OrderDateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[OrderDateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[OrderDateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[OrderQuantity] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[OrderQuantity] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[OrderQuantity]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[OrderQuantity],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[OrderQuantity] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[ProductKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[ProductKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[ProductKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[ProductKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[ProductKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[ProductStandardCost] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[ProductStandardCost] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[ProductStandardCost]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[ProductStandardCost],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[ProductStandardCost] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[PromotionKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[PromotionKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[PromotionKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[PromotionKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[PromotionKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[RevisionNumber] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[RevisionNumber] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[RevisionNumber]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[RevisionNumber],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[RevisionNumber] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[SalesAmount] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[SalesAmount] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[SalesAmount]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[SalesAmount],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[SalesAmount] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[SalesOrderLineNumber] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[SalesOrderLineNumber] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[SalesOrderLineNumber]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[SalesOrderLineNumber],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[SalesOrderLineNumber] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[SalesOrderNumber] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[SalesOrderNumber] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[SalesOrderNumber]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[SalesOrderNumber],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[SalesOrderNumber] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[SalesTerritoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[SalesTerritoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[SalesTerritoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[SalesTerritoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[SalesTerritoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[ShipDate] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[ShipDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[ShipDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[ShipDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[ShipDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[ShipDateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[ShipDateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[ShipDateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[ShipDateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[ShipDateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[TaxAmt] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[TaxAmt] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[TaxAmt]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[TaxAmt],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[TaxAmt] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[TotalProductCost] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[TotalProductCost] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[TotalProductCost]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[TotalProductCost],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[TotalProductCost] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[UnitPrice] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[UnitPrice] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[UnitPrice]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[UnitPrice],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[UnitPrice] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'InternetSales 😀'[UnitPriceDiscountPct] ),",
              "            VAR ___f =",
              "                FILTERS ( 'InternetSales 😀'[UnitPriceDiscountPct] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'InternetSales 😀'[UnitPriceDiscountPct]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'InternetSales 😀'[UnitPriceDiscountPct],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'InternetSales 😀'[UnitPriceDiscountPct] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[CustomerKey] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[CustomerKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[CustomerKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[CustomerKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[CustomerKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[Freight] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[Freight] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[Freight]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[Freight],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[Freight] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[OrderDate] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[OrderDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[OrderDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[OrderDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[OrderDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[OrderDate_Original] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[OrderDate_Original] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[OrderDate_Original]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[OrderDate_Original],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[OrderDate_Original] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[OrderDateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[OrderDateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[OrderDateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[OrderDateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[OrderDateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[OrderDateKey_Original] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[OrderDateKey_Original] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[OrderDateKey_Original]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[OrderDateKey_Original],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[OrderDateKey_Original] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[OrderQuantity] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[OrderQuantity] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[OrderQuantity]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[OrderQuantity],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[OrderQuantity] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[ProductKey] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[ProductKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[ProductKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[ProductKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[ProductKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[SalesAmount] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[SalesAmount] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[SalesAmount]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[SalesAmount],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[SalesAmount] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[TaxAmt] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[TaxAmt] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[TaxAmt]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[TaxAmt],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[TaxAmt] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[TotalProductCost] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[TotalProductCost] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[TotalProductCost]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[TotalProductCost],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[TotalProductCost] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( InternetSales_Current[UnitPrice] ),",
              "            VAR ___f =",
              "                FILTERS ( InternetSales_Current[UnitPrice] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    InternetSales_Current[UnitPrice]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    InternetSales_Current[UnitPrice],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"InternetSales_Current[UnitPrice] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( measurehelper[measurename] ),",
              "            VAR ___f =",
              "                FILTERS ( measurehelper[measurename] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    measurehelper[measurename]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    measurehelper[measurename],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"measurehelper[measurename] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Class] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Class] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Class]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Class],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Class] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Color] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Color] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Color]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Color],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Color] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[DaysToManufacture] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[DaysToManufacture] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[DaysToManufacture]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[DaysToManufacture],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[DaysToManufacture] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[DealerPrice] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[DealerPrice] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[DealerPrice]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[DealerPrice],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[DealerPrice] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[EndDate] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[EndDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[EndDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[EndDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[EndDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[EnglishDescription] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[EnglishDescription] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[EnglishDescription]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[EnglishDescription],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[EnglishDescription] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[FinishedGoodsFlag] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[FinishedGoodsFlag] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[FinishedGoodsFlag]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[FinishedGoodsFlag],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[FinishedGoodsFlag] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Grand Total at Top] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Grand Total at Top] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Grand Total at Top]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Grand Total at Top],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Grand Total at Top] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[HCat] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[HCat] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[HCat]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[HCat],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[HCat] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[HProductName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[HProductName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[HProductName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[HProductName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[HProductName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[HSubCat] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[HSubCat] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[HSubCat]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[HSubCat],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[HSubCat] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ListPrice] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ListPrice] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ListPrice]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ListPrice],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ListPrice] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ModelName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ModelName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ModelName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ModelName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ModelName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ProductAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ProductAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ProductAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ProductAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ProductAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ProductKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ProductKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ProductKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ProductKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ProductKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ProductLine] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ProductLine] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ProductLine]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ProductLine],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ProductLine] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ProductName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ProductName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ProductName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ProductName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ProductName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ProductSubcategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ProductSubcategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ProductSubcategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ProductSubcategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ProductSubcategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[ReorderPoint] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[ReorderPoint] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[ReorderPoint]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[ReorderPoint],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[ReorderPoint] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[SafetyStockLevel] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[SafetyStockLevel] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[SafetyStockLevel]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[SafetyStockLevel],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[SafetyStockLevel] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Size] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Size] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Size]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Size],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Size] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[SizeRange] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[SizeRange] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[SizeRange]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[SizeRange],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[SizeRange] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[SizeUnitMeasureCode] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[SizeUnitMeasureCode] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[SizeUnitMeasureCode]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[SizeUnitMeasureCode],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[SizeUnitMeasureCode] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[StandardCost] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[StandardCost] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[StandardCost]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[StandardCost],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[StandardCost] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[StartDate] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[StartDate] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[StartDate]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[StartDate],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[StartDate] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Status] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Status] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Status]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Status],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Status] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Style] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Style] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Style]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Style],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Style] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[Weight] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[Weight] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[Weight]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[Weight],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[Weight] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Product'[WeightUnitMeasureCode] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Product'[WeightUnitMeasureCode] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Product'[WeightUnitMeasureCode]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Product'[WeightUnitMeasureCode],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Product'[WeightUnitMeasureCode] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales Ratio] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales Ratio] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales Ratio]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales Ratio],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales Ratio] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales Ratio2] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales Ratio2] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales Ratio2]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales Ratio2],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales Ratio2] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales2] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales2] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales2]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales2],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales2] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales2.1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales2.1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales2.1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales2.1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales2.1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales3] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales3] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales3]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales3],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales3] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales3.1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales3.1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales3.1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales3.1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales3.1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales3.2] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales3.2] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales3.2]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales3.2],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales3.2] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales3.3] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales3.3] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales3.3]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales3.3],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales3.3] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales4] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales4] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales4]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales4],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales4] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales4.1] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales4.1] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales4.1]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales4.1],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales4.1] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Category Sales5] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Category Sales5] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Category Sales5]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Category Sales5],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Category Sales5] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[HProductCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[HProductCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[HProductCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[HProductCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[HProductCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[ProductCategoryAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[ProductCategoryAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[ProductCategoryAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[ProductCategoryAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[ProductCategoryAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[ProductCategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[ProductCategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[ProductCategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[ProductCategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[ProductCategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[ProductCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[ProductCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[ProductCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[ProductCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[ProductCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Sales Rank] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Sales Rank] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Sales Rank]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Sales Rank],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Sales Rank] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Sales Rank helper] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Sales Rank helper] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Sales Rank helper]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Sales Rank helper],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Sales Rank helper] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Silver Sales] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Silver Sales] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Silver Sales]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Silver Sales],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Silver Sales] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Silver Sales (old school)] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Silver Sales (old school)] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Silver Sales (old school)]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Silver Sales (old school)],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Silver Sales (old school)] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[Silver Sales 2007] ),",
              "            VAR ___f =",
              "                FILTERS ( 'ProductCategory 😀'[Silver Sales 2007] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'ProductCategory 😀'[Silver Sales 2007]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'ProductCategory 😀'[Silver Sales 2007],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'ProductCategory 😀'[Silver Sales 2007] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Left[Category Sales] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Left[Category Sales] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Left[Category Sales]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Left[Category Sales],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Left[Category Sales] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Left[Category Sales BUDGET] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Left[Category Sales BUDGET] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Left[Category Sales BUDGET]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Left[Category Sales BUDGET],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Left[Category Sales BUDGET] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Left[ProductCategoryAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Left[ProductCategoryAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Left[ProductCategoryAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Left[ProductCategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Left[ProductCategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Left[ProductCategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Left[ProductCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Left[ProductCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Left[ProductCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Left[ProductCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Right[Category Sales] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Right[Category Sales] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Right[Category Sales]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Right[Category Sales],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Right[Category Sales] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Right[Category Sales BUDGET] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Right[Category Sales BUDGET] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Right[Category Sales BUDGET]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Right[Category Sales BUDGET],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Right[Category Sales BUDGET] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Right[ProductCategoryAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Right[ProductCategoryAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Right[ProductCategoryAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Right[ProductCategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Right[ProductCategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Right[ProductCategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory_BUDGET_Right[ProductCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory_BUDGET_Right[ProductCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory_BUDGET_Right[ProductCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory_BUDGET_Right[ProductCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory2[Category Sales] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory2[Category Sales] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory2[Category Sales]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory2[Category Sales],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory2[Category Sales] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory2[Category Sales BUDGET] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory2[Category Sales BUDGET] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory2[Category Sales BUDGET]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory2[Category Sales BUDGET],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory2[Category Sales BUDGET] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory2[ProductCategoryAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory2[ProductCategoryAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory2[ProductCategoryAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory2[ProductCategoryAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory2[ProductCategoryAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory2[ProductCategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory2[ProductCategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory2[ProductCategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory2[ProductCategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory2[ProductCategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductCategory2[ProductCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductCategory2[ProductCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductCategory2[ProductCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductCategory2[ProductCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductCategory2[ProductCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductSubcategory[HProductSubCategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductSubcategory[HProductSubCategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductSubcategory[HProductSubCategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductSubcategory[HProductSubCategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductSubcategory[HProductSubCategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductSubcategory[ProductCategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductSubcategory[ProductCategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductSubcategory[ProductCategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductSubcategory[ProductCategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductSubcategory[ProductCategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductSubcategory[ProductSubcategoryAlternateKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductSubcategory[ProductSubcategoryAlternateKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductSubcategory[ProductSubcategoryAlternateKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductSubcategory[ProductSubcategoryAlternateKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductSubcategory[ProductSubcategoryAlternateKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductSubcategory[ProductSubcategoryKey] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductSubcategory[ProductSubcategoryKey] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductSubcategory[ProductSubcategoryKey]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductSubcategory[ProductSubcategoryKey],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductSubcategory[ProductSubcategoryKey] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( ProductSubcategory[ProductSubcategoryName] ),",
              "            VAR ___f =",
              "                FILTERS ( ProductSubcategory[ProductSubcategoryName] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    ProductSubcategory[ProductSubcategoryName]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    ProductSubcategory[ProductSubcategoryName],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"ProductSubcategory[ProductSubcategoryName] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( rankhelper[rankname] ),",
              "            VAR ___f =",
              "                FILTERS ( rankhelper[rankname] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    rankhelper[rankname]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    rankhelper[rankname],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"rankhelper[rankname] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( rankhelper[ranknum] ),",
              "            VAR ___f =",
              "                FILTERS ( rankhelper[ranknum] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    rankhelper[ranknum]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    rankhelper[ranknum],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"rankhelper[ranknum] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Sales Amount slider'[Sales Amount slider] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Sales Amount slider'[Sales Amount slider] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Sales Amount slider'[Sales Amount slider]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Sales Amount slider'[Sales Amount slider],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Sales Amount slider'[Sales Amount slider] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'CG DatePicker'[DateToUse] ),",
              "            VAR ___f =",
              "                FILTERS ( 'CG DatePicker'[DateToUse] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'CG DatePicker'[DateToUse]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'CG DatePicker'[DateToUse],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TE Date Selector'[DateToUse] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'CG DatePicker'[Ordinal] ),",
              "            VAR ___f =",
              "                FILTERS ( 'CG DatePicker'[Ordinal] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'CG DatePicker'[Ordinal]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'CG DatePicker'[Ordinal],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TE Date Selector'[Ordinal] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'TE Many Measures at once'[Name] ),",
              "            VAR ___f =",
              "                FILTERS ( 'TE Many Measures at once'[Name] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'TE Many Measures at once'[Name]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'TE Many Measures at once'[Name],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TE Many Measures at once'[Name] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'TE Many Measures at once'[Ordinal] ),",
              "            VAR ___f =",
              "                FILTERS ( 'TE Many Measures at once'[Ordinal] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'TE Many Measures at once'[Ordinal]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'TE Many Measures at once'[Ordinal],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TE Many Measures at once'[Ordinal] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'TE Measure Selector'[TE Measure] ),",
              "            VAR ___f =",
              "                FILTERS ( 'TE Measure Selector'[TE Measure] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'TE Measure Selector'[TE Measure]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'TE Measure Selector'[TE Measure],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TE Measure Selector'[TE Measure] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Top or Other'[Sort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Top or Other'[Sort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Top or Other'[Sort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Top or Other'[Sort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Top or Other'[Sort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Top or Other'[Top/Other] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Top or Other'[Top/Other] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Top or Other'[Top/Other]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Top or Other'[Top/Other],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Top or Other'[Top/Other] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( Top3orLess[Top3orLess] ),",
              "            VAR ___f =",
              "                FILTERS ( Top3orLess[Top3orLess] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    Top3orLess[Top3orLess]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    Top3orLess[Top3orLess],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"Top3orLess[Top3orLess] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'TopN'[TopN] ),",
              "            VAR ___f =",
              "                FILTERS ( 'TopN'[TopN] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'TopN'[TopN]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'TopN'[TopN],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'TopN'[TopN] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'X axis'[Sort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'X axis'[Sort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'X axis'[Sort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'X axis'[Sort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'X axis'[Sort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'X axis'[xMeasure] ),",
              "            VAR ___f =",
              "                FILTERS ( 'X axis'[xMeasure] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'X axis'[xMeasure]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'X axis'[xMeasure],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'X axis'[xMeasure] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Y axis'[Sort] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Y axis'[Sort] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Y axis'[Sort]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Y axis'[Sort],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Y axis'[Sort] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )",
              "        & IF (",
              "            ISFILTERED ( 'Y axis'[yMeasure] ),",
              "            VAR ___f =",
              "                FILTERS ( 'Y axis'[yMeasure] )",
              "            VAR ___r =",
              "                COUNTROWS ( ___f )",
              "            VAR ___t =",
              "                TOPN (",
              "                    MaxFilters,",
              "                    ___f,",
              "                    'Y axis'[yMeasure]",
              "                )",
              "            VAR ___d =",
              "                CONCATENATEX (",
              "                    ___t,",
              "                    'Y axis'[yMeasure],",
              "                    \", \"",
              "                )",
              "            VAR ___x =",
              "                \"'Y axis'[yMeasure] = \" & ___d",
              "                    & IF (",
              "                        ___r > MaxFilters,",
              "                        \", ... [\" & ___r & \" items selected]\"",
              "                    ) & \" \"",
              "            RETURN",
              "                ___x",
              "                    & UNICHAR ( 13 )",
              "                    & UNICHAR ( 10 )",
              "        )"
            ],
            "lineageTag": "061652f4-8968-4ccb-8a9f-f0c8ca02cd5f"
          },
          {
            "name": "_ECRN hov",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    HASONEVALUE ( Geography[EnglishCountryRegionName] ),",
              "    \"ECRN hov\"",
              ")"
            ],
            "expression": [
              "IF (",
              "    HASONEVALUE ( Geography[EnglishCountryRegionName] ),",
              "    \"ECRN hov\"",
              ")"
            ],
            "lineageTag": "2b6d8c4e-ec3d-4473-9024-12b13c9007ed"
          },
          {
            "name": "_ECRN iis",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISINSCOPE ( Geography[EnglishCountryRegionName] ),",
              "    \"ECRN iis\"",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISINSCOPE ( Geography[EnglishCountryRegionName] ),",
              "    \"ECRN iis\"",
              ")"
            ],
            "lineageTag": "52e022ae-71f1-4cff-9bdb-3dd3990f8a95"
          },
          {
            "name": "_Gender hov",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    HASONEVALUE ( Customer[Gender] ),",
              "    \"Gender hov\"",
              ")"
            ],
            "expression": [
              "IF (",
              "    HASONEVALUE ( Customer[Gender] ),",
              "    \"Gender hov\"",
              ")"
            ],
            "lineageTag": "0088e517-172c-469c-a0e3-1d5b273b4427"
          },
          {
            "name": "_Gender iis",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISINSCOPE ( Customer[Gender] ),",
              "    \"Gender iis\"",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISINSCOPE ( Customer[Gender] ),",
              "    \"Gender iis\"",
              ")"
            ],
            "lineageTag": "20a15eb4-5918-45cd-8815-86483fc43a81"
          },
          {
            "name": "_IIS test",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//has to be reverse order of the hierarchy else CalendarYearis always in scope (you can see it)",
              "SWITCH(TRUE(),",
              "ISINSCOPE(Customer[Gender]),\"Gender scope\",",
              "ISINSCOPE(Customer[FullName]),\"fullname scope\",",
              "ISINSCOPE(Geography[EnglishCountryRegionName]),\"ECRN scope\",",
              "ISINSCOPE('Date 👍'[CalendarYear]),\"Year scope\",",
              "\"? scope\" // or just BLANK()",
              ")"
            ],
            "expression": [
              "//has to be reverse order of the hierarchy else CalendarYearis always in scope (you can see it)",
              "SWITCH(TRUE(),",
              "ISINSCOPE(Customer[Gender]),\"Gender scope\",",
              "ISINSCOPE(Customer[FullName]),\"fullname scope\",",
              "ISINSCOPE(Geography[EnglishCountryRegionName]),\"ECRN scope\",",
              "ISINSCOPE('Date 👍'[CalendarYear]),\"Year scope\",",
              "\"? scope\" // or just BLANK()",
              ")"
            ],
            "lineageTag": "42dc5d1a-1b75-458b-a435-cd4c6c938003"
          },
          {
            "name": "_count rows",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "COUNTROWS('InternetSales 😀')",
            "lineageTag": "7dcce13a-e569-4e24-9d75-2b125b5befd1"
          },
          {
            "name": "_Gender isfiltered",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "IF(ISFILTERED(Customer[Gender]),\"Gender isfiltered\") //remove gender from chart but then use slicer to pick gender"
            ],
            "lineageTag": "05395839-14e5-420e-95ae-da44a96d5ad2"
          }
        ],
        "partitions": [
          {
            "name": "InternetSales 😀-25512f31-503e-474c-a8e0-a0e174ad93a6",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\"192.168.1.116\\sql2017\", \"adventureworksdw\"),",
                "    dbo_FactInternetSales = Source{[Schema=\"dbo\",Item=\"FactInternetSales\"]}[Data]",
                "in",
                "    dbo_FactInternetSales"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "All Measures 😀",
        "annotations": [
          {
            "name": "436ba87b-9c83-4389-a31b-ebd06a36be98",
            "value": "{\"Expression\":\"\"}"
          }
        ],
        "columns": [
          {
            "name": "Column",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1665d0bf-f4dc-446c-933f-f5bbebfaa504",
            "sourceColumn": "[Column]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "77ad3cb7-da1c-4aa2-87fb-91ac7429ada9",
        "measures": [
          {
            "name": "Total Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              }
            ],
            "description": [
              "SUM ( 'InternetSales 😀'[SalesAmount] )",
              "//this is a measure so will naturally provide filter context ie you can slice it"
            ],
            "expression": [
              "SUM ( 'InternetSales 😀'[SalesAmount] )",
              "//this is a measure so will naturally provide filter context ie you can slice it"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "lineageTag": "e05fa218-b3ed-4764-9484-f0fb2485bb15"
          },
          {
            "name": "Total Costs",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "description": "SUM ( 'InternetSales 😀'[TotalProductCost] )",
            "expression": "SUM ( 'InternetSales 😀'[TotalProductCost] )",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "bc655bec-2005-4341-a804-54df749a97ab"
          },
          {
            "name": "Total Profit",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "description": "[Total Sales] - [Total Costs]",
            "expression": "[Total Sales] - [Total Costs]",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "befe03cd-06c7-4fde-947b-c7695863d683"
          },
          {
            "name": "Higher Sales than LW (astro)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "description": [
              "//only highlight Sales above Sales LW",
              "IF (",
              "    [Total Sales] > [Total Sales LW],",
              "    [Total Sales],",
              "    BLANK ()",
              ")"
            ],
            "expression": [
              "//only highlight Sales above Sales LW",
              "IF (",
              "    [Total Sales] > [Total Sales LW],",
              "    [Total Sales],",
              "    BLANK ()",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "29328827-3762-4b7d-9ef0-9103330cd964"
          },
          {
            "name": "Selected Products",
            "description": [
              "VAR ConCat =",
              "    //CALCULATE ( //not actually required",
              "    CONCATENATEX (",
              "        VALUES ( 'Product'[ProductName] ),",
              "        //from a distinct starting list",
              "        'Product'[ProductName],",
              "        //add the one you pick",
              "        \",\"",
              "            & UNICHAR ( 10 ) //10 = carriage return - to get vertical list",
              "    ) //)",
              "VAR IsItFiltered =",
              "    //are you slicing by ProductName?",
              "    IF (",
              "        ISFILTERED ( 'Product'[ProductName] ),",
              "        ConCat,",
              "        \"No Products Selected\"",
              "    ) // just in case",
              "RETURN",
              "    IsItFiltered"
            ],
            "expression": [
              "VAR ConCat =",
              "    //CALCULATE ( //not actually required",
              "    CONCATENATEX (",
              "        VALUES ( 'Product'[ProductName] ),",
              "        //from a distinct starting list",
              "        'Product'[ProductName],",
              "        //add the one you pick",
              "        \",\"",
              "            & UNICHAR ( 10 ) //10 = carriage return - to get vertical list",
              "    ) //)",
              "VAR IsItFiltered =",
              "    //are you slicing by ProductName?",
              "    IF (",
              "        ISFILTERED ( 'Product'[ProductName] ),",
              "        ConCat,",
              "        \"No Products Selected\"",
              "    ) // just in case",
              "RETURN",
              "    IsItFiltered"
            ],
            "lineageTag": "4c10914e-d5ef-46e6-999c-dae892160f2f"
          },
          {
            "name": "Selected Countries",
            "description": [
              "VAR ConCat =",
              "    CALCULATE (",
              "        CONCATENATEX (",
              "            VALUES ( Geography[EnglishCountryRegionName] ),",
              "            //from starting list",
              "            Geography[EnglishCountryRegionName],",
              "            //the one you pick",
              "            \",\"",
              "                & UNICHAR ( 10 ) //10 = carriage return - to get vertical list",
              "        )",
              "    )",
              "VAR IsItFiltered =",
              "    IF (",
              "        ISFILTERED ( Geography[EnglishCountryRegionName] ),",
              "        ConCat,",
              "        \"No Country Selected\"",
              "    ) // just in case",
              "RETURN",
              "    IsItFiltered"
            ],
            "expression": [
              "VAR ConCat =",
              "    CALCULATE (",
              "        CONCATENATEX (",
              "            VALUES ( Geography[EnglishCountryRegionName] ),",
              "            //from starting list",
              "            Geography[EnglishCountryRegionName],",
              "            //the one you pick",
              "            \",\"",
              "                & UNICHAR ( 10 ) //10 = carriage return - to get vertical list",
              "        )",
              "    )",
              "VAR IsItFiltered =",
              "    IF (",
              "        ISFILTERED ( Geography[EnglishCountryRegionName] ),",
              "        ConCat,",
              "        \"No Country Selected\"",
              "    ) // just in case",
              "RETURN",
              "    IsItFiltered"
            ],
            "lineageTag": "f0852b20-42d6-487c-a583-3c2ab9fc72cb"
          },
          {
            "name": "Selected Years",
            "description": [
              "VAR ConCat =",
              "    CALCULATE (",
              "        CONCATENATEX (",
              "            VALUES ( 'Date 👍'[CalendarYear] ),",
              "            // from starting list",
              "            'Date 👍'[CalendarYear],",
              "            //the one you pick",
              "            \",\"",
              "                & UNICHAR ( 10 ) //10 = carriage return - to get vertical list",
              "        )",
              "    )",
              "VAR IsItFiltered =",
              "    IF (",
              "        ISFILTERED ( 'Date 👍'[CalendarYear] ),",
              "        ConCat,",
              "        \"No Year Selected\"",
              "    ) // just in case",
              "RETURN",
              "    IsItFiltered"
            ],
            "expression": [
              "VAR ConCat =",
              "    CALCULATE (",
              "        CONCATENATEX (",
              "            VALUES ( 'Date 👍'[CalendarYear] ),",
              "            // from starting list",
              "            'Date 👍'[CalendarYear],",
              "            //the one you pick",
              "            \",\"",
              "                & UNICHAR ( 10 ) //10 = carriage return - to get vertical list",
              "        )",
              "    )",
              "VAR IsItFiltered =",
              "    IF (",
              "        ISFILTERED ( 'Date 👍'[CalendarYear] ),",
              "        ConCat,",
              "        \"No Year Selected\"",
              "    ) // just in case",
              "RETURN",
              "    IsItFiltered"
            ],
            "lineageTag": "a5221710-4c3e-498c-b469-b0b70f0f44cd"
          },
          {
            "name": "Selected",
            "description": [
              "\"You selected:\"",
              "    & UNICHAR ( 10 ) & [Selected Products] & \",\"",
              "    & UNICHAR ( 10 ) & [Selected Countries] & \",\"",
              "    & UNICHAR ( 10 ) & [Selected Years]"
            ],
            "expression": [
              "\"You selected:\"",
              "    & UNICHAR ( 10 ) & [Selected Products] & \",\"",
              "    & UNICHAR ( 10 ) & [Selected Countries] & \",\"",
              "    & UNICHAR ( 10 ) & [Selected Years]"
            ],
            "lineageTag": "de3707b2-fd49-4a67-b505-68a8b3cb2e31"
          },
          {
            "name": "Count Sales",
            "description": "COUNT ( 'InternetSales 😀'[SalesOrderLineNumber] )",
            "expression": "COUNT ( 'InternetSales 😀'[SalesOrderLineNumber] )",
            "formatString": "0",
            "lineageTag": "9d0f3086-ad4d-406f-aaac-b9d50a3674fc"
          },
          {
            "name": "Icon Measure",
            "description": [
              "//conditional formatting (by Icons)",
              "SWITCH (",
              "    TRUE (),",
              "    [Total Sales] > 500000,",
              "        \"https://adevtestazuresqlda1367.blob.core.windows.net/publicother/41C.gif\",",
              "    //\"sprint\" from CustomIconsTheme",
              "    [Total Sales] > 200000,",
              "        \"https://adevtestazuresqlda1367.blob.core.windows.net/publicother/93c5.gif\",",
              "    \"https://adevtestazuresqlda1367.blob.core.windows.net/publicother/ODkF.gif\"",
              ")"
            ],
            "expression": [
              "//conditional formatting (by Icons)",
              "SWITCH (",
              "    TRUE (),",
              "    [Total Sales] > 500000,",
              "        \"https://adevtestazuresqlda1367.blob.core.windows.net/publicother/41C.gif\",",
              "    //\"sprint\" from CustomIconsTheme",
              "    [Total Sales] > 200000,",
              "        \"https://adevtestazuresqlda1367.blob.core.windows.net/publicother/93c5.gif\",",
              "    \"https://adevtestazuresqlda1367.blob.core.windows.net/publicother/ODkF.gif\"",
              ")"
            ],
            "lineageTag": "8d5e74ee-b894-474a-ba79-a901bcc786a0"
          },
          {
            "name": "Selected Customers",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": [
              "VAR ConCat =",
              "    //CALCULATE ( //not actually required",
              "    CONCATENATEX (",
              "        VALUES ( Customer[FullName] ),",
              "        //from a distinct starting list",
              "        Customer[FullName],",
              "        //add the one you pick",
              "        \",\"",
              "            & UNICHAR ( 10 ) //10 = carriage return - to get vertical list",
              "    ) //)",
              "VAR IsItFiltered =",
              "    //are you slicing by ProductName?",
              "    IF (",
              "        ISFILTERED ( Customer[FullName] ),",
              "        ConCat,",
              "        \"No Customers Selected\"",
              "    ) // just in case",
              "RETURN",
              "    IsItFiltered"
            ],
            "expression": [
              "",
              "VAR ConCat =",
              "    //CALCULATE ( //not actually required",
              "    CONCATENATEX (",
              "        VALUES ( Customer[FullName] ),",
              "        //from a distinct starting list",
              "        Customer[FullName],",
              "        //add the one you pick",
              "        \",\"",
              "            & UNICHAR ( 10 ) //10 = carriage return - to get vertical list",
              "    ) //)",
              "VAR IsItFiltered =",
              "    //are you slicing by ProductName?",
              "    IF (",
              "        ISFILTERED ( Customer[FullName] ),",
              "        ConCat,",
              "        \"No Customers Selected\"",
              "    ) // just in case",
              "RETURN",
              "    IsItFiltered"
            ],
            "lineageTag": "61225f27-d56c-4c07-9231-8cfe645ead83"
          },
          {
            "name": "Total Sales0",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "description": [
              "SUM ( 'InternetSales 😀'[SalesAmount] ) + 0",
              "//converts blank to zero",
              "//also          COALESCE(InternetSales[SalesAmount],0)"
            ],
            "expression": [
              "SUM ( 'InternetSales 😀'[SalesAmount] ) + 0",
              "//converts blank to zero",
              "//also          COALESCE(InternetSales[SalesAmount],0)"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "6e9c8c49-5838-4e9b-8879-e3b34f0fcb38"
          },
          {
            "name": "Earliest Day Total Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "description": [
              "VAR _mindate =",
              "    MIN ( 'Date 👍'[Date] ) //first (and single date) from the slider",
              "RETURN",
              "    CALCULATE (",
              "        [Total Sales],",
              "        TREATAS (",
              "            {",
              "                _mindate",
              "            },",
              "            'Date 👍'[Date]",
              "        )",
              "    )"
            ],
            "expression": [
              "VAR _mindate =",
              "    MIN ( 'Date 👍'[Date] ) //first (and single date) from the slider",
              "RETURN",
              "    CALCULATE (",
              "        [Total Sales],",
              "        TREATAS (",
              "            {",
              "                _mindate",
              "            },",
              "            'Date 👍'[Date]",
              "        )",
              "    )"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "89dfe15e-e2b0-43e1-b414-f8eef0484fed"
          },
          {
            "name": "DateFilterHELPER",
            "description": [
              "COMBINEVALUES (",
              "    \" -\",",
              "    MIN ( 'Date 👍'[Date] ),",
              "    MAX ( 'Date 👍'[Date] ),",
              "    COUNTROWS ( 'Date 👍' )",
              ")"
            ],
            "expression": [
              "COMBINEVALUES (",
              "    \" -\",",
              "    MIN ( 'Date 👍'[Date] ),",
              "    MAX ( 'Date 👍'[Date] ),",
              "    COUNTROWS ( 'Date 👍' )",
              ")"
            ],
            "lineageTag": "de77ae1f-95d0-4552-a87a-3a5220d02215"
          },
          {
            "name": "Total Profit EandL",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": [
              "EVALUATEANDLOG ( [Total Sales] )",
              "    - EVALUATEANDLOG ( [Total Costs] )"
            ],
            "expression": [
              "EVALUATEANDLOG ( [Total Sales] )",
              "    - EVALUATEANDLOG ( [Total Costs] )"
            ],
            "lineageTag": "a5e6f3de-31b4-4750-94d7-ca358e2dc201"
          },
          {
            "name": "Total Quantity",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": "SUM ( 'InternetSales 😀'[OrderQuantity] )",
            "expression": "SUM ( 'InternetSales 😀'[OrderQuantity] )",
            "lineageTag": "b510c756-717f-4e4e-b6c5-7b3b6b270744"
          },
          {
            "name": "Total Sales by Month (Window abs)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": [
              "",
              "calculate(",
              "[Total Sales],",
              "window(",
              "1,abs, //start",
              "-1,abs, //end",
              "SUMMARIZE(allselected('Date 👍'),'Date 👍'[MMMYYYY],'Date 👍'[Date]),",
              ",",
              "partitionby('Date 👍'[MMMYYYY])",
              ")",
              ")"
            ],
            "expression": [
              "",
              "calculate(",
              "[Total Sales],",
              "window(",
              "1,abs, //start",
              "-1,abs, //end",
              "SUMMARIZE(allselected('Date 👍'),'Date 👍'[MMMYYYY],'Date 👍'[Date]),",
              ",",
              "partitionby('Date 👍'[MMMYYYY]) //ensures [total sales] are calculated for each month separately",
              ")",
              ")"
            ],
            "lineageTag": "39e761f2-ed99-4ab6-a0ec-4d7462d291ef"
          },
          {
            "name": "Total Sales 7 days (Window rel)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    WINDOW (",
              "        -6,",
              "        REL,",
              "        //start",
              "        0,",
              "        REL,",
              "        //end = current row",
              "        //ie current row and back 6",
              "        SUMMARIZE (",
              "            ALLSELECTED ( 'Date 👍' ),",
              "            //'Date 👍'[MMMYYYY],",
              "            'Date 👍'[Date]",
              "        ) //,",
              "        //,",
              "        //partitionby('Date 👍'[MMMYYYY])",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    WINDOW (",
              "        -6,",
              "        REL,",
              "        //start",
              "        0,",
              "        REL,",
              "        //end = current row",
              "        //ie current row and back 6",
              "        SUMMARIZE (",
              "            ALLSELECTED ( 'Date 👍' ),",
              "            //'Date 👍'[MMMYYYY],",
              "            'Date 👍'[Date]",
              "        ) //,",
              "        //,",
              "        //partitionby('Date 👍'[MMMYYYY])",
              "    )",
              ")"
            ],
            "lineageTag": "772f3817-81a1-46bd-9f10-bbd0ec88fabf"
          },
          {
            "name": "Total Sales RT (Window abs/rel)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    WINDOW (",
              "        1,",
              "        ABS,",
              "        //row 1",
              "        0,",
              "        REL,",
              "        //end = current row",
              "        SUMMARIZE (",
              "            ALLSELECTED ( 'Date 👍' ),",
              "            //'Date 👍'[MMMYYYY],",
              "            'Date 👍'[Date]",
              "        ) //,",
              "        //,",
              "        //partitionby('Date 👍'[MMMYYYY])",
              "    )",
              ")"
            ],
            "expression": [
              "",
              "//IF([Total Sales],  //removes rows with no sales. See blank() at bottom of code",
              "",
              "// see bottom of table (for repeating £29M) and 11 sept 2005 (no sales)",
              "    CALCULATE (",
              "    [Total Sales],",
              "    WINDOW (",
              "        1,",
              "        ABS,",
              "        //row 1",
              "        0,",
              "        REL,",
              "        //end = current row",
              "        SUMMARIZE (",
              "            ALLSELECTED ( 'Date 👍' ),",
              "            //'Date 👍'[MMMYYYY],",
              "            'Date 👍'[Date]",
              "        ) //,",
              "        //,",
              "        //partitionby('Date 👍'[MMMYYYY])",
              "    )",
              "    )",
              "//,BLANK()",
              "//)"
            ],
            "lineageTag": "739ca008-bea2-4b4b-a279-b2a160fa43de"
          },
          {
            "name": "Total Sales RT (by category)(Window abs/rel)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    //as Components has no sales",
              "    CALCULATE (",
              "        [Total Sales],",
              "        WINDOW (",
              "            1,",
              "            ABS,",
              "            //row 1",
              "            0,",
              "            REL,",
              "            //end = current row",
              "            SUMMARIZE (",
              "                ALLSELECTED ( 'ProductCategory 😀' ),",
              "                'ProductCategory 😀'[ProductCategoryName]",
              "            )",
              "        )",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    //as Components has no sales",
              "    CALCULATE (",
              "        [Total Sales],",
              "        WINDOW (",
              "            1,",
              "            ABS,",
              "            //row 1 is now fixed",
              "            0,",
              "            REL,",
              "            //end = current row",
              "            SUMMARIZE (",
              "                ALLSELECTED ( 'ProductCategory 😀' ),",
              "                'ProductCategory 😀'[ProductCategoryName]",
              "            )",
              "        )",
              "    )",
              ")"
            ],
            "lineageTag": "7746ec85-e6db-4863-af07-b6420890dbca"
          },
          {
            "name": "Total Sales RT (by category)(classic)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    //as Components has no sales",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALLSELECTED ( 'ProductCategory 😀' ),",
              "            // as opposed to just ALL. Try it!",
              "            'ProductCategory 😀'[ProductCategoryName]",
              "                <= MAX ( 'ProductCategory 😀'[ProductCategoryName] )",
              "        )",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    //as Components has no sales",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALLSELECTED ( 'ProductCategory 😀' ),",
              "            // as opposed to just ALL. Try it!",
              "            'ProductCategory 😀'[ProductCategoryName]",
              "                <= MAX ( 'ProductCategory 😀'[ProductCategoryName] )",
              "        )",
              "    )",
              ")"
            ],
            "lineageTag": "8aa12afe-23ab-4a15-8245-0236b5f6c736"
          },
          {
            "name": "Country to Compare",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": [
              "",
              "var _selectedCountry=SELECTEDVALUE('DISCONNECTED Countries'[CountryIndex]) //returns the index number of the country (alphabetically) from the DISCONNECTED table",
              "return",
              "IF(",
              "    HASONEVALUE(Geography[EnglishCountryRegionName]), // gets rid of a meaningless Total",
              "    INDEX(_selectedCountry,ALLSELECTED(Geography[EnglishCountryRegionName])) //returns a model related country name that will slice measures",
              ")"
            ],
            "expression": [
              "",
              "var _selectedCountry=SELECTEDVALUE('DISCONNECTED Countries'[CountryIndex]) //returns the index number of the country (alphabetically) from the DISCONNECTED table",
              "return",
              "IF(",
              "    HASONEVALUE(Geography[EnglishCountryRegionName]), // gets rid of a meaningless Total",
              "    INDEX(_selectedCountry,ALLSELECTED(Geography[EnglishCountryRegionName])) //returns a model related country name that will slice measures",
              ")"
            ],
            "lineageTag": "005abaaa-b472-4cb3-9924-f8e5134c554b"
          },
          {
            "name": "Total Profit to compare",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": [
              "",
              "var _position=IF(",
              "                ISFILTERED('DISCONNECTED Countries'[EnglishCountryRegionName]) //are you slicing by this?",
              "                ,SELECTEDVALUE('DISCONNECTED Countries'[CountryIndex])",
              "                ,1//default=1 (Australia)",
              "                ) ",
              "return",
              "IF(",
              "    HASONEVALUE(Geography[EnglishCountryRegionName]), // gets rid of a meaningless Total",
              "    CALCULATE(",
              "        [Total Profit],",
              "     INDEX(_position,ALLSELECTED(Geography[EnglishCountryRegionName])) //which country are you comparing against?",
              "        )",
              ")"
            ],
            "expression": [
              "",
              "var _position=IF(",
              "                ISFILTERED('DISCONNECTED Countries'[EnglishCountryRegionName]) //are you slicing by this?",
              "                ,SELECTEDVALUE('DISCONNECTED Countries'[CountryIndex])",
              "                ,1//default=1 (Australia)",
              "                ) ",
              "return",
              "IF(",
              "    HASONEVALUE(Geography[EnglishCountryRegionName]), // gets rid of a meaningless Total",
              "    CALCULATE(",
              "        [Total Profit],",
              "     INDEX(_position,ALLSELECTED(Geography[EnglishCountryRegionName])) //which country are you comparing against?",
              "        )",
              ")"
            ],
            "lineageTag": "77c04401-126b-4559-8264-4765cd45287b"
          },
          {
            "name": "Total Profit Difference to compare",
            "description": [
              "",
              "IF(",
              "    HASONEVALUE(Geography[EnglishCountryRegionName]), // gets rid of a meaningless Total",
              "    DIVIDE([Total Profit],[Total Profit to compare],0)",
              ")"
            ],
            "expression": [
              "",
              "IF(",
              "    HASONEVALUE(Geography[EnglishCountryRegionName]), // gets rid of a meaningless Total",
              "    DIVIDE([Total Profit],[Total Profit to compare],0)",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "ea50754b-1f47-44b3-8e29-47488e3bc464"
          },
          {
            "name": "Sales for current year (excluding PromotionKey 1) (chatGPT no calculate)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": [
              "",
              "VAR CurrentYearSales =",
              "    SUMX(",
              "        FILTER(",
              "            'InternetSales 😀',",
              "            YEAR('InternetSales 😀'[OrderDate]) = YEAR(TODAY())-15 && 'InternetSales 😀'[PromotionKey] <> 1 //-15 just because we have no data for the current year",
              "        ),",
              "        'InternetSales 😀'[SalesAmount]",
              "    )",
              "RETURN",
              "    CurrentYearSales"
            ],
            "expression": [
              "",
              "VAR CurrentYearSales =",
              "    SUMX(",
              "        FILTER(",
              "            'InternetSales 😀',",
              "            YEAR('InternetSales 😀'[OrderDate]) = YEAR(TODAY())-15 && 'InternetSales 😀'[PromotionKey] <> 1 //-15 just because we have no data for the current year",
              "        ),",
              "        'InternetSales 😀'[SalesAmount]",
              "    )",
              "RETURN",
              "    CurrentYearSales"
            ],
            "lineageTag": "a6b82582-18b7-4713-a7a8-911882efec32"
          },
          {
            "name": "Sales for current year (excluding PromotionKey 1) (chatgpt calculate)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": [
              "",
              "CALCULATE(",
              "    SUM('InternetSales 😀'[SalesAmount]),",
              "    FILTER(",
              "        'InternetSales 😀',",
              "        YEAR('InternetSales 😀'[OrderDate]) = YEAR(TODAY())-15 && 'InternetSales 😀'[PromotionKey] <> 1 //-15 just because we have no data for the current year",
              "    )",
              ")"
            ],
            "expression": [
              "",
              "CALCULATE(",
              "    SUM('InternetSales 😀'[SalesAmount]),",
              "    FILTER(",
              "        'InternetSales 😀',",
              "        YEAR('InternetSales 😀'[OrderDate]) = YEAR(TODAY())-15 && 'InternetSales 😀'[PromotionKey] <> 1 //-15 just because we have no data for the current year",
              "    )",
              ")"
            ],
            "lineageTag": "9e4f3605-210c-4ea2-bb7e-10af27d188ce"
          },
          {
            "name": "Top 10 product sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "-- this was reverse engineered from TOPN in the FILTERS pane",
              "SUMX(",
              "    TOPN(10,",
              "    SUMMARIZECOLUMNS(",
              "\t\t\t'Product'[ProductName],",
              "\t\t\t\"Total_Sales\", 'All Measures 😀'[Total Sales]",
              "            ),",
              "        [Total_Sales],DESC -- column name from above",
              "        )",
              "    ,[Total_Sales]",
              "    )"
            ],
            "lineageTag": "d4163a42-4347-44fb-9109-4d64973b5108"
          },
          {
            "name": "Total Sales Rounded",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "MROUND([Total Sales],1000)",
            "lineageTag": "0d2eccab-67ba-4ee2-9e5c-86195a5925e3"
          },
          {
            "name": "HasNoSales Sales Amount",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "[Total Sales] = 0",
            "lineageTag": "f79ae05d-dced-4ae0-a76a-b72b43104290"
          },
          {
            "name": "HasNoSales COUNTROWS",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "IF(",
              "    COUNTROWS ( 'InternetSales 😀' ) = 0,",
              "    \"Yes\", // just a cosmetic change instead of True/False",
              "     \"No\"",
              ")"
            ],
            "lineageTag": "24452fef-bc25-4643-91d5-bfeaa2c11601"
          },
          {
            "name": "HasNoSales ISEMPTY",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "ISEMPTY ( 'InternetSales 😀' )",
            "lineageTag": "ca8d5a49-db8b-4bc3-bf26-6f7f11f0f12b"
          },
          {
            "name": "HasNoSales INTERSECT",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "        ISEMPTY (",
              "            INTERSECT ( VALUES ( 'Product'[ProductKey] ), VALUES ( 'InternetSales 😀'[ProductKey] ) )",
              "        )"
            ],
            "lineageTag": "3514b9fc-3d9c-414a-8a3b-9011081ac2f6"
          },
          {
            "name": "HasNoSales SELECTEDVALUE",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "// nb - requires product on the chart to provide context",
              "        NOT ( SELECTEDVALUE ( 'Product'[ProductKey] ) IN VALUES ( 'InternetSales 😀'[ProductKey] ) )"
            ],
            "lineageTag": "b835b2a2-488d-4085-9e3d-7b3e97ab2d26"
          },
          {
            "name": "Total Sales dynamic format",
            "expression": [
              "",
              "// see DAX in format property (underneath Measure (far left))",
              "SUM ( 'InternetSales 😀'[SalesAmount] )"
            ],
            "formatStringDefinition": {
              "expression": [
                "var __currentvalue=SELECTEDMEASURE()",
                "var __format=",
                "SWITCH(TRUE(),",
                "__currentvalue<=1e3, \"#,0.\", -- <1000",
                "//__currentvalue<=1e4, \"#,0,.00 K\", -- <10000",
                "__currentvalue<=1e5, \"#,0,.00 K\", -- <100000",
                "__currentvalue<=1e6, \"#,0,. K\", -- <1000000",
                "__currentvalue<=1e7, \"#,0,,.00 M\",",
                "__currentvalue<=1e8, \"#,0,,.0 M\",",
                "__currentvalue<=1e9, \"#,0,,. M\"",
                ")",
                "var __formatstring=\"£\" & __format & \" Sterling\"",
                "RETURN",
                "__formatstring"
              ]
            },
            "lineageTag": "0a15885d-85dc-4060-a378-8f792d2c8093"
          },
          {
            "name": "Total Sales (stop)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "//see https://www.youtube.com/watch?v=73axSxNuJuk",
              "CALCULATE(",
              "    [Total Sales],",
              "    FILTER('Date 👍','Date 👍'[Date]<=MAX('Date (Disconnected)'[Date]))",
              "    )",
              ""
            ],
            "lineageTag": "7b0e1daa-2468-4941-8e95-f2ec876bac5d"
          },
          {
            "name": "Filter detail rows by date",
            "detailRowsDefinition": {
              "expression": [
                "//https://www.youtube.com/watch?v=73axSxNuJuk",
                "FILTER('Date 👍','Date 👍'[Date]<=MAX('Date (Disconnected)'[Date]))"
              ]
            },
            "lineageTag": "3a3d116e-22c1-4292-9315-72943ff2f1c0"
          },
          {
            "name": "Total Sales (stop - filter detail rows by date)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "//so kool!!! Re-use a variable!!!!! See the measure [Filter detail rows by date]",
              "//see - https://www.antmanbi.com/post/using-detailrows-with-window-functions-in-dax",
              "// and https://www.youtube.com/watch?v=73axSxNuJuk",
              "",
              "//nb. requires Tabular Editor",
              "",
              "CALCULATE([Total Sales],DETAILROWS([Filter detail rows by date]))"
            ],
            "lineageTag": "53718f5c-8947-4896-bd3e-3d4488f3a466"
          },
          {
            "name": "Filter detail rows 2",
            "detailRowsDefinition": {
              "expression": [
                "SUMMARIZECOLUMNS(",
                "    'Date 👍'[CalendarYear],",
                "    Customer[FullName],",
                "    KEEPFILTERS( TREATAS( {2008}, 'Date 👍'[CalendarYear] )),",
                "    \"Total Sales\", [Total Sales]",
                ")"
              ]
            },
            "lineageTag": "52092936-da44-4834-8c37-19bbbc2a4096"
          },
          {
            "name": "Total Sales (filter detail rows 2)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "//see - https://www.antmanbi.com/post/using-detailrows-with-window-functions-in-dax",
              "CALCULATE(",
              "    //[Total Sales], ",
              "    countrows('InternetSales 😀'),",
              "    DETAILROWS([Filter detail rows 2])",
              "    )"
            ],
            "lineageTag": "1f0af28d-81b8-4b06-9b72-e19756c073fc"
          },
          {
            "name": "Total Sales (filter detail rows 2.1)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "//see - https://www.antmanbi.com/post/using-detailrows-with-window-functions-in-dax",
              "CALCULATE(",
              "    [Total Sales], ",
              "    DETAILROWS([Filter detail rows 2])",
              "    )"
            ],
            "lineageTag": "1465a43b-da5c-4a3f-96ef-eb9c8bc48049"
          },
          {
            "name": "Sales Date countrows check",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "//nb 20050911 has no sales",
              "CALCULATE(",
              "    SUMX(",
              "        VALUES('InternetSales 😀'[OrderDateKey])",
              "        , 1",
              "        )",
              "        )",
              "//CALCULATE(DISTINCTCOUNT('InternetSales 😀'[OrderDateKey]))",
              ""
            ],
            "lineageTag": "0f60362d-d183-4f16-9020-3fcfd0190f9c"
          },
          {
            "name": "DetailRows metrics by Country MMMYYYY",
            "detailRowsDefinition": {
              "expression": [
                "ADDCOLUMNS (",
                "    CALCULATETABLE (",
                "        SUMMARIZE (",
                "            'InternetSales 😀',",
                "            Geography[EnglishCountryRegionName],",
                "            'Date 👍'[MMMYYYY],'Date 👍'[MMMYYYY sort]",
                "        ),",
                "        REMOVEFILTERS ( 'InternetSales 😀' )",
                "    ),",
                "    \"@Sales\", [Total Sales],",
                "    \"@Cost\", [Total Costs],",
                "    \"@profit\", [Total Profit]",
                ")",
                "//ORDER BY Geography[EnglishCountryRegionName],'Date 👍'[MMMYYYY sort]"
              ]
            },
            "lineageTag": "8532e5b4-a440-45c5-8067-c96c3610fd7a"
          },
          {
            "name": "_All(Internet Sales)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "CALCULATE([Total Sales],ALL('InternetSales 😀'))"
            ],
            "lineageTag": "177ce7aa-ed1b-454f-aefe-528bec4a252f"
          },
          {
            "name": "_All(ProductCategory)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "CALCULATE([Total Sales],ALL('ProductCategory 😀'))"
            ],
            "lineageTag": "a77d289a-9561-43a1-9e38-385b47575738"
          },
          {
            "name": "_All(customer)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "CALCULATE([Total Sales],ALL('Customer'))"
            ],
            "lineageTag": "6ec0bec6-65c4-4418-9160-4524616f07a5"
          },
          {
            "name": "_RemoveFilters(customer)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "CALCULATE([Total Sales],REMOVEFILTERS('Customer'))"
            ],
            "lineageTag": "b08baa0e-a133-457e-a583-0fc46a7157c6"
          },
          {
            "name": "_RemoveFilters(Internet Sales)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "CALCULATE([Total Sales],REMOVEFILTERS('InternetSales 😀'))"
            ],
            "lineageTag": "aeb2c0ce-fbba-4e33-a9fd-2f3e36f5f3f1"
          },
          {
            "name": "_RemoveFilters(ProductCategory)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "CALCULATE([Total Sales],REMOVEFILTERS('ProductCategory 😀'))"
            ],
            "lineageTag": "d08d25b3-ba43-4bc8-8314-50992dc52844"
          },
          {
            "name": "_Performance Count Sales FILTER",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "CALCULATE (",
              "COUNTROWS( 'InternetSales 😀') ,",
              "FILTER ( 'InternetSales 😀', 'InternetSales 😀'[UnitPrice] >= 5 ))"
            ],
            "lineageTag": "37390cd8-f5e3-4d95-89a8-c7fc6216398c"
          },
          {
            "name": "_Performance Count Sales KEEPFILTERS",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "CALCULATE (",
              "COUNTROWS( 'InternetSales 😀' ) ,",
              "KEEPFILTERS( 'InternetSales 😀'[UnitPrice] >= 5 ))"
            ],
            "lineageTag": "7444880d-d769-46b5-9417-e23c34594e15"
          }
        ],
        "partitions": [
          {
            "name": "All Measures 😀-0ab74767-d2c6-4648-8788-41a7c053b08a",
            "mode": "import",
            "source": {
              "expression": [
                "ROW (",
                "    \"Column\", BLANK ()",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "All ToDate Measures",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "lineageTag": "f61b26e2-d1de-4bd3-afff-afdee7a24b10",
        "measures": [
          {
            "name": "Costs MTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Costs],",
              "    DATESMTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Costs],",
              "    DATESMTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "5dbc882c-2df4-40f8-8ce6-4408a473f5ff"
          },
          {
            "name": "Costs QTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Costs],",
              "    DATESQTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Costs],",
              "    DATESQTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "6ed27035-d47b-4c06-9cfe-196b561fb8d6"
          },
          {
            "name": "Costs YTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Costs],",
              "    DATESYTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Costs],",
              "    DATESYTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "2f1bb4ad-d43a-4a83-b892-c3a25ebff51b"
          },
          {
            "name": "Profit MTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Profit],",
              "    DATESMTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Profit],",
              "    DATESMTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "422c6a3f-f89c-470b-8718-ad3775cbfc43"
          },
          {
            "name": "Profit QTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Costs],",
              "    DATESQTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Profit],",
              "    DATESQTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "bd458b72-4aad-4363-85d9-f937986c37fa"
          },
          {
            "name": "Profit YTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Profit],",
              "    DATESYTD ( 'Date 👍'[Date] )",
              ")",
              "",
              "//is the same as",
              "",
              "// CALCULATE (",
              "//     [Total Profit],",
              "//     FILTER (",
              "//         ALL ( 'Date 👍'[Date] ),",
              "//         'Date 👍'[Date] <= MAX ( 'Date 👍'[Date] ) &&",
              "//         YEAR ( 'Date 👍'[Date] ) = YEAR ( MAX ( 'Date 👍'[Date] ) )",
              "//     )",
              "// )"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Profit],",
              "    DATESYTD ( 'Date 👍'[Date] )",
              ")",
              "",
              "//is the same as",
              "",
              "// CALCULATE (",
              "//     [Total Profit],",
              "//     FILTER (",
              "//         ALL ( 'Date 👍'[Date] ),",
              "//         'Date 👍'[Date] <= MAX ( 'Date 👍'[Date] ) &&",
              "//         YEAR ( 'Date 👍'[Date] ) = YEAR ( MAX ( 'Date 👍'[Date] ) )",
              "//     )",
              "// )"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "be4f80bd-b245-457a-9bf6-8f3849abcb26"
          },
          {
            "name": "Sales MTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESMTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESMTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "lineageTag": "f6c6b89a-8083-4c0e-9f39-3ccfeb2009e6"
          },
          {
            "name": "Sales QTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESQTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESQTD ( 'Date 👍'[Date] )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "dd42748e-8f57-4ecd-9f9d-76e5b9706336"
          },
          {
            "name": "Sales YTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESYTD ( 'Date 👍'[Date] //,\"31/3\" //financial year end",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESYTD ( 'Date 👍'[Date]) //,\"31/3\" //financial year end",
              "    ",
              ")"
            ],
            "lineageTag": "23830f49-e1f1-4429-8e88-2303ec93c22b"
          },
          {
            "name": "Sales WTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//no TotalWTD function",
              "IF (",
              "    HASONEVALUE ( 'Calendar'[Year] )",
              "        && HASONEVALUE ( 'Calendar'[WeekNum] ),",
              "    // ie you are filtered on year and week",
              "    CALCULATE (",
              "        [Total Sales],",
              "        // this",
              "        FILTER (",
              "            ALL ( 'Calendar' ),",
              "            'Calendar'[Year]",
              "                = VALUES ( 'Calendar'[Year] ) //by Year",
              "                && 'Calendar'[WeekNum]",
              "                    = VALUES ( 'Calendar'[WeekNum] ) //and WeekNum",
              "                && 'Calendar'[Date]",
              "                    <= MAX ( 'Calendar'[Date] ) //and current date > previous",
              "        )",
              "    )",
              ")"
            ],
            "expression": [
              "",
              "//no TotalWTD function",
              "",
              "// or can use MAX instead of SELECTEDVALUE",
              "",
              "// use whatever combination of year and weeknumber that you may require.",
              "// eg you may need to account for the idiosyncracies of week 1 and 53",
              "VAR CurrentYear = SELECTEDVALUE ( 'Calendar'[Year] )",
              "VAR CurrentWeekNum = SELECTEDVALUE ( 'Calendar'[WeekNum] )",
              "",
              "VAR CurrentDate = SELECTEDVALUE ( 'Calendar'[Date] ) ",
              "RETURN",
              "    IF (",
              "        NOT ISBLANK ( CurrentYear )",
              "            && NOT ISBLANK ( CurrentWeekNum ),",
              "        CALCULATE (",
              "            [Total Sales],",
              "            FILTER (",
              "                ALL ( 'Calendar' ),",
              "                'Calendar'[Year] = CurrentYear                  //by Year",
              "                    && 'Calendar'[WeekNum] = CurrentWeekNum     //and WeekNum",
              "                    && 'Calendar'[Date] <= CurrentDate          //and current date > previous date within the week",
              "            )",
              "        )",
              "    )"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "181d91b3-149a-49ad-b862-927397071110"
          },
          {
            "name": "SWITCH Measure",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR SelectedRow =",
              "    SELECTEDVALUE ( 'Y axis'[yMeasure] ) //for each column header",
              "VAR SelectedColumn =",
              "    SELECTEDVALUE ( 'X axis'[xMeasure] ) //for each row header",
              "RETURN",
              "    SWITCH (",
              "        SelectedRow //for each row",
              "        ,",
              "        \"Sales\",",
              "            //for this column header then [Total Sales], [Sales QTD], [Sales YTD] on rows",
              "            SWITCH (",
              "                SelectedColumn,",
              "                \"This Month\", [Total Sales],",
              "                \"QTD\", [Sales QTD],",
              "                \"YTD\", [Sales YTD]",
              "            ),",
              "        \"Costs\",",
              "            //for this column header then [Total Costs], [Costs QTD], [Costs YTD] on rows",
              "            SWITCH (",
              "                SelectedColumn,",
              "                \"This Month\", [Total Costs],",
              "                \"QTD\", [Costs QTD],",
              "                \"YTD\", [Costs YTD]",
              "            ),",
              "        \"Profit\",",
              "            //for this column header then [Total Profit], [Profit QTD], [Profit YTD] on rows",
              "            SWITCH (",
              "                SelectedColumn,",
              "                \"This Month\", [Total Profit],",
              "                \"QTD\", [Profit QTD],",
              "                \"YTD\", [Profit YTD]",
              "            )",
              "    )"
            ],
            "expression": [
              "VAR SelectedRow =",
              "    SELECTEDVALUE ( 'Y axis'[yMeasure] ) //for each column header",
              "VAR SelectedColumn =",
              "    SELECTEDVALUE ( 'X axis'[xMeasure] ) //for each row header",
              "RETURN",
              "    SWITCH (",
              "        SelectedRow //for each row",
              "        ,",
              "        \"Sales\",",
              "            //for this column header then [Total Sales], [Sales QTD], [Sales YTD] on rows",
              "            SWITCH (",
              "                SelectedColumn,",
              "                \"This Month\", [Total Sales],",
              "                \"QTD\", [Sales QTD],",
              "                \"YTD\", [Sales YTD]",
              "            ),",
              "        \"Costs\",",
              "            //for this column header then [Total Costs], [Costs QTD], [Costs YTD] on rows",
              "            SWITCH (",
              "                SelectedColumn,",
              "                \"This Month\", [Total Costs],",
              "                \"QTD\", [Costs QTD],",
              "                \"YTD\", [Costs YTD]",
              "            ),",
              "        \"Profit\",",
              "            //for this column header then [Total Profit], [Profit QTD], [Profit YTD] on rows",
              "            SWITCH (",
              "                SelectedColumn,",
              "                \"This Month\", [Total Profit],",
              "                \"QTD\", [Profit QTD],",
              "                \"YTD\", [Profit YTD]",
              "            )",
              "    )"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "cca5b525-6b43-4a8e-857c-814c36408e0a"
          },
          {
            "name": "EOM",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ENDOFMONTH ( 'Date 👍'[Date] )",
              ")",
              "//only works if there are sales on the LAST DAY OF THE MONTH!!!!!"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ENDOFMONTH ( 'Date 👍'[Date] )",
              ")",
              "//only works if there are sales on the LAST DAY OF THE MONTH!!!!!"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "21606464-46ab-457c-9cf8-7743ca809a5d"
          },
          {
            "name": "Last Date Sales",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "LASTNONBLANK (",
              "    'Date 👍'[Date],",
              "    [Total Sales]",
              ")"
            ],
            "expression": [
              "LASTNONBLANK (",
              "    'Date 👍'[Date],",
              "    [Total Sales]",
              ")"
            ],
            "formatString": "Short Date",
            "lineageTag": "21534c81-76a7-4a44-a103-07cf02ba1033"
          },
          {
            "name": "EOM1",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CLOSINGBALANCEMONTH (",
              "    [Total Sales],",
              "    'Date 👍'[Date]",
              ")",
              "//only works if there are sales on the LAST DAY OF THE MONTH!!!!!"
            ],
            "expression": [
              "CLOSINGBALANCEMONTH (",
              "    [Total Sales],",
              "    'Date 👍'[Date]",
              ")",
              "//only works if there are sales on the LAST DAY OF THE MONTH!!!!!"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "4e563ea1-9b7a-4265-9d43-fb9e97e42067"
          },
          {
            "name": "EOM2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    LASTNONBLANK (",
              "        'Date 👍'[Date],",
              "        [Total Sales]",
              "    )",
              ")",
              "//returns  last date's sales but only on that date"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    LASTNONBLANK (",
              "        'Date 👍'[Date],",
              "        [Total Sales]",
              "    )",
              ")",
              "//returns  last date's sales but only on that date"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "70162a45-0a0d-4dc9-9fe3-b470e5ec4cd4"
          },
          {
            "name": "EOM3 Final",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    LASTNONBLANK (",
              "        PARALLELPERIOD (",
              "            'Date 👍'[Date],",
              "            0,",
              "            MONTH",
              "        ),",
              "        [Total Sales]",
              "    )",
              ")",
              "//returns  last date's sales no matter what the date :)"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    LASTNONBLANK (",
              "        PARALLELPERIOD (",
              "            'Date 👍'[Date],",
              "            0,",
              "            MONTH",
              "        ),",
              "        [Total Sales]",
              "    )",
              ")",
              "//returns  last date's sales no matter what the date :)"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "9afe0e6b-0861-481d-9dde-4de01a1934fe"
          },
          {
            "name": "Sales YTD2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALL ( 'Date 👍' ),",
              "        'Date 👍'[CalendarYear]",
              "            = MAX ( 'Date 👍'[CalendarYear] ) // where CalendarYear=current row's CalendarYear",
              "            && 'Date 👍'[Date]",
              "                <= MAX ( 'Date 👍'[Date] ) // and Date<=current row's Date",
              "    )",
              ")",
              "",
              "//this is how chatgpt did it without Time Intelligence"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALL ( 'Date 👍' ),",
              "        'Date 👍'[CalendarYear]",
              "            = MAX ( 'Date 👍'[CalendarYear] ) // where CalendarYear=current row's CalendarYear",
              "            && 'Date 👍'[Date]",
              "                <= MAX ( 'Date 👍'[Date] ) // and Date<=current row's Date",
              "    )",
              ")",
              "",
              "//this is how chatgpt did it without Time Intelligence"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "9174113c-7ca3-45a4-9f89-dcfd412801a5"
          },
          {
            "name": "Sales YTD3",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "TOTALYTD (",
              "    [Total Sales],",
              "    'Date 👍'[Date]",
              ")",
              "// this is how a quick measure does it"
            ],
            "expression": [
              "//see August 2008",
              "CALCULATE(",
              "    TOTALYTD (",
              "        [Total Sales],",
              "        'Date 👍'[Date]",
              "    ),",
              "    'Date 👍'[Sales Check] //flag column that hides future months with no sales :)",
              ")",
              ""
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "6c08e292-1805-45b2-8a5a-484716c7ff3e"
          },
          {
            "name": "Sales YTD4",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESBETWEEN (",
              "        'Date 👍'[Date],",
              "        DATE ( YEAR (",
              "            MAX ( 'Date 👍'[Date] )",
              "        ), 1, 1 ),",
              "        MAX ( 'Date 👍'[Date] ) //between Jan 1st and current date",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESBETWEEN (",
              "        'Date 👍'[Date],",
              "        DATE ( YEAR (",
              "            MAX ( 'Date 👍'[Date] )",
              "        ), 1, 1 ),",
              "        MAX ( 'Date 👍'[Date] ) //between Jan 1st and current date",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "09fbaa52-bbb5-4df7-a105-56085d1af15c"
          },
          {
            "name": "Sales YTD - hide future values",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//THIS IS ONLY RELEVANT IF YOUR DATE TABLE GOES INTO THE FUTURE",
              "//https://www.youtube.com/watch?v=VXd1wl-5vKI",
              "CALCULATE (",
              "    [Total Sales],",
              "    CALCULATETABLE (",
              "        //return a list of dates in the past",
              "        DATESYTD ( 'Date 👍'[Date] ),",
              "        'Date 👍'[IsPast] = TRUE",
              "    )",
              ")"
            ],
            "expression": [
              "//THIS IS ONLY RELEVANT IF YOUR DATE TABLE GOES INTO THE FUTURE",
              "//https://www.youtube.com/watch?v=VXd1wl-5vKI",
              "CALCULATE (",
              "    [Total Sales],",
              "    CALCULATETABLE (",
              "        //return a list of dates in the past",
              "        DATESYTD ( 'Date 👍'[Date] ),",
              "        'Date 👍'[IsPast] = TRUE",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "e6d3c403-4b74-4c5f-a26e-dc77af0407bb"
          },
          {
            "name": "Average delivery Working Days (fast)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "AVERAGEX (",
              "    'InternetSales 😀',",
              "    CALCULATE (",
              "        COUNTROWS ( 'Date 👍' ),",
              "        DATESBETWEEN (",
              "            'Date 👍'[Date],",
              "            'InternetSales 😀'[OrderDate],",
              "            'InternetSales 😀'[ShipDate]",
              "        ),",
              "        NOT 'Date 👍'[DayNumberOfWeek]",
              "            IN {",
              "            1,",
              "            7",
              "        } //sun,sat",
              "    )",
              ")"
            ],
            "expression": [
              "AVERAGEX (",
              "    'InternetSales 😀',",
              "    CALCULATE (",
              "        COUNTROWS ( 'Date 👍' ),",
              "        DATESBETWEEN (",
              "            'Date 👍'[Date],",
              "            'InternetSales 😀'[OrderDate],",
              "            'InternetSales 😀'[ShipDate]",
              "        ),",
              "        NOT 'Date 👍'[DayNumberOfWeek]",
              "            IN {",
              "            1,",
              "            7",
              "        } //sun,sat",
              "    )",
              ")"
            ],
            "lineageTag": "9e67fcdb-3a42-40d5-a798-352977a699c9"
          },
          {
            "name": "Average delivery Working Days (slow)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "// work it out mathematically ie total working days/numberof orders",
              "//nb it is possible on bigger datasets that this version is faster!!!!",
              "VAR NumOfAllOrders =",
              "    COUNTROWS ( 'InternetSales 😀' ) // will be the divide by",
              "VAR NonWD =",
              "    CALCULATETABLE (",
              "        // a table of nonworking days that we will need to filter",
              "        VALUES ( 'Date 👍'[Date] ),",
              "        ALL ( 'Date 👍' ),",
              "        'Date 👍'[DayNumberOfWeek]",
              "            IN {",
              "            1,",
              "            7",
              "        }",
              "    )",
              "VAR DaysIRangeByNumOfOrders =",
              "    SUMX (",
              "        SUMMARIZE (",
              "            'InternetSales 😀',",
              "            'InternetSales 😀'[OrderDate],",
              "            'InternetSales 😀'[ShipDate]",
              "        ),",
              "        //reduces the rows to the combo we want",
              "        VAR NumOfOrders =",
              "            CALCULATE (",
              "                COUNTROWS ( 'InternetSales 😀' )",
              "            ) // needs calculate so it counts correct slice of the above combo",
              "        VAR NumOfNonWD =",
              "            //count the days between orderdate and shipdate that are non working",
              "            COUNTROWS (",
              "                FILTER (",
              "                    NonWD,",
              "                    'Date 👍'[Date] >= 'InternetSales 😀'[OrderDate]",
              "                        && 'Date 👍'[Date] <= 'InternetSales 😀'[ShipDate]",
              "                )",
              "            )",
              "        VAR NumOfWD = 'InternetSales 😀'[ShipDate] - 'InternetSales 😀'[OrderDate] + 1 - NumOfNonWD // working days per order",
              "        RETURN",
              "            NumOfOrders * NumOfWD // total working days",
              "    )",
              "RETURN",
              "    DIVIDE (",
              "        DaysIRangeByNumOfOrders,",
              "        NumOfAllOrders,",
              "        0",
              "    )"
            ],
            "expression": [
              "// work it out mathematically ie total working days/numberof orders",
              "//nb it is possible on bigger datasets that this version is faster!!!!",
              "VAR NumOfAllOrders =",
              "    COUNTROWS ( 'InternetSales 😀' ) // will be the divide by",
              "VAR NonWD =",
              "    CALCULATETABLE (",
              "        // a table of nonworking days that we will need to filter",
              "        VALUES ( 'Date 👍'[Date] ),",
              "        ALL ( 'Date 👍' ),",
              "        'Date 👍'[DayNumberOfWeek]",
              "            IN {",
              "            1,",
              "            7",
              "        }",
              "    )",
              "VAR DaysIRangeByNumOfOrders =",
              "    SUMX (",
              "        SUMMARIZE (",
              "            'InternetSales 😀',",
              "            'InternetSales 😀'[OrderDate],",
              "            'InternetSales 😀'[ShipDate]",
              "        ),",
              "        //reduces the rows to the combo we want",
              "        VAR NumOfOrders =",
              "            CALCULATE (",
              "                COUNTROWS ( 'InternetSales 😀' )",
              "            ) // needs calculate so it counts correct slice of the above combo",
              "        VAR NumOfNonWD =",
              "            //count the days between orderdate and shipdate that are non working",
              "            COUNTROWS (",
              "                FILTER (",
              "                    NonWD,",
              "                    'Date 👍'[Date] >= 'InternetSales 😀'[OrderDate]",
              "                        && 'Date 👍'[Date] <= 'InternetSales 😀'[ShipDate]",
              "                )",
              "            )",
              "        VAR NumOfWD = 'InternetSales 😀'[ShipDate] - 'InternetSales 😀'[OrderDate] + 1 - NumOfNonWD // working days per order",
              "        RETURN",
              "            NumOfOrders * NumOfWD // total working days",
              "    )",
              "RETURN",
              "    DIVIDE (",
              "        DaysIRangeByNumOfOrders,",
              "        NumOfAllOrders,",
              "        0",
              "    )"
            ],
            "lineageTag": "d34f7033-8560-4f1d-8068-9f9a7e329027"
          },
          {
            "name": "Running total by country (then date)",
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR CurrentDate =",
              "    MAX ( 'InternetSales 😀'[OrderDate] )",
              "VAR CurrentCountry =",
              "    MAX ( Geography[EnglishCountryRegionName] )",
              "RETURN",
              "    CALCULATE (",
              "        [Total Sales],",
              "        'InternetSales 😀'[OrderDate] <= CurrentDate,",
              "        Geography[EnglishCountryRegionName] = CurrentCountry,",
              "        ALL () // required. Removes all filters to generate a running total",
              "        // and doesn't calculate on any date with no sales :)",
              "    )"
            ],
            "expression": [
              "VAR CurrentDate =",
              "    MAX ( 'InternetSales 😀'[OrderDate] )",
              "VAR CurrentCountry =",
              "    MAX ( Geography[EnglishCountryRegionName] )",
              "RETURN",
              "    CALCULATE (",
              "        [Total Sales],",
              "        'InternetSales 😀'[OrderDate] <= CurrentDate,",
              "        Geography[EnglishCountryRegionName] = CurrentCountry,",
              "        ALL () // required. Removes all filters to generate a running total",
              "        // and doesn't calculate on any date with no sales :)",
              "    )"
            ],
            "formatString": "#,0.00",
            "lineageTag": "d83191bf-f048-4b42-b0fc-1b8be64c033b"
          },
          {
            "name": "_1aSales RT",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "// over all dates",
              "VAR currentDate =",
              "    MAX ( 'Date 👍'[Date] )",
              "VAR dateFrame =",
              "    FILTER (",
              "        ALL ( 'Date 👍'[Date] ),",
              "        'Date 👍'[Date] <= currentDate",
              "    )",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        dateFrame",
              "    )",
              "RETURN",
              "    result"
            ],
            "expression": [
              "// over all dates",
              "VAR currentDate =",
              "    MAX ( 'Date 👍'[Date] )",
              "VAR dateFrame =",
              "    FILTER (",
              "        ALL ( 'Date 👍'[Date] ),",
              "        'Date 👍'[Date] <= currentDate",
              "    )",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        dateFrame",
              "    )",
              "RETURN",
              "    result"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "lineageTag": "0eabe85a-de39-4571-a56e-6b390e34f231"
          },
          {
            "name": "_1FrameStart",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR currentDate =",
              "    MAX ( 'Date 👍'[Date] )",
              "VAR currentDateAsInt =",
              "    TRUNC ( currentDate )",
              "VAR FirstSalesDate =",
              "    //starting point for your dates",
              "    CALCULATE (",
              "        MIN ( 'InternetSales 😀'[OrderDate] ),",
              "        ALL ( 'InternetSales 😀' ) //could be filtered and parametised with whatif param",
              "    )",
              "VAR FirstSalesDateasInt =",
              "    TRUNC ( FirstSalesDate )",
              "VAR result =",
              "    IF (",
              "        MOD (",
              "            currentDateAsInt - FirstSalesDateasInt,",
              "            7 // some random number of days.",
              "        ) = 0 ",
              "        // could also reference a whatif parameter",
              "        ,",
              "        TRUE ()",
              "    )",
              "RETURN",
              "    //DateAsInt",
              "    result"
            ],
            "expression": [
              "VAR currentDate =",
              "    MAX ( 'Date 👍'[Date] )",
              "VAR currentDateAsInt =",
              "    TRUNC ( currentDate )",
              "VAR FirstSalesDate =",
              "    //starting point for your dates",
              "    CALCULATE (",
              "        MIN ( 'InternetSales 😀'[OrderDate] ),",
              "        ALL ( 'InternetSales 😀' ) //could be filtered and parametised with whatif param",
              "    )",
              "VAR FirstSalesDateasInt =",
              "    TRUNC ( FirstSalesDate )",
              "VAR result =",
              "    IF (",
              "        MOD (",
              "            currentDateAsInt - FirstSalesDateasInt,",
              "            7 // some random number of days.",
              "        ) = 0 ",
              "        // could also reference a whatif parameter",
              "        ,",
              "        TRUE ()",
              "    )",
              "RETURN",
              "    //DateAsInt",
              "    result"
            ],
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "a0a81d25-61e1-4b3d-886f-b96ebce5784e"
          },
          {
            "name": "_2FrameStartDate",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDateTimeCustom\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//this errors!",
              "--CALCULATE(max('InternetSales 😀'[OrderDate]),[_FrameStart]=TRUE())",
              "VAR currentDate =",
              "    MAX ( 'Date 👍'[Date] )",
              "VAR DatesBeforeNow =",
              "    FILTER (",
              "        ALL ( 'Date 👍'[Date] ),",
              "        'Date 👍'[Date] <= currentDate",
              "    )",
              "VAR Frame =",
              "    FILTER (",
              "        DatesBeforeNow,",
              "        [_1FrameStart]",
              "            = TRUE ()",
              "    ) // a table",
              "VAR StartofFrame =",
              "    MAXX (",
              "        Frame,",
              "        'Date 👍'[Date]",
              "    ) //scalar value - nb has to be maxx",
              "RETURN",
              "    StartofFrame"
            ],
            "expression": [
              "//this errors!",
              "--CALCULATE(max('InternetSales 😀'[OrderDate]),[_FrameStart]=TRUE())",
              "VAR currentDate =",
              "    MAX ( 'Date 👍'[Date] )",
              "VAR DatesBeforeNow =",
              "    FILTER (",
              "        ALL ( 'Date 👍'[Date] ),",
              "        'Date 👍'[Date] <= currentDate",
              "    )",
              "VAR Frame =",
              "    FILTER (",
              "        DatesBeforeNow,",
              "        [_1FrameStart]",
              "            = TRUE ()",
              "    ) // a table",
              "VAR StartofFrame =",
              "    MAXX (",
              "        Frame,",
              "        'Date 👍'[Date]",
              "    ) //scalar value - nb has to be maxx",
              "RETURN",
              "    StartofFrame"
            ],
            "formatString": "dd/mm/yyyy",
            "lineageTag": "768f2045-0227-483c-ba97-d6098463b16c"
          },
          {
            "name": "_3Frame RT",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR currentDate =",
              "    MAX ( 'Date 👍'[Date] )",
              "VAR frameStartDate = [_2FrameStartDate]",
              "VAR DateFrame =",
              "    DATESBETWEEN (",
              "        'Date 👍'[Date],",
              "        frameStartDate,",
              "        currentDate",
              "    )",
              "VAR Result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        DateFrame",
              "    )",
              "RETURN",
              "    Result"
            ],
            "expression": [
              "VAR currentDate =",
              "    MAX ( 'Date 👍'[Date] )",
              "VAR frameStartDate = [_2FrameStartDate]",
              "VAR DateFrame =",
              "    DATESBETWEEN (",
              "        'Date 👍'[Date],",
              "        frameStartDate,",
              "        currentDate",
              "    )",
              "VAR Result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        DateFrame",
              "    )",
              "RETURN",
              "    Result"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "lineageTag": "aa671f21-d835-49c0-b60b-9292512d1560"
          },
          {
            "name": "Sales TD by period ('month name' level) offset",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//ie running total per month name per period (next level up in the hierarchy)",
              "VAR offsetmonth =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrMonthOffset] )",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL (",
              "                Dates_EDNA[CurrMonthOffset],",
              "                Dates_EDNA[IsAfterToday]",
              "            ),",
              "            Dates_EDNA[CurrMonthOffset] <= offsetmonth",
              "                && Dates_EDNA[IsAfterToday]",
              "                    = FALSE ()",
              "        ),",
              "        // the following is the level that you are slicing down to. (M)",
              "        REMOVEFILTERS (",
              "            Dates_EDNA[Month Name],",
              "            Dates_EDNA[Month]",
              "        ) // [Month] is required to sort correctly",
              "    )",
              "RETURN",
              "    result"
            ],
            "expression": [
              "//ie running total per month name per period (next level up in the hierarchy)",
              "VAR offsetmonth =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrMonthOffset] )",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL (",
              "                Dates_EDNA[CurrMonthOffset],",
              "                Dates_EDNA[IsAfterToday]",
              "            ),",
              "            Dates_EDNA[CurrMonthOffset] <= offsetmonth",
              "                && Dates_EDNA[IsAfterToday]",
              "                    = FALSE ()",
              "        ),",
              "        // the following is the level that you are slicing down to. (M)",
              "        REMOVEFILTERS (",
              "            Dates_EDNA[Month Name],",
              "            Dates_EDNA[Month] // [Month] is required to sort correctly",
              "        ) ",
              "    )",
              "RETURN",
              "    result"
            ],
            "lineageTag": "1bb1c035-4fbf-4e35-be5a-6aed474ceae7"
          },
          {
            "name": "Sales TD by period ('Quarter' level) offset",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//ie running total per quarter per period (next level up in the hierarchy)",
              "VAR offsetquarter =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrQuarterOffset] )",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL (",
              "                Dates_EDNA[CurrQuarterOffset],",
              "                Dates_EDNA[IsAfterToday]",
              "            ),",
              "            Dates_EDNA[CurrQuarterOffset] <= offsetquarter",
              "                && Dates_EDNA[IsAfterToday]",
              "                    = FALSE ()",
              "        ),",
              "        // the following is the level that you are slicing down to. (Q)",
              "        REMOVEFILTERS (",
              "            Dates_EDNA[Quarter],",
              "            Dates_EDNA[Quarter Number]",
              "        )",
              "    )",
              "RETURN",
              "    result"
            ],
            "expression": [
              "//ie running total per quarter per period (next level up in the hierarchy)",
              "VAR offsetquarter =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrQuarterOffset] )",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL (",
              "                Dates_EDNA[CurrQuarterOffset],",
              "                Dates_EDNA[IsAfterToday]",
              "            ),",
              "            Dates_EDNA[CurrQuarterOffset] <= offsetquarter",
              "                && Dates_EDNA[IsAfterToday]",
              "                    = FALSE ()",
              "        ),",
              "        // the following is the level that you are slicing down to. (Q)",
              "        REMOVEFILTERS (",
              "            Dates_EDNA[Quarter],",
              "            Dates_EDNA[Quarter Number]",
              "        )",
              "    )",
              "RETURN",
              "    result"
            ],
            "lineageTag": "0aa0ab77-db24-4d0d-9290-7e39f66e9b55"
          },
          {
            "name": "Sales RT1 (GD)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "var _ODate=MAX('InternetSales 😀'[OrderDate]) //current row for iteration purposes",
              "var _table=",
              "    filter(",
              "        ALLSELECTED('InternetSales 😀')",
              "        ,'InternetSales 😀'[OrderDate]<=_ODate)",
              "return",
              "SUMX(_table,[Total Sales])"
            ],
            "expression": [
              "",
              "var _ODate=MAX('InternetSales 😀'[OrderDate]) //current row for iteration purposes",
              "var _table=",
              "    filter(",
              "        ALLSELECTED('InternetSales 😀')",
              "        ,'InternetSales 😀'[OrderDate]<=_ODate)",
              "var _result=SUMX(_table,[Total Sales])",
              "return",
              "_result"
            ],
            "lineageTag": "ccd1ccce-aef5-4c44-b293-6f0a25f849a4"
          },
          {
            "name": "Sales RT per country GD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "var _ODate=MAX('InternetSales 😀'[OrderDate]) //current row for iteration purposes",
              "var _country=max(Geography[EnglishCountryRegionName]) //current row for iteration purposes",
              "var _table=",
              "filter(",
              "    ALLSELECTED('InternetSales 😀'),",
              "    'InternetSales 😀'[OrderDate]<=_ODate && RELATED(Geography[EnglishCountryRegionName])=_country",
              "    )",
              "return",
              "SUMX(_table,[Total Sales])",
              "",
              ""
            ],
            "expression": [
              "",
              "var _ODate=MAX('InternetSales 😀'[OrderDate]) //current row for iteration purposes",
              "var _country=max(Geography[EnglishCountryRegionName]) //current row for iteration purposes",
              "var _table=",
              "filter(",
              "    ALL('InternetSales 😀'),",
              "    RELATED(Geography[EnglishCountryRegionName])=_country",
              "    && 'InternetSales 😀'[OrderDate]<=_ODate",
              "    )",
              "var _result=SUMX(_table,[Total Sales])",
              "return",
              "_result",
              "",
              ""
            ],
            "lineageTag": "c9ff50d3-f242-4ce9-8479-71be69e73359"
          },
          {
            "name": "Sales RT  per Y (GD)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "var _ODate=MAX('InternetSales 😀'[OrderDate]) //current row for iteration purposes",
              "var _year=max('Date 👍'[CalendarYear]) //current row for iteration purposes",
              "var _table=",
              "filter(",
              "    ALLSELECTED('InternetSales 😀'),",
              "    'InternetSales 😀'[OrderDate]<=_ODate && YEAR('InternetSales 😀'[OrderDate])=_year",
              "    )",
              "return",
              "SUMX(_table,[Total Sales])"
            ],
            "expression": [
              "",
              "var _ODate=MAX('InternetSales 😀'[OrderDate]) //current row for iteration purposes",
              "var _year=max('Date 👍'[CalendarYear]) //current row for iteration purposes",
              "var _table=",
              "filter(",
              "    ALL('InternetSales 😀'),",
              "     YEAR('InternetSales 😀'[OrderDate])=_year",
              "     && 'InternetSales 😀'[OrderDate]<=_ODate",
              "    )",
              "var _result=SUMX(_table,[Total Sales])",
              "return",
              "_result"
            ],
            "lineageTag": "d20a7058-684b-407d-b245-8cd56c61dccb"
          },
          {
            "name": "Sales RT per Y (GD) (chatgpt)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "VAR _ODate = MAX ( 'InternetSales 😀'[OrderDate] )",
              "VAR _year = MAX ( 'Date 👍'[CalendarYear] )",
              "RETURN",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALLSELECTED ( 'InternetSales 😀' ),",
              "            'InternetSales 😀'[OrderDate] <= _ODate",
              "                && YEAR ( 'InternetSales 😀'[OrderDate] ) = _year",
              "        )",
              "    )",
              "",
              "//The main change I made was to replace the table variable '_table' with a CALCULATE function. The CALCULATE function is a more efficient way to filter a table in DAX, because it allows you to apply filters to a measure directly, rather than having to create a separate filtered table.",
              "",
              "//I also removed the SUMX function, and instead returned the [Total Sales] measure directly from the CALCULATE function. This is because the CALCULATE function already returns the sum of the measure, filtered according to the specified filter conditions.",
              "",
              "//Overall, this optimized code should have better performance than the original code, especially for larger data sets."
            ],
            "expression": [
              "",
              "VAR _ODate = MAX ( 'InternetSales 😀'[OrderDate] )",
              "VAR _year = MAX ( 'Date 👍'[CalendarYear] )",
              "RETURN",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALLSELECTED ( 'InternetSales 😀' ),",
              "            'InternetSales 😀'[OrderDate] <= _ODate",
              "                && YEAR ( 'InternetSales 😀'[OrderDate] ) = _year",
              "        )",
              "    )",
              "",
              "//The main change I made was to replace the table variable '_table' with a CALCULATE function. The CALCULATE function is a more efficient way to filter a table in DAX, because it allows you to apply filters to a measure directly, rather than having to create a separate filtered table.",
              "",
              "//I also removed the SUMX function, and instead returned the [Total Sales] measure directly from the CALCULATE function. This is because the CALCULATE function already returns the sum of the measure, filtered according to the specified filter conditions.",
              "",
              "//Overall, this optimized code should have better performance than the original code, especially for larger data sets."
            ],
            "lineageTag": "3d759499-9dd2-44ab-84a9-6f318f613ca1"
          },
          {
            "name": "Average delivery Working Days (optimized chatgpt (NOT!))",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "//In this optimized version, we removed the SUMMARIZE function, which was causing the slow performance, and instead used the SUMX function to iterate through each row of the 'InternetSales' table. We also removed the CALCULATE function from the inner COUNTROWS function, which was not needed, and we simplified the calculation of working days per order. Overall, this optimized code should perform faster than the original code.",
              "",
              "VAR NumOfAllOrders =",
              "    COUNTROWS ( 'InternetSales 😀' ) // will be the divide by",
              "VAR NonWD =",
              "    CALCULATETABLE (",
              "        // a table of nonworking days that we will need to filter",
              "        VALUES ( 'Date 👍'[Date] ),",
              "        ALL ( 'Date 👍' ),",
              "        'Date 👍'[DayNumberOfWeek]",
              "            IN {",
              "            1,",
              "            7",
              "        }",
              "    )",
              "VAR DaysIRangeByNumOfOrders =",
              "    SUMX (",
              "        'InternetSales 😀',",
              "        VAR NumOfNonWD =",
              "            //count the days between orderdate and shipdate that are non working",
              "            COUNTROWS (",
              "                FILTER (",
              "                    NonWD,",
              "                    'Date 👍'[Date] >= 'InternetSales 😀'[OrderDate]",
              "                        && 'Date 👍'[Date] <= 'InternetSales 😀'[ShipDate]",
              "                )",
              "            )",
              "        VAR NumOfWD = 'InternetSales 😀'[ShipDate] - 'InternetSales 😀'[OrderDate] + 1 - NumOfNonWD // working days per order",
              "        RETURN",
              "            NumOfWD // working days for each order",
              "    )",
              "RETURN",
              "    DIVIDE (",
              "        DaysIRangeByNumOfOrders,",
              "        NumOfAllOrders,",
              "        0",
              "    )",
              "",
              ""
            ],
            "expression": [
              "",
              "//In this optimized version, we removed the SUMMARIZE function, which was causing the slow performance, and instead used the SUMX function to iterate through each row of the 'InternetSales' table. We also removed the CALCULATE function from the inner COUNTROWS function, which was not needed, and we simplified the calculation of working days per order. Overall, this optimized code should perform faster than the original code.",
              "",
              "VAR NumOfAllOrders =",
              "    COUNTROWS ( 'InternetSales 😀' ) // will be the divide by",
              "VAR NonWD =",
              "    CALCULATETABLE (",
              "        // a table of nonworking days that we will need to filter",
              "        VALUES ( 'Date 👍'[Date] ),",
              "        ALL ( 'Date 👍' ),",
              "        'Date 👍'[DayNumberOfWeek]",
              "            IN {",
              "            1,",
              "            7",
              "        }",
              "    )",
              "VAR DaysIRangeByNumOfOrders =",
              "    SUMX (",
              "        'InternetSales 😀',",
              "        VAR NumOfNonWD =",
              "            //count the days between orderdate and shipdate that are non working",
              "            COUNTROWS (",
              "                FILTER (",
              "                    NonWD,",
              "                    'Date 👍'[Date] >= 'InternetSales 😀'[OrderDate]",
              "                        && 'Date 👍'[Date] <= 'InternetSales 😀'[ShipDate]",
              "                )",
              "            )",
              "        VAR NumOfWD = 'InternetSales 😀'[ShipDate] - 'InternetSales 😀'[OrderDate] + 1 - NumOfNonWD // working days per order",
              "        RETURN",
              "            NumOfWD // working days for each order",
              "    )",
              "RETURN",
              "    DIVIDE (",
              "        DaysIRangeByNumOfOrders,",
              "        NumOfAllOrders,",
              "        0",
              "    )",
              "",
              ""
            ],
            "lineageTag": "d557360b-d0f7-4ede-b376-d141179b02c2"
          },
          {
            "name": "DAX Debugger DATESYTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "//see https://www.thebiccountant.com/2019/05/19/dax-calculate-debugger/",
              "VAR FilterTable = DATESYTD ( 'Date 👍'[Date])",
              "VAR TableLength = ",
              "    COUNTROWS(FilterTable)",
              "VAR ColumnMax = ",
              "    MAXX(FilterTable, [Date])",
              "VAR ColumnMin = ",
              "    MINX(FilterTable, [Date])",
              "VAR TOPX = IF(TableLength < 10, TableLength, 10)",
              "VAR ValuesInColumn = ",
              "    //CONCATENATEX(TOPN(TOPX, FilterTable), [Date], \", \") ",
              "    //I have customised this so that you can see the end of the frame",
              "    CONCATENATEX(TOPN(TOPX, FilterTable,[Date],DESC), [Date], \", \",[Date],ASC)",
              "RETURN",
              "    --\"TableLength: \" & TableLength  & \", Min: \" & ColumnMin & \", Max: \" & ColumnMax",
              "     \"TableLength: \" & TableLength  & \", Min: \" & ColumnMin & \", Max: \" & ColumnMax & UNICHAR(13) & UNICHAR(10) & \"Top \" & TOPX & \" Values: \" & ValuesInColumn"
            ],
            "expression": [
              "",
              "//see https://www.thebiccountant.com/2019/05/19/dax-calculate-debugger/",
              "VAR FilterTable = DATESYTD ( 'Date 👍'[Date])",
              "VAR TableLength = ",
              "    COUNTROWS(FilterTable)",
              "VAR ColumnMax = ",
              "    MAXX(FilterTable, [Date])",
              "VAR ColumnMin = ",
              "    MINX(FilterTable, [Date])",
              "VAR TOPX = IF(TableLength < 10, TableLength, 10)",
              "VAR ValuesInColumn = ",
              "    //CONCATENATEX(TOPN(TOPX, FilterTable), [Date], \", \") ",
              "    //I have customised this so that you can see the end of the frame",
              "    CONCATENATEX(TOPN(TOPX, FilterTable,[Date],DESC), [Date], \", \",[Date],ASC)",
              "RETURN",
              "    --\"TableLength: \" & TableLength  & \", Min: \" & ColumnMin & \", Max: \" & ColumnMax",
              "     \"TableLength: \" & TableLength  & \", Min: \" & ColumnMin & \", Max: \" & ColumnMax & UNICHAR(13) & UNICHAR(10) & \"Top \" & TOPX & \" Values: \" & ValuesInColumn"
            ],
            "lineageTag": "0c23f38f-b809-4be8-8999-5f88570fc465"
          },
          {
            "name": "Sales WTD2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "expression": [
              "",
              "VAR CurrentWeekStartDate = MAX ( Calendar[Week Start Date with Year] )",
              "VAR CurrentDate = MAX ( Calendar[Date] )",
              "RETURN",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL ( Calendar[Date] ),",
              "            Calendar[Date] >= CurrentWeekStartDate",
              "                && Calendar[Date] <= CurrentDate",
              "        )",
              "    )"
            ],
            "lineageTag": "dc672d9c-1487-4993-8498-68d2cd2660ea"
          },
          {
            "name": "Sales YTD Offset",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL ( Dates_EDNA),",
              "            Dates_EDNA[CurrYearOffset]=MAX(Dates_EDNA[CurrYearOffset])&&  //per year",
              "            Dates_EDNA[CurrDayOffset] <= max(Dates_EDNA[CurrDayOffset])&& //= daily to date per year",
              "            //Dates_EDNA[CurrQuarterOffset]=MAX(Dates_EDNA[CurrQuarterOffset])&&   //this would give you QTD instead",
              "            //Dates_EDNA[CurrMonthOffset]=MAX(Dates_EDNA[CurrMonthOffset])&&   //this would give you MTD instead",
              "            Dates_EDNA[IsAfterToday]=FALSE()",
              "        )",
              "           ",
              "    )",
              ""
            ],
            "lineageTag": "2f62515c-26c7-4b57-92fc-36d5ec20b9ec"
          },
          {
            "name": "Sales WTD3 (GD)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "--Greg Deckler style",
              "VAR CurrentWeekStartDate = MAX ( Calendar[Week Start Date with Year] )",
              "VAR CurrentDate = MAX ( Calendar[Date] )",
              "VAR __table=",
              "        FILTER (",
              "            ALL ( Calendar[Date] ),",
              "            Calendar[Date] >= CurrentWeekStartDate",
              "                && Calendar[Date] <= CurrentDate",
              "        )",
              "VAR __result=SUMX(__table,[Total Sales])",
              "RETURN",
              "__result"
            ],
            "lineageTag": "66ab1533-e045-4c04-af45-c61f7cb9602a"
          },
          {
            "name": "Sales YTD5 (GD)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "--Greg Deckler style",
              "VAR CurrentYear = MAX ( 'Date 👍'[CalendarYear] ) //frame",
              "VAR CurrentDate = MAX ( 'Date 👍'[Date] )",
              "VAR __table=",
              "        FILTER (",
              "            ALL ( 'Date 👍' ),",
              "            'Date 👍'[CalendarYear] = CurrentYear",
              "                && 'Date 👍'[Date] <= CurrentDate",
              "        )",
              "VAR __result=SUMX(__table,[Total Sales])",
              "RETURN",
              "__result"
            ],
            "lineageTag": "538b88ff-f929-48ec-85db-d60201a4bb94"
          },
          {
            "name": "Sales MTD2 (GD)",
            "expression": [
              "",
              "--Greg Deckler style",
              "VAR CurrentMonth = MAX ( 'Date 👍'[MMMYYYY] ) ",
              "VAR CurrentDate = MAX ( 'Date 👍'[Date] )",
              "VAR __table=",
              "        FILTER (",
              "            ALL ( 'Date 👍' ),",
              "            'Date 👍'[MMMYYYY] = CurrentMonth",
              "                && 'Date 👍'[Date] <= CurrentDate",
              "        )",
              "VAR __result=SUMX(__table,[Total Sales])",
              "RETURN",
              "IF(ISINSCOPE('Date 👍'[Date]),__result) // so only shows at [Date] level"
            ],
            "formatString": "0",
            "lineageTag": "d221a0ca-5d8e-4f0a-9e6f-b29de44c7a3f"
          }
        ],
        "partitions": [
          {
            "name": "All ToDate Measures-c4b4fddb-7ba8-43a2-9415-f8df336bdc27",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type text) meta [Serialized.Text = true]) in type table [Column1 = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Column1\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Y axis",
        "columns": [
          {
            "name": "Sort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "16971a2f-cf7d-482b-ac09-b06bd31a4c3d",
            "sourceColumn": "[Sort]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "yMeasure",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "355173b3-90ca-4d61-b125-b9a6ffd15a31",
            "sourceColumn": "[yMeasure]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "a904301f-8218-498d-b418-e5de0f4e6e6c",
        "partitions": [
          {
            "name": "Y axis-8b4df23d-3e50-4f1e-b475-0b302d0609d0",
            "mode": "import",
            "source": {
              "expression": [
                "DATATABLE (",
                "    \"yMeasure\", STRING,",
                "    \"Sort\", INTEGER,",
                "    {",
                "        { \"Sales\", 1 },",
                "        { \"Costs\", 2 },",
                "        { \"Profit\", 3 }",
                "    }",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "X axis",
        "columns": [
          {
            "name": "Sort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "7152a368-f265-4a8f-ba7c-3f901447d6cf",
            "sourceColumn": "[Sort]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "xMeasure",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1d51f6c9-8d83-4ad9-9704-a358f8b81b11",
            "sortByColumn": "Sort",
            "sourceColumn": "[xMeasure]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "41b3f6af-52a4-47f8-97d8-33e594195c02",
        "partitions": [
          {
            "name": "X axis-b93b796a-2753-42a9-ba7b-521933a17167",
            "mode": "import",
            "source": {
              "expression": [
                "DATATABLE (",
                "    \"xMeasure\", STRING,",
                "    \"Sort\", INTEGER //table definition",
                "    ,",
                "    {",
                "        //now the rows",
                "        { \"This Month\", 1 },",
                "        { \"QTD\", 2 },",
                "        { \"YTD\", 3 }",
                "    }",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "All Last (Previous) Measures",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "lineageTag": "c9136d74-9352-45fe-86fd-66b10e351e23",
        "measures": [
          {
            "name": "Total Sales PM",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATEADD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        MONTH",
              "    )",
              ")"
            ],
            "expression": [
              "",
              "//HASONEVALUE removes strange hierarchical totals",
              "IF(",
              "    HASONEVALUE('Date 👍'[MMMYYYY]),",
              "CALCULATE (",
              "    [Total Sales],",
              "    DATEADD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        MONTH",
              "    )",
              ")",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "048c8049-ff1b-4cbc-9835-2d68ca585dc6"
          },
          {
            "name": "Total Sales PY",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATEADD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        YEAR",
              "    )",
              ")",
              "//year/quarter/month",
              "//slices contextually - eg add QYYYY after CalendarYear in the table or Date after MMMYYYY",
              "//For leap year issues see - https://radacad.com/same-period-last-year-to-date-dax-calculation-in-power-bi"
            ],
            "expression": [
              "",
              "CALCULATE (",
              "    [Total Sales],",
              "    DATEADD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        YEAR",
              "    )",
              ")",
              "//year/quarter/month",
              "//slices contextually - eg add QYYYY after CalendarYear in the table or Date after MMMYYYY",
              "//For leap year issues see - https://radacad.com/same-period-last-year-to-date-dax-calculation-in-power-bi"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "lineageTag": "fb78d921-39b6-4944-afcf-9ca4764bcbd0"
          },
          {
            "name": "Total Sales PY v2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    SAMEPERIODLASTYEAR ( 'Date 👍'[Date] )",
              ")",
              "//slices contextually - eg add QYYYY after CalendarYear in the table or Date after MMMYYYY"
            ],
            "expression": [
              "",
              "//SAMEPERIODLASTYEAR works at any level in a date hierarchy :)",
              "IF(",
              "    ISFILTERED('Date 👍'), //removes irrelevant total",
              "    CALCULATE(",
              "        CALCULATE (",
              "            [Total Sales],",
              "            SAMEPERIODLASTYEAR ( 'Date 👍'[Date] ) // this may be slower, particularly if using DirectQuery",
              "            //,'Date 👍'[Sales Check] // this does not work. needs to be an outer calculate",
              "        ),",
              "    'Date 👍'[Sales Check] //removes future rows with no sales in that month yet",
              "    )",
              ")",
              "//slices contextually - eg add QYYYY after CalendarYear in the table or Date after MMMYYYY)"
            ],
            "lineageTag": "0a0ed02a-0fbf-4828-bc2e-04d481e4f8c6"
          },
          {
            "name": "Total Sales PYTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales PY],",
              "    DATESYTD ( 'Date 👍'[Date] )",
              ")",
              "//slices contextually - eg add QYYYY after CalendarYear in the table"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales PY],",
              "    DATESYTD ( 'Date 👍'[Date] )",
              ")",
              "//slices contextually - eg add QYYYY after CalendarYear in the table"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "d05b1258-1bce-40b2-8732-ee37014443f1"
          },
          {
            "name": "Total Sales just LW",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'Calendar' ),",
              "    'Calendar'[WeekIndex] = -1",
              ")",
              "// nb data here is around 600 weeks old"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'Calendar' ),",
              "    'Calendar'[WeekIndex] = -1",
              ")",
              "// nb data here is around 600 weeks old"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "b0dde970-8f12-47db-8bf5-16c837e0c0b7"
          },
          {
            "name": "Total Sales just L4W",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'Calendar' ),",
              "    AND (",
              "        'Calendar'[WeekIndex] <= -1,",
              "        'Calendar'[WeekIndex] >= -4",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'Calendar' ),",
              "    AND (",
              "        'Calendar'[WeekIndex] <= -1,",
              "        'Calendar'[WeekIndex] >= -4",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "e08e6033-55fb-4158-b82b-387bb86d1d89"
          },
          {
            "name": "Total Sales just LY only",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    'Calendar'[YearIndex] = -1",
              ")",
              "// try -13 just to show (ie not the same as PREVIOUS... which works across all periods)"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    'Calendar'[YearIndex] = -1",
              ")",
              "// try -13 just to show (ie not the same as PREVIOUS... which works across all periods)"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "40daf032-ea11-46c0-91e6-2767d33384cf"
          },
          {
            "name": "Total Sales just L4W 4W Ago",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'Calendar' ),",
              "    AND (",
              "        'Calendar'[WeekIndex] <= -5,",
              "        'Calendar'[WeekIndex] >= -9",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'Calendar' ),",
              "    AND (",
              "        'Calendar'[WeekIndex] <= -5,",
              "        'Calendar'[WeekIndex] >= -9",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "1d1174f5-9236-41b0-9b43-6732693dc95a"
          },
          {
            "name": "Total Sales last 14 days only",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    // any measure",
              "    FILTER (",
              "        ALL ( 'Calendar' ),",
              "        'Calendar'[DayIndex]",
              "            <= MAX ( 'Calendar'[DayIndex] )",
              "            && 'Calendar'[DayIndex]",
              "                > MAX ( 'Calendar'[DayIndex] ) - 14",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    // any measure",
              "    FILTER (",
              "        ALL ( 'Calendar' ),",
              "        'Calendar'[DayIndex]",
              "            <= MAX ( 'Calendar'[DayIndex] )",
              "            && 'Calendar'[DayIndex]",
              "                > MAX ( 'Calendar'[DayIndex] ) - 14",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "67a5ce54-fcf1-41bc-b81b-1cd921b62cc9"
          },
          {
            "name": "Total Sales just LW 1 Year ago",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'Calendar' ),",
              "    'Calendar'[WeekIndex] = -53",
              ")",
              "// nb data here is around 600 weeks old"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'Calendar' ),",
              "    'Calendar'[WeekIndex] = -53",
              ")",
              "// nb data here is around 600 weeks old"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "2f261732-2ec6-43d0-a53d-c10cfdd3d6bd"
          },
          {
            "name": "Total Sales PM v2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    PREVIOUSMONTH ( 'Date 👍'[Date] )",
              ")",
              "//add Date as column after MMMYYYY and this returns TOTAL of previousmonth"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    PREVIOUSMONTH ( 'Date 👍'[Date] )",
              ")",
              "//add Date as column after MMMYYYY and this returns TOTAL of previousmonth"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "2b9cef1c-2110-4b0b-bb5c-e6a65c4f2e90"
          },
          {
            "name": "Total Sales LW",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    //this",
              "    FILTER (",
              "        ALL ( 'Calendar' ),",
              "        //(nb custom date calendar)",
              "        'Calendar'[Year]",
              "            = MAX ( 'Calendar'[Year] ) //by Year",
              "            && 'Calendar'[WeekNum]",
              "                = MAX ( 'Calendar'[WeekNum] ) - 1 //and current WeekNum -1",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    //this",
              "    FILTER (",
              "        ALL ( 'Calendar' ),",
              "        //(nb custom date calendar)",
              "        'Calendar'[Year]",
              "            = MAX ( 'Calendar'[Year] ) //by Year",
              "            && 'Calendar'[WeekNum]",
              "                = MAX ( 'Calendar'[WeekNum] ) - 1 //and current WeekNum -1",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "f97b2ad2-2e30-44f2-a8b6-1c906c6cb8d9"
          },
          {
            "name": "Total Sales PY v3",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    PARALLELPERIOD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        YEAR",
              "    )",
              ")",
              "//year, month or quarter",
              "//does NOT slice contextually - eg add QYYYY after CalendarYear in the table - get duplicates"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    PARALLELPERIOD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        YEAR",
              "    )",
              ")",
              "//year, month or quarter",
              "//does NOT slice contextually - eg add QYYYY after CalendarYear in the table - get duplicates"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "3cf1e9bb-faf1-4783-80a2-794eedbe8a2f"
          },
          {
            "name": "Total Sales PY v4",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    PREVIOUSYEAR ( 'Date 👍'[Date] )",
              ")",
              "//previousday, previousmonth, previousquarter, previousyear",
              "//does NOT slice contextually - eg add QYYYY after CalendarYear in the table - get duplicates"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    PREVIOUSYEAR ( 'Date 👍'[Date] )",
              ")",
              "//previousday, previousmonth, previousquarter, previousyear",
              "//does NOT slice contextually - eg add QYYYY after CalendarYear in the table - get duplicates"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "d4586629-d312-4fcf-a032-25e1076ba99d"
          },
          {
            "name": "Total Sales PY v5",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALL ( 'Date 👍'[CalendarYear] ),",
              "        MAX ( 'Date 👍'[CalendarYear] ) - 1 = 'Date 👍'[CalendarYear] //-1 for previous",
              "        //treat MAX as 'the current row'",
              "    )",
              ")",
              "//does NOT slice contextually - eg add QYYYY after CalendarYear in the table - get blank"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALL ( 'Date 👍'[CalendarYear] ),",
              "        MAX ( 'Date 👍'[CalendarYear] ) - 1 = 'Date 👍'[CalendarYear] //-1 for previous",
              "        //treat MAX as 'the current row'",
              "    )",
              ")",
              "//does NOT slice contextually - eg add QYYYY after CalendarYear in the table - get blank"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "c498e3bf-e08a-491c-9c10-a84277cc719b"
          },
          {
            "name": "Total Sales LW TreatAs",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "// get WeekIndex for current row",
              "VAR _pw =",
              "    SELECTEDVALUE ( Calendar_Current[WeekIndex] )",
              "RETURN",
              "    CALCULATE (",
              "        // calculate this",
              "        InternetSales_Current[IS_Current Total Sales],",
              "        // on the basis of this",
              "        ALL ( Calendar_Current ),",
              "        // for this",
              "        TREATAS (",
              "            {",
              "                _pw - 1",
              "            },",
              "            Calendar_Current[WeekIndex]",
              "        ) // get 1 previous compared to current row",
              "    )"
            ],
            "expression": [
              "// get WeekIndex for current row",
              "VAR _pw =",
              "    SELECTEDVALUE ( Calendar_Current[WeekIndex] )",
              "RETURN",
              "    CALCULATE (",
              "        // calculate this",
              "        InternetSales_Current[IS_Current Total Sales],",
              "        // on the basis of this",
              "        ALL ( Calendar_Current ),",
              "        // for this",
              "        TREATAS (",
              "            {",
              "                _pw - 1",
              "            },",
              "            Calendar_Current[WeekIndex]",
              "        ) // get 1 previous compared to current row",
              "    )"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "cfaec2bb-fbe5-41b6-94f5-f9789b5a5244"
          },
          {
            "name": "Total Sales L4W TreatAs",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "// get WeekIndex for current row",
              "VAR _pw =",
              "    SELECTEDVALUE ( Calendar_Current[WeekIndex] )",
              "RETURN",
              "    CALCULATE (",
              "        InternetSales_Current[IS_Current Total Sales],",
              "        ALL ( Calendar_Current ),",
              "        TREATAS (",
              "            {",
              "                _pw - 1,",
              "                _pw - 2,",
              "                _pw - 3,",
              "                _pw - 4",
              "            },",
              "            Calendar_Current[WeekIndex]",
              "        )",
              "    )",
              "// go back 1 to 4, not counting 0 (=current week)"
            ],
            "expression": [
              "// get WeekIndex for current row",
              "VAR _pw =",
              "    SELECTEDVALUE ( Calendar_Current[WeekIndex] )",
              "RETURN",
              "    CALCULATE (",
              "        InternetSales_Current[IS_Current Total Sales],",
              "        ALL ( Calendar_Current ),",
              "        TREATAS (",
              "            {",
              "                _pw - 1,",
              "                _pw - 2,",
              "                _pw - 3,",
              "                _pw - 4",
              "            },",
              "            Calendar_Current[WeekIndex]",
              "        )",
              "    )",
              "// go back 1 to 4, not counting 0 (=current week)"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "178dd9c8-0a56-426f-92f1-e40eaf6742ba"
          },
          {
            "name": "Total Sales L4W",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//note - uses Calendar_Current",
              "CALCULATE (",
              "    [IS_Current Total Sales],",
              "    FILTER (",
              "        ALL ( 'Calendar_Current' ),",
              "        //nb deducts 1 through 4 from current row's WeekIndex",
              "        //max is required so can do calculation against a single value",
              "        'Calendar_Current'[WeekIndex]",
              "            = MAX ( Calendar_Current[WeekIndex] ) - 1",
              "            || 'Calendar_Current'[WeekIndex]",
              "                = MAX ( Calendar_Current[WeekIndex] ) - 2",
              "            || 'Calendar_Current'[WeekIndex]",
              "                = MAX ( Calendar_Current[WeekIndex] ) - 3",
              "            || 'Calendar_Current'[WeekIndex]",
              "                = MAX ( Calendar_Current[WeekIndex] ) - 4",
              "    )",
              ")"
            ],
            "expression": [
              "//note - uses Calendar_Current",
              "CALCULATE (",
              "    [IS_Current Total Sales],",
              "    FILTER (",
              "        ALL ( 'Calendar_Current' ),",
              "        //nb deducts 1 through 4 from current row's WeekIndex",
              "        //max is required so can do calculation against a single value",
              "        'Calendar_Current'[WeekIndex]",
              "            = MAX ( Calendar_Current[WeekIndex] ) - 1",
              "            || 'Calendar_Current'[WeekIndex]",
              "                = MAX ( Calendar_Current[WeekIndex] ) - 2",
              "            || 'Calendar_Current'[WeekIndex]",
              "                = MAX ( Calendar_Current[WeekIndex] ) - 3",
              "            || 'Calendar_Current'[WeekIndex]",
              "                = MAX ( Calendar_Current[WeekIndex] ) - 4",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "7ef130c1-c7bc-4193-876a-20bbec8cfa54"
          },
          {
            "name": "Last 12M (365D) Rolling Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -1,",
              "        YEAR",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -1,",
              "        YEAR",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "cf708f81-0218-4a47-a8d1-0f587f043a91"
          },
          {
            "name": "X Measure PY DATEHELPER dateadd",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [DateFilterHELPER],",
              "    DATEADD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        YEAR",
              "    )",
              ")",
              "--just replaced [whatever measure] with [DateFilterHELPER]"
            ],
            "expression": [
              "CALCULATE (",
              "    [DateFilterHELPER],",
              "    DATEADD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        YEAR",
              "    )",
              ")",
              "--just replaced [whatever measure] with [DateFilterHELPER]"
            ],
            "lineageTag": "8178fbcc-644d-475d-b5cd-a8003f9330f6"
          },
          {
            "name": "X Measure PY DATEHELPER sameperiodlastyear",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [DateFilterHELPER],",
              "    SAMEPERIODLASTYEAR ( 'Date 👍'[Date] )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [DateFilterHELPER],",
              "    SAMEPERIODLASTYEAR ( 'Date 👍'[Date] )",
              ")"
            ],
            "lineageTag": "88bbc656-3b33-4f46-b121-c7853bdf0a3e"
          },
          {
            "name": "X Measure PY DATEHELPER parallelperiod",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [DateFilterHELPER],",
              "    PARALLELPERIOD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        YEAR",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [DateFilterHELPER],",
              "    PARALLELPERIOD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        YEAR",
              "    )",
              ")"
            ],
            "lineageTag": "87e4375b-d466-4647-8179-061ee5a236cf"
          },
          {
            "name": "X Measure PY DATEHELPER previousyear",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [DateFilterHELPER],",
              "    PREVIOUSYEAR ( 'Date 👍'[Date] )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [DateFilterHELPER],",
              "    PREVIOUSYEAR ( 'Date 👍'[Date] )",
              ")"
            ],
            "lineageTag": "d8b52972-3fdc-4345-a981-90e056d02a04"
          },
          {
            "name": "X Measure PY DATEHELPER filter",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [DateFilterHELPER],",
              "    FILTER (",
              "        ALL ( 'Date 👍'[CalendarYear] ),",
              "        MAX ( 'Date 👍'[CalendarYear] ) - 1 = 'Date 👍'[CalendarYear] //-1 for previous",
              "        //treat MAX as 'the current row'",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [DateFilterHELPER],",
              "    FILTER (",
              "        ALL ( 'Date 👍'[CalendarYear] ),",
              "        MAX ( 'Date 👍'[CalendarYear] ) - 1 = 'Date 👍'[CalendarYear] //-1 for previous",
              "        //treat MAX as 'the current row'",
              "    )",
              ")"
            ],
            "lineageTag": "850afcce-c541-4db0-a729-3932f269369b"
          },
          {
            "name": "Total Sales PY Offset",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR offsetprev =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrYearOffset] ) - 1 //simple :)",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL ( Dates_EDNA ),",
              "            Dates_EDNA[CurrYearOffset] = offsetprev",
              "        )",
              "    )",
              "RETURN",
              "    result"
            ],
            "expression": [
              "VAR offsetprev =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrYearOffset] ) - 1 //simple :) ie 1 period ago. (Number could be parametised)",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL ( Dates_EDNA ),",
              "            Dates_EDNA[CurrYearOffset] = offsetprev         //ie year level",
              "        )",
              "    )",
              "RETURN",
              "    result"
            ],
            "lineageTag": "02ee2e2b-6cc1-450f-ab4f-4feb0ee7569e"
          },
          {
            "name": "Total Sales PY edna",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATEADD (",
              "        Dates_EDNA[Date],",
              "        -1,",
              "        YEAR",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATEADD (",
              "        Dates_EDNA[Date],",
              "        -1,",
              "        YEAR",
              "    )",
              ")"
            ],
            "lineageTag": "1a069c62-10a9-4df4-a686-2d5fc7e42e88"
          },
          {
            "name": "Total Sales PM edna",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATEADD (",
              "        Dates_EDNA[Date],",
              "        -1,",
              "        MONTH",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATEADD (",
              "        Dates_EDNA[Date],",
              "        -1,",
              "        MONTH",
              "    )",
              ")"
            ],
            "lineageTag": "8ea23542-e12f-457b-a52e-3a6e1aa93bf8"
          },
          {
            "name": "Total Sales PM Offset",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR offsetprev =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrMonthOffset] ) - 1",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL ( Dates_EDNA ),",
              "            Dates_EDNA[CurrMonthOffset] = offsetprev",
              "        )",
              "    )",
              "RETURN",
              "    result"
            ],
            "expression": [
              "",
              "VAR offsetprev =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrMonthOffset] ) - 1       //1 month ago  (number can be paramteised)",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL ( Dates_EDNA ),",
              "            Dates_EDNA[CurrMonthOffset] = offsetprev    //ie month level    nb get a running total if change to <=",
              "        )",
              "    )",
              "RETURN",
              "    result"
            ],
            "lineageTag": "defab94c-2ed3-488f-8063-660ff769be56"
          },
          {
            "name": "Sales TD by period ('Quarter' level) offset (previous)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//ie running total per quarter per period (next level up in the hierarchy)",
              "VAR offsetquarter =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrQuarterOffset] ) - 1 //simple :)",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL (",
              "                Dates_EDNA[CurrQuarterOffset],",
              "                Dates_EDNA[IsAfterToday]",
              "            ),",
              "            Dates_EDNA[CurrQuarterOffset] <= offsetquarter",
              "                && Dates_EDNA[IsAfterToday]",
              "                    = FALSE ()",
              "        ),",
              "        // the following is the level that you are slicing down to. (Q)",
              "        REMOVEFILTERS (",
              "            Dates_EDNA[Quarter],",
              "            Dates_EDNA[Quarter Number]",
              "        )",
              "    )",
              "RETURN",
              "    result"
            ],
            "expression": [
              "//ie running total per quarter per period (next level up in the hierarchy)",
              "VAR offsetquarter =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrQuarterOffset] ) - 1 //simple :)",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL (",
              "                Dates_EDNA[CurrQuarterOffset],",
              "                Dates_EDNA[IsAfterToday]",
              "            ),",
              "            Dates_EDNA[CurrQuarterOffset] <= offsetquarter",
              "                && Dates_EDNA[IsAfterToday]",
              "                    = FALSE ()",
              "        ),",
              "        // the following is the level that you are slicing down to. (Q)",
              "        REMOVEFILTERS (",
              "            Dates_EDNA[Quarter],",
              "            Dates_EDNA[Quarter Number]",
              "        )",
              "    )",
              "RETURN",
              "    result"
            ],
            "lineageTag": "ac2b9346-74fd-4e5e-b671-30b858ab3c6c"
          },
          {
            "name": "Total Sales PM offset (-1 MMMYYYY)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    OFFSET (",
              "        // as yet UNDOCUMENTED as of 9/2022 !!!",
              "        //NB If you have a hierachy CY->MMMYYYY ",
              "        //then OFFSET does NOT carry December(previous year) ",
              "        //into January(current year)  :(",
              "        //But works fine with just MMMYYYY   :)",
              "        -1, // 1 ago",
              "        ALLSELECTED (",
              "            'Date 👍'[MMMYYYY],",
              "            'Date 👍'[MMMYYYY sort] //MUST include the sort by column",
              "        ),",
              "        ORDERBY ( 'Date 👍'[MMMYYYY sort], ASC )",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    OFFSET (",
              "        // as yet UNDOCUMENTED as of 9/2022 !!!",
              "        //NB If you have a hierachy CY->MMMYYYY ",
              "        //then OFFSET does NOT carry December(previous year) ",
              "        //into January(current year)  :(",
              "        //But works fine with just MMMYYYY   :)",
              "        -1, // 1 ago",
              "        ALLSELECTED (",
              "            'Date 👍'[MMMYYYY],",
              "            'Date 👍'[MMMYYYY sort] //MUST include the sort by column",
              "        ),",
              "        ORDERBY ( 'Date 👍'[MMMYYYY sort], ASC )",
              "    )",
              ")"
            ],
            "lineageTag": "7d0d1f63-53c3-47de-848f-51b0bfe1600c"
          },
          {
            "name": "Total Sales PM offset (Curr - Prev) (-1 MMMYYYY)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "[Total Sales]",
              "    - CALCULATE (",
              "        [Total Sales],",
              "        OFFSET (",
              "            -1,",
              "            SUMMARIZE (",
              "                ALLSELECTED ( 'InternetSales 😀' ),",
              "                'Date 👍'[MMMYYYY],",
              "                'Date 👍'[MMMYYYY sort]",
              "            ),",
              "            //table to iterate over",
              "            ORDERBY ( 'Date 👍'[MMMYYYY sort] ) //,KEEP, // can't be anything else for now",
              "            //PARTITIONBY(<group column>)",
              "        )",
              "    )"
            ],
            "expression": [
              "[Total Sales]",
              "    - CALCULATE (",
              "        [Total Sales],",
              "        OFFSET (",
              "            -1,",
              "            SUMMARIZE (",
              "                ALLSELECTED ( 'InternetSales 😀' ),",
              "                'Date 👍'[MMMYYYY],",
              "                'Date 👍'[MMMYYYY sort]",
              "            ),",
              "            //table to iterate over",
              "            ORDERBY ( 'Date 👍'[MMMYYYY sort] ) //,KEEP, // can't be anything else for now",
              "            //PARTITIONBY(<group column>)",
              "        )",
              "    )"
            ],
            "lineageTag": "d4c65d3e-fda7-4411-ac31-a0f31a2091fd"
          },
          {
            "name": "Total Sales PY v2 (month level only)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "expression": [
              "",
              "//can be adapted to any level using the relevant offset column and number ago",
              "",
              "//compare this to PY v2 which uses SAMEPERIODLASTYEAR",
              "var __currentmonth=MAX('Date 👍'[MonthsFromNow]) //offset column",
              "RETURN",
              "IF(HASONEVALUE('Date 👍'[MMMYYYY sort]), //removes irrelevant total",
              "    CALCULATE(",
              "        [Total Sales],",
              "        REMOVEFILTERS('Date 👍'), //remove all date filters but keep the following ....",
              "        'Date 👍'[MonthsFromNow]=__currentmonth - 12   //12 months ago",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "lineageTag": "e0db5fff-9ced-4a42-8b10-15b40542abc9"
          },
          {
            "name": "Total Quantity change PM",
            "expression": [
              "",
              "",
              "// *** see DAX in the DYNAMIC format",
              "",
              "if( //only calculate if there is a previous value",
              "    NOT(ISBLANK(CALCULATE (",
              "    [Total Quantity],",
              "    DATEADD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        MONTH",
              "    ))))",
              "    &&",
              "    NOT(HASONEVALUE('Date 👍'[Date])) && //does not make sense to calculate at day level",
              "    HASONEVALUE('Date 👍'[MMMYYYY]), //so only calculates at month level (not Q or Y)",
              "    //then calculate ....",
              "[Total Quantity]-",
              "CALCULATE (",
              "    [Total Quantity],",
              "    DATEADD (",
              "        'Date 👍'[Date],",
              "        -1,",
              "        MONTH",
              "    )",
              ")",
              ")"
            ],
            "formatStringDefinition": {
              "expression": [
                "//\"✔️ 0 Units ; ❌ 0 Units\"",
                "// or ...",
                "var __up=unichar(9652) --up",
                "var __down=UNICHAR(9662) --down",
                "var __trend=if([Total Quantity change PM]>=0,__up,__down)",
                "var __formatstring=__trend & \"0 Units\"",
                "return ",
                "__formatstring & \";\" & __formatstring"
              ]
            },
            "lineageTag": "ec2a0246-b1b0-4b99-a0ef-7c2dcfde525a"
          },
          {
            "name": "Total Sales PM Offset (param)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "VAR offsetprev =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrMonthOffset] ) - Pick1to12[Pick1to12 Value]      // .... ago  (parametised)",
              "VAR result =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        FILTER (",
              "            ALL ( Dates_EDNA ),",
              "            Dates_EDNA[CurrMonthOffset] = offsetprev    //nb get a running total if change to <=",
              "        )",
              "    )",
              "RETURN",
              "    result"
            ],
            "lineageTag": "aecbff89-5467-4d47-b3fe-36725e9319ab"
          },
          {
            "name": "Total Sales PM GD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "//slices by just MMMYYYY (test by adding a hierarchy of Y > MMMYYYY",
              "var __MMMYYYYsort=MAX('Date 👍'[MMMYYYY sort]) //sort criteria (as [MMMYYYY] incorrectly sorts",
              "var __table=ALL('Date 👍'[MMMYYYY],'Date 👍'[MMMYYYY sort]) //sort table",
              "var __previousdate=",
              "MAXX(",
              "    FILTER(",
              "        __table,",
              "        'Date 👍'[MMMYYYY sort]<__MMMYYYYsort // ie MAXX will return the previous 1",
              "        ),",
              "    'Date 👍'[MMMYYYY sort]",
              ")",
              "var __previousvalue=",
              "SUMX(",
              "    FILTER(",
              "        __table,",
              "        'Date 👍'[MMMYYYY sort]=__previousdate",
              "    ),",
              "    [Total Sales]",
              ")",
              "RETURN",
              "//HASONEVALUE removes strange hierarchical totals",
              "IF(HASONEVALUE('Date 👍'[MMMYYYY]),__previousvalue) "
            ],
            "lineageTag": "f1f83136-c369-487a-bd8d-ce114cf35f6b"
          },
          {
            "name": "Total Sales PY GD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "var __Y=MAX('Date 👍'[CalendarYear])",
              "var __table=ALL('Date 👍'[CalendarYear])",
              "var __previousdate=",
              "MAXX(",
              "    FILTER(",
              "        __table,",
              "        'Date 👍'[CalendarYear]<__Y",
              "        ),",
              "    'Date 👍'[CalendarYear]",
              ")",
              "var __previousvalue=",
              "SUMX(",
              "    FILTER(",
              "        __table,",
              "        'Date 👍'[CalendarYear]=__previousdate",
              "    ),",
              "    [Total Sales]",
              ")",
              "RETURN",
              "__previousvalue"
            ],
            "lineageTag": "ed53a582-5e8a-44de-81db-aa8b58bf60b0"
          }
        ],
        "partitions": [
          {
            "name": "All Last (Previous) Measures-1bac3d6b-61aa-4996-91b8-39b2898c53cf",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type text) meta [Serialized.Text = true]) in type table [Column1 = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Column1\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "All Running Measures",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "lineageTag": "60ff9154-8f84-449f-a24f-d158c6b9e786",
        "measures": [
          {
            "name": "Running Total Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALLSELECTED ( 'Date 👍' ) //as opposed to just ALL so can slice eg by MMMYYYY",
              "        ,",
              "        'Date 👍'[Date]",
              "            <= MAX ( 'Date 👍'[Date] ) //running total over date",
              "            // treat MAX as the current row",
              "    )",
              ")",
              "//slices contextually by anything in the date hierarchy"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALLSELECTED ( 'Date 👍' ) //as opposed to just ALL so can slice eg by MMMYYYY",
              "        ,",
              "        'Date 👍'[Date]",
              "            <= MAX ( 'Date 👍'[Date] ) //running total over date",
              "            // treat MAX as the current row",
              "    )",
              ")",
              "//slices contextually by anything in the date hierarchy"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "b6dd110a-6fe4-48b9-8267-b63cf489803b"
          },
          {
            "name": "30 Day Running Total Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALL ( 'Date 👍' ),",
              "        'Date 👍'[Date]",
              "            > MAX ( 'Date 👍'[Date] ) - 30",
              "            && //must be MAX (not LASTDATE)",
              "            'Date 👍'[Date]",
              "                <= MAX ( 'Date 👍'[Date] )",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALL ( 'Date 👍' ),",
              "        'Date 👍'[Date]",
              "            > MAX ( 'Date 👍'[Date] ) - 30",
              "            && //must be MAX (not LASTDATE)",
              "            'Date 👍'[Date]",
              "                <= MAX ( 'Date 👍'[Date] )",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "3a2248f9-1575-4302-b053-fa12c5df9397"
          },
          {
            "name": "30 Day Running Total Salesv2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        //reference column",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        //like Max to get the current row - either will work",
              "        -30,",
              "        // 30 days backwards",
              "        DAY",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        //reference column",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        //like Max to get the current row - either will work",
              "        -30,",
              "        // 30 days backwards",
              "        DAY",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "6aac8797-db33-41b1-9a07-5e6e6e65782e"
          },
          {
            "name": "Running Total over Category",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALLSELECTED ( 'ProductCategory 😀' ),",
              "        'ProductCategory 😀'[ProductCategoryName]",
              "            <= MAX ( 'ProductCategory 😀'[ProductCategoryName] ) //is the same logic as dates",
              "            //running total over catgeory",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALLSELECTED ( 'ProductCategory 😀' ),",
              "        'ProductCategory 😀'[ProductCategoryName]",
              "            <= MAX ( 'ProductCategory 😀'[ProductCategoryName] ) //is the same logic as dates",
              "            //running total over catgeory",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "1059cb59-d1b4-498f-9b76-19132e3c607c"
          },
          {
            "name": "Running Total over Category and Subcategory",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    //removes subcategories with no sales from the list else get duplicate running total value on lines with no sales",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    CALCULATE (",
              "        [Total Sales],",
              "        //criteria 1 -SubCategoryName",
              "        FILTER (",
              "            ALL ( 'ProductSubCategory' ),",
              "            ProductSubCategory[ProductSubCategoryName]",
              "                <= MAX ( ProductSubCategory[ProductSubCategoryName] ) //nb <=. running total over subcategory",
              "        ) //criteria 2 -CategoryName",
              "        ,",
              "        FILTER (",
              "            ALL ( 'ProductCategory 😀' ),",
              "            'ProductCategory 😀'[ProductCategoryName]",
              "                = MAX ( 'ProductCategory 😀'[ProductCategoryName] ) //nb =. This gives a running total for each category",
              "        )",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    //removes subcategories with no sales from the list else get duplicate running total value on lines with no sales",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    CALCULATE (",
              "        [Total Sales],",
              "        //criteria 1 -SubCategoryName",
              "        FILTER (",
              "            ALL ( 'ProductSubCategory' ),",
              "            ProductSubCategory[ProductSubCategoryName]",
              "                <= MAX ( ProductSubCategory[ProductSubCategoryName] ) //nb <=. running total over subcategory",
              "        ) //criteria 2 -CategoryName",
              "        ,",
              "        FILTER (",
              "            ALL ( 'ProductCategory 😀' ),",
              "            'ProductCategory 😀'[ProductCategoryName]",
              "                = MAX ( 'ProductCategory 😀'[ProductCategoryName] ) //nb =. This gives a running total for each category",
              "        )",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "a276f54b-cc04-4c0e-9f41-38173eae7289"
          },
          {
            "name": "Running Total over Category v2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//useful for ratios",
              "CALCULATE (",
              "    [Total Sales],",
              "    //critria 1",
              "    FILTER (",
              "        ALL ( 'ProductCategory 😀' ),",
              "        'ProductCategory 😀'[ProductCategoryName]",
              "            <= MAX ( 'ProductCategory 😀'[ProductCategoryName] ) //running total over catgeory",
              "    ) //criteria 2    ",
              "    ,",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'ProductCategory 😀'[ProductCategoryName]",
              "    ) //no filters InternetSales except ProductCategoryName",
              ")",
              "//remove all filters except category ie show only by category eg do not slice by CalendarYear"
            ],
            "expression": [
              "//useful for ratios",
              "CALCULATE (",
              "    [Total Sales],",
              "    //critria 1",
              "    FILTER (",
              "        ALL ( 'ProductCategory 😀' ),",
              "        'ProductCategory 😀'[ProductCategoryName]",
              "            <= MAX ( 'ProductCategory 😀'[ProductCategoryName] ) //running total over catgeory",
              "    ) //criteria 2    ",
              "    ,",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'ProductCategory 😀'[ProductCategoryName]",
              "    ) //no filters InternetSales except ProductCategoryName",
              ")",
              "//remove all filters except category ie show only by category eg do not slice by CalendarYear"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "0d68eae6-ed38-4c4f-b891-da47c3ce1783"
          },
          {
            "name": "Running Total over Category v3",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//useful for ratios",
              "CALCULATE (",
              "    [Total Sales],",
              "    //citeria 1",
              "    //running total over category",
              "    FILTER (",
              "        ALL ( 'ProductCategory 😀' ),",
              "        'ProductCategory 😀'[ProductCategoryName]",
              "            <= MAX ( 'ProductCategory 😀'[ProductCategoryName] )",
              "    ) //criteria 2 ",
              "    //remove all filters except CategoryName and except anything from Date table   ",
              "    ,",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'ProductCategory 😀'[ProductCategoryName],",
              "        'Date 👍'",
              "    ) //experiment with the CalendarYear slicer",
              ")"
            ],
            "expression": [
              "//useful for ratios",
              "CALCULATE (",
              "    [Total Sales],",
              "    //citeria 1",
              "    //running total over category",
              "    FILTER (",
              "        ALL ( 'ProductCategory 😀' ),",
              "        'ProductCategory 😀'[ProductCategoryName]",
              "            <= MAX ( 'ProductCategory 😀'[ProductCategoryName] )",
              "    ) //criteria 2 ",
              "    //remove all filters except CategoryName and except anything from Date table   ",
              "    ,",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'ProductCategory 😀'[ProductCategoryName],",
              "        'Date 👍'",
              "    ) //experiment with the CalendarYear slicer",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "b88a4e23-c6d7-437c-a043-ccb0fa510035"
          },
          {
            "name": "Running Total Sales over MMMYYYY",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALLSELECTED ( 'Date 👍' ),",
              "        'Date 👍'[MMMYYYY sort]",
              "            <= MAX ( 'Date 👍'[MMMYYYY sort] ) //must pick the sort version to get a guaranteed order",
              "            // treat MAX as the current row",
              "    )",
              ")",
              "//slices contextually by anything in the date hierarchy"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALLSELECTED ( 'Date 👍' ),",
              "        'Date 👍'[MMMYYYY sort]",
              "            <= MAX ( 'Date 👍'[MMMYYYY sort] ) //must pick the sort version to get a guaranteed order",
              "            // treat MAX as the current row",
              "    )",
              ")",
              "//slices contextually by anything in the date hierarchy"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "7ffe6d40-96dd-4688-8d22-051e2db552c8"
          },
          {
            "name": "MaxDate testcalc",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": "MAX ( 'Date 👍'[Date] )",
            "expression": "MAX ( 'Date 👍'[Date] )",
            "formatString": "General Date",
            "lineageTag": "af36a2de-d61e-40bc-8717-525a4bf433cc"
          }
        ],
        "partitions": [
          {
            "name": "All Running Measures-cc20e43d-c72b-4e41-bdb6-4366ce6cb20e",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type text) meta [Serialized.Text = true]) in type table [Column1 = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Column1\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "All Average Measures",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "lineageTag": "d8934336-4c54-4971-bd52-9ace11840f54",
        "measures": [
          {
            "name": "30D Moving Average Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "AVERAGEX (",
              "    DATESINPERIOD (",
              "        //set of dates",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -30,",
              "        DAY",
              "    ),",
              "    [Total Sales] //over which to calculate average of total sales",
              ")"
            ],
            "expression": [
              "AVERAGEX (",
              "    DATESINPERIOD (",
              "        //set of dates",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -30,",
              "        DAY",
              "    ),",
              "    [Total Sales] //over which to calculate average of total sales",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "398fbce7-47b8-47ec-8c0b-59dc682a6d12"
          },
          {
            "name": "3M DAILY Moving Average Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "AVERAGEX (",
              "    DATESINPERIOD (",
              "        //set of dates",
              "        'Date 👍'[Date],",
              "        //DAILY",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -3,",
              "        MONTH",
              "    ),",
              "    [Total Sales] //over which to calculate average of total sales",
              ")"
            ],
            "expression": [
              "AVERAGEX (",
              "    DATESINPERIOD (",
              "        //set of dates",
              "        'Date 👍'[Date],",
              "        //DAILY",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -3,",
              "        MONTH",
              "    ),",
              "    [Total Sales] //over which to calculate average of total sales",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "84698035-b737-4911-bc52-1e58de5c0005"
          },
          {
            "name": "Average Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": "AVERAGE ( 'InternetSales 😀'[SalesAmount] )",
            "expression": "AVERAGE ( 'InternetSales 😀'[SalesAmount] )",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "77ace43b-752b-4f3e-943d-ef0a553f3a32"
          },
          {
            "name": "Dynamic DAILY Average Sales1",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "AVERAGEX (",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        - 'days average1'[days average1 Value],",
              "        //first slicer value",
              "        DAY",
              "    ),",
              "    [Total Sales]",
              ")"
            ],
            "expression": [
              "AVERAGEX (",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        - 'days average1'[days average1 Value],",
              "        //first slicer value",
              "        DAY",
              "    ),",
              "    [Total Sales]",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "1354597a-7601-4531-ac1a-36424a7245cb"
          },
          {
            "name": "Dynamic DAILY Average Sales2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "AVERAGEX (",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        - 'days average2'[days average2 Value],",
              "        //2nd slicer value",
              "        DAY",
              "    ),",
              "    [Total Sales]",
              ")"
            ],
            "expression": [
              "AVERAGEX (",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        - 'days average2'[days average2 Value],",
              "        //2nd slicer value",
              "        DAY",
              "    ),",
              "    [Total Sales]",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "46f8c4fb-630c-452b-8476-433e0a6b7d96"
          },
          {
            "name": "12M MONTHLY Moving Average Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR FirstDateInPeriod =",
              "    NEXTDAY (",
              "        SAMEPERIODLASTYEAR (",
              "            LASTDATE ( 'Date 👍'[Date] )",
              "        )",
              "    ) // first day of PERIOD,last year",
              "VAR LastDateInPeriod =",
              "    LASTDATE ( 'Date 👍'[Date] ) //end of current PERIOD",
              "RETURN",
              "    IF (",
              "        NOT (",
              "            ISBLANK ( FirstDateInPeriod )",
              "        ),",
              "        //only calculate if have PERIOD last year",
              "        DIVIDE (",
              "            CALCULATE (",
              "                //this data set",
              "                [Total Sales],",
              "                DATESBETWEEN (",
              "                    'Date 👍'[Date],",
              "                    FirstDateInPeriod,",
              "                    LastDateInPeriod",
              "                )",
              "            ),",
              "            12",
              "        ) //divide by 12",
              "        ,",
              "        BLANK () //else nothing",
              "    )"
            ],
            "expression": [
              "VAR FirstDateInPeriod =",
              "    NEXTDAY (",
              "        SAMEPERIODLASTYEAR (",
              "            LASTDATE ( 'Date 👍'[Date] )",
              "        )",
              "    ) // first day of PERIOD,last year",
              "VAR LastDateInPeriod =",
              "    LASTDATE ( 'Date 👍'[Date] ) //end of current PERIOD",
              "RETURN",
              "    IF (",
              "        NOT (",
              "            ISBLANK ( FirstDateInPeriod )",
              "        ),",
              "        //only calculate if have PERIOD last year",
              "        DIVIDE (",
              "            CALCULATE (",
              "                //this data set",
              "                [Total Sales],",
              "                DATESBETWEEN (",
              "                    'Date 👍'[Date],",
              "                    FirstDateInPeriod,",
              "                    LastDateInPeriod",
              "                )",
              "            ),",
              "            12",
              "        ) //divide by 12",
              "        ,",
              "        BLANK () //else nothing",
              "    )"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "d1b01287-58f7-4c96-a620-53f9256bad80"
          },
          {
            "name": "3M DAILY Moving Average Sales 1Y ago",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//IF(",
              "//   NOT(ISBLANK(SAMEPERIODLASTYEAR('Date'[Date]))) ,  //only calculate if have PERIOD last year",
              "CALCULATE (",
              "    [3M DAILY Moving Average Sales],",
              "    SAMEPERIODLASTYEAR ( 'Date 👍'[Date] )",
              ")",
              "//)",
              "//the If statement is designed so only calculates if there is a sameperiodlastyear",
              "//uncomment to see the initial straight line disappear",
              "//ie it only starts calculating when there is more than the first years worth of data"
            ],
            "expression": [
              "//IF(",
              "//   NOT(ISBLANK(SAMEPERIODLASTYEAR('Date'[Date]))) ,  //only calculate if have PERIOD last year",
              "CALCULATE (",
              "    [3M DAILY Moving Average Sales],",
              "    SAMEPERIODLASTYEAR ( 'Date 👍'[Date] )",
              ")",
              "//)",
              "//the If statement is designed so only calculates if there is a sameperiodlastyear",
              "//uncomment to see the initial straight line disappear",
              "//ie it only starts calculating when there is more than the first years worth of data"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "4a6d6b11-a188-4fd3-b163-f40e1d803f78"
          },
          {
            "name": "Average to ship time",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "AVERAGEX (",
              "    'InternetSales 😀',",
              "    DATEDIFF (",
              "        'InternetSales 😀'[OrderDate],",
              "        'InternetSales 😀'[ShipDate],",
              "        DAY",
              "    )",
              ")"
            ],
            "expression": [
              "AVERAGEX (",
              "    'InternetSales 😀',",
              "    DATEDIFF (",
              "        'InternetSales 😀'[OrderDate],",
              "        'InternetSales 😀'[ShipDate],",
              "        DAY",
              "    )",
              ")"
            ],
            "lineageTag": "6fec21d0-8139-4c09-ae5e-16af7971c83c"
          },
          {
            "name": "30D Moving Average Sales2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    //this",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -30,",
              "        DAY",
              "    )",
              ") //over this period",
              "/ 30",
              "//fancy equivalent",
              "//CALCULATE(DISTINCTCOUNT('Date'[Date]),",
              "//            DATESINPERIOD('Date'[Date],LASTDATE('Date'[Date]),-30,DAY))"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    //this",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -30,",
              "        DAY",
              "    )",
              ") //over this period",
              "/ 30",
              "//fancy equivalent",
              "//CALCULATE(DISTINCTCOUNT('Date'[Date]),",
              "//            DATESINPERIOD('Date'[Date],LASTDATE('Date'[Date]),-30,DAY))"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "f2784d75-a004-4a62-950c-0844f8fb121f"
          },
          {
            "name": "3M MONTHLY Moving Average Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    //makes little sense if you are at a different level in the date hierarchy",
              "    ISFILTERED ( 'Date 👍'[MMMYYYY] ),",
              "    //do not show unless is sliced by MMMYYYY - drill out to CalendarYear and it disappears",
              "    CALCULATE (",
              "        [Total Sales],",
              "        //this",
              "        DATESINPERIOD (",
              "            'Date 👍'[Date],",
              "            LASTDATE ( 'Date 👍'[Date] ),",
              "            -3,",
              "            MONTH",
              "        )",
              "    ) //over this period",
              "    / 3 //fancy equivalent",
              "    //CALCULATE(DISTINCTCOUNT('Date'[EnglishMonthName]),",
              "    //           DATESINPERIOD('Date'[Date],LASTDATE('Date'[Date]),-3,MONTH))",
              ")"
            ],
            "expression": [
              "IF (",
              "    //makes little sense if you are at a different level in the date hierarchy",
              "    ISFILTERED ( 'Date 👍'[MMMYYYY] ),",
              "    //do not show unless is sliced by MMMYYYY - drill out to CalendarYear and it disappears",
              "    CALCULATE (",
              "        [Total Sales],",
              "        //this",
              "        DATESINPERIOD (",
              "            'Date 👍'[Date],",
              "            LASTDATE ( 'Date 👍'[Date] ),",
              "            -3,",
              "            MONTH",
              "        )",
              "    ) //over this period",
              "    / 3 //fancy equivalent",
              "    //CALCULATE(DISTINCTCOUNT('Date'[EnglishMonthName]),",
              "    //           DATESINPERIOD('Date'[Date],LASTDATE('Date'[Date]),-3,MONTH))",
              ")"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "lineageTag": "3250d822-e214-4de5-9883-b6bf7393eeb2"
          },
          {
            "name": "YEARLY Moving Average Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR oneyear =",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -1,",
              "        YEAR",
              "    ) //over this period",
              "VAR countyears =",
              "    CALCULATE (",
              "        DISTINCTCOUNT ( 'Date 👍'[CalendarYear] )",
              "    ) //var countyears2=SUMX(VALUES('Date 👍'[CalendarYear]),1)",
              "RETURN",
              "    DIVIDE (",
              "        CALCULATE (",
              "            [Total Sales],",
              "            //this",
              "            oneyear",
              "        ),",
              "        //by",
              "        countyears //countyears2",
              "        ,",
              "        0",
              "    )"
            ],
            "expression": [
              "VAR oneyear =",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -1,",
              "        YEAR",
              "    ) //over this period",
              "VAR countyears =",
              "    CALCULATE (",
              "        DISTINCTCOUNT ( 'Date 👍'[CalendarYear] )",
              "    ) //var countyears2=SUMX(VALUES('Date 👍'[CalendarYear]),1)",
              "RETURN",
              "    DIVIDE (",
              "        CALCULATE (",
              "            [Total Sales],",
              "            //this",
              "            oneyear",
              "        ),",
              "        //by",
              "        countyears //countyears2",
              "        ,",
              "        0",
              "    )"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "86512e12-dc13-44ce-ac79-bd2931117eff"
          },
          {
            "name": "YEARLY Moving Average Sales v2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR oneyear =",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -1,",
              "        YEAR",
              "    ) //over this period",
              "//var countyears=CALCULATE(DISTINCTCOUNT('Date 👍'[CalendarYear]))",
              "VAR countyears2 =",
              "    SUMX (",
              "        VALUES ( 'Date 👍'[CalendarYear] ),",
              "        1",
              "    ) //sometimes quicker",
              "RETURN",
              "    DIVIDE (",
              "        CALCULATE (",
              "            [Total Sales],",
              "            //this",
              "            oneyear",
              "        ),",
              "        //by",
              "        //countyears",
              "        countyears2,",
              "        0",
              "    )"
            ],
            "expression": [
              "VAR oneyear =",
              "    DATESINPERIOD (",
              "        'Date 👍'[Date],",
              "        LASTDATE ( 'Date 👍'[Date] ),",
              "        -1,",
              "        YEAR",
              "    ) //over this period",
              "//var countyears=CALCULATE(DISTINCTCOUNT('Date 👍'[CalendarYear]))",
              "VAR countyears2 =",
              "    SUMX (",
              "        VALUES ( 'Date 👍'[CalendarYear] ),",
              "        1",
              "    ) //sometimes quicker",
              "RETURN",
              "    DIVIDE (",
              "        CALCULATE (",
              "            [Total Sales],",
              "            //this",
              "            oneyear",
              "        ),",
              "        //by",
              "        //countyears",
              "        countyears2,",
              "        0",
              "    )"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "baca64de-02ef-4ad6-be43-70eacddc2982"
          },
          {
            "name": "Period Rolling average Measure",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR __PERIOD = 30",
              "VAR __first_date =",
              "    CALCULATE (",
              "        FIRSTDATE ( 'Date 👍'[Date] ),",
              "        ALLSELECTED ( 'Date 👍'[Date] )",
              "    )",
              "VAR __LAST_DATE =",
              "    LASTDATE ( 'Date 👍'[Date] )",
              "RETURN",
              "    IF (",
              "        __LAST_DATE - __first_date >= __PERIOD - 1,",
              "        // ie needs the full period before starts calculating",
              "        AVERAGEX (",
              "            DATESBETWEEN (",
              "                //show just this with EVALUATE with(out) +1",
              "                'Date 👍'[Date],",
              "                DATEADD (",
              "                    __LAST_DATE,",
              "                    - __PERIOD + 1,",
              "                    DAY",
              "                ),",
              "                //ie go back __PERIOD-1 day",
              "                DATEADD (",
              "                    __LAST_DATE,",
              "                    0,",
              "                    DAY",
              "                )",
              "            ),",
              "            CALCULATE (",
              "                ( 'All Measures 😀'[Total Sales] )",
              "            )",
              "        )",
              "    )"
            ],
            "expression": [
              "VAR __PERIOD = 30",
              "VAR __first_date =",
              "    CALCULATE (",
              "        FIRSTDATE ( 'Date 👍'[Date] ),",
              "        ALLSELECTED ( 'Date 👍'[Date] )",
              "    )",
              "VAR __LAST_DATE =",
              "    LASTDATE ( 'Date 👍'[Date] )",
              "RETURN",
              "    IF (",
              "        __LAST_DATE - __first_date >= __PERIOD - 1,",
              "        // ie needs the full period before starts calculating",
              "        AVERAGEX (",
              "            DATESBETWEEN (",
              "                //show just this with EVALUATE with(out) +1",
              "                'Date 👍'[Date],",
              "                DATEADD (",
              "                    __LAST_DATE,",
              "                    - __PERIOD + 1,",
              "                    DAY",
              "                ),",
              "                //ie go back __PERIOD-1 day",
              "                DATEADD (",
              "                    __LAST_DATE,",
              "                    0,",
              "                    DAY",
              "                )",
              "            ),",
              "            CALCULATE (",
              "                ( 'All Measures 😀'[Total Sales] )",
              "            )",
              "        )",
              "    )"
            ],
            "lineageTag": "c83173c3-4f7b-4f16-b621-8ddafa87332a"
          },
          {
            "name": "Average quantity per Quarter BAD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "AVERAGEX (",
              "    KEEPFILTERS (",
              "        VALUES ( 'Date 👍'[CalendarQuarter] )",
              "    ),",
              "    CALCULATE (",
              "        SUM ( 'InternetSales 😀'[OrderQuantity] )",
              "    )",
              ")"
            ],
            "expression": [
              "AVERAGEX (",
              "    KEEPFILTERS (",
              "        VALUES ( 'Date 👍'[CalendarQuarter] )",
              "    ),",
              "    CALCULATE (",
              "        SUM ( 'InternetSales 😀'[OrderQuantity] )",
              "    )",
              ")"
            ],
            "lineageTag": "054127cc-de2f-45af-aa97-fc6175a022c7"
          },
          {
            "name": "Average quantity per Quarter GOOD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "-- create a matrix of calendarquarter and sum(orderquantity)",
              "VAR _Table =",
              "    SUMMARIZE (",
              "        'Date 👍',",
              "        'Date 👍'[CalendarQuarter],",
              "        \"Value\", SUM ( 'InternetSales 😀'[OrderQuantity] )",
              "    )",
              "RETURN",
              "    --simply average the value (virtual) column",
              "    AVERAGEX (",
              "        _Table,",
              "        [Value]",
              "    )",
              "-- this works with intellisense"
            ],
            "expression": [
              "-- create a matrix of calendarquarter and sum(orderquantity)",
              "VAR _Table =",
              "    SUMMARIZE (",
              "        'Date 👍',",
              "        'Date 👍'[CalendarQuarter],",
              "        \"Value\", SUM ( 'InternetSales 😀'[OrderQuantity] )",
              "    )",
              "RETURN",
              "    --simply average the value (virtual) column",
              "    AVERAGEX (",
              "        _Table,",
              "        [Value]",
              "    )",
              "-- this works with intellisense"
            ],
            "lineageTag": "632b53c1-a34e-4077-887e-bcb25da72fe2"
          },
          {
            "name": "Average quantity per day BAD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "AVERAGEX (",
              "    KEEPFILTERS (",
              "        VALUES ( 'InternetSales 😀'[OrderDate] )",
              "    ),",
              "    CALCULATE (",
              "        SUM ( 'InternetSales 😀'[OrderQuantity] )",
              "    )",
              ")"
            ],
            "expression": [
              "AVERAGEX (",
              "    KEEPFILTERS (",
              "        VALUES ( 'InternetSales 😀'[OrderDate] )",
              "    ),",
              "    CALCULATE (",
              "        SUM ( 'InternetSales 😀'[OrderQuantity] )",
              "    )",
              ")"
            ],
            "lineageTag": "69ce04c8-293c-47d5-9279-47bcb6317cc5"
          },
          {
            "name": "Average quantity per day GOOD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "-- create a matrix of orderdate and sum(orderquantity)",
              "VAR _Table =",
              "    SUMMARIZE (",
              "        'InternetSales 😀',",
              "        'InternetSales 😀'[OrderDate],",
              "        \"Value\", SUM ( 'InternetSales 😀'[OrderQuantity] )",
              "    )",
              "RETURN",
              "    --simply average the value (virtual) column",
              "    AVERAGEX (",
              "        _Table,",
              "        [Value]",
              "    )",
              "-- this works with intellisense"
            ],
            "expression": [
              "-- create a matrix of orderdate and sum(orderquantity)",
              "VAR _Table =",
              "    SUMMARIZE (",
              "        'InternetSales 😀',",
              "        'InternetSales 😀'[OrderDate],",
              "        \"Value\", SUM ( 'InternetSales 😀'[OrderQuantity] )",
              "    )",
              "RETURN",
              "    --simply average the value (virtual) column",
              "    AVERAGEX (",
              "        _Table,",
              "        [Value]",
              "    )",
              "-- this works with intellisense"
            ],
            "lineageTag": "8ceb1067-9600-4cc7-bba3-238e55d2230e"
          },
          {
            "name": "Average quantity per day GOOD2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR __Table =",
              "    GROUPBY (",
              "        'InternetSales 😀',",
              "        'InternetSales 😀'[OrderDate],",
              "        \"Value\",",
              "            SUMX (",
              "                CURRENTGROUP (),",
              "                'InternetSales 😀'[OrderQuantity]",
              "            )",
              "    ) --groupby works when everything is from the same table",
              "RETURN",
              "    AVERAGEX (",
              "        __Table,",
              "        [Value]",
              "    )"
            ],
            "expression": [
              "VAR __Table =",
              "    GROUPBY (",
              "        'InternetSales 😀',",
              "        'InternetSales 😀'[OrderDate],",
              "        \"Value\",",
              "            SUMX (",
              "                CURRENTGROUP (),",
              "                'InternetSales 😀'[OrderQuantity]",
              "            )",
              "    ) --groupby works when everything is from the same table",
              "RETURN",
              "    AVERAGEX (",
              "        __Table,",
              "        [Value]",
              "    )"
            ],
            "lineageTag": "33c52d6c-e1fb-4013-aef7-d84024392d0b"
          },
          {
            "name": "3M MONTHLY Moving Average offset",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR currentoffset =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrMonthOffset] )",
              "VAR MovAv =",
              "    CALCULATE (",
              "        'All Average Measures'[Average Sales PM],",
              "        FILTER (",
              "            ALL ( Dates_EDNA ),",
              "            // get a frame of 3 months",
              "            Dates_EDNA[CurrMonthOffset] <= currentoffset",
              "                && Dates_EDNA[CurrMonthOffset] >= ( currentoffset - 3 + 1 )",
              "        )",
              "    )",
              "RETURN",
              "    MovAv"
            ],
            "expression": [
              "",
              "//would be easy to convert to any other period offset",
              "",
              "VAR currentoffset =",
              "    SELECTEDVALUE ( Dates_EDNA[CurrMonthOffset] )",
              "VAR MovAv =",
              "    CALCULATE (",
              "        'All Average Measures'[Average Sales PM],",
              "        FILTER (",
              "            ALL ( Dates_EDNA ),",
              "            // get a frame of 3 months",
              "            Dates_EDNA[CurrMonthOffset] <= currentoffset",
              "                && Dates_EDNA[CurrMonthOffset] >= ( currentoffset - 3 + 1 ) // 3 is configurable and could be parametized",
              "        )",
              "    )",
              "RETURN",
              "    MovAv"
            ],
            "lineageTag": "a4577f86-7015-4fba-9659-274ac7aeb532"
          },
          {
            "name": "Average Sales PM",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "AVERAGEX (",
              "    VALUES ( Dates_EDNA[Month & Year] ),",
              "    [Total Sales]",
              ")"
            ],
            "expression": [
              "AVERAGEX (",
              "    VALUES ( Dates_EDNA[Month & Year] ),",
              "    [Total Sales]",
              ")"
            ],
            "lineageTag": "f5129bcb-1a92-4759-a31a-e06c22584d84"
          },
          {
            "name": "3M MONTHLY Moving Average Sales (window function)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISFILTERED ( 'Date 👍'[MMMYYYY] ),",
              "    //else makes no sense if not slicing by [MMMYYYY]",
              "    AVERAGEX (",
              "        WINDOW (",
              "            -2,",
              "            rel,",
              "            //2 back",
              "            0,",
              "            rel,",
              "            //current row",
              "            SUMMARIZE (",
              "                ALLSELECTED ( 'Date 👍' ),",
              "                'Date 👍'[MMMYYYY],",
              "                'Date 👍'[MMMYYYY sort]",
              "            ),",
              "            //table over which to iterate",
              "            ORDERBY ( 'Date 👍'[MMMYYYY sort], ASC )",
              "        ),",
              "        [Total Sales]",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISFILTERED ( 'Date 👍'[MMMYYYY] ),",
              "    //else makes no sense if not slicing by [MMMYYYY]",
              "    AVERAGEX (",
              "        WINDOW (",
              "            -2,",
              "            rel,",
              "            //2 back",
              "            0,",
              "            rel,",
              "            //current row",
              "            SUMMARIZE (",
              "                ALLSELECTED ( 'Date 👍' ),",
              "                'Date 👍'[MMMYYYY],",
              "                'Date 👍'[MMMYYYY sort]",
              "            ),",
              "            //table over which to iterate",
              "            ORDERBY ( 'Date 👍'[MMMYYYY sort], ASC )",
              "        ),",
              "        [Total Sales]",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "lineageTag": "9df7c068-d9e6-44ee-813f-a44065a06170"
          },
          {
            "name": "MONTHLY Moving Average yearly ref (window function)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISFILTERED ( 'Date 👍'[MMMYYYY] ),",
              "    //else makes no sense",
              "    AVERAGEX (",
              "        WINDOW (",
              "            1,",
              "            abs,",
              "            12,",
              "            abs,",
              "            //gives a 12 month fixed window subject to the partitionby",
              "            SUMMARIZE (",
              "                ALLSELECTED ( 'Date 👍' ),",
              "                'Date 👍'[CalendarYear],",
              "                'Date 👍'[MMMYYYY],",
              "                'Date 👍'[MMMYYYY sort]",
              "            ),",
              "            ORDERBY ( 'Date 👍'[CalendarYear], ASC,",
              "            'Date 👍'[MMMYYYY], ASC,",
              "            'Date 👍'[MMMYYYY sort], ASC ),",
              "            // all the context from the summarize must be added here",
              "            keep,",
              "            //currently no other choice",
              "            PARTITIONBY ( 'Date 👍'[CalendarYear] )",
              "        ),",
              "        [Total Sales]",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISFILTERED ( 'Date 👍'[MMMYYYY] ),",
              "    //else makes no sense",
              "    AVERAGEX (",
              "        WINDOW (",
              "            1,",
              "            abs,",
              "            12,",
              "            abs,",
              "            //gives a 12 month fixed window subject to the partitionby",
              "            SUMMARIZE (",
              "                ALLSELECTED ( 'Date 👍' ),",
              "                'Date 👍'[CalendarYear],",
              "                'Date 👍'[MMMYYYY],",
              "                'Date 👍'[MMMYYYY sort]",
              "            ),",
              "            ORDERBY ( 'Date 👍'[CalendarYear], ASC,",
              "            'Date 👍'[MMMYYYY], ASC,",
              "            'Date 👍'[MMMYYYY sort], ASC ),",
              "            // all the context from the summarize must be added here",
              "            keep,",
              "            //currently no other choice",
              "            PARTITIONBY ( 'Date 👍'[CalendarYear] )",
              "        ),",
              "        [Total Sales]",
              "    )",
              ")"
            ],
            "lineageTag": "654720ca-e150-4606-9eb2-13eaca557c9b"
          },
          {
            "name": "30D Moving Average Sales GD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "//simple maths",
              "VAR LatestDate = LASTDATE('Date 👍'[Date]) // the current row context",
              "VAR DateRange = DATESINPERIOD('Date 👍'[Date], LatestDate, -30, DAY) //last 30 days max",
              "VAR TotalDays = COUNTROWS(DateRange)",
              "VAR TotalSales = SUMX(",
              "                        FILTER(",
              "                            ALL('InternetSales 😀'), ",
              "                            'InternetSales 😀'[OrderDate] IN DateRange",
              "                            ), ",
              "                    'InternetSales 😀'[SalesAmount]",
              "                    )",
              "VAR Result = TotalSales / TotalDays",
              "RETURN Result",
              "",
              ""
            ],
            "lineageTag": "1ea42e53-ffb4-466c-8581-dfed37a2afbc"
          }
        ],
        "partitions": [
          {
            "name": "All Average Measures-e4885073-3a58-49f5-abc6-2cc1fa52d746",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type text) meta [Serialized.Text = true]) in type table [Column1 = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Column1\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "days average1",
        "columns": [
          {
            "name": "days average1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "version": 0
                }
              }
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "ac3690fc-4d21-453e-9da1-32b232b23d34",
            "sourceColumn": "[Value]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "a3a84db9-d3d8-430f-a6e8-515481d86ec8",
        "measures": [
          {
            "name": "days average1 Value",
            "description": [
              "SELECTEDVALUE (",
              "    'days average1'[days average1],",
              "    90",
              ")",
              "//converts your slicer list to a measure of the value you select"
            ],
            "expression": [
              "SELECTEDVALUE (",
              "    'days average1'[days average1],",
              "    90",
              ")",
              "//converts your slicer list to a measure of the value you select"
            ],
            "formatString": "0",
            "lineageTag": "c81dbd51-a02b-410d-8572-fced93ff89be"
          }
        ],
        "partitions": [
          {
            "name": "days average1-431e0a36-c3bf-40f7-a87f-96c53fa216fd",
            "mode": "import",
            "source": {
              "expression": [
                "GENERATESERIES (",
                "    30,",
                "    180,",
                "    30",
                ")",
                "//between 30 and 180 increasing in 30's"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "days average2",
        "columns": [
          {
            "name": "days average2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "version": 0
                }
              }
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "a9594ba7-1755-4772-86c5-235e29837a1e",
            "sourceColumn": "[Value]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "22ea9fa8-3d9c-4df6-9be8-f82cc8725ccf",
        "measures": [
          {
            "name": "days average2 Value",
            "description": [
              "SELECTEDVALUE (",
              "    'days average2'[days average2],",
              "    120",
              ")"
            ],
            "expression": [
              "SELECTEDVALUE (",
              "    'days average2'[days average2],",
              "    120",
              ")"
            ],
            "lineageTag": "7b518d40-6b39-45c2-beab-afa2918491a6"
          }
        ],
        "partitions": [
          {
            "name": "days average2-535fe2a0-6533-4132-ada5-d46879434d3f",
            "mode": "import",
            "source": {
              "expression": [
                "GENERATESERIES (",
                "    30,",
                "    180,",
                "    30",
                ")",
                "//between 30 and 180 increasing in 30's"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Calendar",
        "columns": [
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "58d418d6-01fc-4b23-9f96-0482b7658db5",
            "sourceColumn": "[Date]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "YEAR ( 'Calendar'[Date] )",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "dd9cbd41-48cc-4d5a-ae1a-c0332c4b7543",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "YEAR ( 'Calendar'[Date] ) & \"-Q\"",
              "    & FORMAT (",
              "        'Calendar'[Date],",
              "        \"q\"",
              "    )"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "14b88a91-b156-4e90-a6d6-5b4abc3c3e2d",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "MonthYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "FORMAT (",
              "    'Calendar'[Date],",
              "    \"MMM yyyy\"",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "6a245342-01b5-4afd-8363-d023ffb6376b",
            "sortByColumn": "MonthYearsortbyYear",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "MonthYearsortbyYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "FORMAT (",
              "    'Calendar'[Date],",
              "    \"yyyyMM\"",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "5615f4d3-806e-4df8-8df1-10a2260556c6",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "FORMAT (",
              "    'Calendar'[Date],",
              "    \"MMM\"",
              ")",
              "//mmmm for full month name"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "8d2ec4a2-fedd-4dd5-8246-c71b44e5385e",
            "sortByColumn": "MonthsortinYear",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "MonthsortinYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "MONTH ( 'Calendar'[Date] )",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "eb11f670-c1b1-4564-b6f7-2ab921a09d1c",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "WeekDay",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "FORMAT (",
              "    'Calendar'[Date],",
              "    \"ddd\"",
              ")",
              "//dddd for full day name"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "e1b38eaa-59c8-4146-ae2f-5f361c11a628",
            "sortByColumn": "WeekDaysort",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "WeekDaysort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "WEEKDAY (",
              "    'Calendar'[Date],",
              "    2",
              ")"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "d17e3a48-53ed-4d75-a8b6-c0fd9210d6af",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "MonthDay",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "DAY ( 'Calendar'[Date] )",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "75cbc9a9-2899-40ed-aa51-cba185068782",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "DayIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "DATEDIFF (",
              "    'Calendar'[Date],",
              "    TODAY (),",
              "    DAY",
              ") * -1",
              "// days ago from today"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "ffa75ad1-8859-403f-8771-a515a8cc552c",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "MonthIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "//months ago from today",
              "(",
              "    (",
              "        'Calendar'[Year]",
              "            - YEAR (",
              "                TODAY ()",
              "            )",
              "    ) * 12",
              ") + 'Calendar'[MonthsortinYear]",
              "    - MONTH (",
              "        TODAY ()",
              "    )"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "9975f10d-25d3-4f51-a74e-979bf2036e5f",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "YearIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "INT (",
              "    'Calendar'[Year]",
              "        - YEAR (",
              "            TODAY ()",
              "        )",
              ")",
              "// years ago"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "92820d7f-71bf-4408-b2ea-b4b4d162c045",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "DayofYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "DATEDIFF (",
              "    DATE ( YEAR ( 'Calendar'[Date] ), 1, 1 ),",
              "    'Calendar'[Date],",
              "    DAY",
              ") + 1"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "201823a6-a21c-4f5a-b508-90ce955387f9",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "DateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "FORMAT (",
              "    'Calendar'[Date],",
              "    \"yyyyMMdd\"",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "7bfec958-5a53-4c83-971f-b73878649f73",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "WeekNum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "WEEKNUM (",
              "    'Calendar'[Date],",
              "    2",
              ")",
              "//2= starts Monday",
              "//standard Microsoft calculation, as opposed to ISO Week"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "08f2e753-95a8-4f57-b2c5-e832fd2d277a",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "WeekIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "double",
            "expression": [
              "ROUNDDOWN (",
              "    ( 'Calendar'[DayIndex] - ( 'Calendar'[WeekDaysort] - 1 ) ) / 7,",
              "    0",
              ")",
              "//-1 so current week is 0"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "29619788-0b70-40d5-9092-f49be078abec",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "YearWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "'Calendar'[Year] & \" W\" & 'Calendar'[WeekNum]",
            "isDataTypeInferred": true,
            "lineageTag": "8d85ac2d-88dd-41f1-ad07-da1cfd4155f1",
            "sortByColumn": "WeekIndex",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "StartofYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "expression": "DATE ( YEAR ( 'Calendar'[Date] ), 1, 1 )",
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "lineageTag": "c7cc5a7f-f546-4586-bc90-d722b7cfdc46",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "StartofMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "expression": "DATE ( YEAR ( 'Calendar'[Date] ), MONTH ( 'Calendar'[Date] ), 1 )",
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "lineageTag": "64c114c1-de3b-4c17-a8c9-199dc835afa1",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "EndofYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "expression": [
              "DATE ( Calendar[Year], 12, 31 )",
              "//do not use ENDOFYEAR in case your dates do not go to the year end"
            ],
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "lineageTag": "fa58b7c6-a2ad-4a82-b7d2-e5516d85ed30",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "EndofMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "expression": "ENDOFMONTH ( 'Calendar'[Date] )",
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "lineageTag": "8fd3826b-6b9c-4145-a971-df542b32b96a",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Iso Week",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "WEEKNUM (",
              "    [Date],",
              "    21",
              ")",
              "//21 is undocumented - see comparison with weeknum on 20060101",
              "//see wikipedia for definition"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "6d7a7947-fbd7-495e-ba65-66b0f4960e93",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Iso Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "//see wikipedia",
              "IF (",
              "    AND (",
              "        WEEKNUM (",
              "            [Date],",
              "            21",
              "        ) < 5 //21 is undocumented",
              "        ,",
              "        WEEKNUM (",
              "            [Date],",
              "            2",
              "        ) > 50",
              "    ),",
              "    [Year] + 1,",
              "    IF (",
              "        AND (",
              "            WEEKNUM (",
              "                [Date],",
              "                21",
              "            ) > 50,",
              "            WEEKNUM (",
              "                [Date],",
              "                2",
              "            ) < 5",
              "        ),",
              "        [Year] - 1,",
              "        [Year]",
              "    )",
              ")",
              "//another version",
              "//ISO Year = YEAR([Date] + 26 - [ISO Week])"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "fd0afb13-6110-4708-8fc4-10e26d464c5f",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Iso Year Week",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "'Calendar'[Iso Year] & \" week \"",
              "    & FORMAT (",
              "        'Calendar'[Iso Week],",
              "        \"00\"",
              "    )"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "2554d83e-1f6a-499f-8cee-413b4bd8c17e",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "DateIsPassed",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "expression": [
              "'Calendar'[Date]",
              "    < TODAY ()",
              "//useful as a filter if certain calculations have issues with future dates",
              "//or 'Calendar'[Date]<=MAX(InternetSales[OrderdDate]) //if what up to the end of your data",
              "//Can now use this column as a TRUE/FALSE slicer. The idea being that TRUE stops running totals returning the last running total value for future dates"
            ],
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "isDataTypeInferred": true,
            "lineageTag": "e64a6a9a-1d9c-4a7a-9f49-3bb41cbb1e5e",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Week Start Date with Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDateTimeCustom\":true}"
              }
            ],
            "dataType": "dateTime",
            "expression": [
              "",
              "'Calendar'[Date]-WEEKDAY('Calendar'[Date],2)+1 -- 2 starts Monday"
            ],
            "formatString": "yyyy-mm-dd",
            "isDataTypeInferred": true,
            "lineageTag": "5f227208-265e-4303-ac2e-1a2719f7542d",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Week No starting Jan 1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "VAR _1 =",
              "    QUOTIENT (",
              "        DATEDIFF (",
              "            STARTOFYEAR ( 'Calendar'[Date] ),",
              "            'Calendar'[Date],",
              "            DAY",
              "        ),",
              "        7",
              "    ) + 1",
              "RETURN",
              "    IF (",
              "        _1 < 52,",
              "        _1,",
              "        52",
              "    )"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "1af05e18-94a5-40f0-b9b7-84bbad4be02b",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Week Day starting Jan 1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "MOD (",
              "    DATEDIFF (",
              "        'Calendar'[Week Start Date with Year],",
              "        [Date],",
              "        DAY",
              "    ),",
              "    7",
              ") + 1"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "3088f172-652a-4a5b-b8ad-8057c28fdf35",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "ISO Week Index",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "expression": [
              "VAR startOfWeek = 2 // = Monday Where 1 is Sunday and 7 is Saturday",
              "VAR currentDay = [Date]",
              "VAR dayIndex =",
              "    DATEDIFF (",
              "        currentDay,",
              "        TODAY (),",
              "        DAY",
              "    ) * -1",
              "VAR todayNum =",
              "    WEEKDAY (",
              "        TODAY ()",
              "    )",
              "VAR weekIndex =",
              "    ROUNDDOWN (",
              "        ( dayIndex + todayNum - startOfWeek - 6 ) / 7,",
              "        0",
              "    )",
              "RETURN",
              "    weekIndex"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "8f8b0436-fc68-43f7-999d-4b5043923cf3",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Tax Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "IF (",
              "    DATE ( YEAR ( 'Calendar'[Date] ), 4, 5 ) > 'Calendar'[Date],",
              "    //5th April",
              "    YEAR ( 'Calendar'[Date] ) - 1,",
              "    YEAR ( 'Calendar'[Date] )",
              ")"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "1e3b7b04-48f6-4c23-88e8-3b96104b133c",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Week Ending",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "expression": [
              "",
              "'Calendar'[Date]-WEEKDAY('Calendar'[Date],2)+7 //basically, start of week +7",
              "",
              "//harder",
              "//'Calendar'[Date]",
              "//    - MOD (",
              " //       'Calendar'[Date] - 2,",
              " //       7",
              "//    ) + 6",
              "////-2 is -1+ -1 more to account for Monday being the start of the week"
            ],
            "formatString": "General Date",
            "isDataTypeInferred": true,
            "lineageTag": "9cbcebd8-4a4b-4e34-9531-2788710e3eac",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "week of fiscal month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "// 2 accounts for monday being start of week",
              "1",
              "    + WEEKNUM (",
              "        'Calendar'[Week Ending],",
              "        2",
              "    )",
              "    - WEEKNUM (",
              "        STARTOFMONTH ( 'Calendar'[Week Ending] ),",
              "        2",
              "    )"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "a4dc5066-c44b-40f2-ad7a-7ade335da778",
            "summarizeBy": "sum",
            "type": "calculated"
          }
        ],
        "lineageTag": "a10e0d6b-e16f-432e-9499-d07a8925d6f3",
        "measures": [
          {
            "name": "hideyear",
            "description": [
              "VAR cy = [selectedyear]",
              "VAR y =",
              "    SELECTEDVALUE ( 'Calendar'[Year] )",
              "RETURN",
              "    IF (",
              "        cy = y,",
              "        \"hide\"",
              "    )"
            ],
            "expression": [
              "VAR cy = [selectedyear]",
              "VAR y =",
              "    SELECTEDVALUE ( 'Calendar'[Year] )",
              "RETURN",
              "    IF (",
              "        cy = y,",
              "        \"hide\"",
              "    )"
            ],
            "lineageTag": "f5fa9d3c-3246-45c2-906a-3cdb6e26e878"
          }
        ],
        "partitions": [
          {
            "name": "Calendar-5dac94ee-00f6-4ad9-bf59-97c117ff0893",
            "mode": "import",
            "source": {
              "expression": [
                "//generate calendar dates between 2 dates",
                "CALENDAR (",
                "    DATE ( //start date",
                "    YEAR (",
                "        MIN ( 'InternetSales 😀'[OrderDate] )",
                "    ), MONTH (",
                "        MIN ( 'InternetSales 😀'[OrderDate] )",
                "    ), 1 ),",
                "    // 1st day of 1st month's sales",
                "    DATE ( //endate",
                "    YEAR (",
                "        MAX ( 'InternetSales 😀'[OrderDate] )",
                "    ), MONTH (",
                "        MAX ( 'InternetSales 😀'[OrderDate] )",
                "    ), DAY (",
                "        MAX ( 'InternetSales 😀'[OrderDate] )",
                "    ) ) // last day of last month's sales",
                "    //up to current date: ",
                "    //DATE( YEAR( NOW() ), MONTH( NOW() ), DAY( NOW()) ) //nb ENDOFYEAR function will return the last date so far!!!!!",
                "    //or up to year end of current date",
                "    //DATE( YEAR( NOW() ), 12, 31 ) //this means ENDOFYEAR function is guaranteed to work",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "All Rank (Top) Measures",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "lineageTag": "6db42b22-dd67-453e-9d46-0a0569d0a744",
        "measures": [
          {
            "name": "Rank All Customers by Sales",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    RANKX (",
              "        ALL ( Customer[FullName] ),",
              "        [Total Sales]",
              "    ) // by customer name ",
              ")",
              "//not dense so get duplicates"
            ],
            "expression": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    RANKX (",
              "        ALL ( Customer[FullName] ),",
              "        [Total Sales]",
              "    ) // by customer name ",
              ")",
              "//not dense so get duplicates"
            ],
            "formatString": "0",
            "lineageTag": "18e2ddff-a266-4621-91fa-d0e397496548"
          },
          {
            "name": "Rank All Products by Sales",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides products without sales else they all appear at bottom (rank=103)",
              "    //nb probably not a good idea to try to convert <blank> into \"N/A\" as it won't rank!!!!",
              "    // see if(isnumber(.... in https://powerpivotpro.com/2019/09/a-brief-treatment-of-divide-rankx-and-n-a/",
              "    RANKX (",
              "        ALL ( 'Product'[ProductName] ),",
              "        [Total Sales]",
              "    ) //rank over productname",
              ")",
              "// nb not dense - so watch out for duplicate values"
            ],
            "expression": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides products without sales else they all appear at bottom (rank=103)",
              "    //nb probably not a good idea to try to convert <blank> into \"N/A\" as it won't rank!!!!",
              "    // see if(isnumber(.... in https://powerpivotpro.com/2019/09/a-brief-treatment-of-divide-rankx-and-n-a/",
              "    RANKX (",
              "        ALL ( 'Product'[ProductName] ), //cannot just use 'Product' as every row will rank 1",
              "        [Total Sales]",
              "    ) //rank over productname",
              ")",
              "// nb not dense - so watch out for duplicate values"
            ],
            "formatString": "0",
            "lineageTag": "ea98095b-a5b1-4178-847f-9050a18c78d8"
          },
          {
            "name": "Rank Selected Countries by Sales",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides products without sales",
              "    RANKX (",
              "        ALLSELECTED ( Geography[EnglishCountryRegionName] ),",
              "        [Total Sales]",
              "    ) //filter on selected countries nb. returns all 1's if pick just 1 country (of course)",
              ")"
            ],
            "expression": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides products without sales",
              "    RANKX (",
              "        ALLSELECTED ( Geography[EnglishCountryRegionName] ),",
              "        [Total Sales]",
              "    ) //filter on selected countries nb. returns all 1's if pick just 1 country (of course)",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "f5e6a810-59a9-4c92-b3f0-d1bbad7c7598"
          },
          {
            "name": "Rank Selected Customers by Sales",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides products without sales",
              "    RANKX (",
              "        ALLSELECTED ( Customer[FullName] ),",
              "        [Total Sales]",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides products without sales",
              "    RANKX (",
              "        ALLSELECTED ( Customer[FullName] ),",
              "        [Total Sales]",
              "    )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "8637b13d-1dad-43e0-b115-a6df8d8af5c3"
          },
          {
            "name": "Rank Selected Products by Sales",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides products without sales",
              "    RANKX (",
              "        ALLSELECTED ( 'Product'[ProductName] ),",
              "        [Total Sales]",
              "    ) //filter on selected productname",
              ")"
            ],
            "expression": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides products without sales",
              "    RANKX (",
              "        ALLSELECTED ( 'Product'[ProductName] ),",
              "        [Total Sales]",
              "    ) //filter on selected productname",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "4c0710b9-7727-4610-8751-5e3c2ae04235"
          },
          {
            "name": "Sales :- Other",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//Sales except for TopN",
              "CALCULATE (",
              "    [Total Sales],",
              "    KEEPFILTERS (",
              "        //only show the following else naturally blank",
              "        EXCEPT (",
              "            //all customers except TopN",
              "            ALL ( Customer[FullName] ),",
              "            TOPN (",
              "                [TopN Value],",
              "                ALL ( Customer[FullName] ),",
              "                [Total Sales]",
              "            )",
              "        )",
              "    )",
              ")"
            ],
            "expression": [
              "//Sales except for TopN",
              "CALCULATE (",
              "    [Total Sales],",
              "    KEEPFILTERS (",
              "        //only show the following else naturally blank",
              "        EXCEPT (",
              "            //all customers except TopN",
              "            ALL ( Customer[FullName] ),",
              "            TOPN (",
              "                [TopN Value],",
              "                ALL ( Customer[FullName] ),",
              "                [Total Sales]",
              "            )",
              "        )",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "1262f423-a0cc-47b4-b0ab-0eb97357c3a2"
          },
          {
            "name": "Sales :- Other Total Only",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//Other is not a [FullName] so show [Sales :- Other]",
              "IF (",
              "    NOT (",
              "        ISFILTERED ( Customer[FullName] )",
              "    ),",
              "    [Sales :- Other]",
              ")",
              "//ie blank if filter by FullName - which is what will happen for the TopN"
            ],
            "expression": [
              "//Other is not a [FullName] so show [Sales :- Other]",
              "IF (",
              "    NOT (",
              "        ISFILTERED ( Customer[FullName] )",
              "    ),",
              "    [Sales :- Other]",
              ")",
              "//ie blank if filter by FullName - which is what will happen for the TopN"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "4ac82b30-f246-4a0a-a585-31fc0dc7092c"
          },
          {
            "name": "Sales :- Top",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    KEEPFILTERS (",
              "        //without this you get the aggegate of TopN sales on EVERY row",
              "        TOPN (",
              "            [TopN Value],",
              "            ALL ( Customer[FullName] ),",
              "            [Total Sales], DESC",
              "        ) //rows,initial data set,measure,order",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    KEEPFILTERS (",
              "        //without this you get the aggegate of TopN sales on EVERY row",
              "        TOPN (",
              "            [TopN Value],",
              "            ALL ( Customer[FullName] ),",
              "            [Total Sales], DESC",
              "        ) //rows,initial data set,measure,order",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "f9f1a221-c3e0-48a4-8f42-6057197fb670"
          },
          {
            "name": "Sales Top or Other",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    HASONEVALUE ( 'Top or Other'[Top/Other] ),",
              "    //is required for matrix to slice",
              "    SWITCH (",
              "        VALUES ( 'Top or Other'[Top/Other] ),",
              "        \"Top\", [Sales :- Top],",
              "        //if Top then....",
              "        \"Other\", [Sales :- Other Total Only] //if Other then ....",
              "    ),",
              "    [Total Sales] //else",
              ")"
            ],
            "expression": [
              "IF (",
              "    HASONEVALUE ( 'Top or Other'[Top/Other] ),",
              "    //is required for matrix to slice",
              "    SWITCH (",
              "        VALUES ( 'Top or Other'[Top/Other] ),",
              "        \"Top\", [Sales :- Top],",
              "        //if Top then....",
              "        \"Other\", [Sales :- Other Total Only] //if Other then ....",
              "    ),",
              "    [Total Sales] //else",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "4acfe593-7638-475f-8f80-6f19bfa3a4e9"
          },
          {
            "name": "Rank ALL SubCategories by Sales",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISBLANK ( [Total Sales] ),",
              "    BLANK (),",
              "    //strip out rows with no sales",
              "    RANKX (",
              "        FILTER (",
              "            ALL ( ProductSubcategory ) //rank over all subcategories",
              "            ,",
              "            NOT (",
              "                ISBLANK ( [Total Sales] )",
              "            ) //as long as they have sales",
              "        ),",
              "        [Total Sales]",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISBLANK ( [Total Sales] ),",
              "    BLANK (),",
              "    //strip out rows with no sales",
              "    RANKX (",
              "        FILTER (",
              "            ALL ( ProductSubcategory ) //rank over all subcategories",
              "            ,",
              "            NOT (",
              "                ISBLANK ( [Total Sales] )",
              "            ) //as long as they have sales",
              "        ),",
              "        [Total Sales]",
              "    )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "b6105dd5-95e2-4dae-a89f-d3873fd449c6"
          },
          {
            "name": "RankSalesbySubCategory",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    //show",
              "    FILTER (",
              "        //matches to correct row from rankhelper table (ie rank 1,2 or 3)",
              "        ProductSubcategory,",
              "        [Rank ALL SubCategories by Sales] = [SelectedRankHelperValue]",
              "    ),",
              "    FILTER (",
              "        //just the slicer (top 1,2 or 3) ie is dynamic",
              "        ProductSubcategory,",
              "        [Rank ALL SubCategories by Sales] <= [Top3orLess Value]",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    //show",
              "    FILTER (",
              "        //matches to correct row from rankhelper table (ie rank 1,2 or 3)",
              "        ProductSubcategory,",
              "        [Rank ALL SubCategories by Sales] = [SelectedRankHelperValue]",
              "    ),",
              "    FILTER (",
              "        //just the slicer (top 1,2 or 3) ie is dynamic",
              "        ProductSubcategory,",
              "        [Rank ALL SubCategories by Sales] <= [Top3orLess Value]",
              "    )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "e242750d-a096-43f0-bfd1-446614c20d4c"
          },
          {
            "name": "RankSubCategoryName",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [SelectedSubCategoryValue],",
              "    //from ProductSubcategory table - picks subcategory name",
              "    FILTER (",
              "        //matches to correct row from rankhelper table (ie rank 1,2 or 3)",
              "        ProductSubcategory,",
              "        [Rank ALL SubCategories by Sales] = [SelectedRankHelperValue]",
              "    ),",
              "    FILTER (",
              "        //just the slicer (top 1,2 or 3) ie is dynamic",
              "        ProductSubcategory,",
              "        [Rank ALL SubCategories by Sales] <= [Top3orLess Value]",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [SelectedSubCategoryValue],",
              "    //from ProductSubcategory table - picks subcategory name",
              "    FILTER (",
              "        //matches to correct row from rankhelper table (ie rank 1,2 or 3)",
              "        ProductSubcategory,",
              "        [Rank ALL SubCategories by Sales] = [SelectedRankHelperValue]",
              "    ),",
              "    FILTER (",
              "        //just the slicer (top 1,2 or 3) ie is dynamic",
              "        ProductSubcategory,",
              "        [Rank ALL SubCategories by Sales] <= [Top3orLess Value]",
              "    )",
              ")"
            ],
            "lineageTag": "509a9db8-7ca6-4128-b227-9e3eb9a8ea8b"
          },
          {
            "name": "Rank All Customers By Sales2",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "RANKX (",
              "    ALLSELECTED ( Customer[FullName] ),",
              "    [Total Sales],",
              "    ,",
              "    Desc",
              ")"
            ],
            "expression": [
              "RANKX (",
              "    ALLSELECTED ( Customer[FullName] ),",
              "    [Total Sales],",
              "    ,",
              "    Desc",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "71594c5d-b152-4502-8281-5e341212c602"
          },
          {
            "name": "Top N Customers",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        //filter fullname by TopN",
              "        VALUES ( Customer[FullName] ),",
              "        //VALUES = distinct                                                                                ",
              "        //the FILTER and VALUES combination can be replaced by KEEPFILTERS - see later ",
              "        //(nb probably no performance difference)",
              "        IF (",
              "            RANKX (",
              "                ALL ( Customer[FullName] ) //ALL means do not filter",
              "                ,",
              "                [Total Sales],",
              "                ,",
              "                desc,",
              "                DENSE",
              "            ) <= 'TopN'[TopN Value],",
              "            //DENSE will account for duplicates",
              "            [Total Sales],",
              "            BLANK ()",
              "        )",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        //filter fullname by TopN",
              "        VALUES ( Customer[FullName] ),",
              "        //VALUES = distinct                                                                                ",
              "        //the FILTER and VALUES combination can be replaced by KEEPFILTERS - see later ",
              "        //(nb probably no performance difference)",
              "        IF (",
              "            RANKX (",
              "                ALL ( Customer[FullName] ) //ALL means do not filter",
              "                ,",
              "                [Total Sales],",
              "                ,",
              "                desc,",
              "                DENSE",
              "            ) <= 'TopN'[TopN Value],",
              "            //DENSE will account for duplicates",
              "            [Total Sales],",
              "            BLANK ()",
              "        )",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "c016f7db-60bc-4922-8d4c-9afee823f316"
          },
          {
            "name": "Bottom N",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        VALUES ( Customer[FullName] ),",
              "        //if choose ALL then returns the grand total sales for the bottom N on each row",
              "        //IF (",
              "        RANKX (",
              "            FILTER (",
              "                ALL ( Customer[FullName] ),",
              "                NOT (",
              "                    ISBLANK ( [Total Sales] )",
              "                )",
              "            ),",
              "            [Total Sales],",
              "            ,",
              "            asc,",
              "            DENSE",
              "        ) <= 'TopN'[TopN Value] //,",
              "        //[Total Sales],",
              "        // BLANK ()",
              "        //)",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        VALUES ( Customer[FullName] ),",
              "        //if choose ALL then returns the grand total sales for the bottom N on each row",
              "        //IF (",
              "        RANKX (",
              "            FILTER (",
              "                ALL ( Customer[FullName] ),",
              "                NOT (",
              "                    ISBLANK ( [Total Sales] )",
              "                )",
              "            ),",
              "            [Total Sales],",
              "            ,",
              "            asc,",
              "            DENSE",
              "        ) <= 'TopN'[TopN Value] //,",
              "        //[Total Sales],",
              "        // BLANK ()",
              "        //)",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "f17afc8a-e85a-49ab-bd4d-d9526050a478"
          },
          {
            "name": "Rank Sales per SubCategory",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//just neater with a variable",
              "VAR ranking =",
              "    RANKX (",
              "        ALL ( ProductSubcategory[ProductSubcategoryName] ),",
              "        [Total Sales],",
              "        ,",
              "        DESC",
              "    )",
              "RETURN",
              "    IF (",
              "        NOT (",
              "            ISBLANK ( [Total Sales] )",
              "        ),",
              "        ranking,",
              "        BLANK ()",
              "    )"
            ],
            "expression": [
              "//just neater with a variable",
              "VAR ranking =",
              "    RANKX (",
              "        ALL ( ProductSubcategory[ProductSubcategoryName] ),",
              "        [Total Sales],",
              "        ,",
              "        DESC",
              "    )",
              "RETURN",
              "    IF (",
              "        NOT (",
              "            ISBLANK ( [Total Sales] )",
              "        ),",
              "        ranking,",
              "        BLANK ()",
              "    )"
            ],
            "formatString": "0",
            "lineageTag": "04d1a1da-8641-46ac-8cad-4ef1276aab75"
          },
          {
            "name": "Top N v2 MS_FN",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR customerrank =",
              "    RANKX (",
              "        ALLSELECTED (",
              "            Customer[MaritalStatus],",
              "            Customer[FullName]",
              "        ),",
              "        [Total Sales],",
              "        ,",
              "        desc,",
              "        DENSE",
              "    )",
              "RETURN",
              "    //customerrank // just this on its own to show ranking number",
              "    IF (",
              "        customerrank <= 'TopN'[TopN Value],",
              "        [Total Sales]",
              "    )"
            ],
            "expression": [
              "VAR customerrank =",
              "    RANKX (",
              "        ALLSELECTED (",
              "            Customer[MaritalStatus],",
              "            Customer[FullName]",
              "        ),",
              "        [Total Sales],",
              "        ,",
              "        desc,",
              "        DENSE",
              "    )",
              "RETURN",
              "    //customerrank // just this on its own to show ranking number",
              "    IF (",
              "        customerrank <= 'TopN'[TopN Value],",
              "        [Total Sales]",
              "    )"
            ],
            "formatString": "\"£\"#,0;-\"£\"#,0;\"£\"#,0",
            "lineageTag": "a17e1a04-c1ab-4133-99dd-8adbfafeae25"
          },
          {
            "name": "Top N v2rank",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR customerrank =",
              "    RANKX (",
              "        ALL ( Customer[FullName] ),",
              "        [Total Sales],",
              "        ,",
              "        desc,",
              "        DENSE",
              "    )",
              "RETURN",
              "    customerrank",
              "// just this on its own to show ranking number",
              "//if(customerrank<='TopN'[TopN Value],[Total Sales])"
            ],
            "expression": [
              "VAR customerrank =",
              "    RANKX (",
              "        ALL ( Customer[FullName] ),",
              "        [Total Sales],",
              "        ,",
              "        desc,",
              "        DENSE",
              "    )",
              "RETURN",
              "    customerrank",
              "// just this on its own to show ranking number",
              "//if(customerrank<='TopN'[TopN Value],[Total Sales])"
            ],
            "formatString": "0",
            "lineageTag": "450261a9-31ca-48e1-aad6-ac4e3fb712e8"
          },
          {
            "name": "Rank Selected Countries by Sales v2",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    COUNTROWS (",
              "        ALLSELECTED ( Geography[EnglishCountryRegionName] )",
              "    ) > 1 //do not show if only pick 1 country",
              "    ,",
              "    [Rank Selected Countries by Sales] //the referenced measure",
              ")"
            ],
            "expression": [
              "IF (",
              "    COUNTROWS (",
              "        ALLSELECTED ( Geography[EnglishCountryRegionName] )",
              "    ) > 1 //do not show if only pick 1 country",
              "    ,",
              "    [Rank Selected Countries by Sales] //the referenced measure",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "fad919af-60cf-4535-9fbd-46598586cbeb"
          },
          {
            "name": "Rank Sales by Crossjoin Country and SubCategory",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISBLANK ( [Total Sales] ) //|| NOT HASONEVALUE(Geography[EnglishCountryRegionName])",
              "    ,",
              "    BLANK (),",
              "    //strip out record with no sales",
              "    //else",
              "    RANKX (",
              "        CROSSJOIN (",
              "            ALLSELECTED ( Geography[EnglishCountryRegionName] ),",
              "            ALLSELECTED ( ProductSubcategory[ProductSubCategoryName] )",
              "        ) //crossjoin returns permutations of country and subcategory",
              "        // you could have tried to use summarizecolumns instead of crossjoin but it is not acceptable inside the rankx",
              "        //allselected so can explicitly filter on those columns",
              "        ,",
              "        [Total Sales],",
              "        ,",
              "        Desc,",
              "        DENSE",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISBLANK ( [Total Sales] ) //|| NOT HASONEVALUE(Geography[EnglishCountryRegionName])",
              "    ,",
              "    BLANK (),",
              "    //strip out record with no sales",
              "    //else",
              "    RANKX (",
              "        CROSSJOIN (",
              "            ALLSELECTED ( Geography[EnglishCountryRegionName] ),",
              "            ALLSELECTED ( ProductSubcategory[ProductSubCategoryName] )",
              "        ) //crossjoin returns permutations of country and subcategory",
              "        // you could have tried to use summarizecolumns instead of crossjoin but it is not acceptable inside the rankx",
              "        //allselected so can explicitly filter on those columns",
              "        ,",
              "        [Total Sales],",
              "        ,",
              "        Desc,",
              "        DENSE",
              "    )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "cc1f90d0-7b78-472d-ab8a-967169b9e7d4"
          },
          {
            "name": "Rank All Customers By Sales(lowest) v1",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//if(not(ISBLANK([Total Sales])), // hides anything without sales otherwise no sales gets ranked #1",
              "RANKX (",
              "    FILTER (",
              "        // nb zero sales is ranked 1 if do not apply FILTER",
              "        ALLSELECTED ( Customer[FullName] ),",
              "        //ALLSELECTED just in case you decide to slice on FullName",
              "        [Total Sales]",
              "    ),",
              "    [Total Sales],",
              "    ,",
              "    ASC,",
              "    DENSE //dense guarantees sequential numbers - even with duplicates",
              ")",
              "//)"
            ],
            "expression": [
              "//if(not(ISBLANK([Total Sales])), // hides anything without sales otherwise no sales gets ranked #1",
              "RANKX (",
              "    FILTER (",
              "        // nb zero sales is ranked 1 if do not apply FILTER",
              "        ALLSELECTED ( Customer[FullName] ),",
              "        //ALLSELECTED just in case you decide to slice on FullName",
              "        [Total Sales]",
              "    ),",
              "    [Total Sales],",
              "    ,",
              "    ASC,",
              "    DENSE //dense guarantees sequential numbers - even with duplicates",
              ")",
              "//)"
            ],
            "formatString": "0",
            "lineageTag": "8c6eb420-6b34-4858-9611-d4c7c31b0fee"
          },
          {
            "name": "Rank All Customers By Sales(lowest) v2",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides anything without sales //could also use IF(ISNUMBER(..",
              "    RANKX (",
              "        //FILTER( // nb zero (blank) sales is ranked 1 if do not apply FILTER",
              "        ALLSELECTED ( Customer[FullName] ) //ALLSELECTED just in case you decide to slice on FullName",
              "        //        ,[Total Sales]  ",
              "        //        )",
              "        ,",
              "        [Total Sales],",
              "        ,",
              "        ASC,",
              "        DENSE",
              "    ) //dense guarantees sequential numbers - even with duplicates",
              ")"
            ],
            "expression": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides anything without sales //could also use IF(ISNUMBER(..",
              "    RANKX (",
              "        //FILTER( // nb zero (blank) sales is ranked 1 if do not apply FILTER",
              "        ALLSELECTED ( Customer[FullName] ) //ALLSELECTED just in case you decide to slice on FullName",
              "        //        ,[Total Sales]  ",
              "        //        )",
              "        ,",
              "        [Total Sales],",
              "        ,",
              "        ASC,",
              "        DENSE",
              "    ) //dense guarantees sequential numbers - even with duplicates",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "e426dbe6-4839-418f-8685-56247c744303"
          },
          {
            "name": "Rank All Customers By Sales(lowest) correct",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides anything without sales",
              "    RANKX (",
              "        FILTER (",
              "            // nb zero sales is ranked 1 if do not apply FILTER",
              "            ALLSELECTED ( Customer[FullName] ) //ALLSELECTED just in case you decide to slice on FullName",
              "            ,",
              "            [Total Sales]",
              "        ),",
              "        [Total Sales],",
              "        ,",
              "        ASC,",
              "        DENSE",
              "    ) //dense guarantees sequential numbers - even with duplicates",
              ")"
            ],
            "expression": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides anything without sales",
              "    RANKX (",
              "        FILTER (",
              "            // nb zero sales is ranked 1 if do not apply FILTER",
              "            ALLSELECTED ( Customer[FullName] ) //ALLSELECTED just in case you decide to slice on FullName",
              "            ,",
              "            [Total Sales]",
              "        ),",
              "        [Total Sales],",
              "        ,",
              "        ASC,",
              "        DENSE",
              "    ) //dense guarantees sequential numbers - even with duplicates",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "f533d0d5-9c5e-4cd1-b1e4-c4998005d694"
          },
          {
            "name": "Bottom N v2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR customerrank =",
              "    RANKX (",
              "        ALL ( Customer[FullName] ),",
              "        [Total Sales],",
              "        ,",
              "        asc,",
              "        DENSE",
              "    ) // dense accounts for duplicates",
              "RETURN",
              "    //customerrank // just this on its own to show ranking number",
              "    IF (",
              "        customerrank <= 'TopN'[TopN Value] + 1,",
              "        [Total Sales]",
              "    )",
              "//nb +1 is a simple way of accounting for blanks being ranked #1"
            ],
            "expression": [
              "VAR customerrank =",
              "    RANKX (",
              "        ALL ( Customer[FullName] ),",
              "        [Total Sales],",
              "        ,",
              "        asc,",
              "        DENSE",
              "    ) // dense accounts for duplicates",
              "RETURN",
              "    //customerrank // just this on its own to show ranking number",
              "    IF (",
              "        customerrank <= 'TopN'[TopN Value] + 1,",
              "        [Total Sales]",
              "    )",
              "//nb +1 is a simple way of accounting for blanks being ranked #1"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "02978c3a-397d-430c-855b-0422f8012656"
          },
          {
            "name": "Rank by Country and Subcategory Overall",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides products without sales",
              "    RANKX (",
              "        ALL ( Geography[EnglishCountryRegionName] ) //nd ALL, not ALLSELECTED",
              "        ,",
              "        CALCULATE (",
              "            [Total Sales],",
              "            VALUES ( ProductSubcategory )",
              "        ),",
              "        // the subfilter criteria. Try ALLSELECTED instead of VALUES!!",
              "        [Total Sales] //rank this",
              "        ,",
              "        DESC",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [Total Sales] )",
              "    ),",
              "    // hides products without sales",
              "    RANKX (",
              "        ALL ( Geography[EnglishCountryRegionName] ) //nd ALL, not ALLSELECTED",
              "        ,",
              "        CALCULATE (",
              "            [Total Sales],",
              "            VALUES ( ProductSubcategory )",
              "        ),",
              "        // the subfilter criteria. Try ALLSELECTED instead of VALUES!!",
              "        [Total Sales] //rank this",
              "        ,",
              "        DESC",
              "    )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "e843fdca-4491-404d-b8c7-865bb5490118"
          },
          {
            "name": "Rank Sales by Crossjoin Country and SubCategory v2",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    AND (",
              "        ISFILTERED ( Geography[EnglishCountryRegionName] ),",
              "        ISFILTERED ( ProductSubcategory[ProductSubCategoryName] )",
              "    ),",
              "    IF (",
              "        ISBLANK ( [Total Sales] ),",
              "        BLANK (),",
              "        //strip out record with no sales",
              "        //else",
              "        RANKX (",
              "            CROSSJOIN (",
              "                ALLSELECTED ( Geography[EnglishCountryRegionName] ),",
              "                ALLSELECTED ( ProductSubcategory[ProductSubCategoryName] )",
              "            ) //crossjoin returns permutations of country and subcategory",
              "            // you could have tried to use summarizecolumns instead of crossjoin but it is not acceptable inside the rankx",
              "            //allselected so can explicitly filter on those columns",
              "            ,",
              "            [Total Sales],",
              "            ,",
              "            Desc,",
              "            DENSE",
              "        )",
              "    ),",
              "    BLANK () //returns blank if not row filtered on Geography[EnglishCountryRegionName AND ProductSubcategory[ProductSubCategoryName]",
              ")"
            ],
            "expression": [
              "IF (",
              "    AND (",
              "        ISFILTERED ( Geography[EnglishCountryRegionName] ),",
              "        ISFILTERED ( ProductSubcategory[ProductSubCategoryName] )",
              "    ),",
              "    IF (",
              "        ISBLANK ( [Total Sales] ),",
              "        BLANK (),",
              "        //strip out record with no sales",
              "        //else",
              "        RANKX (",
              "            CROSSJOIN (",
              "                ALLSELECTED ( Geography[EnglishCountryRegionName] ),",
              "                ALLSELECTED ( ProductSubcategory[ProductSubCategoryName] )",
              "            ) //crossjoin returns permutations of country and subcategory",
              "            // you could have tried to use summarizecolumns instead of crossjoin but it is not acceptable inside the rankx",
              "            //allselected so can explicitly filter on those columns",
              "            ,",
              "            [Total Sales],",
              "            ,",
              "            Desc,",
              "            DENSE",
              "        )",
              "    ),",
              "    BLANK () //returns blank if not row filtered on Geography[EnglishCountryRegionName AND ProductSubcategory[ProductSubCategoryName]",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "cb21bf0f-b240-4946-97dd-2585025b049e"
          },
          {
            "name": "Bottom N v3",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR customerrank =",
              "    RANKX (",
              "        FILTER (",
              "            ALL ( Customer[FullName] ),",
              "            NOT (",
              "                ISBLANK ( [Total Sales] )",
              "            )",
              "        ) //just a neater way of stripping out customers with no sales",
              "        ,",
              "        [Total Sales],",
              "        ,",
              "        asc,",
              "        DENSE // dense accounts for duplicates",
              "    )",
              "RETURN",
              "    //customerrank // just this on its own to show ranking number",
              "    IF (",
              "        customerrank <= 'TopN'[TopN Value],",
              "        [Total Sales]",
              "    )"
            ],
            "expression": [
              "VAR customerrank =",
              "    RANKX (",
              "        FILTER (",
              "            ALL ( Customer[FullName] ),",
              "            NOT (",
              "                ISBLANK ( [Total Sales] )",
              "            )",
              "        ) //just a neater way of stripping out customers with no sales",
              "        ,",
              "        [Total Sales],",
              "        ,",
              "        asc,",
              "        DENSE // dense accounts for duplicates",
              "    )",
              "RETURN",
              "    //customerrank // just this on its own to show ranking number",
              "    IF (",
              "        customerrank <= 'TopN'[TopN Value],",
              "        [Total Sales]",
              "    )"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "ee6563c1-0746-4754-a494-40afdb73abe0"
          },
          {
            "name": "Bottom N v4",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR customerrank =",
              "    RANKX (",
              "        FILTER (",
              "            ALLNOBLANKROW ( Customer[FullName] ),",
              "            [Total Sales]",
              "        ) //another neat way of stripping out customers with no sales",
              "        ,",
              "        [Total Sales],",
              "        ,",
              "        asc,",
              "        DENSE // dense accounts for duplicates",
              "    )",
              "RETURN",
              "    //customerrank // just this on its own to show ranking number",
              "    IF (",
              "        customerrank <= 'TopN'[TopN Value],",
              "        [Total Sales]",
              "    )"
            ],
            "expression": [
              "VAR customerrank =",
              "    RANKX (",
              "        FILTER (",
              "            ALLNOBLANKROW ( Customer[FullName] ),",
              "            [Total Sales]",
              "        ) //another neat way of stripping out customers with no sales",
              "        ,",
              "        [Total Sales],",
              "        ,",
              "        asc,",
              "        DENSE // dense accounts for duplicates",
              "    )",
              "RETURN",
              "    //customerrank // just this on its own to show ranking number",
              "    IF (",
              "        customerrank <= 'TopN'[TopN Value],",
              "        [Total Sales]",
              "    )"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "79094a31-3414-4444-bb45-438130370aa5"
          },
          {
            "name": "Rank by City (partitionable)",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "IF(ISINSCOPE(Geography[City]), //so only works at city level in hierarchy",
              "RANKX(",
              "   ALLSELECTED(Geography[City]),",
              "    [Total Sales],",
              "    ,",
              "    DESC,",
              "    Dense",
              "    )",
              ")"
            ],
            "expression": [
              "",
              "IF(ISINSCOPE(Geography[City]), //so only works at city level in hierarchy",
              "RANKX(",
              "   ALLSELECTED(Geography[City]),",
              "    [Total Sales],",
              "    ,",
              "    DESC,",
              "    Dense",
              "    )",
              ")"
            ],
            "lineageTag": "b45ffc27-6262-4f04-adfb-12853eebd69b"
          },
          {
            "name": "Top N Products List",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "//this variable will slice in the context of the chart used",
              "//AND BECOME A FIXED VALUE to divide by in a ratio.",
              "var TS=[Total Sales] ",
              "return",
              "CONCATENATEX(",
              "    TOPN(",
              "        'TopN'[TopN Value], //parametised value",
              "        FILTER(  // filters out products with no sales",
              "            'Product',",
              "            [Total Sales]>0",
              "            ),",
              "        [Total Sales], // TopN this",
              "        DESC",
              "        ),",
              "    //concatenate the following",
              "    'Product'[ProductName] ",
              "        & FORMAT([Total Sales], \" , £0,000.00\")",
              "        & FORMAT(DIVIDE([Total Sales],TS),\" , 0%\"),",
              "    UNICHAR(10), //carriage return",
              "    [Total Sales], //order by this",
              "    DESC",
              ")"
            ],
            "expression": [
              "",
              "//this variable will slice in the context of the chart used",
              "//AND BECOME A FIXED VALUE to divide by in a ratio.",
              "var TS=[Total Sales] ",
              "return",
              "CONCATENATEX( //table,expression,delimiter,order this,asc/desc",
              "    TOPN(",
              "        'TopN'[TopN Value], //parametised value",
              "        FILTER(  // filters out products with no sales",
              "            'Product',",
              "            [Total Sales]>0",
              "            ),",
              "        [Total Sales], // TopN this",
              "        DESC",
              "        ),",
              "    //concatenate the following expression",
              "    'Product'[ProductName] ",
              "        & FORMAT([Total Sales], \" , £0,000.00\")",
              "        & FORMAT(DIVIDE([Total Sales],TS),\" , 0%\"),",
              "    UNICHAR(10), //carriage return",
              "    [Total Sales], //order by this",
              "    DESC",
              ")"
            ],
            "lineageTag": "e7a7bbf5-0fd1-4aac-968d-e70a70c9f671"
          },
          {
            "name": "Best selling Product Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "MAXX('Product',[Total Sales])"
            ],
            "expression": [
              "",
              "MAXX('Product',[Total Sales])"
            ],
            "lineageTag": "3e11fdc2-56c6-45f8-8736-27f7e82cc23e"
          },
          {
            "name": "Best selling Customer Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "MAXX('Customer',[Total Sales])"
            ],
            "expression": [
              "",
              "MAXX('Customer',[Total Sales])"
            ],
            "lineageTag": "14c6cd45-6c5d-4532-b8b2-ab65be9c7e01"
          },
          {
            "name": "Best selling Day Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "MAXX(VALUES('Date 👍'[Date]),[Total Sales])"
            ],
            "expression": [
              "",
              "MAXX(VALUES('Date 👍'[Date]),[Total Sales])"
            ],
            "lineageTag": "ba60b8a6-2157-4fc0-803f-1c8820b35131"
          },
          {
            "name": "Top N Customers List",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "//this variable will slice in the context of the chart used",
              "//AND BECOME A FIXED VALUE to divide by in a ratio.",
              "var TS=[Total Sales] ",
              "return",
              "CONCATENATEX(",
              "    TOPN(",
              "        'TopN'[TopN Value], //parametised value",
              "        FILTER(  // filters out products with no sales",
              "            'Customer',",
              "            [Total Sales]>0",
              "            ),",
              "        [Total Sales], // TopN this",
              "        DESC",
              "        ),",
              "    //concatenate the following",
              "    Customer[FullName]",
              "        & FORMAT([Total Sales], \" , £0,000.00\")",
              "        & FORMAT(DIVIDE([Total Sales],TS),\" , 0%\"),",
              "    UNICHAR(10), //carriage return",
              "    [Total Sales], //order by this",
              "    DESC",
              ")"
            ],
            "expression": [
              "",
              "//this variable will slice in the context of the chart used",
              "//AND BECOME A FIXED VALUE to divide by in a ratio.",
              "var TS=[Total Sales] ",
              "return",
              "CONCATENATEX( //table,expression,delimiter,order this,asc/desc",
              "    TOPN(",
              "        'TopN'[TopN Value], //parametised value",
              "        FILTER(  // filters out customers with no sales",
              "            'Customer',",
              "            [Total Sales]>0",
              "            ),",
              "        [Total Sales], // TopN this",
              "        DESC",
              "        ),",
              "    //concatenate the following expression",
              "    Customer[FullName]",
              "        & FORMAT([Total Sales], \" , £0,000.00\")",
              "        & FORMAT(DIVIDE([Total Sales],TS),\" , 0%\"),",
              "    UNICHAR(10), //carriage return",
              "    [Total Sales], //order by this",
              "    DESC",
              ")"
            ],
            "lineageTag": "c67851f5-df0f-466c-9eae-4f72f3aaaf7c"
          },
          {
            "name": "Top N Days List",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "//this variable will slice in the context of the chart used",
              "//AND BECOME A FIXED VALUE to divide by in a ratio.",
              "var TS=[Total Sales] ",
              "return",
              "CONCATENATEX(",
              "    TOPN(",
              "        'TopN'[TopN Value], //parametised value",
              "        FILTER(  // filters out products with no sales",
              "            'Date 👍',",
              "            [Total Sales]>0",
              "            ),",
              "        [Total Sales], // TopN this",
              "        DESC",
              "        ),",
              "    //concatenate the following",
              "    'Date 👍'[Date]",
              "        & FORMAT([Total Sales], \" , £0,000.00\")",
              "        & FORMAT(DIVIDE([Total Sales],TS),\" , 0%\"),",
              "    UNICHAR(10), //carriage return",
              "    [Total Sales], //order by this",
              "    DESC",
              ")"
            ],
            "expression": [
              "",
              "//this variable will slice in the context of the chart used",
              "//AND BECOME A FIXED VALUE to divide by in a ratio.",
              "var TS=[Total Sales] ",
              "return",
              "CONCATENATEX( //table,expression,delimiter,order this,asc/desc",
              "    TOPN(",
              "        'TopN'[TopN Value], //parametised value",
              "        FILTER(  // filters out dates with no sales",
              "            'Date 👍',",
              "            [Total Sales]>0",
              "            ),",
              "        [Total Sales], // TopN this",
              "        DESC",
              "        ),",
              "    //concatenate the following expression",
              "    'Date 👍'[Date]",
              "        & FORMAT([Total Sales], \" , £0,000.00\")",
              "        & FORMAT(DIVIDE([Total Sales],TS),\" , 0%\"),",
              "    UNICHAR(10), //carriage return",
              "    [Total Sales], //order by this",
              "    DESC",
              ")"
            ],
            "lineageTag": "a6daa3bc-afeb-465b-898c-4d2d5ec989f2"
          },
          {
            "name": "Total Sales Rounded Rankx",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "expression": [
              "",
              "RANKX(ALLSELECTED(Customer[FullName]),[Total Sales Rounded],,DESC,Dense)"
            ],
            "lineageTag": "cb2fe938-6838-47bb-bf6a-3482b229f219"
          },
          {
            "name": "Total Sales Rounded Rank",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "expression": [
              "",
              "//Rank has more control over secondary sort orders :)",
              "RANK(",
              "    DENSE,",
              "    ALLSELECTED(Customer[FullName]),",
              "        ORDERBY(",
              "            [Total Sales Rounded],DESC,",
              "            Customer[FullName],ASC // secondary sort  (and you can add more....)",
              "            )",
              "    )"
            ],
            "lineageTag": "c0494633-b6e5-4706-a10e-0ca26acffcfe"
          },
          {
            "name": "Total Sales Band",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "SWITCH(TRUE(),",
              "[Total Sales]>9000000,9000000,",
              "[Total Sales]>3000000,3000000,",
              "0",
              ")"
            ],
            "lineageTag": "944b1b88-ca64-4a36-ad8a-424441b3d6ac"
          },
          {
            "name": "Rank Sales by Sales Band per Country",
            "expression": [
              "",
              "// table,expression to rank,value to evaluate,asc/desc,skip/dense",
              "RANKX(ALL(Geography[EnglishCountryRegionName]),[Total Sales Band],[Total Sales],DESC,Dense)"
            ],
            "formatString": "0",
            "lineageTag": "3fc17cbb-3632-4fbf-bf0d-c1a4eaa0a779"
          }
        ],
        "partitions": [
          {
            "name": "All Rank (Top) Measures-395d00b8-f66b-490f-b586-ae876a7d2141",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type text) meta [Serialized.Text = true]) in type table [Column1 = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Column1\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Top or Other",
        "columns": [
          {
            "name": "Top/Other",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "2c024d5e-587d-46e4-9d7f-8771fccca960",
            "sortByColumn": "Sort",
            "sourceColumn": "[Top/Other]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Sort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "845463ef-b2f5-486f-bdad-bbd7a83974b5",
            "sourceColumn": "[Sort]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "cb6caa1c-1b7b-4039-ad9f-8e7ef8a6f5a2",
        "partitions": [
          {
            "name": "Top or Other-08020cfd-b614-49b6-b4b9-6f75d7c3c7b0",
            "mode": "import",
            "source": {
              "expression": [
                "//custom list",
                "DATATABLE (",
                "    \"Top/Other\", STRING,",
                "    \"Sort\", INTEGER //definition",
                "    ,",
                "    {",
                "        { \"Top\", 1 },",
                "        { \"Other\", 2 }",
                "    //data row",
                "    //data row ",
                "    }",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "TopN",
        "columns": [
          {
            "name": "TopN",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "version": 0
                }
              }
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "f15223f8-88e3-4b34-9d32-31acea4b4f7a",
            "sourceColumn": "[Value]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "a3f3c5f1-82a5-43a6-bf95-ae639955c96c",
        "measures": [
          {
            "name": "TopN Value",
            "description": [
              "SELECTEDVALUE (",
              "    'TopN'[TopN],",
              "    5",
              ")"
            ],
            "expression": [
              "SELECTEDVALUE (",
              "    'TopN'[TopN],",
              "    5",
              ")"
            ],
            "lineageTag": "12f950e0-457a-4518-b313-206e74a88468"
          }
        ],
        "partitions": [
          {
            "name": "TopN-a298c3ee-3848-4c79-bbad-9617a7d494dd",
            "mode": "import",
            "source": {
              "expression": [
                "GENERATESERIES (",
                "    1,",
                "    10,",
                "    1",
                ")",
                "//between 1 and 10 increasing by 1"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "ProductCategory2",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "ProductCategoryKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d31fd743-9aa2-4b25-8ac5-e16a1f7a3732",
            "sourceColumn": "ProductCategoryKey",
            "summarizeBy": "none"
          },
          {
            "name": "ProductCategoryAlternateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "addf3890-7a57-4f5f-888e-0e89ecc1763b",
            "sourceColumn": "ProductCategoryAlternateKey",
            "summarizeBy": "none"
          },
          {
            "name": "ProductCategoryName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "aa687fc1-8ddc-4a89-b4de-9cb08dbbed18",
            "sourceColumn": "ProductCategoryName",
            "summarizeBy": "none"
          },
          {
            "name": "Category Sales",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": "[Total Sales]",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "4a58e9cd-24be-4da9-8bff-a024a40267cc",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Category Sales BUDGET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "expression": "[Category Sales] * 1.2",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "7b37a169-9d95-4737-8744-6ac4adf702d4",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "f847e48d-7e46-42a9-b818-ddaeb22788a5",
        "partitions": [
          {
            "name": "ProductCategory2-44589c19-bd9b-42a4-9a43-feeb23e2f8a4",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\"192.168.1.116\\sql2017\", \"adventureworksdw\"),",
                "    dbo_DimProductCategory = Source{[Schema=\"dbo\",Item=\"DimProductCategory\"]}[Data],",
                "    #\"Removed Columns\" = Table.RemoveColumns(dbo_DimProductCategory,{\"SpanishProductCategoryName\", \"FrenchProductCategoryName\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"EnglishProductCategoryName\", \"ProductCategoryName\"}})",
                "in",
                "    #\"Renamed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "ProductCategory_BUDGET_Left",
        "columns": [
          {
            "name": "ProductCategoryKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "34dc3860-86fc-4889-b005-7e1b20dbf0df",
            "sourceColumn": "ProductCategory2[ProductCategoryKey]",
            "summarizeBy": "count",
            "type": "calculatedTableColumn"
          },
          {
            "name": "ProductCategoryAlternateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "506a0e79-fa2e-4572-a813-915a4ca14744",
            "sourceColumn": "ProductCategory2[ProductCategoryAlternateKey]",
            "summarizeBy": "count",
            "type": "calculatedTableColumn"
          },
          {
            "name": "ProductCategoryName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "a99be143-5205-45d0-a6b4-00cdeb1744b5",
            "sourceColumn": "ProductCategory2[ProductCategoryName]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Category Sales",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "a48032e3-fac3-4851-a87c-b6e678d8a893",
            "sourceColumn": "ProductCategory2[Category Sales]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Category Sales BUDGET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "945d99a8-3b3c-4d1c-a5fa-521537cd1d59",
            "sourceColumn": "ProductCategory2[Category Sales BUDGET]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "a7f94edf-d1a0-490d-99a9-e860ab8c0a40",
        "measures": [
          {
            "name": "Total Sales BUDGET Left",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "description": [
              "",
              "CALCULATE (",
              "    SUM ( ProductCategory_BUDGET_Left[Category Sales BUDGET] ) // SUM is just to get column as measure",
              "    ,",
              "    USERELATIONSHIP ( ProductCategory_BUDGET_Left[ProductCategoryKey], ProductCategory2[ProductCategoryKey] ) //order DOES make a difference!!!!! ",
              "    //relationship must exist (even if not active(dotted)) - see model view",
              ")"
            ],
            "expression": [
              "",
              "CALCULATE (",
              "    SUM ( ProductCategory_BUDGET_Left[Category Sales BUDGET] ) // SUM is just to get column as measure",
              "    ,",
              "    USERELATIONSHIP ( ProductCategory_BUDGET_Left[ProductCategoryKey], ProductCategory2[ProductCategoryKey] ) //order DOES make a difference!!!!! ",
              "    //relationship must exist (even if not active(dotted)) - see model view",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "3a8c66fa-7e87-4af7-ad57-4dac7a691ad5"
          }
        ],
        "partitions": [
          {
            "name": "ProductCategory_BUDGET_Left-08a9708c-86ca-4030-ac96-1bc369d05191",
            "mode": "import",
            "source": {
              "expression": "ProductCategory2",
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "ProductCategory_BUDGET_Right",
        "columns": [
          {
            "name": "ProductCategoryKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "ee4b13ae-1e83-4b8f-8824-70e3f0e0ed42",
            "sourceColumn": "ProductCategory2[ProductCategoryKey]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "ProductCategoryAlternateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "6346abd9-1e8e-4776-acaf-dde1b3d0d0bd",
            "sourceColumn": "ProductCategory2[ProductCategoryAlternateKey]",
            "summarizeBy": "count",
            "type": "calculatedTableColumn"
          },
          {
            "name": "ProductCategoryName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "178b7b8b-8157-4473-b7c5-db932b9f43fd",
            "sourceColumn": "ProductCategory2[ProductCategoryName]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Category Sales",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "00f6c0fd-4f95-49fa-9697-afefb55a5b09",
            "sourceColumn": "ProductCategory2[Category Sales]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Category Sales BUDGET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "5fcf6310-34d1-4374-b516-e1c58066cd70",
            "sourceColumn": "ProductCategory2[Category Sales BUDGET]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "fe861d36-1b0f-4d6b-98a3-c02acb91fa1e",
        "measures": [
          {
            "name": "Total Sales BUDGET Right",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "description": [
              "CALCULATE (",
              "    SUM ( ProductCategory_BUDGET_Right[Category Sales BUDGET] ) // SUM is just to get column as measure",
              "    ,",
              "    TREATAS (",
              "        VALUES ( ProductCategory2[ProductCategoryKey] ),",
              "        ProductCategory_BUDGET_Right[ProductCategoryKey]",
              "    ) // the order of this matters - swap to see ",
              "    // no relationship exists in the model",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    SUM ( ProductCategory_BUDGET_Right[Category Sales BUDGET] ) // SUM is just to get column as measure",
              "    ,",
              "    TREATAS (",
              "        VALUES ( ProductCategory2[ProductCategoryKey] ),",
              "        ProductCategory_BUDGET_Right[ProductCategoryKey]",
              "    ) // the order of this matters - swap to see ",
              "    // no relationship exists in the model",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "75a02529-1912-4947-9587-998ee2dc945a"
          }
        ],
        "partitions": [
          {
            "name": "ProductCategory_BUDGET_Right-697545e1-fc44-4002-8eb4-5a77ef5d2b12",
            "mode": "import",
            "source": {
              "expression": "ProductCategory2",
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "rankhelper",
        "columns": [
          {
            "name": "ranknum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isNameInferred": true,
            "lineageTag": "234fd1dc-c4c2-4290-a70c-5b22f7dab511",
            "sourceColumn": "[ranknum]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "rankname",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "05d77bc4-677a-47d0-8391-bf3db4683d26",
            "sortByColumn": "ranknum",
            "sourceColumn": "[rankname]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "9faa1c61-0940-4f9f-af20-2ac9e8ad79a4",
        "measures": [
          {
            "name": "SelectedRankHelperValue",
            "description": [
              "//SELECTEDVALUE(rankhelper[ranknum],BLANK())",
              "IF (",
              "    HASONEVALUE ( rankhelper[RankNum] ),",
              "    VALUES ( rankhelper[RankNum] ),",
              "    BLANK ()",
              ")"
            ],
            "expression": [
              "//SELECTEDVALUE(rankhelper[ranknum],BLANK())",
              "IF (",
              "    HASONEVALUE ( rankhelper[RankNum] ),",
              "    VALUES ( rankhelper[RankNum] ),",
              "    BLANK ()",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "7e7e1183-5198-4ed5-832c-e8cb8b2143b0"
          }
        ],
        "partitions": [
          {
            "name": "rankhelper-4f7f4259-56d8-4cb2-afe4-d9c459e72dcc",
            "mode": "import",
            "source": {
              "expression": [
                "DATATABLE (",
                "    \"ranknum\", INTEGER,",
                "    \"rankname\", STRING,",
                "    {",
                "        { 1, \"1st\" },",
                "        { 2, \"2nd\" },",
                "        { 3, \"3rd\" }",
                "    }",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Top3orLess",
        "columns": [
          {
            "name": "Top3orLess",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "version": 0
                }
              }
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "98804ba0-efb7-4307-8111-177dc6535dcc",
            "sourceColumn": "[Value]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "ce524508-655e-4afe-8ae7-8ba7ea90a1d9",
        "measures": [
          {
            "name": "Top3orLess Value",
            "description": [
              "SELECTEDVALUE (",
              "    'Top3orLess'[Top3orLess],",
              "    3",
              ")"
            ],
            "expression": [
              "SELECTEDVALUE (",
              "    'Top3orLess'[Top3orLess],",
              "    3",
              ")"
            ],
            "lineageTag": "800719a7-0afd-418b-bdbc-a5a0b008a245"
          }
        ],
        "partitions": [
          {
            "name": "Top3orLess-73c7fac7-32a9-4e39-8e5e-fbbe9eb28404",
            "mode": "import",
            "source": {
              "expression": [
                "GENERATESERIES (",
                "    1,",
                "    3,",
                "    1",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "All ALL Measures",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "lineageTag": "4861d65b-8b91-49b7-aeb1-a66fdc6ffc28",
        "measures": [
          {
            "name": "Sales_ALL",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'InternetSales 😀' )",
              ")",
              "//ALL=absolute total ie remove ALL row filters"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'InternetSales 😀' )",
              ")",
              "//ALL=absolute total ie remove ALL row filters"
            ],
            "formatString": "\"£\"#,0.00;-\"£\"#,0.00;\"£\"#,0.00",
            "lineageTag": "fe96bd25-171a-4dd1-863a-9f1e844bea70"
          },
          {
            "name": "Sales_ALLSELECTED",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLSELECTED ()",
              ")",
              "//any or many slicers selected will filter this"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLSELECTED ()",
              ")",
              "//any or many slicers selected will filter this"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "232ceca3-6d11-4b03-9a7b-6dc8b4f68e94"
          },
          {
            "name": "SalesRatio_ALL",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": "[Total Sales] / [Sales_ALL]",
            "expression": "[Total Sales] / [Sales_ALL]",
            "formatString": "0%;-0%;0%",
            "lineageTag": "8901bdd6-6f58-4e7e-9361-9c17920ea752"
          },
          {
            "name": "SalesRatio_ALLSELECTED",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": "[Total Sales] / [Sales_ALLSELECTED]",
            "expression": "[Total Sales] / [Sales_ALLSELECTED]",
            "formatString": "0%;-0%;0%",
            "lineageTag": "b94b2fb5-b8e5-4d8e-b0bc-7ceb56381be3"
          },
          {
            "name": "Count Products",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "COUNTROWS ( 'Product' )",
              "//also DISTINCTCOUNT but it has more overhead so avoid"
            ],
            "expression": [
              "COUNTROWS ( 'Product' )",
              "//also DISTINCTCOUNT but it has more overhead so avoid"
            ],
            "formatString": "0",
            "lineageTag": "70b319f6-5be0-4a2c-aae4-6760c01b36dd"
          },
          {
            "name": "Count ALL Products",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "COUNTROWS (",
              "    VALUES ( 'Product' )",
              ")",
              "// compare ALL to VALUES or DISTINCT",
              "//nb DISTINCT only returns values that exist",
              "//VALUES returns a blank row for unrelated rows"
            ],
            "expression": [
              "COUNTROWS (",
              "    VALUES ( 'Product' )",
              ")",
              "// compare ALL to VALUES or DISTINCT",
              "//nb DISTINCT only returns values that exist",
              "//VALUES returns a blank row for unrelated rows"
            ],
            "formatString": "0",
            "lineageTag": "d3714c0d-ab9d-42a6-af9a-a36e2f251dec"
          },
          {
            "name": "Count ALL Products_SizeRange",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "COUNTROWS (",
              "    ALL ( 'Product'[SizeRange] )",
              ")"
            ],
            "expression": [
              "COUNTROWS (",
              "    ALL ( 'Product'[SizeRange] )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "ca0f9f6e-636d-4e3e-9ff2-1a666ed9e18c"
          },
          {
            "name": "Count ALL Products_Style",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "COUNTROWS (",
              "    ALL ( 'Product'[Style] )",
              ")"
            ],
            "expression": [
              "COUNTROWS (",
              "    ALL ( 'Product'[Style] )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "29c9a85e-1f8c-4b9f-9255-f240a3fad753"
          },
          {
            "name": "Sales_ALLEXCEPT_CY",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'Date 👍'[CalendarYear]",
              "    )",
              ")",
              "//ignore all filters except slice only by CY"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'Date 👍'[CalendarYear]",
              "    )",
              ")",
              "//ignore all filters except slice only by CY"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "d5643214-4bab-460f-8bfd-9243b9d01610"
          },
          {
            "name": "Sales_ALLEXCEPT_Category",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'ProductCategory 😀'[ProductCategoryName]",
              "    )",
              ")",
              "//remove all filters except category ie show only by category"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'ProductCategory 😀'[ProductCategoryName]",
              "    )",
              ")",
              "//remove all filters except category ie show only by category"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "9d5a9558-4509-4013-ab4f-61289db64d19"
          },
          {
            "name": "Sales_ALLEXCEPT_MMMYYYY_CY",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'Date 👍'[MMMYYYY],",
              "        'Date 👍'[CalendarYear]",
              "    ) //remove all filters except MMMYYYY and CY",
              ")",
              "//look at the total at bottom (it has subsetted when you pick a calendaryear)"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'Date 👍'[MMMYYYY],",
              "        'Date 👍'[CalendarYear]",
              "    ) //remove all filters except MMMYYYY and CY",
              ")",
              "//look at the total at bottom (it has subsetted when you pick a calendaryear)"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "0fc34ede-7f88-4dca-b355-c4c74f988ae1"
          },
          {
            "name": "SalesRatio_MonthofYear",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "DIVIDE (",
              "    [Sales_ALLEXCEPT_MMMYYYY_CY],",
              "    [Sales_ALLEXCEPT_CY]",
              ")"
            ],
            "expression": [
              "DIVIDE (",
              "    [Sales_ALLEXCEPT_MMMYYYY_CY],",
              "    [Sales_ALLEXCEPT_CY]",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "cdf96d58-195c-4268-886b-2ebad6471917"
          },
          {
            "name": "Sales_ALLEXCEPT_date",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'Date 👍'[Date]",
              "    )",
              ")",
              "//remove all filters except date ie show only by date"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'Date 👍'[Date]",
              "    )",
              ")",
              "//remove all filters except date ie show only by date"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "f0384953-a3e2-4177-a916-3aa373231ab8"
          },
          {
            "name": "Sales_ALL_CY",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'Date 👍'[CalendarYear] )",
              ")",
              "//slice by anything except!!!! year - nb not using ALLEXCEPT"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALL ( 'Date 👍'[CalendarYear] )",
              ")",
              "//slice by anything except!!!! year - nb not using ALLEXCEPT"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "cea01731-5358-46fb-9256-0c9ec442d4f2"
          },
          {
            "name": "Sales_ALLEXCEPT_MMMYYYY",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'Date 👍'[MMMYYYY]",
              "    )",
              ")",
              "//remove all filters except MMMYYYY ie show only by MMMYYYY",
              "//you may be thinking that this returns the same as Sales_ALLEXCEPT_MMMYYYY_CY",
              "//look at the total at bottom (it has NOT subsetted when you pick a calendaryear)"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    ALLEXCEPT (",
              "        'InternetSales 😀',",
              "        'Date 👍'[MMMYYYY]",
              "    )",
              ")",
              "//remove all filters except MMMYYYY ie show only by MMMYYYY",
              "//you may be thinking that this returns the same as Sales_ALLEXCEPT_MMMYYYY_CY",
              "//look at the total at bottom (it has NOT subsetted when you pick a calendaryear)"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "b72b18d6-25c5-44d4-87b8-6b150d900c69"
          },
          {
            "name": "Ratio1_by Product",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//shows 100% if not sliced by ProductName :(",
              "[Total Sales]",
              "    / CALCULATE (",
              "        [Total Sales],",
              "        ALL ( Product[ProductName] )",
              "    )"
            ],
            "expression": [
              "//shows 100% if not sliced by ProductName :(",
              "[Total Sales]",
              "    / CALCULATE (",
              "        [Total Sales],",
              "        ALL ( Product[ProductName] )",
              "    )"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "690103f4-eed8-446d-9875-cfd93cde9435"
          },
          {
            "name": "Ratio2_by SubCategory",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//shows 100% if not sliced by ProductSubcategoryName :(",
              "[Total Sales]",
              "    / CALCULATE (",
              "        [Total Sales],",
              "        ALL ( ProductSubcategory[ProductSubcategoryName] )",
              "    )"
            ],
            "expression": [
              "//shows 100% if not sliced by ProductSubcategoryName :(",
              "[Total Sales]",
              "    / CALCULATE (",
              "        [Total Sales],",
              "        ALL ( ProductSubcategory[ProductSubcategoryName] )",
              "    )"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "826229fb-4493-4fe3-af96-eab52afead35"
          },
          {
            "name": "Ratio3_by Category",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//shows 100% if not sliced by ProductCategoryName :(",
              "[Total Sales]",
              "    / CALCULATE (",
              "        [Total Sales],",
              "        ALL ( 'ProductCategory 😀'[ProductCategoryName] )",
              "    )"
            ],
            "expression": [
              "//shows 100% if not sliced by ProductCategoryName :(",
              "[Total Sales]",
              "    / CALCULATE (",
              "        [Total Sales],",
              "        ALL ( 'ProductCategory 😀'[ProductCategoryName] )",
              "    )"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "289ba8fe-9965-4bbc-9c78-392531f98809"
          },
          {
            "name": "Ratio1_by Product_ISFILTERED",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISFILTERED ( Product[ProductName] ),",
              "    //do not show unless is sliced by ProductName",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( Product[ProductName] )",
              "        )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISFILTERED ( Product[ProductName] ),",
              "    //do not show unless is sliced by ProductName",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( Product[ProductName] )",
              "        )",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "7e7acc52-7475-432a-8847-0ed71848c1a3"
          },
          {
            "name": "Ratio2_by SubCategory_ISFILTERED",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISFILTERED ( ProductSubcategory[ProductSubcategoryName] ),",
              "    //only show if sliced on SubcategoryName",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( ProductSubcategory[ProductSubcategoryName] )",
              "        )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISFILTERED ( ProductSubcategory[ProductSubcategoryName] ),",
              "    //only show if sliced on SubcategoryName",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( ProductSubcategory[ProductSubcategoryName] )",
              "        )",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "aa8f8ae6-05ef-49e3-8b21-0da198d67b65"
          },
          {
            "name": "Ratio3_by Category_ISFILTERED",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISFILTERED ( 'ProductCategory 😀'[ProductCategoryName] ),",
              "    //do not show unless sliced by CategoryName",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( 'ProductCategory 😀'[ProductCategoryName] )",
              "        )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISFILTERED ( 'ProductCategory 😀'[ProductCategoryName] ),",
              "    //do not show unless sliced by CategoryName",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( 'ProductCategory 😀'[ProductCategoryName] )",
              "        )",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "d95ebfda-0c3f-4f7c-a3cf-00ec0cfb206b"
          },
          {
            "name": "Ratio2v2_by SubCategory_ISFILTERED",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISFILTERED ( ProductSubcategory[ProductSubcategoryName] )",
              "        && NOT (",
              "            ISFILTERED ( 'Product'[ProductName] )",
              "        ),",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( ProductSubcategory[ProductSubcategoryName] )",
              "        )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISFILTERED ( ProductSubcategory[ProductSubcategoryName] )",
              "        && NOT (",
              "            ISFILTERED ( 'Product'[ProductName] )",
              "        ),",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( ProductSubcategory[ProductSubcategoryName] )",
              "        )",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "6cd157f1-7afb-4ad3-947c-96190b7bc0b1"
          },
          {
            "name": "Ratio3v2_by Category_ISFILTERED",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISFILTERED ( 'ProductCategory 😀'[ProductCategoryName] )",
              "        && NOT (",
              "            ISFILTERED ( ProductSubcategory[ProductSubcategoryName] )",
              "        ),",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( 'ProductCategory 😀'[ProductCategoryName] )",
              "        )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISFILTERED ( 'ProductCategory 😀'[ProductCategoryName] )",
              "        && NOT (",
              "            ISFILTERED ( ProductSubcategory[ProductSubcategoryName] )",
              "        ),",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( 'ProductCategory 😀'[ProductCategoryName] )",
              "        )",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "bdbfcfaf-8ec5-434a-9359-5ac663cdd4ad"
          },
          {
            "name": "Ratio123ToParent",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISFILTERED ( Product[ProductName] ),",
              "    //by productname then",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( Product[ProductName] )",
              "        ),",
              "    IF (",
              "        ISFILTERED ( ProductSubcategory[ProductSubcategoryName] ),",
              "        //by productsubcategoryname then",
              "        [Total Sales]",
              "            / CALCULATE (",
              "                [Total Sales],",
              "                ALL ( ProductSubcategory[ProductSubcategoryName] )",
              "            ),",
              "        IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[ProductCategoryName] ),",
              "            //by productcategoryname then",
              "            [Total Sales]",
              "                / CALCULATE (",
              "                    [Total Sales],",
              "                    ALL ( 'ProductCategory 😀'[ProductCategoryName] )",
              "                )",
              "        )",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISFILTERED ( Product[ProductName] ),",
              "    //by productname then",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( Product[ProductName] )",
              "        ),",
              "    IF (",
              "        ISFILTERED ( ProductSubcategory[ProductSubcategoryName] ),",
              "        //by productsubcategoryname then",
              "        [Total Sales]",
              "            / CALCULATE (",
              "                [Total Sales],",
              "                ALL ( ProductSubcategory[ProductSubcategoryName] )",
              "            ),",
              "        IF (",
              "            ISFILTERED ( 'ProductCategory 😀'[ProductCategoryName] ),",
              "            //by productcategoryname then",
              "            [Total Sales]",
              "                / CALCULATE (",
              "                    [Total Sales],",
              "                    ALL ( 'ProductCategory 😀'[ProductCategoryName] )",
              "                )",
              "        )",
              "    )",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "5309fa52-eda2-4240-8e59-c24a04f67ad6"
          },
          {
            "name": "Ratio123ToParentvH",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISFILTERED ( 'Product'[HProductName] ),",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( 'Product'[HProductName] )",
              "        ),",
              "    IF (",
              "        ISFILTERED ( 'Product'[HSubCat] ),",
              "        [Total Sales]",
              "            / CALCULATE (",
              "                [Total Sales],",
              "                ALL ( 'Product'[HSubCat] )",
              "            ),",
              "        IF (",
              "            ISFILTERED ( 'Product'[HCat] ),",
              "            [Total Sales]",
              "                / CALCULATE (",
              "                    [Total Sales],",
              "                    ALL ( 'Product'[HCat] )",
              "                )",
              "        )",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISFILTERED ( 'Product'[HProductName] ),",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( 'Product'[HProductName] )",
              "        ),",
              "    IF (",
              "        ISFILTERED ( 'Product'[HSubCat] ),",
              "        [Total Sales]",
              "            / CALCULATE (",
              "                [Total Sales],",
              "                ALL ( 'Product'[HSubCat] )",
              "            ),",
              "        IF (",
              "            ISFILTERED ( 'Product'[HCat] ),",
              "            [Total Sales]",
              "                / CALCULATE (",
              "                    [Total Sales],",
              "                    ALL ( 'Product'[HCat] )",
              "                )",
              "        )",
              "    )",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "d9e83644-35ff-45a6-87df-5ddb553f0ce2"
          },
          {
            "name": "Count ALL nonblank Products_Style",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//COUNTROWS(ALLEXCEPT('Product','Product'[Style])) //try this row first",
              "COUNTAX (",
              "    ALL ( 'Product' ),",
              "    [Style]",
              ")"
            ],
            "expression": [
              "//COUNTROWS(ALLEXCEPT('Product','Product'[Style])) //try this row first",
              "COUNTAX (",
              "    ALL ( 'Product' ),",
              "    [Style]",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "5d50f81c-9dcf-480a-aaf0-84b2d72a6386"
          },
          {
            "name": "Count nonblank Products_Style",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "COUNTAX (",
              "    'Product',",
              "    'Product'[Style]",
              ")",
              "//same as Count Products except blank if no Style"
            ],
            "expression": [
              "COUNTAX (",
              "    'Product',",
              "    'Product'[Style]",
              ")",
              "//same as Count Products except blank if no Style"
            ],
            "formatString": "0",
            "lineageTag": "a808288f-ecf1-4792-b1bf-ee833e254ca0"
          },
          {
            "name": "_(Table)/All(Table)/All(Column)/Allnoblankrow(Table)/Allnoblankrow(Column)/AllSelected(Table)/Allselected(Column)/AllExcept(Table,Column)",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Count Sales],",
              "    ProductSubcategory",
              ") & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALL ( ProductSubcategory )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALL ( ProductSubcategory[ProductSubcategoryName] )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALLNOBLANKROW ( ProductSubcategory )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALLNOBLANKROW ( ProductSubcategory[ProductSubcategoryName] )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALLSELECTED ( ProductSubcategory )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALLSELECTED ( ProductSubcategory[ProductSubcategoryName] )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALLEXCEPT (",
              "            ProductSubcategory,",
              "            ProductSubcategory[ProductSubcategoryName]",
              "        )",
              "    )"
            ],
            "expression": [
              "CALCULATE (",
              "    [Count Sales],",
              "    ProductSubcategory",
              ") & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALL ( ProductSubcategory )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALL ( ProductSubcategory[ProductSubcategoryName] )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALLNOBLANKROW ( ProductSubcategory )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALLNOBLANKROW ( ProductSubcategory[ProductSubcategoryName] )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALLSELECTED ( ProductSubcategory )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALLSELECTED ( ProductSubcategory[ProductSubcategoryName] )",
              "    ) & \"|-|\"",
              "    & CALCULATE (",
              "        [Count Sales],",
              "        ALLEXCEPT (",
              "            ProductSubcategory,",
              "            ProductSubcategory[ProductSubcategoryName]",
              "        )",
              "    )"
            ],
            "lineageTag": "0a109c89-db48-4e2b-aa1e-152e4d1497b1"
          },
          {
            "name": "Count Products SOLD",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    COUNTROWS ( 'Product' ) //or COUNTROWS(VALUES(InternetSales[ProductKey])",
              "    ,",
              "    'InternetSales 😀'",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    COUNTROWS ( 'Product' ) //or COUNTROWS(VALUES(InternetSales[ProductKey])",
              "    ,",
              "    'InternetSales 😀'",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "7b8716f9-8d39-4f78-a243-6100b3c06cfc"
          },
          {
            "name": "Count Products SOLD v2",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "COUNTROWS (",
              "    VALUES ( 'InternetSales 😀'[ProductKey] )",
              ")",
              "//VALUES=distinct"
            ],
            "expression": [
              "COUNTROWS (",
              "    VALUES ( 'InternetSales 😀'[ProductKey] )",
              ")",
              "//VALUES=distinct"
            ],
            "formatString": "0",
            "lineageTag": "7b777ed2-99d2-4c8a-b37e-74e515abcc11"
          },
          {
            "name": "Count ALL Products SOLD",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    COUNTROWS ( 'Product' ),",
              "    FILTER (",
              "        ALL ( 'InternetSales 😀' ),",
              "        TRUE",
              "    ) //remove the ALL and it will count per slice",
              "    //FILTER is required to get products SOLD",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    COUNTROWS ( 'Product' ),",
              "    FILTER (",
              "        ALL ( 'InternetSales 😀' ),",
              "        TRUE",
              "    ) //remove the ALL and it will count per slice",
              "    //FILTER is required to get products SOLD",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "1df5eec7-defc-4073-bb4a-0319dc26494e"
          },
          {
            "name": "Count ALL Products SOLD v2",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "COUNTROWS (",
              "    ALL ( 'InternetSales 😀'[ProductKey] )",
              ")",
              "//compare ALL to VALUES or DISTINCT"
            ],
            "expression": [
              "COUNTROWS (",
              "    ALL ( 'InternetSales 😀'[ProductKey] )",
              ")",
              "//compare ALL to VALUES or DISTINCT"
            ],
            "formatString": "0",
            "lineageTag": "83a0e19a-8aac-4f4d-a448-603531b9bc80"
          },
          {
            "name": "Count Products by Customer CROSSFILTER",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Count Products],",
              "    CROSSFILTER ( 'InternetSales 😀'[ProductKey], 'Product'[ProductKey], BOTH ) //overrides the direction of an existing relationship",
              "    //nb you can have multiple CROSSFILTER if you have a chain of relationships to traverse",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Count Products],",
              "    CROSSFILTER ( 'InternetSales 😀'[ProductKey], 'Product'[ProductKey], BOTH ) //overrides the direction of an existing relationship",
              "    //nb you can have multiple CROSSFILTER if you have a chain of relationships to traverse",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "4628084f-55c1-4295-b8ff-9cf5021fcf51"
          },
          {
            "name": "Highest Lowest Sales by City",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR highest =",
              "    MAXX (",
              "        ALLSELECTED ( Geography[City] ),",
              "        [Total Sales]",
              "    )",
              "VAR lowest =",
              "    MINX (",
              "        ALLSELECTED ( Geography[City] ),",
              "        [Total Sales]",
              "    )",
              "RETURN",
              "    SWITCH (",
              "        TRUE (),",
              "        [Total Sales] = highest, \"#73B761\",",
              "        [Total Sales] = lowest, \"#DB271C\"",
              "    )"
            ],
            "expression": [
              "VAR highest =",
              "    MAXX (",
              "        ALLSELECTED ( Geography[City] ),",
              "        [Total Sales]",
              "    )",
              "VAR lowest =",
              "    MINX (",
              "        ALLSELECTED ( Geography[City] ),",
              "        [Total Sales]",
              "    )",
              "RETURN",
              "    SWITCH (",
              "        TRUE (),",
              "        [Total Sales] = highest, \"#73B761\",",
              "        [Total Sales] = lowest, \"#DB271C\"",
              "    )"
            ],
            "lineageTag": "c2142833-5a3c-4169-a143-4af8ba069af6"
          },
          {
            "name": "Ratio1_by Product_ISINSCOPE",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    ISINSCOPE ( Product[ProductName] ),",
              "    //calculate just at ProductName level",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( Product[ProductName] )",
              "        )",
              ")"
            ],
            "expression": [
              "IF (",
              "    ISINSCOPE ( Product[ProductName] ),",
              "    //calculate just at ProductName level",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( Product[ProductName] )",
              "        )",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "e476ffb2-ec42-41f5-ad46-78add735774f"
          },
          {
            "name": "Ratio1_by Product_HASONEVALUE",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    HASONEVALUE ( Product[ProductName] ),",
              "    //just a ProductName",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( Product[ProductName] )",
              "        )",
              ")"
            ],
            "expression": [
              "IF (",
              "    HASONEVALUE ( Product[ProductName] ),",
              "    //just a ProductName",
              "    [Total Sales]",
              "        / CALCULATE (",
              "            [Total Sales],",
              "            ALL ( Product[ProductName] )",
              "        )",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "lineageTag": "b08af84a-381f-4b88-b4f6-023cce4ffca1"
          },
          {
            "name": "HASONVALUE_ProductName",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": "HASONEVALUE ( Product[ProductName] )",
            "expression": "HASONEVALUE ( Product[ProductName] )",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "41723693-6b4a-4746-8dac-2825de7696b0"
          },
          {
            "name": "ISFILTERED_ProductName",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": "ISFILTERED ( Product[ProductName] )",
            "expression": "ISFILTERED ( Product[ProductName] )",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "c7365710-5529-49be-8c03-f9750ddb359e"
          },
          {
            "name": "ISNSCOPE_ProductName",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": "ISINSCOPE ( Product[ProductName] )",
            "expression": "ISINSCOPE ( Product[ProductName] )",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "48bb6292-5a6a-4631-9245-8d7cd9e20185"
          },
          {
            "name": "ISINSCOPE_test",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//see https://www.kasperonbi.com/use-isinscope-to-get-the-right-hierarchy-level-in-dax/",
              "SWITCH (",
              "    TRUE (),",
              "    ISINSCOPE ( 'ProductCategory 😀'[ProductCategoryName] ), \"Category scope\",",
              "    ISINSCOPE ( ProductSubcategory[ProductSubcategoryName] ), \"Subcategory scope\",",
              "    ISINSCOPE ( 'Product'[ProductName] ), \"Product scope\",",
              "    \"Other scope\"",
              ")"
            ],
            "expression": [
              "//see https://www.kasperonbi.com/use-isinscope-to-get-the-right-hierarchy-level-in-dax/",
              "SWITCH (",
              "    TRUE (),",
              "    ISINSCOPE ( 'ProductCategory 😀'[ProductCategoryName] ), \"Category scope\",",
              "    ISINSCOPE ( ProductSubcategory[ProductSubcategoryName] ), \"Subcategory scope\",",
              "    ISINSCOPE ( 'Product'[ProductName] ), \"Product scope\",",
              "    \"Other scope\"",
              ")"
            ],
            "lineageTag": "ba412ee7-7561-42ae-af08-99321d80ddb5"
          },
          {
            "name": "SalesRatio percent of year",
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR salesforanyYear =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        VALUES ( 'Date 👍'[CalendarYear] ),",
              "        // by (distinct) calendaryear",
              "        REMOVEFILTERS ( 'Date 👍' ) //remove all date filters",
              "    )",
              "RETURN",
              "    DIVIDE (",
              "        [Total Sales],",
              "        salesforanyYear,",
              "        0",
              "    )"
            ],
            "expression": [
              "VAR salesforanyYear =",
              "    CALCULATE (",
              "        [Total Sales],",
              "        VALUES ( 'Date 👍'[CalendarYear] ),",
              "        // by (distinct) calendaryear",
              "        REMOVEFILTERS ( 'Date 👍' ) //remove all date filters",
              "    )",
              "RETURN",
              "    DIVIDE (",
              "        [Total Sales],",
              "        salesforanyYear,",
              "        0",
              "    )"
            ],
            "formatString": "#,0.00%;-#,0.00%;#,0.00%",
            "lineageTag": "2490f8db-537a-4165-a30d-075be287ec37"
          },
          {
            "name": "Wrong % Months*",
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR ts = [Total Sales]",
              "VAR div =",
              "    CALCULATE (",
              "        ts,",
              "        ALL ( 'Date 👍'[EnglishMonthName*] )",
              "    ) //this is already sorted by MNOY",
              "RETURN",
              "    DIVIDE (",
              "        ts,",
              "        div,",
              "        0",
              "    )"
            ],
            "expression": [
              "VAR ts = [Total Sales]",
              "VAR div =",
              "    CALCULATE (",
              "        ts,",
              "        ALL ( 'Date 👍'[EnglishMonthName*] )",
              "    ) //this is already sorted by MNOY",
              "RETURN",
              "    DIVIDE (",
              "        ts,",
              "        div,",
              "        0",
              "    )"
            ],
            "formatString": "0%;-0%;0%",
            "lineageTag": "8a84f96d-a230-4b29-8882-80b5ee156cd0"
          },
          {
            "name": "Right % Months*",
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//interestingly, you still get a wrong answer if you do the calc below with variables!!!!",
              "DIVIDE (",
              "    [Total Sales],",
              "    CALCULATE (",
              "        [Total Sales],",
              "        ALL (",
              "            'Date 👍'[EnglishMonthName*],",
              "            'Date 👍'[MonthNumberOfYear]",
              "        ) //visual and sort columns",
              "    ),",
              "    0",
              ")"
            ],
            "expression": [
              "//interestingly, you still get a wrong answer if you do the calc below with variables!!!!",
              "DIVIDE (",
              "    [Total Sales],",
              "    CALCULATE (",
              "        [Total Sales],",
              "        ALL (",
              "            'Date 👍'[EnglishMonthName*],",
              "            'Date 👍'[MonthNumberOfYear]",
              "        ) //visual and sort columns",
              "    ),",
              "    0",
              ")"
            ],
            "formatString": "0%;-0%;0%",
            "lineageTag": "3f0a72a3-e0e9-4b39-9e14-e346bd14411d"
          },
          {
            "name": "Right % Months**",
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//again, this returns incorrect if you use variables",
              "//sorted with non breaking spaces",
              "DIVIDE (",
              "    [Total Sales],",
              "    CALCULATE (",
              "        [Total Sales],",
              "        ALL ( 'Date 👍'[EnglishMonthName**] //presorted using non breaking spaces",
              "        )",
              "    ),",
              "    0",
              ")"
            ],
            "expression": [
              "//again, this returns incorrect if you use variables",
              "//sorted with non breaking spaces",
              "DIVIDE (",
              "    [Total Sales],",
              "    CALCULATE (",
              "        [Total Sales],",
              "        ALL ( 'Date 👍'[EnglishMonthName**] //presorted using non breaking spaces",
              "        )",
              "    ),",
              "    0",
              ")"
            ],
            "formatString": "0%;-0%;0%",
            "lineageTag": "8daae32e-08a9-44e4-97a3-17fa27395842"
          }
        ],
        "partitions": [
          {
            "name": "All ALL Measures-122d7b3a-2f78-4656-9660-bc9b4814944a",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type text) meta [Serialized.Text = true]) in type table [Column1 = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Column1\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "All FILTER Measures",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "lineageTag": "0061f45b-c5c1-4c30-8c27-a4774c6855ce",
        "measures": [
          {
            "name": "AlwaysRed",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    'Product'[Color] = \"Red\"",
              ")",
              "//no matter what row you are on, show me the red total"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    'Product'[Color] = \"Red\"",
              ")",
              "//no matter what row you are on, show me the red total"
            ],
            "formatString": "#,0",
            "lineageTag": "aab2e5df-0d40-45f9-96a4-826242d8b381"
          },
          {
            "name": "AlwaysRed_Filter",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALL ( 'Product'[Color] ) //no matter what color row you are on",
              "        ,",
              "        'Product'[Color] = \"Red\" // show me totalsales for red",
              "    )",
              ")",
              "// test by slicing by Accessories - it does filter"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALL ( 'Product'[Color] ) //no matter what color row you are on",
              "        ,",
              "        'Product'[Color] = \"Red\" // show me totalsales for red",
              "    )",
              ")",
              "// test by slicing by Accessories - it does filter"
            ],
            "formatString": "#,0",
            "lineageTag": "2579a5a0-2a51-4cc5-a353-c24866733bfd"
          },
          {
            "name": "OnlyRed_Values",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        //YOU DON'T ACTUALLY NEED THE FILTER IN THIS CASE as it is naturally provided by CALCULATE in the following argument",
              "        VALUES ( 'Product'[Color] ),",
              "        'Product'[Color] = \"Red\" //only show total sales for color where color =red",
              "        //nb Values can only account for 1 column. For multiple criteria see OnlyRed_<1000",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        //YOU DON'T ACTUALLY NEED THE FILTER IN THIS CASE as it is naturally provided by CALCULATE in the following argument",
              "        VALUES ( 'Product'[Color] ),",
              "        'Product'[Color] = \"Red\" //only show total sales for color where color =red",
              "        //nb Values can only account for 1 column. For multiple criteria see OnlyRed_<1000",
              "    )",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "1e59a40a-00c8-478b-9ccf-99f508bf690e"
          },
          {
            "name": "OnlyRed_KeepFilters",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    KEEPFILTERS ( 'Product'[Color] = \"Red\" )",
              ")",
              "//just simpler than FILTER and VALUES"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    KEEPFILTERS ( 'Product'[Color] = \"Red\" )",
              ")",
              "//just simpler than FILTER and VALUES"
            ],
            "formatString": "#,0",
            "lineageTag": "14b09515-89ba-4ef3-916a-48fb25833fd5"
          },
          {
            "name": "AlwaysRed_FilterALL",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALL ( 'Product' ) // remove all filters on product table no matter how you slice it ",
              "        //- on the other hand, always less efficient than ALL('Product'[Color]), if color is the only criteria",
              "        ,",
              "        'Product'[Color] = \"Red\" // except color =red",
              "    )",
              ")",
              "//test by slicing by Accessories - it does not filter and remains as the red grand total"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        ALL ( 'Product' ) // remove all filters on product table no matter how you slice it ",
              "        //- on the other hand, always less efficient than ALL('Product'[Color]), if color is the only criteria",
              "        ,",
              "        'Product'[Color] = \"Red\" // except color =red",
              "    )",
              ")",
              "//test by slicing by Accessories - it does not filter and remains as the red grand total"
            ],
            "formatString": "#,0",
            "lineageTag": "d9f1c003-0d89-4ff9-b99e-bbf0aa52502b"
          },
          {
            "name": "Only <£10_Summarize",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        SUMMARIZE (",
              "            'Product',",
              "            'Product'[ListPrice]",
              "        ) //a distinct list of prices - can test in an evaluate statement",
              "        ,",
              "        'Product'[ListPrice] < 10 //where...",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        SUMMARIZE (",
              "            'Product',",
              "            'Product'[ListPrice]",
              "        ) //a distinct list of prices - can test in an evaluate statement",
              "        ,",
              "        'Product'[ListPrice] < 10 //where...",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "c4166c66-1c2b-4695-9cdf-2ba785cc0e80"
          },
          {
            "name": "Only <£10_KeepFilters",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    KEEPFILTERS (",
              "        FILTER (",
              "            ALL ( 'Product'[ListPrice] ),",
              "            'Product'[ListPrice] < 10",
              "        )",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    KEEPFILTERS (",
              "        FILTER (",
              "            ALL ( 'Product'[ListPrice] ),",
              "            'Product'[ListPrice] < 10",
              "        )",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "e0f7927b-1cdb-47e1-bc70-c86b9c1ddab6"
          },
          {
            "name": "Only <£10",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "SUMX (",
              "    //using the following row set, sum total sales",
              "    CALCULATETABLE (",
              "        'InternetSales 😀',",
              "        'InternetSales 😀'[UnitPrice] < 10",
              "    ) //just add criteria - can test in an evaluate statement",
              "    ,",
              "    [Total Sales]",
              ")"
            ],
            "expression": [
              "SUMX (",
              "    //using the following row set, sum total sales",
              "    CALCULATETABLE (",
              "        'InternetSales 😀',",
              "        'InternetSales 😀'[UnitPrice] < 10",
              "    ) //just add criteria - can test in an evaluate statement",
              "    ,",
              "    [Total Sales]",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "65f70691-1150-48ee-9427-93827b714144"
          },
          {
            "name": "US Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "SUMX (",
              "    FILTER (",
              "        'InternetSales 😀',",
              "        RELATED ( Geography[CountryRegionCode] ) = \"US\" // join on",
              "    ),",
              "    [Total Sales] //US sales only",
              ")"
            ],
            "expression": [
              "SUMX (",
              "    FILTER (",
              "        'InternetSales 😀',",
              "        RELATED ( Geography[CountryRegionCode] ) = \"US\" // join on",
              "    ),",
              "    [Total Sales] //US sales only",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "d7eba344-87fc-450b-a0e9-f221a4308ae2"
          },
          {
            "name": "US total of individual sales over 1k",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR US =",
              "    FILTER (",
              "        //just get US",
              "        VALUES ( Geography[CountryRegionCode] ),",
              "        Geography[CountryRegionCode] = \"US\"",
              "    )",
              "VAR US1k =",
              "    SUMX (",
              "        US //for US dataset",
              "        ,",
              "        CALCULATE (",
              "            [Total Sales],",
              "            'InternetSales 😀'[SalesAmount] > 1000",
              "        ) // sum total sales for individual salesamount>1000",
              "    )",
              "RETURN",
              "    US1k"
            ],
            "expression": [
              "VAR US =",
              "    FILTER (",
              "        //just get US",
              "        VALUES ( Geography[CountryRegionCode] ),",
              "        Geography[CountryRegionCode] = \"US\"",
              "    )",
              "VAR US1k =",
              "    SUMX (",
              "        US //for US dataset",
              "        ,",
              "        CALCULATE (",
              "            [Total Sales],",
              "            'InternetSales 😀'[SalesAmount] > 1000",
              "        ) // sum total sales for individual salesamount>1000",
              "    )",
              "RETURN",
              "    US1k"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "00a6b32f-ea22-4dab-9ae8-4961536e2827"
          },
          {
            "name": "OnlyRed_<£1000",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        SUMMARIZE (",
              "            'Product',",
              "            'Product'[Color],",
              "            'Product'[ListPrice]",
              "        ) //create unique combinations of color and listprice",
              "        //nb VALUES can only account for 1 column, SUMMARIZE allows multiple columns",
              "        ,",
              "        'Product'[Color] = \"Red\"",
              "            && 'Product'[ListPrice] < 1000 //where...",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        SUMMARIZE (",
              "            'Product',",
              "            'Product'[Color],",
              "            'Product'[ListPrice]",
              "        ) //create unique combinations of color and listprice",
              "        //nb VALUES can only account for 1 column, SUMMARIZE allows multiple columns",
              "        ,",
              "        'Product'[Color] = \"Red\"",
              "            && 'Product'[ListPrice] < 1000 //where...",
              "    )",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "f70cb7da-6759-4272-8499-ab806caba129"
          },
          {
            "name": "OnlyRed_KeepFilters_<£1000",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    KEEPFILTERS ( 'Product'[ListPrice] < 1000 ),",
              "    KEEPFILTERS ( 'Product'[Color] = \"Red\" )",
              ")",
              "//again just more simple than Filter/Summarize"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    KEEPFILTERS ( 'Product'[ListPrice] < 1000 ),",
              "    KEEPFILTERS ( 'Product'[Color] = \"Red\" )",
              ")",
              "//again just more simple than Filter/Summarize"
            ],
            "formatString": "#,0",
            "lineageTag": "d2edeb27-5d86-401d-b869-1e722c79fc8a"
          },
          {
            "name": "European sales over 1k",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR eur =",
              "    FILTER (",
              "        //just get countries",
              "        VALUES ( Geography[EnglishCountryRegionName] ),",
              "        Geography[EnglishCountryRegionName]",
              "            IN {",
              "            \"united kingdom\",",
              "            \"france\",",
              "            \"germany\"",
              "        }",
              "    )",
              "VAR eur1k =",
              "    SUMX (",
              "        eur //for european dataset",
              "        ,",
              "        CALCULATE (",
              "            [Total Sales],",
              "            'InternetSales 😀'[SalesAmount] > 1000",
              "        ) // sum total sales for individual salesamount>1000",
              "    )",
              "RETURN",
              "    eur1k"
            ],
            "expression": [
              "VAR eur =",
              "    FILTER (",
              "        //just get countries",
              "        VALUES ( Geography[EnglishCountryRegionName] ),",
              "        Geography[EnglishCountryRegionName]",
              "            IN {",
              "            \"united kingdom\",",
              "            \"france\",",
              "            \"germany\"",
              "        }",
              "    )",
              "VAR eur1k =",
              "    SUMX (",
              "        eur //for european dataset",
              "        ,",
              "        CALCULATE (",
              "            [Total Sales],",
              "            'InternetSales 😀'[SalesAmount] > 1000",
              "        ) // sum total sales for individual salesamount>1000",
              "    )",
              "RETURN",
              "    eur1k"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "8613d117-230f-40cf-9e31-50d8c061e3c2"
          },
          {
            "name": "European sales over ?",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "VAR slider = 'Sales Amount slider'[Sales Amount slider Value]",
              "VAR eur =",
              "    FILTER (",
              "        //just get countries",
              "        VALUES ( Geography[EnglishCountryRegionName] ),",
              "        Geography[EnglishCountryRegionName]",
              "            IN {",
              "            \"united kingdom\",",
              "            \"france\",",
              "            \"germany\"",
              "        }",
              "    )",
              "VAR eur1k =",
              "    SUMX (",
              "        eur //for european dataset",
              "        ,",
              "        CALCULATE (",
              "            [Total Sales],",
              "            'InternetSales 😀'[SalesAmount] > slider",
              "        ) // sum total sales for individual salesamount>?",
              "        // interestingly, this errors if you replace the slider variable with the literal 'Sales Amount slider'[Sales Amount slider Value]",
              "    )",
              "RETURN",
              "    eur1k"
            ],
            "expression": [
              "VAR slider = 'Sales Amount slider'[Sales Amount slider Value]",
              "VAR eur =",
              "    FILTER (",
              "        //just get countries",
              "        VALUES ( Geography[EnglishCountryRegionName] ),",
              "        Geography[EnglishCountryRegionName]",
              "            IN {",
              "            \"united kingdom\",",
              "            \"france\",",
              "            \"germany\"",
              "        }",
              "    )",
              "VAR eur1k =",
              "    SUMX (",
              "        eur //for european dataset",
              "        ,",
              "        CALCULATE (",
              "            [Total Sales],",
              "            'InternetSales 😀'[SalesAmount] > slider",
              "        ) // sum total sales for individual salesamount>?",
              "        // interestingly, this errors if you replace the slider variable with the literal 'Sales Amount slider'[Sales Amount slider Value]",
              "    )",
              "RETURN",
              "    eur1k"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "2152c80c-a974-4e33-bc22-22266d00d5d4"
          },
          {
            "name": "Filter test - ProductSubcategoryName",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "SWITCH (",
              "    TRUE (),",
              "    ISFILTERED ( ProductSubcategory[ProductSubcategoryName] ), \"direct filter on subcategory\",",
              "    ISCROSSFILTERED ( ProductSubcategory[ProductSubcategoryName] ), \"indirect filter on subcategory\",",
              "    \"no filters\"",
              ")"
            ],
            "expression": [
              "SWITCH (",
              "    TRUE (),",
              "    ISFILTERED ( ProductSubcategory[ProductSubcategoryName] ), \"direct filter on subcategory\",",
              "    ISCROSSFILTERED ( ProductSubcategory[ProductSubcategoryName] ), \"indirect filter on subcategory\",",
              "    \"no filters\"",
              ")"
            ],
            "lineageTag": "372371a7-8483-492e-a7a4-4ca3c7fa11b6"
          },
          {
            "name": "TotalSales2008FILTER",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        'Date 👍',",
              "        'Date 👍'[CalendarYear] = 2008",
              "    )",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    FILTER (",
              "        'Date 👍',",
              "        'Date 👍'[CalendarYear] = 2008",
              "    )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "e80d454e-c0a3-4519-947a-ab3cf94f1088"
          },
          {
            "name": "TotalSales2008",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "CALCULATE (",
              "    [Total Sales],",
              "    'Date 👍'[CalendarYear] = 2008",
              ")"
            ],
            "expression": [
              "CALCULATE (",
              "    [Total Sales],",
              "    'Date 👍'[CalendarYear] = 2008",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "26d303e8-7cc8-424e-a9de-781aad3ae5ce"
          },
          {
            "name": "OnlyRed_SumX",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "SUMX (",
              "    FILTER (",
              "        'InternetSales 😀',",
              "        RELATED ( 'Product'[Color] ) = \"Red\"",
              "    ),",
              "    'InternetSales 😀'[SalesAmount]",
              ")"
            ],
            "expression": [
              "SUMX (",
              "    FILTER (",
              "        'InternetSales 😀',",
              "        RELATED ( 'Product'[Color] ) = \"Red\"",
              "    ),",
              "    'InternetSales 😀'[SalesAmount] //column",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "4ebfd514-6899-47cd-8c1b-a17c55456539"
          },
          {
            "name": "OnlyRed_Search",
            "expression": [
              "",
              "CALCULATE(",
              "    [Total Sales],",
              "    FILTER(",
              "        KEEPFILTERS(VALUES('Product'[Color])), //retain the color filter",
              "        SEARCH(\"red\",'Product'[Color],1,0) >=1 //contains red ",
              "        //https://www.sqlbi.com/articles/optimizing-text-search-in-dax/",
              "        --useful if searching wider text columns",
              "    )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "7bf647f3-1013-463c-b31f-3a1a00c29cb5"
          },
          {
            "name": "OnlyRed_ContainsString",
            "expression": [
              "",
              "CALCULATE(",
              "    [Total Sales],",
              "    FILTER(",
              "        KEEPFILTERS(VALUES('Product'[Color])), //retain the color filter",
              "        CONTAINSSTRING('Product'[Color],\"*ed\" ",
              "        //https://www.sqlbi.com/articles/optimizing-text-search-in-dax/",
              "        --useful if searching wider text columns",
              "    )",
              "))"
            ],
            "formatString": "0",
            "lineageTag": "2a90ecb7-317a-4ef0-8515-637602c4dba4"
          }
        ],
        "partitions": [
          {
            "name": "All FILTER Measures-b01b2a36-95c4-4537-9e3e-0206e771c640",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type text) meta [Serialized.Text = true]) in type table [Column1 = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Column1\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "InternetSales_Current",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "ProductKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0489fe5c-f5b2-441c-8841-f5c35c3180f1",
            "sourceColumn": "ProductKey",
            "summarizeBy": "none"
          },
          {
            "name": "OrderDateKey_Original",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "fa999cd8-29b9-492f-a017-7a5f86cbac63",
            "sourceColumn": "OrderDateKey_Original",
            "summarizeBy": "sum"
          },
          {
            "name": "CustomerKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c00f4f95-12ea-4b0c-ab46-4ac40bd0050d",
            "sourceColumn": "CustomerKey",
            "summarizeBy": "none"
          },
          {
            "name": "OrderQuantity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "91c7ccaa-f6cd-4e84-980e-97385ae34796",
            "sourceColumn": "OrderQuantity",
            "summarizeBy": "sum"
          },
          {
            "name": "UnitPrice",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "6592464e-1515-4705-b01f-e7f3f8771f2e",
            "sourceColumn": "UnitPrice",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalProductCost",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "7ee9e0f5-14c8-461f-ad9a-fca9e79c6dc1",
            "sourceColumn": "TotalProductCost",
            "summarizeBy": "sum"
          },
          {
            "name": "SalesAmount",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "80228a02-655f-4ccb-9477-1d16a1395909",
            "sourceColumn": "SalesAmount",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxAmt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "cb3f6693-a076-483b-a2bc-5e7790c72aed",
            "sourceColumn": "TaxAmt",
            "summarizeBy": "sum"
          },
          {
            "name": "Freight",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "decimal",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "b1c9b2bd-bcd0-4028-ab87-e00258f7d791",
            "sourceColumn": "Freight",
            "summarizeBy": "sum"
          },
          {
            "name": "OrderDate_Original",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "f1bc82c9-296f-4eda-85b3-8a39bb63f4d5",
            "sourceColumn": "OrderDate_Original",
            "summarizeBy": "none"
          },
          {
            "name": "OrderDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "expression": "DATE ( YEAR ( InternetSales_Current[OrderDate_Original] ) + 11, MONTH ( InternetSales_Current[OrderDate_Original] ), DAY ( InternetSales_Current[OrderDate_Original] ) )",
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "lineageTag": "d2bbccd2-8804-47fe-9c06-cfd51ac2a47e",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "OrderDateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "expression": [
              "FORMAT (",
              "    InternetSales_Current[OrderDate],",
              "    \"YYYYMMdd\"",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "fdf6aa4f-8384-426b-b3ed-49f952741bd2",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "34b7118e-1b8a-4711-9a0b-ff8ddda4b5cd",
        "measures": [
          {
            "name": "IS_Current Total Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": "SUM ( InternetSales_Current[SalesAmount] )",
            "expression": "SUM ( InternetSales_Current[SalesAmount] )",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "1b63b73f-0364-4eb4-b26b-e8a706e540ba"
          },
          {
            "name": "IS_Current Average Sales",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": "AVERAGE ( InternetSales_Current[SalesAmount] )",
            "expression": "AVERAGE ( InternetSales_Current[SalesAmount] )",
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "49426583-fa9d-4ab7-9b47-37240ef7ccdd"
          }
        ],
        "partitions": [
          {
            "name": "InternetSales_Current-64715e36-c63a-4500-a1ca-beccb4e76933",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\"192.168.1.116\\sql2017\", \"adventureworksdw\"),",
                "    dbo_FactInternetSales = Source{[Schema=\"dbo\",Item=\"FactInternetSales\"]}[Data],",
                "    #\"Removed Columns\" = Table.RemoveColumns(dbo_FactInternetSales,{\"DueDateKey\", \"ShipDateKey\", \"PromotionKey\", \"CurrencyKey\", \"SalesTerritoryKey\", \"SalesOrderNumber\", \"SalesOrderLineNumber\", \"RevisionNumber\", \"ExtendedAmount\", \"UnitPriceDiscountPct\", \"DiscountAmount\", \"ProductStandardCost\", \"CarrierTrackingNumber\", \"CustomerPONumber\", \"DueDate\", \"ShipDate\", \"DimCurrency\", \"DimPromotion\"}),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Removed Columns\",{{\"OrderDate\", type date}}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Changed Type\",{{\"OrderDate\", \"OrderDate_Original\"}, {\"OrderDateKey\", \"OrderDateKey_Original\"}})",
                "in",
                "    #\"Renamed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Calendar_Current",
        "columns": [
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "7fccb741-a511-4e1a-a800-d550aa69c042",
            "sourceColumn": "[Date]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "YEAR ( 'Calendar_Current'[Date] )",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "fbdb3493-f570-4c69-b614-eb82caec08a3",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "YEAR ( 'Calendar_Current'[Date] ) & \"-Q\"",
              "    & FORMAT (",
              "        'Calendar_Current'[Date],",
              "        \"q\"",
              "    )"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "10735308-dba0-481c-80b6-f2e774b9f8d5",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "MonthYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "FORMAT (",
              "    'Calendar_Current'[Date],",
              "    \"MMM yyyy\"",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "ce22a4a3-56aa-47d6-8363-6fd26361a9c7",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "MonthYearsortbyYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "FORMAT (",
              "    'Calendar_Current'[Date],",
              "    \"yyyyMM\"",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "6d0a8680-ac43-4fe5-b905-1acd34de869e",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "FORMAT (",
              "    'Calendar_Current'[Date],",
              "    \"MMM\"",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "fe432d20-be87-4e84-9010-5db2bd9048d1",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "MonthsortinYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "MONTH ( 'Calendar_Current'[Date] )",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "e60f1807-6a9d-449d-922a-9b935aca55f6",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "WeekDay",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "FORMAT (",
              "    'Calendar_Current'[Date],",
              "    \"ddd\"",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "c2b1a0b8-3ca9-47d0-9827-4ca8cdde9d3e",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "WeekDaysort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "WEEKDAY (",
              "    'Calendar_Current'[Date],",
              "    2",
              ")"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "fd616f68-4482-4767-9a69-046d4cc184e4",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "MonthDay",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "DAY ( 'Calendar_Current'[Date] )",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "f811744a-9106-4dfb-bd45-2077b56e7f72",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "DayIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "DATEDIFF (",
              "    'Calendar_Current'[Date],",
              "    TODAY (),",
              "    DAY",
              ") * -1",
              "// days ago from today"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "9a1d3075-11e9-4452-a8ee-34a875d3853d",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "MonthIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "//months ago from today",
              "(",
              "    (",
              "        'Calendar_Current'[Year]",
              "            - YEAR (",
              "                TODAY ()",
              "            )",
              "    ) * 12",
              ") + 'Calendar_Current'[MonthsortinYear]",
              "    - MONTH (",
              "        TODAY ()",
              "    )"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "e6c039b4-2f1c-4039-bc27-234190f26ffb",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "YearIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "INT (",
              "    'Calendar_Current'[Year]",
              "        - YEAR (",
              "            TODAY ()",
              "        )",
              ")",
              "// years ago"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "cef25275-d91d-4eb1-a15e-60e57ea76658",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "DayofYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "DATEDIFF (",
              "    DATE ( YEAR ( 'Calendar_Current'[Date] ), 1, 1 ),",
              "    'Calendar_Current'[Date],",
              "    DAY",
              ") + 1"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "759ec648-51dc-4097-97ea-5fddf30f1555",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "DateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "FORMAT (",
              "    'Calendar_Current'[Date],",
              "    \"yyyyMMdd\"",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "88dafd7b-dfec-495f-9247-784e76aceab3",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "WeekNum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "WEEKNUM (",
              "    'Calendar_Current'[Date],",
              "    2",
              ")",
              "//2= starts Monday"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "e5c7e00b-75f2-4d6e-9369-5fe53541e2ad",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "WeekIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "expression": [
              "ROUNDDOWN (",
              "    ( 'Calendar_Current'[DayIndex] - ( 'Calendar_Current'[WeekDaysort] - 1 ) ) / 7,",
              "    0",
              ")",
              "//-1 so current week is 0"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "8b6ebb69-eea3-4a8b-b552-7084c48078fb",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "YearWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "'Calendar_Current'[Year] & \" W\" & 'Calendar_Current'[WeekNum]",
            "isDataTypeInferred": true,
            "lineageTag": "b055cbe8-f1b4-4fcf-ac6b-d510ba592407",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "StartofYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "expression": "DATE ( YEAR ( 'Calendar_Current'[Date] ), 1, 1 )",
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "lineageTag": "69acf91b-c4ff-4486-9a43-cc90a045cf10",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "StartofMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "expression": "DATE ( YEAR ( 'Calendar_Current'[Date] ), MONTH ( 'Calendar_Current'[Date] ), 1 )",
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "lineageTag": "68a759cd-856c-4588-b4dc-9b052ea1a5f5",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "EndofYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "expression": [
              "DATE ( Calendar_Current[Year], 12, 31 )",
              "//do not use ENDOFYEAR in case your dates do not go to the year end"
            ],
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "lineageTag": "66c2dd1e-f2d6-48e1-a84d-ac21c3a24d32",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "EndofMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "expression": [
              "VAR monthend =",
              "    SWITCH (",
              "        Calendar_Current[MonthsortinYear],",
              "        1, 31,",
              "        2, 28,",
              "        3, 31,",
              "        4, 30,",
              "        5, 31,",
              "        6, 30,",
              "        7, 31,",
              "        8, 31,",
              "        9, 30,",
              "        10, 31,",
              "        11, 30,",
              "        12, 31",
              "    ) // month number and last day",
              "RETURN",
              "    IF (",
              "        Calendar_Current[MonthIndex] <> 0 // test for current month",
              "        ,",
              "        ENDOFMONTH ( 'Calendar_Current'[Date] ),",
              "        DATE ( Calendar_Current[Year], Calendar_Current[MonthsortinYear], monthend ) // required else ENDOFMONTH returns the current day of the month for MonthIndex=0",
              "        //as calendat runs only to TODAY",
              "    )"
            ],
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "lineageTag": "9cb3b186-0930-4835-ab14-7d9ee580c6d8",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "12monthrange",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "VAR _maxdate =",
              "    MAX ( internetsales_current[orderdate] )",
              "RETURN",
              "    IF (",
              "        DATEDIFF (",
              "            calendar_current[date],",
              "            _maxdate,",
              "            MONTH",
              "        )",
              "            IN GENERATESERIES (",
              "                1,",
              "                12,",
              "                1",
              "            ),",
              "        1,",
              "        0",
              "    )",
              "//day/month/year and any range",
              "//now just use basic filter in a report, 12monthrange=1"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "95d7ccba-0934-4421-991a-99feb3843deb",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "RelativeWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "expression": [
              "VAR startofweek =",
              "    Calendar_Current[Date]",
              "        - WEEKDAY (",
              "            Calendar_Current[Date],",
              "            2",
              "        ) + 1 //2= starts monday",
              "VAR startofcurrentweek =",
              "    TODAY ()",
              "        - WEEKDAY (",
              "            TODAY (),",
              "            2",
              "        ) + 1",
              "RETURN",
              "    ( startofweek - startofcurrentweek ) / 7"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "c6324fbf-f540-4139-bb7a-9828dad23f92",
            "summarizeBy": "sum",
            "type": "calculated"
          }
        ],
        "lineageTag": "42346c94-3863-4598-ae02-59fd0417b615",
        "partitions": [
          {
            "name": "Calendar_Current-a6021d4c-981e-4f13-98b3-71dc1d1c47f5",
            "mode": "import",
            "source": {
              "expression": [
                "CALENDAR (",
                "    DATE ( YEAR (",
                "        MIN ( InternetSales_Current[OrderDate] )",
                "    ), MONTH (",
                "        MIN ( InternetSales_Current[OrderDate] )",
                "    ), 1 ),",
                "    // 1st day of 1st month's sales",
                "    //Date( ",
                "    // YEAR( MAX(InternetSales_Current[OrderDate]) ), ",
                "    // MONTH( MAX(InternetSales_Current[OrderDate]) ), ",
                "    // DAY( MAX(InternetSales_Current[OrderDate]) )) // last day of last month's sales",
                "    //up to current date: ",
                "    DATE ( YEAR (",
                "        NOW ()",
                "    ), MONTH (",
                "        NOW ()",
                "    ), DAY (",
                "        NOW ()",
                "    ) )",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "measurehelper",
        "columns": [
          {
            "name": "measurename",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "28200bff-7da5-44ad-8953-9623b864fc19",
            "sourceColumn": "[measurename]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "88d649b1-8293-42ea-8493-6cd874f3b328",
        "measures": [
          {
            "name": "measurename value",
            "description": [
              "SELECTEDVALUE (",
              "    measurehelper[measurename],",
              "    \"Total Sales\"",
              ")"
            ],
            "expression": [
              "SELECTEDVALUE (",
              "    measurehelper[measurename],",
              "    \"Total Sales\"",
              ")"
            ],
            "lineageTag": "9eb6238d-1ea6-4eda-abc4-edd733768306"
          },
          {
            "name": "Switch Measure2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "description": [
              "SWITCH (",
              "    [measurename value],",
              "    //is selectedvalue",
              "    \"Total Sales\", [Total Sales],",
              "    \"Total Profit\", [Total Profit],",
              "    \"Total Costs\", [Total Costs]",
              ")"
            ],
            "expression": [
              "SWITCH (",
              "    [measurename value],",
              "    //is selectedvalue",
              "    \"Total Sales\", [Total Sales],",
              "    \"Total Profit\", [Total Profit],",
              "    \"Total Costs\", [Total Costs]",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "fd83d963-f284-407c-9b8a-1be27facaa65"
          },
          {
            "name": "Rank Selected Countries by Sales/Profit/Cost",
            "description": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [measurename value] )",
              "    ),",
              "    // hides if measure is blank",
              "    RANKX (",
              "        ALLSELECTED ( Geography[EnglishCountryRegionName] ),",
              "        [Switch Measure2]",
              "    )",
              ")"
            ],
            "expression": [
              "IF (",
              "    NOT (",
              "        ISBLANK ( [measurename value] )",
              "    ),",
              "    // hides if measure is blank",
              "    RANKX (",
              "        ALLSELECTED ( Geography[EnglishCountryRegionName] ),",
              "        [Switch Measure2]",
              "    )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "8da6beef-ae62-4ad6-b9e9-8831fa7385f5"
          }
        ],
        "partitions": [
          {
            "name": "measurehelper-052bd06b-2514-4cfb-bea2-257b25b8e4f9",
            "mode": "import",
            "source": {
              "expression": [
                "DATATABLE (",
                "    \"measurename\", STRING,",
                "    {",
                "        { \"Total Sales\" },",
                "        { \"Total Profit\" },",
                "        { \"Total Costs\" }",
                "    }",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Sales Amount slider",
        "columns": [
          {
            "name": "Sales Amount slider",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "version": 0
                }
              }
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "4f00ef01-a3fb-407e-8e45-6d3a9490a17e",
            "sourceColumn": "[Value]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "240a4636-2dd8-4cb4-b529-b73ad428606b",
        "measures": [
          {
            "name": "Sales Amount slider Value",
            "description": [
              "SELECTEDVALUE (",
              "    'Sales Amount slider'[Sales Amount slider],",
              "    100",
              ")"
            ],
            "expression": [
              "SELECTEDVALUE (",
              "    'Sales Amount slider'[Sales Amount slider],",
              "    100",
              ")"
            ],
            "lineageTag": "5a547eec-9de4-417b-bea9-65a8df49be77"
          }
        ],
        "partitions": [
          {
            "name": "Sales Amount slider-c32b4de4-007e-44d6-ae5c-d4090446ac24",
            "mode": "import",
            "source": {
              "expression": [
                "GENERATESERIES (",
                "    100,",
                "    2000,",
                "    100",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "datehelper",
        "columns": [
          {
            "name": "datenum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "b946d9be-01e1-4410-bf61-26af3288de72",
            "sourceColumn": "[datenum]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "datename",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "3829ec97-7dd6-411b-a7b8-4e83f0693cad",
            "sourceColumn": "[datename]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "94149b70-3294-4f6d-8f8f-71620f1dd89b",
        "measures": [
          {
            "name": "Total Sales Switch Date",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "description": [
              "SWITCH (",
              "    [pickone],",
              "    \"order date\",",
              "        CALCULATE (",
              "            [Total Sales],",
              "            USERELATIONSHIP ( 'InternetSales 😀'[OrderDateKey], 'Date 👍'[DateKey] )",
              "        ),",
              "    \"due date\",",
              "        CALCULATE (",
              "            [Total Sales],",
              "            USERELATIONSHIP ( 'InternetSales 😀'[DueDateKey], 'Date 👍'[DateKey] )",
              "        ),",
              "    \"ship date\",",
              "        CALCULATE (",
              "            [Total Sales],",
              "            USERELATIONSHIP ( 'InternetSales 😀'[ShipDateKey], 'Date 👍'[DateKey] )",
              "        )",
              ")"
            ],
            "expression": [
              "SWITCH (",
              "    [pickone],",
              "    \"order date\",",
              "        CALCULATE (",
              "            [Total Sales],",
              "            USERELATIONSHIP ( 'InternetSales 😀'[OrderDateKey], 'Date 👍'[DateKey] )",
              "        ),",
              "    \"due date\",",
              "        CALCULATE (",
              "            [Total Sales],",
              "            USERELATIONSHIP ( 'InternetSales 😀'[DueDateKey], 'Date 👍'[DateKey] )",
              "        ),",
              "    \"ship date\",",
              "        CALCULATE (",
              "            [Total Sales],",
              "            USERELATIONSHIP ( 'InternetSales 😀'[ShipDateKey], 'Date 👍'[DateKey] )",
              "        )",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "309537b5-2a2e-48eb-ad81-d5c8f555777a"
          },
          {
            "name": "pickone",
            "description": "SELECTEDVALUE ( datehelper[datename] )",
            "expression": "SELECTEDVALUE ( datehelper[datename] )",
            "lineageTag": "9cdb30a3-0626-4be9-ac02-fbb315d01dd7"
          },
          {
            "name": "Total Sales ship date",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "CALCULATE (",
              "            [Total Sales],",
              "            USERELATIONSHIP ( 'InternetSales 😀'[ShipDateKey], 'Date 👍'[DateKey] )",
              "        )"
            ],
            "lineageTag": "af915eb7-4142-4d42-a93c-d9d6ea544e81"
          },
          {
            "name": "Total Sales unshipped",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "//for orders not yet shipped (none in this data)",
              "CALCULATE (",
              "            [Total Sales],",
              "            ISBLANK('InternetSales 😀'[ShipDateKey] )",
              "        )"
            ],
            "lineageTag": "3c026937-d3b8-4e37-b3ba-c28f4578b42a"
          },
          {
            "name": "Total Sales by Shipped2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "CALCULATE (",
              "[Total Sales],",
              "CROSSFILTER ( 'Date 👍'[DateKey], 'InternetSales 😀'[OrderDateKey], NONE ),-- disables default relationship",
              "TREATAS (",
              "VALUES ( 'Date 👍'[DateKey] ),",
              "'InternetSales 😀'[ShipDateKey]",
              "    )",
              ")",
              ""
            ],
            "lineageTag": "5f01fe5a-c45a-432f-b712-c7979f85e100"
          }
        ],
        "partitions": [
          {
            "name": "datehelper-d651fc95-4401-421d-a7a1-892c17e49f76",
            "mode": "import",
            "source": {
              "expression": [
                "DATATABLE (",
                "    \"datenum\", INTEGER,",
                "    \"datename\", STRING,",
                "    {",
                "        { 1, \"order date\" },",
                "        { 2, \"due date\" },",
                "        { 3, \"ship date\" }",
                "    }",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "All Correct Totals",
        "annotations": [
          {
            "name": "PBI_QueryRelationships",
            "value": "{\"columnCount\":1,\"keyColumnNames\":[],\"queryRelationships\":[],\"columnIdentities\":[\"Section1/All Correct Totals/Changed Type.{Column1,0}\"],\"ColumnCount\":1,\"KeyColumnNames\":[],\"ColumnIdentities\":[\"Section1/All Correct Totals/Changed Type.{Column1,0}\"],\"RelationshipInfo\":[]}"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "lineageTag": "0e0d9455-3627-484a-97a3-fccbb6318424",
        "measures": [
          {
            "name": "High Days wrong",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "IF (",
              "    [Total Sales] > 20000,",
              "    1",
              ")"
            ],
            "expression": [
              "IF (",
              "    [Total Sales] > 20000,",
              "    1",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "f6b785da-e0e4-414f-8bca-fb10365ad93f"
          },
          {
            "name": "High Days correct",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//totally flexible within the date hierarchy",
              "SUMX (",
              "    'Date 👍',",
              "    // the x forces a row by row calculation FIRST",
              "    IF (",
              "        [Total Sales] > 20000,",
              "        1",
              "    )",
              ")"
            ],
            "expression": [
              "//totally flexible within the date hierarchy",
              "SUMX (",
              "    'Date 👍',",
              "    // the x forces a row by row calculation FIRST",
              "    IF (",
              "        [Total Sales] > 20000,",
              "        1",
              "    )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "c6c88b3e-cedb-4bd8-b832-cb45a19c5cdb"
          },
          {
            "name": "High Months at month level",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "SUMX (",
              "    VALUES ( 'Date 👍'[MMMYYYY] ),",
              "    //fixed at month level only",
              "    IF (",
              "        [Total Sales] > 500000,",
              "        1",
              "    )",
              ")"
            ],
            "expression": [
              "SUMX (",
              "    VALUES ( 'Date 👍'[MMMYYYY] ),",
              "    //fixed at month level only",
              "    IF (",
              "        [Total Sales] > 500000,",
              "        1",
              "    )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "b6cf146b-bf7d-41af-a4c2-ac19e091df66"
          },
          {
            "name": "High Months at month level or above",
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//Returns a blank whenever the report goes below the supported granularity,",
              "//guaranteeing that if a number is shown, it is the correct one.",
              "VAR DaysAtCurrentGrain =",
              "    //number of visible rows",
              "    COUNTROWS ( 'Date 👍' )",
              "VAR DaysAtFormulaGrain =",
              "    //enforce the month granularity.",
              "    CALCULATE (",
              "        COUNTROWS ( 'Date 👍' ),",
              "        ALL ( 'Date 👍' ),",
              "        VALUES ( 'Date 👍'[MMMYYYY] )",
              "    ) //If the two variables return the very same number, ",
              "//then DAX is working in a filter context at the month granularity level or above that (such as the year). ",
              "//If the two numbers are different, it means that the formula is computing the result below the supported granularity,",
              "// and the result must be a blank:",
              "VAR IsSafeToCompute = ( DaysAtCurrentGrain = DaysAtFormulaGrain )",
              "VAR Result =",
              "    IF (",
              "        IsSafeToCompute,",
              "        SUMX (",
              "            VALUES ( 'Date 👍'[MMMYYYY] ),",
              "            IF (",
              "                [Total Sales] > 500000,",
              "                1",
              "            )",
              "        )",
              "    )",
              "RETURN",
              "    Result"
            ],
            "expression": [
              "//Returns a blank whenever the report goes below the supported granularity,",
              "//guaranteeing that if a number is shown, it is the correct one.",
              "VAR DaysAtCurrentGrain =",
              "    //number of visible rows",
              "    COUNTROWS ( 'Date 👍' )",
              "VAR DaysAtFormulaGrain =",
              "    //enforce the month granularity.",
              "    CALCULATE (",
              "        COUNTROWS ( 'Date 👍' ),",
              "        ALL ( 'Date 👍' ),",
              "        VALUES ( 'Date 👍'[MMMYYYY] )",
              "    ) //If the two variables return the very same number, ",
              "//then DAX is working in a filter context at the month granularity level or above that (such as the year). ",
              "//If the two numbers are different, it means that the formula is computing the result below the supported granularity,",
              "// and the result must be a blank:",
              "VAR IsSafeToCompute = ( DaysAtCurrentGrain = DaysAtFormulaGrain )",
              "VAR Result =",
              "    IF (",
              "        IsSafeToCompute,",
              "        SUMX (",
              "            VALUES ( 'Date 👍'[MMMYYYY] ),",
              "            IF (",
              "                [Total Sales] > 500000,",
              "                1",
              "            )",
              "        )",
              "    )",
              "RETURN",
              "    Result"
            ],
            "formatString": "0",
            "lineageTag": "77a5af28-bd26-4dca-ab74-2b2f144e4b6e"
          },
          {
            "name": "Min Sales wrong",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "MIN (",
              "    'All Measures 😀'[Total Sales],",
              "    'All Last (Previous) Measures'[Total Sales PY]",
              ")"
            ],
            "expression": [
              "MIN (",
              "    'All Measures 😀'[Total Sales],",
              "    'All Last (Previous) Measures'[Total Sales PY]",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "16eb18b4-fb0d-4979-a45d-ba756ccbea65"
          },
          {
            "name": "Min Sales correct",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "//nb MIN does not account for null values - see Min Sales correct2",
              "SUMX (",
              "    SUMMARIZE (",
              "        Customer,",
              "        Customer[FullName],",
              "        \"Total Sales X\", [Total Sales],",
              "        \"Total Sales PY X\", [Total Sales PY]",
              "    ),",
              "    //now the x operation",
              "    MIN (",
              "        [Total Sales X],",
              "        [Total Sales PY X]",
              "    ) --just to prove its the virtual column names being used",
              ")"
            ],
            "expression": [
              "//nb MIN does not account for null values - see Min Sales correct2",
              "SUMX (",
              "    SUMMARIZE (",
              "        Customer,",
              "        Customer[FullName],",
              "        \"Total Sales X\", [Total Sales],",
              "        \"Total Sales PY X\", [Total Sales PY]",
              "    ),",
              "    //now the x operation",
              "    MIN (",
              "        [Total Sales X],",
              "        [Total Sales PY X]",
              "    ) --just to prove its the virtual column names being used",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "0266bf7a-f31c-4215-9a8e-57b891a6fbb0"
          },
          {
            "name": "Min Sales correct2",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-GB\"}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "SUMX (",
              "    SUMMARIZE (",
              "        Customer,",
              "        Customer[FullName],",
              "        \"Total Sales X\", [Total Sales],",
              "        \"Total Sales PY X\", [Total Sales PY]",
              "    ),",
              "    //now the x operation",
              "    MIN (",
              "        IF (",
              "            ISBLANK ( [Total Sales X] ),",
              "            //nulls don't work with MIN",
              "            [Total Sales PY X],",
              "            //returns the opposite if TS X is blank -- cannot use 0 as 0 will always be minimum!!!!",
              "            [Total Sales X]",
              "        ),",
              "        IF (",
              "            ISBLANK ( [Total Sales PY X] ),",
              "            [Total Sales X],",
              "            [Total Sales PY X]",
              "        )",
              "    ) --just to prove its the virtual column names being used",
              ")"
            ],
            "expression": [
              "SUMX (",
              "    SUMMARIZE (",
              "        Customer,",
              "        Customer[FullName],",
              "        \"Total Sales X\", [Total Sales],",
              "        \"Total Sales PY X\", [Total Sales PY]",
              "    ),",
              "    //now the x operation",
              "    MIN (",
              "        IF (",
              "            ISBLANK ( [Total Sales X] ),",
              "            //nulls don't work with MIN",
              "            [Total Sales PY X],",
              "            //returns the opposite if TS X is blank -- cannot use 0 as 0 will always be minimum!!!!",
              "            [Total Sales X]",
              "        ),",
              "        IF (",
              "            ISBLANK ( [Total Sales PY X] ),",
              "            [Total Sales X],",
              "            [Total Sales PY X]",
              "        )",
              "    ) --just to prove its the virtual column names being used",
              ")"
            ],
            "formatString": "\"£\"#,0.###############;-\"£\"#,0.###############;\"£\"#,0.###############",
            "lineageTag": "ba5f698b-0044-4bf8-becb-acfe6f42cacc"
          }
        ],
        "partitions": [
          {
            "name": "All Correct Totals-f74176ed-c5cf-46cb-9ba0-bb73597b7294",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type text) meta [Serialized.Text = true]) in type table [Column1 = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Column1\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "DOCUMENTATION 👍😎",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "LinkedQueryName",
            "value": "DOCUMENTATION 👍😎"
          }
        ],
        "columns": [
          {
            "name": "Parent",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "e5d60e86-a908-495b-909e-bf99ee3ab3ef",
            "sourceColumn": "Parent",
            "summarizeBy": "none"
          },
          {
            "name": "Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "52a14933-17c1-45eb-ada0-d4155ccc67c7",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Expression",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "5f6a1a20-c079-4cb0-aa31-b0ebf5d5856d",
            "sourceColumn": "Expression",
            "summarizeBy": "none"
          },
          {
            "name": "DataType",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "bf683e4e-6560-4449-9648-ddd21c81abd0",
            "sourceColumn": "DataType",
            "summarizeBy": "none"
          },
          {
            "name": "ObjectType",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "5e77dc75-97d7-4c7b-8e7f-5db8b433446d",
            "sourceColumn": "ObjectType",
            "summarizeBy": "none"
          },
          {
            "name": "FormatString",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "b0dc7b31-e060-45a8-9f9d-9ff207193399",
            "sourceColumn": "FormatString",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "22ceab9e-ec5c-4f4f-a9f1-9e4d9f543330",
        "partitions": [
          {
            "name": "DOCUMENTATION 👍😎-b578d651-71cc-4138-bff7-2d44e28ea487",
            "mode": "import",
            "source": {
              "expression": [
                "//source is tabular editor",
                "",
                "let",
                "    Source = Csv.Document(File.Contents(\"C:\\Users\\mholm\\Downloads\\v10documentation.txt\"),[Delimiter=\"\t\", Columns=8, Encoding=1252, QuoteStyle=QuoteStyle.None]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}, {\"Column2\", type text}, {\"Column3\", type text}, {\"Column4\", type text}, {\"Column5\", type text}, {\"Column6\", type text}, {\"Column7\", type text}, {\"Column8\", type text}}),",
                "    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Changed Type\", [PromoteAllScalars=true]),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Promoted Headers\",{{\"Object\", type text}, {\"Name\", type text}, {\"ObjectType\", type text}, {\"Parent\", type text}, {\"Description\", type text}, {\"FormatString\", type text}, {\"DataType\", type text}, {\"Expression\", type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type1\",{\"Object\", \"Description\"}),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Removed Columns\",{\"Parent\", \"Name\", \"Expression\", \"DataType\", \"ObjectType\", \"FormatString\"})",
                "in",
                "    #\"Reordered Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "TE Measure Selector",
        "columns": [
          {
            "name": "TE Measure",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "7587fe03-050c-495d-aebd-15f3350cfd39",
            "sourceColumn": "[TE Measure]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "a86e0081-ba73-4067-8957-4274b9c1c53c",
        "measures": [
          {
            "name": "TE Dynamic Measure",
            "description": [
              "VAR _s =",
              "    SELECTEDVALUE ( 'TE Measure Selector'[TE Measure] )",
              "RETURN",
              "    SWITCH (",
              "        _s,",
              "        \"Costs MTD\", [Costs MTD],",
              "        \"Costs QTD\", [Costs QTD],",
              "        \"Costs YTD\", [Costs YTD],",
              "        \"Profit MTD\", [Profit MTD],",
              "        \"Profit QTD\", [Profit QTD],",
              "        \"Profit YTD\", [Profit YTD],",
              "        \"Sales MTD\", [Sales MTD],",
              "        \"Sales QTD\", [Sales QTD],",
              "        \"Sales YTD\", [Sales YTD],",
              "        BLANK ()",
              "    )"
            ],
            "expression": [
              "VAR _s =",
              "    SELECTEDVALUE ( 'TE Measure Selector'[TE Measure] )",
              "RETURN",
              "    SWITCH (",
              "        _s,",
              "        \"Costs MTD\", [Costs MTD],",
              "        \"Costs QTD\", [Costs QTD],",
              "        \"Costs YTD\", [Costs YTD],",
              "        \"Profit MTD\", [Profit MTD],",
              "        \"Profit QTD\", [Profit QTD],",
              "        \"Profit YTD\", [Profit YTD],",
              "        \"Sales MTD\", [Sales MTD],",
              "        \"Sales QTD\", [Sales QTD],",
              "        \"Sales YTD\", [Sales YTD],",
              "        BLANK ()",
              "    )"
            ],
            "lineageTag": "b13df4a2-2f8c-472d-affb-ec84fb283162"
          }
        ],
        "partitions": [
          {
            "name": "TE Measure Selector",
            "mode": "import",
            "source": {
              "expression": [
                "SELECTCOLUMNS (",
                "    {",
                "        \"Costs MTD\",",
                "        \"Costs QTD\",",
                "        \"Costs YTD\",",
                "        \"Profit MTD\",",
                "        \"Profit QTD\",",
                "        \"Profit YTD\",",
                "        \"Sales MTD\",",
                "        \"Sales QTD\",",
                "        \"Sales YTD\"",
                "    },",
                "    \"TE Measure\", [Value]",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "CG DatePicker",
        "calculationGroup": {
          "calculationItems": [
            {
              "name": "OrderDate",
              "expression": "selectedmeasure()"
            },
            {
              "name": "DueDate",
              "expression": [
                "calculate (",
                "    selectedmeasure(),",
                "    userelationship(",
                "                    'InternetSales 😀'[DueDateKey],",
                "                    'Date 👍'[DateKey]",
                "                    )",
                ")"
              ]
            },
            {
              "name": "ShipDate",
              "expression": [
                "calculate (",
                "    selectedmeasure(),",
                "    userelationship(",
                "                    'InternetSales 😀'[ShipDateKey],",
                "                    'Date 👍'[DateKey]",
                "                    )",
                ")"
              ]
            }
          ]
        },
        "columns": [
          {
            "name": "DateToUse",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "2f6d0488-2e34-43e0-a14a-88e62f4e39d9",
            "sortByColumn": "Ordinal",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Ordinal",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "lineageTag": "dcf54103-764d-45c8-90df-ad439c6e481d",
            "sourceColumn": "Ordinal",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "e528659a-cece-44b9-9e9a-1508c2fe0f9d",
        "partitions": [
          {
            "name": "Partition",
            "mode": "import",
            "source": {
              "type": "calculationGroup"
            }
          }
        ]
      },
      {
        "name": "TE Many Measures at once",
        "calculationGroup": {
          "calculationItems": [
            {
              "name": "BaseMeasure",
              "expression": "selectedmeasure()",
              "ordinal": 0
            },
            {
              "name": "MTD",
              "expression": "CALCULATE(selectedmeasure() , DATESMTD('Date 👍'[Date]))",
              "ordinal": 1
            },
            {
              "name": "QTD",
              "expression": "CALCULATE(selectedmeasure() , DATESQTD('Date 👍'[Date]))",
              "ordinal": 2
            },
            {
              "name": "YTD",
              "expression": "CALCULATE(selectedmeasure() , DATESYTD('Date 👍'[Date]))",
              "ordinal": 3
            }
          ],
          "precedence": 1
        },
        "columns": [
          {
            "name": "Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6135fd9a-0560-4f43-9f9b-6e7ad5647fc8",
            "sortByColumn": "Ordinal",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Ordinal",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "lineageTag": "8ecee212-0992-405f-8923-9f0a06363ed5",
            "sourceColumn": "Ordinal",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "e48fd6d0-a8f1-4644-9360-f2ab4c2a2752",
        "partitions": [
          {
            "name": "Partition",
            "mode": "import",
            "source": {
              "type": "calculationGroup"
            }
          }
        ]
      },
      {
        "name": "@Dynamic Measure",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "5f26513bc2b845edb41e073dabbf4d1c"
          }
        ],
        "columns": [
          {
            "name": "Measure Selection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "SortByColumn"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "e17d84bb-24bf-4775-9a70-b97faf8dc893",
            "sortByColumn": "SortOrder",
            "sourceColumn": "[Measure Selection]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "SortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1a024ffb-17a7-416d-b33a-1e8a34804dc5",
            "sourceColumn": "[SortOrder]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "description": "Created in Tabular Editor :)",
        "lineageTag": "d45468fc-937d-4c59-893a-3fce56d715ac",
        "measures": [
          {
            "name": "Dynamic Measure FORMATTED",
            "description": [
              "VAR selection =",
              "    SELECTEDVALUE ( '@Dynamic Measure'[Measure Selection] )",
              "RETURN",
              "    SWITCH (",
              "        selection,",
              "        \"Total Sales\",",
              "            FORMAT (",
              "                [Total Sales],",
              "                \"\\£#,0;(\\£#,0),\\£#,0\"",
              "            ),",
              "        \"Total Cost\",",
              "            FORMAT (",
              "                [Total Costs],",
              "                \"\\£#,0;(\\£#,0),\\£#,0\"",
              "            ),",
              "        \"Total Profit\",",
              "            FORMAT (",
              "                [Total Profit],",
              "                \"\\£#,0;(\\£#,0),\\£#,0\"",
              "            ),",
              "        \"Count Sales\",",
              "            FORMAT (",
              "                [Count Sales],",
              "                \"0\"",
              "            ),",
              "        \"Profit %\",",
              "            FORMAT (",
              "                DIVIDE (",
              "                    [Total Profit],",
              "                    [Total Sales],",
              "                    0",
              "                ),",
              "                \"0.0%;-0.0%;0.0%\"",
              "            )",
              "    )"
            ],
            "expression": [
              "VAR selection =",
              "    SELECTEDVALUE ( '@Dynamic Measure'[Measure Selection] )",
              "RETURN",
              "    SWITCH (",
              "        selection,",
              "        \"Total Sales\",",
              "            FORMAT (",
              "                [Total Sales],",
              "                \"\\£#,0;(\\£#,0),\\£#,0\"",
              "            ),",
              "        \"Total Cost\",",
              "            FORMAT (",
              "                [Total Costs],",
              "                \"\\£#,0;(\\£#,0),\\£#,0\"",
              "            ),",
              "        \"Total Profit\",",
              "            FORMAT (",
              "                [Total Profit],",
              "                \"\\£#,0;(\\£#,0),\\£#,0\"",
              "            ),",
              "        \"Count Sales\",",
              "            FORMAT (",
              "                [Count Sales],",
              "                \"0\"",
              "            ),",
              "        \"Profit %\",",
              "            FORMAT (",
              "                DIVIDE (",
              "                    [Total Profit],",
              "                    [Total Sales],",
              "                    0",
              "                ),",
              "                \"0.0%;-0.0%;0.0%\"",
              "            )",
              "    )"
            ],
            "lineageTag": "b2b66963-53c8-4c64-969c-2b1d71d65f42"
          }
        ],
        "partitions": [
          {
            "name": "@Dynamic Measure-d4a12626-bf7c-4595-b1be-fb30833c9397",
            "mode": "import",
            "source": {
              "expression": [
                "DATATABLE (",
                "    \"Measure Selection\", STRING,",
                "    \"SortOrder\", INTEGER,",
                "    {",
                "        { \"Total Sales\", 1 },",
                "        { \"Total Cost\", 2 },",
                "        { \"Total Profit\", 3 },",
                "        { \"Count Sales\", 4 },",
                "        { \"Profit %\", 5 }",
                "    }",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "TE @Dynamic Measure",
        "calculationGroup": {
          "calculationItems": [
            {
              "name": "Total Sales",
              "expression": [
                "//apply the calc group to the following measure",
                "if(",
                "isselectedmeasure([Dynamic Measure FORMATTED CG]),[Total Sales],selectedmeasure()",
                ")"
              ],
              "formatStringDefinition": {
                "expression": [
                  "if(",
                  "isselectedmeasure([Dynamic Measure FORMATTED CG]),\"\\£#,0;(\\£#,0),\\£#,0\",selectedmeasureformatstring()",
                  ")"
                ]
              },
              "ordinal": 0
            },
            {
              "name": "Total Cost",
              "expression": "[Total Costs]",
              "formatStringDefinition": {
                "expression": [
                  "if(",
                  "isselectedmeasure([Dynamic Measure FORMATTED CG]),\"\\£#,0;(\\£#,0),\\£#,0\",selectedmeasureformatstring()",
                  ")"
                ]
              },
              "ordinal": 1
            },
            {
              "name": "Total Profit",
              "expression": "[Total Profit]",
              "formatStringDefinition": {
                "expression": [
                  "if(",
                  "isselectedmeasure([Dynamic Measure FORMATTED CG]),\"\\£#,0;(\\£#,0),\\£#,0\",selectedmeasureformatstring()",
                  ")"
                ]
              },
              "ordinal": 2
            },
            {
              "name": "Count Sales",
              "expression": "[Count Sales]",
              "formatStringDefinition": {
                "expression": [
                  "if(",
                  "isselectedmeasure([Dynamic Measure FORMATTED CG]),\"0\",selectedmeasureformatstring()",
                  ")"
                ]
              },
              "ordinal": 3
            },
            {
              "name": "Profit %",
              "expression": "DIVIDE([Total Profit],[Total Sales],0)",
              "formatStringDefinition": {
                "expression": [
                  "if(",
                  "isselectedmeasure([Dynamic Measure FORMATTED CG]),\"0.0%;-0.0%;0.0%\",selectedmeasureformatstring()",
                  ")"
                ]
              },
              "ordinal": 4
            }
          ],
          "precedence": 2
        },
        "columns": [
          {
            "name": "Measure Selection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "24597afd-5ced-4d07-a27e-164de20b5721",
            "sortByColumn": "Ordinal",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Ordinal",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "lineageTag": "dfbfd9f7-0eb0-4617-93ea-a9adbbcdf3f4",
            "sourceColumn": "Ordinal",
            "summarizeBy": "sum"
          }
        ],
        "description": "Created in Tabular Editor :)",
        "lineageTag": "1cc0ea45-078a-4820-a296-d8f4d7d4119f",
        "measures": [
          {
            "name": "Dynamic Measure FORMATTED CG",
            "description": "BLANK ()",
            "expression": "BLANK ()",
            "lineageTag": "32ad14e7-f953-4e1f-803b-b3db06e6e63b"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "mode": "import",
            "source": {
              "type": "calculationGroup"
            }
          }
        ]
      },
      {
        "name": "PageDetailsForMeasures",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "PageName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "SortByColumn"
              },
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "f5bdaa07-1273-43a9-996e-0e9f9aaee45c",
            "sortByColumn": "PageIndex",
            "sourceColumn": "PageName",
            "summarizeBy": "none"
          },
          {
            "name": "MeasureName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "10f941e9-84f9-4b4b-b064-cc12829e3e42",
            "sourceColumn": "MeasureName",
            "summarizeBy": "none"
          },
          {
            "name": "TableName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "a199632c-61f0-4fcc-bcb8-1da5d3b093bc",
            "sourceColumn": "TableName",
            "summarizeBy": "none"
          },
          {
            "name": "Expression",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "e6c54d5b-0e09-4c01-9c2d-6c8e013d0bee",
            "sourceColumn": "Expression",
            "summarizeBy": "none"
          },
          {
            "name": "Dependency",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "047d2685-7a5f-481c-8382-ac792b23d51a",
            "sourceColumn": "Dependency",
            "summarizeBy": "none"
          },
          {
            "name": "Reverse Dependency",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "42cb102f-c8ac-4bd5-9a50-2b5aa540f7e5",
            "sourceColumn": "Reverse Dependency",
            "summarizeBy": "none"
          },
          {
            "name": "PageIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "6ffc3dca-1a59-48e8-b5c5-925d4543dc90",
            "sourceColumn": "PageIndex",
            "summarizeBy": "sum"
          },
          {
            "name": "Name.1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "5a64354f-c48a-4ffa-ad4b-2a5ef6c56bb4",
            "sourceColumn": "Name.1",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "0ce39eee-1cf8-4fd6-8e6c-d9c3f113bf49",
        "partitions": [
          {
            "name": "PageDetailsForMeasures-4f095ea3-1167-42d1-90a1-c3e5336ad644",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.NestedJoin(#\"List of all Columns/Fields/Measures/Expressions Used in Visuals:\", {\"PageIndex\"}, #\"List of Pages:\", {\"PageIndex\"}, \"List of Pages:\", JoinKind.Inner),",
                "    #\"Expanded List of Pages:\" = Table.ExpandTableColumn(Source, \"List of Pages:\", {\"DisplayName\"}, {\"DisplayName\"}),",
                "    //#\"Removed Columns\" = Table.RemoveColumns(#\"Expanded List of Pages:\",{\"PageIndex\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Expanded List of Pages:\",{{\"DisplayName\", \"PageName\"}}),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Renamed Columns\",{\"PageName\", \"Name\", \"Table Name\", \"Expression\"}),",
                "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Reordered Columns\",{{\"Name\", \"ColumnOrMeasureName\"}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Renamed Columns1\", {\"Name.1\"}, #\"List of Measures:\", {\"Measure Name\"}, \"List of Measures:\", JoinKind.FullOuter),",
                "    #\"Expanded List of Measures:\" = Table.ExpandTableColumn(#\"Merged Queries\", \"List of Measures:\", {\"Expression\", \"Dependency\", \"Reverse Dependency\"}, {\"Expression.1\", \"Dependency\", \"Reverse Dependency\"}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Expanded List of Measures:\", each ([Expression.1] <> null)),",
                "    #\"Inserted Text Before Delimiter\" = Table.AddColumn(#\"Filtered Rows\", \"Text Before Delimiter\", each Text.BeforeDelimiter([Expression], \".\"), type text),",
                "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Inserted Text Before Delimiter\",{\"Table Name\"}),",
                "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Removed Columns1\",{{\"Text Before Delimiter\", \"TableName\"}}),",
                "    #\"Reordered Columns1\" = Table.ReorderColumns(#\"Renamed Columns2\",{\"PageName\", \"ColumnOrMeasureName\", \"Expression\", \"TableName\", \"Expression.1\", \"Dependency\", \"Reverse Dependency\"}),",
                "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Reordered Columns1\",{\"Expression\"}),",
                "    #\"Renamed Columns3\" = Table.RenameColumns(#\"Removed Columns2\",{{\"Expression.1\", \"Expression\"}, {\"ColumnOrMeasureName\", \"MeasureName\"}}),",
                "    #\"Filtered Rows1\" = Table.SelectRows(#\"Renamed Columns3\", each true)",
                "in",
                "    #\"Filtered Rows1\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "PickMeasure",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "d4ad38aee31140868886c00f473de6d1"
          }
        ],
        "columns": [
          {
            "name": "PickMeasure",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "a8102a13-ae0d-4992-9842-9b0eeaa78853",
            "relatedColumnDetails": {
              "groupByColumns": [
                {
                  "groupingColumn": "PickMeasure Fields"
                }
              ]
            },
            "sortByColumn": "PickMeasure Order",
            "sourceColumn": "[Value1]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "PickMeasure Fields",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "kind": 2,
                  "version": 3
                }
              }
            ],
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "e5977886-5ff0-4b67-8dda-cb3259412311",
            "sortByColumn": "PickMeasure Order",
            "sourceColumn": "[Value2]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "PickMeasure Order",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "f665c102-2f0e-48f1-be54-92d69d432728",
            "sourceColumn": "[Value3]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "fe752702-71cc-46dd-b3ee-aced6bf2e9f8",
        "partitions": [
          {
            "name": "PickMeasure-731f36c8-f01b-4449-9ca0-e02766c7c154",
            "mode": "import",
            "source": {
              "expression": [
                "{",
                "    ( \"Total Sales\", NAMEOF ( 'All Measures 😀'[Total Sales] ), 0 ),",
                "    ( \"Total Costs\", NAMEOF ( 'All Measures 😀'[Total Costs] ), 1 ),",
                "    ( \"Total Profit\", NAMEOF ( 'All Measures 😀'[Total Profit] ), 2 ),",
                "    ( \"Sales Ratio\", NAMEOF ( 'All ALL Measures'[SalesRatio_ALLSELECTED] ), 3 )",
                "}"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "PickSliceBy",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "d91da8bbe64640ec8e3d9eadc75d167d"
          }
        ],
        "columns": [
          {
            "name": "PickSliceBy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "d4a012b3-b38a-4320-a17a-7bf1cad85379",
            "relatedColumnDetails": {
              "groupByColumns": [
                {
                  "groupingColumn": "PickSliceBy Fields"
                }
              ]
            },
            "sortByColumn": "PickSliceBy Order",
            "sourceColumn": "[Value1]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "PickSliceBy Fields",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "kind": 2,
                  "version": 3
                }
              }
            ],
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "b5bdc3d8-c49e-4490-968b-819cd1667a84",
            "sortByColumn": "PickSliceBy Order",
            "sourceColumn": "[Value2]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "PickSliceBy Order",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "a632da74-daa4-45fb-ab22-77ac7109a685",
            "sourceColumn": "[Value3]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "b4fdec03-21e7-49f0-85eb-d79fa4d4ba08",
        "partitions": [
          {
            "name": "PickSliceBy-5a115606-a65e-4743-9de7-d5226ff0cc37",
            "mode": "import",
            "source": {
              "expression": [
                "{",
                "    ( \"CalendarYear\", NAMEOF ( 'Date 👍'[CalendarYear] ), 0 ),",
                "    ( \"CalendarQuarter\", NAMEOF ( 'Date 👍'[CalendarQuarter] ), 1 ),",
                "    ( \"EnglishMonthName\", NAMEOF ( 'Date 👍'[EnglishMonthName*] ), 2 ),",
                "    ( \"FullName\", NAMEOF ( 'Customer'[FullName] ), 3 )",
                "}"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "CalendarScale",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "66d31547d4f44e3f81e94470fef17d83"
          }
        ],
        "columns": [
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "DataType"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "264595cc-d9fa-43bd-99b4-f8da35ae754a",
            "sourceColumn": "[Date]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Inventory",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "91b870cf-f610-40eb-a444-e206812e3908",
            "sourceColumn": "[Inventory]",
            "summarizeBy": "average",
            "type": "calculatedTableColumn"
          },
          {
            "name": "IsCurrentQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "expression": [
              "VAR _today =",
              "    TODAY ()",
              "VAR _currentyear =",
              "    YEAR ( _today )",
              "VAR _currentquarter =",
              "    QUARTER ( _today )",
              "VAR _year =",
              "    YEAR ( CalendarScale[Date] )",
              "VAR _quarter =",
              "    QUARTER ( CalendarScale[Date] )",
              "RETURN",
              "    IF (",
              "        _year = _currentyear",
              "            && _quarter = _currentquarter,",
              "        TRUE (),",
              "        FALSE ()",
              "    )"
            ],
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "isDataTypeInferred": true,
            "lineageTag": "166c44e6-83e1-4bbc-9a3e-32dceb472be5",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "DynamicScaleQW",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "SortByColumn"
              }
            ],
            "dataType": "string",
            "expression": [
              "IF (",
              "    CalendarScale[IsCurrentQuarter],",
              "    //evaluates to true",
              "    \"W\"",
              "        & WEEKNUM ( CalendarScale[Date] ) & \" - \"",
              "        & YEAR ( CalendarScale[Date] ),",
              "    \"Q\"",
              "        & QUARTER ( CalendarScale[Date] ) & \" - \"",
              "        & YEAR ( CalendarScale[Date] )",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "a999ef54-aa5f-42a2-9b46-f1d179d97086",
            "sortByColumn": "DynamicScaleQWSort",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "DynamicScaleQWSort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "IF (",
              "    CalendarScale[IsCurrentQuarter],",
              "    //evaluates to true",
              "    YEAR ( CalendarScale[Date] )",
              "        & QUARTER ( CalendarScale[Date] )",
              "        & WEEKNUM ( CalendarScale[Date] ),",
              "    //YQW",
              "    YEAR ( CalendarScale[Date] )",
              "        & QUARTER ( CalendarScale[Date] ) //YQ",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "e9b7593f-cc85-4fa0-9a4d-2fbd0e3fd000",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "3c66cdaa-ee79-4a59-9427-a6ffff4d4cbe",
        "measures": [
          {
            "name": "_AverageInventory",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "description": "AVERAGE ( CalendarScale[Inventory] )",
            "expression": "AVERAGE ( CalendarScale[Inventory] )",
            "lineageTag": "8ba3e73a-60da-48ed-9dbd-d62a1d30e9eb"
          }
        ],
        "partitions": [
          {
            "name": "CalendarScale-ec4f923f-0c36-46a8-8d8d-98ae37e9a664",
            "mode": "import",
            "source": {
              "expression": [
                "//see - https://www.youtube.com/watch?v=RRM21vp8ZxE",
                "ADDCOLUMNS (",
                "    CALENDAR (",
                "        DATE ( 2016, 1, 1 ),",
                "        TODAY ()",
                "    ),",
                "    \"Inventory\",",
                "        RANDBETWEEN (",
                "            10000,",
                "            30000",
                "        )",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Dates_EDNA",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "65b76b2d-bf61-4c57-ac3d-accc35a4e216",
            "sourceColumn": "Date",
            "summarizeBy": "none"
          },
          {
            "name": "Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e469b259-e298-41c2-81e8-54efec4af2f4",
            "sourceColumn": "Year",
            "summarizeBy": "sum"
          },
          {
            "name": "CurrYearOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "aff13e28-cebf-4aeb-8759-166488100992",
            "sourceColumn": "CurrYearOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "YearCompleted",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "5bcdc6e4-2686-42ee-986f-3689c2091a26",
            "sourceColumn": "YearCompleted",
            "summarizeBy": "none"
          },
          {
            "name": "Quarter Number",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ece8c796-afac-4902-8dbd-2b06ecdca725",
            "sourceColumn": "Quarter Number",
            "summarizeBy": "sum"
          },
          {
            "name": "Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "SortByColumn"
              },
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "501ca16c-fbc9-4982-8da5-91c0cc8312e6",
            "sortByColumn": "Quarter Number",
            "sourceColumn": "Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "Start of Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "dedb9476-b0d5-486c-a99e-e09c9e1de5c5",
            "sourceColumn": "Start of Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "End of Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "0966934e-72fe-4ee0-89df-d79af61c52c6",
            "sourceColumn": "End of Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "Quarter & Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "SortByColumn"
              },
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "0421be3a-1ae1-4457-907c-bd53748d3517",
            "sortByColumn": "QuarternYear",
            "sourceColumn": "Quarter & Year",
            "summarizeBy": "none"
          },
          {
            "name": "QuarternYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "7210aa95-41ca-4bff-9b6b-cf64dc1a3e81",
            "sourceColumn": "QuarternYear",
            "summarizeBy": "sum"
          },
          {
            "name": "CurrQuarterOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "6d0834b9-80ce-4604-88d0-37bf9092d880",
            "sourceColumn": "CurrQuarterOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "QuarterCompleted",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "d1bea388-ac4e-4cb9-871b-ed420261f230",
            "sourceColumn": "QuarterCompleted",
            "summarizeBy": "none"
          },
          {
            "name": "Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "fb42da65-5d91-4bf0-826d-84453a86975e",
            "sourceColumn": "Month",
            "summarizeBy": "sum"
          },
          {
            "name": "Start of Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "577c0c02-6f33-4fec-952a-1c3e6fe45541",
            "sourceColumn": "Start of Month",
            "summarizeBy": "none"
          },
          {
            "name": "End of Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "76480b6d-d599-49ea-9344-17c4e0eebe27",
            "sourceColumn": "End of Month",
            "summarizeBy": "none"
          },
          {
            "name": "Month & Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "SortByColumn"
              },
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "fb24ab89-473a-4425-9396-07851407a2e5",
            "sortByColumn": "MonthnYear",
            "sourceColumn": "Month & Year",
            "summarizeBy": "none"
          },
          {
            "name": "MonthnYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "324b16eb-25de-43ad-b849-fe2592d834f9",
            "sourceColumn": "MonthnYear",
            "summarizeBy": "sum"
          },
          {
            "name": "CurrMonthOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d8013bbb-1b14-467f-93c8-578016b1f463",
            "sourceColumn": "CurrMonthOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "MonthCompleted",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "28ea1e91-ab3b-4f1f-bfc7-c508e726152f",
            "sourceColumn": "MonthCompleted",
            "summarizeBy": "none"
          },
          {
            "name": "Month Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "SortByColumn"
              },
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "c6ebb061-bd1a-40a2-8ed4-34d92276200e",
            "sortByColumn": "Month",
            "sourceColumn": "Month Name",
            "summarizeBy": "none"
          },
          {
            "name": "Month Short",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "SortByColumn"
              },
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "b4ab2bcd-c0cb-4bd7-9456-c02ff3a27f98",
            "sortByColumn": "Month",
            "sourceColumn": "Month Short",
            "summarizeBy": "none"
          },
          {
            "name": "Month Initial",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "bf89ff67-6faf-4dc9-925b-0de5d392cdc3",
            "sourceColumn": "Month Initial",
            "summarizeBy": "none"
          },
          {
            "name": "Day of Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "3b2b44eb-edeb-495c-909f-520ff0b167d9",
            "sourceColumn": "Day of Month",
            "summarizeBy": "sum"
          },
          {
            "name": "Week Number",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2f3f4961-959a-4366-a37a-dadcfefed00e",
            "sourceColumn": "Week Number",
            "summarizeBy": "sum"
          },
          {
            "name": "Start of Week",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "e490d720-3a9b-4cfd-a5f0-25a10f14351f",
            "sourceColumn": "Start of Week",
            "summarizeBy": "none"
          },
          {
            "name": "End of Week",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "aead771e-53ac-48dc-b44d-28e3cbe9c6c4",
            "sourceColumn": "End of Week",
            "summarizeBy": "none"
          },
          {
            "name": "Week & Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "363967ca-1a0f-439e-9ed5-41c06adec477",
            "sourceColumn": "Week & Year",
            "summarizeBy": "none"
          },
          {
            "name": "WeeknYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0a4f7ecc-9a5f-45ae-9ac7-92e165ed06dd",
            "sourceColumn": "WeeknYear",
            "summarizeBy": "sum"
          },
          {
            "name": "CurrWeekOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "37b9de85-ee11-4577-8e9b-2a84e8822e1c",
            "sourceColumn": "CurrWeekOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "WeekCompleted",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "440ce747-99bd-4d4b-85af-c5bbbee2cafd",
            "sourceColumn": "WeekCompleted",
            "summarizeBy": "none"
          },
          {
            "name": "Day of Week Number",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "98943e03-77b4-4d96-bb39-dfa82794115d",
            "sourceColumn": "Day of Week Number",
            "summarizeBy": "sum"
          },
          {
            "name": "Day of Week Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "c127e46d-875e-4df3-aa38-69d648ba9f9f",
            "sourceColumn": "Day of Week Name",
            "summarizeBy": "none"
          },
          {
            "name": "Day of Week Initial",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "9a4a0f92-4094-4478-afd4-657dede8a09e",
            "sourceColumn": "Day of Week Initial",
            "summarizeBy": "none"
          },
          {
            "name": "DateInt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b86bc14b-c254-4591-817a-e615901fb76d",
            "sourceColumn": "DateInt",
            "summarizeBy": "sum"
          },
          {
            "name": "CurrDayOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "518a5f28-edf1-4927-97ea-59610f7b6aac",
            "sourceColumn": "CurrDayOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "IsAfterToday",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "79038993-c430-4475-9708-3e1f015fa43d",
            "sourceColumn": "IsAfterToday",
            "summarizeBy": "none"
          },
          {
            "name": "IsWeekDay",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "02accb1e-7bd9-4514-b980-b103672a9f32",
            "sourceColumn": "IsWeekDay",
            "summarizeBy": "none"
          },
          {
            "name": "IsHoliday",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "199f1cb7-d54a-4767-b337-9052b9f92909",
            "sourceColumn": "IsHoliday",
            "summarizeBy": "none"
          },
          {
            "name": "IsBusinessDay",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "be1e324c-75df-4de5-bed0-68de58f9b388",
            "sourceColumn": "IsBusinessDay",
            "summarizeBy": "none"
          },
          {
            "name": "Day Type",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "d0b51382-a686-44f6-b29d-6c4707b9b6c0",
            "sourceColumn": "Day Type",
            "summarizeBy": "none"
          },
          {
            "name": "ISO Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "1bf0f36c-01ea-45c2-81b5-43cc6b25c9b0",
            "sourceColumn": "ISO Year",
            "summarizeBy": "sum"
          },
          {
            "name": "ISO CurrYearOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ea9f1016-9672-4441-960b-bf27411e34df",
            "sourceColumn": "ISO CurrYearOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "ISO Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "ba306f0f-19f8-4a86-8fd4-9362b0736ecb",
            "sourceColumn": "ISO Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "ISO Quarter & Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "91fea61c-d661-49b6-a988-c7d43afa01d1",
            "sourceColumn": "ISO Quarter & Year",
            "summarizeBy": "none"
          },
          {
            "name": "ISO QuarternYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "1610486c-631b-496b-8b7b-9a776d6449ea",
            "sourceColumn": "ISO QuarternYear",
            "summarizeBy": "sum"
          },
          {
            "name": "ISO CurrQuarterOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "5463f9d1-3598-4e42-b0fc-8345749d1c9c",
            "sourceColumn": "ISO CurrQuarterOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "Fiscal Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "402b3108-00ff-4d7d-8d18-aadaf74417be",
            "sourceColumn": "Fiscal Year",
            "summarizeBy": "none"
          },
          {
            "name": "Fiscal CurrYearOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b5f1776a-5c78-4721-b4ef-ebefafe631ea",
            "sourceColumn": "Fiscal CurrYearOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "Fiscal Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "d21ddca3-fbc1-48e0-8ab1-d4ef60f93598",
            "sourceColumn": "Fiscal Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "FQuarternYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "6703d02e-31fe-45a2-8099-b8e93973bccc",
            "sourceColumn": "FQuarternYear",
            "summarizeBy": "sum"
          },
          {
            "name": "Fiscal Period",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "bcfc0bb1-771a-4031-a5ee-35346174a66c",
            "sourceColumn": "Fiscal Period",
            "summarizeBy": "none"
          },
          {
            "name": "FPeriodnYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a0ee28c8-b135-43ac-b13d-c814310b3e13",
            "sourceColumn": "FPeriodnYear",
            "summarizeBy": "sum"
          },
          {
            "name": "Fiscal Week",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "4db680f0-f679-408a-b3ab-4da3cab79a81",
            "sourceColumn": "Fiscal Week",
            "summarizeBy": "none"
          },
          {
            "name": "FWeeknYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "3724b74c-52c8-4be3-9748-932010ace023",
            "sourceColumn": "FWeeknYear",
            "summarizeBy": "sum"
          },
          {
            "name": "IsCurrentFY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "aa6af7e1-512b-4baa-9434-04eecb71902e",
            "sourceColumn": "IsCurrentFY",
            "summarizeBy": "none"
          },
          {
            "name": "IsCurrentFQ",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "73fc0a69-e437-482b-8511-89e2df428d0d",
            "sourceColumn": "IsCurrentFQ",
            "summarizeBy": "none"
          },
          {
            "name": "IsCurrentFP",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "f8f77d2e-1bda-4a31-a3d9-b587bfd73ec4",
            "sourceColumn": "IsCurrentFP",
            "summarizeBy": "none"
          },
          {
            "name": "IsCurrentFW",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "7cb9b1b6-75b1-4bfc-9a80-1a70ed6260df",
            "sourceColumn": "IsCurrentFW",
            "summarizeBy": "none"
          },
          {
            "name": "IsPYTD",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "68d955dd-faf6-4065-94c7-80b1e68bb196",
            "sourceColumn": "IsPYTD",
            "summarizeBy": "none"
          },
          {
            "name": "IsPFYTD",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "3570103a-d700-4778-a9bd-1750372972b1",
            "sourceColumn": "IsPFYTD",
            "summarizeBy": "none"
          },
          {
            "name": "Relative Networkdays",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "double",
            "lineageTag": "bfa5205a-6248-427f-a8db-6fbe3fe679df",
            "sourceColumn": "Relative Networkdays",
            "summarizeBy": "sum"
          },
          {
            "name": "Tax Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "9e0cdcb2-aad0-47d7-96c6-9bed1bd5a7f8",
            "sourceColumn": "Tax Year",
            "summarizeBy": "none"
          },
          {
            "name": "Start of Week.1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "d97d5524-49d6-4f2b-a077-5d6ef7da6af6",
            "sourceColumn": "Start of Week.1",
            "summarizeBy": "none"
          },
          {
            "name": "Week start Day Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c987edbd-50e7-4129-93e7-7eacac185624",
            "sourceColumn": "Week start Day Name",
            "summarizeBy": "none"
          },
          {
            "name": "End of Week.1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "968f9648-b359-4662-bb80-14bd1b7f8f8a",
            "sourceColumn": "End of Week.1",
            "summarizeBy": "none"
          },
          {
            "name": "Week end Day Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "85495530-5a3e-4291-8b95-4657c273304e",
            "sourceColumn": "Week end Day Name",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "f8628d89-3385-4fe3-a4b9-83173fd2e45c",
        "partitions": [
          {
            "name": "Dates_EDNA-070010da-920c-43b6-b437-c73a23c04800",
            "mode": "import",
            "source": {
              "expression": [
                "//https://forum.enterprisedna.co/t/extended-date-table-power-query-m-function/6390",
                "",
                "let",
                "    Source = Function_Dates_EDNA(#date(2000, 1, 1), #date(2030, 12, 31), 4, null, 1, true),",
                "    #\"Added Custom\" = Table.AddColumn(Source, \"Tax Year\", each if [Date] < #date(Date.Year([Date]),4,5) then Date.Year([Date])-1 else Date.Year([Date])),",
                "    #\"Inserted Start of Week\" = Table.AddColumn(#\"Added Custom\", \"Start of Week.1\", each Date.StartOfWeek([Date]), type date),",
                "    #\"Inserted Day Name\" = Table.AddColumn(#\"Inserted Start of Week\", \"Day Name\", each Date.DayOfWeekName([Start of Week.1]), type text),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Inserted Day Name\",{{\"Day Name\", \"Week start Day Name\"}}),",
                "    // added Day.Saturday (actually START of week)",
                "    #\"Inserted End of Week\" = Table.AddColumn(#\"Renamed Columns\", \"End of Week.1\", each Date.EndOfWeek([Start of Week.1],Day.Saturday), type date),",
                "    #\"Inserted Day Name1\" = Table.AddColumn(#\"Inserted End of Week\", \"Day Name\", each Date.DayOfWeekName([End of Week.1]), type text),",
                "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Inserted Day Name1\",{{\"Day Name\", \"Week end Day Name\"}})",
                "in",
                "    #\"Renamed Columns1\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "dax",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "CATALOG_NAME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "a4e0fbd0-cd62-4913-92b4-909d8f1dd278",
            "sourceColumn": "CATALOG_NAME",
            "summarizeBy": "none"
          },
          {
            "name": "SCHEMA_NAME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "bee7d504-7c4b-4113-a42b-d31075c90a9f",
            "sourceColumn": "SCHEMA_NAME",
            "summarizeBy": "none"
          },
          {
            "name": "CUBE_NAME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "aaa9d39d-4c30-402d-98ba-3600402b17f4",
            "sourceColumn": "CUBE_NAME",
            "summarizeBy": "none"
          },
          {
            "name": "MEASURE_NAME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "56653c5e-fc1a-4163-8bd1-e3d7521d57fb",
            "sourceColumn": "MEASURE_NAME",
            "summarizeBy": "none"
          },
          {
            "name": "MEASURE_UNIQUE_NAME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "d5d92d58-5611-411e-889b-ae3dd2659137",
            "sourceColumn": "MEASURE_UNIQUE_NAME",
            "summarizeBy": "none"
          },
          {
            "name": "MEASURE_CAPTION",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "a86b268b-c215-477f-9545-adca3f25322e",
            "sourceColumn": "MEASURE_CAPTION",
            "summarizeBy": "none"
          },
          {
            "name": "MEASURE_GUID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "4eabbbfb-d860-41a9-9455-fe572a6ab198",
            "sourceColumn": "MEASURE_GUID",
            "summarizeBy": "none"
          },
          {
            "name": "MEASURE_AGGREGATOR",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "43856781-6742-4b16-a293-a37a0f2c5cbc",
            "sourceColumn": "MEASURE_AGGREGATOR",
            "summarizeBy": "none"
          },
          {
            "name": "DATA_TYPE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "2f429af1-d449-452c-b3ec-01bb839191a7",
            "sourceColumn": "DATA_TYPE",
            "summarizeBy": "none"
          },
          {
            "name": "NUMERIC_PRECISION",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "d006354c-bbfb-4ecd-af8e-67d3b6f375ee",
            "sourceColumn": "NUMERIC_PRECISION",
            "summarizeBy": "none"
          },
          {
            "name": "NUMERIC_SCALE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "5d15ed70-719a-492c-8383-adc082523f08",
            "sourceColumn": "NUMERIC_SCALE",
            "summarizeBy": "none"
          },
          {
            "name": "MEASURE_UNITS",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "13a34086-6fb9-4057-be0c-2e25f6f87d76",
            "sourceColumn": "MEASURE_UNITS",
            "summarizeBy": "none"
          },
          {
            "name": "DESCRIPTION",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "e794942b-12ea-47b8-8b30-25623717451c",
            "sourceColumn": "DESCRIPTION",
            "summarizeBy": "none"
          },
          {
            "name": "EXPRESSION",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "5c1582b3-f60c-4a5c-9f9e-6cde9cc6bb1b",
            "sourceColumn": "EXPRESSION",
            "summarizeBy": "none"
          },
          {
            "name": "MEASURE_IS_VISIBLE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "ad11b84f-ab8d-4040-b276-a0ea32e8c735",
            "sourceColumn": "MEASURE_IS_VISIBLE",
            "summarizeBy": "none"
          },
          {
            "name": "LEVELS_LIST",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "ac3323fa-0395-4663-85b2-165f89490824",
            "sourceColumn": "LEVELS_LIST",
            "summarizeBy": "none"
          },
          {
            "name": "MEASURE_NAME_SQL_COLUMN_NAME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "b679b68d-0768-4173-9ab4-99e6e39a8fc1",
            "sourceColumn": "MEASURE_NAME_SQL_COLUMN_NAME",
            "summarizeBy": "none"
          },
          {
            "name": "MEASURE_UNQUALIFIED_CAPTION",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "a52d01a6-c9f0-43d5-9039-254703471848",
            "sourceColumn": "MEASURE_UNQUALIFIED_CAPTION",
            "summarizeBy": "none"
          },
          {
            "name": "MEASUREGROUP_NAME",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "7b72bbf9-94a2-49c6-aee1-b6030cd6b5c9",
            "sourceColumn": "MEASUREGROUP_NAME",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "fa94ec4c-3f35-462d-a6f4-24e1f68a8658",
        "partitions": [
          {
            "name": "dax-449ce2e1-13f4-4999-a188-12e4de5372be",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Csv.Document(File.Contents(\"Y:\\Downloads\\dax.csv\"),[Delimiter=\",\", Columns=19, Encoding=65001, QuoteStyle=QuoteStyle.Csv]),",
                "    #\"Promoted Headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars=true])",
                "in",
                "    #\"Promoted Headers\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Dates_IMKE",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "c3909b04-9d63-419b-8d2c-144e5685c898",
            "sourceColumn": "Date",
            "summarizeBy": "none"
          },
          {
            "name": "DateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "44c83365-c8aa-4dd2-ba84-d5939d441bf7",
            "sourceColumn": "DateKey",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar YearNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "5455253e-0d6c-4a53-84b1-7bc1db721af8",
            "sourceColumn": "Calendar YearNumber",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "324505cc-2080-4b32-a672-4a3e116bdc8a",
            "sourceColumn": "Calendar Year",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar QuarterNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "f1281bf8-8a99-4211-9911-5dd64693ba24",
            "sourceColumn": "Calendar QuarterNumber",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "b2f4ad9b-0d42-4e12-8f22-411acd68764b",
            "sourceColumn": "Calendar Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar YearQuarterNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "653f7f7e-8f32-40cf-8d27-1f142ae0afe0",
            "sourceColumn": "Calendar YearQuarterNumber",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar Quarter Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "1a1e83ae-3e34-45f3-a8b4-08faa03c5ae6",
            "sourceColumn": "Calendar Quarter Year",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar MonthNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0de83614-abc0-4cdf-acc8-359081cce222",
            "sourceColumn": "Calendar MonthNumber",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "9b8d3a50-1086-48b6-9a5b-78f42d1e72b3",
            "sourceColumn": "Calendar Month",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar YearMonthNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "180eb38f-0229-4b62-b964-8df3c22ea4fb",
            "sourceColumn": "Calendar YearMonthNumber",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar Month Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "003a8254-f8e6-4c9c-9ce5-908bd6db9491",
            "sourceColumn": "Calendar Month Year",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar WeekNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c163fe5a-b5aa-4525-b721-501565544cbb",
            "sourceColumn": "Calendar WeekNumber",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar Week",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "79902aee-4175-4100-ad45-f4ef4d196b20",
            "sourceColumn": "Calendar Week",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar YearWeekNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "6a031f0c-e749-4d7d-bc4e-a758a44bfca9",
            "sourceColumn": "Calendar YearWeekNumber",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar Week Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "ae391cb2-dcd0-4a45-a725-1aa3ae2d9084",
            "sourceColumn": "Calendar Week Year",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar WeekYearOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "9ace9da6-c751-4626-aa7d-ba523c4db94e",
            "sourceColumn": "Calendar WeekYearOrder",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar DayOfYearNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b2ba6bfe-64d5-4744-a668-1d608a35d9f9",
            "sourceColumn": "Calendar DayOfYearNumber",
            "summarizeBy": "sum"
          },
          {
            "name": "Day of Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "bf5e6ee6-dbab-4b85-a20a-f49a91d2e443",
            "sourceColumn": "Day of Month",
            "summarizeBy": "sum"
          },
          {
            "name": "WeekDayNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c5224f02-52df-476a-b6de-d9533637baf7",
            "sourceColumn": "WeekDayNumber",
            "summarizeBy": "sum"
          },
          {
            "name": "Week Day",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "1bcc1208-1751-4069-8922-93252fe39cdc",
            "sourceColumn": "Week Day",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar RelativeWeekPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "f69c9f46-4991-4e97-8a67-57bc82fcdbdd",
            "sourceColumn": "Calendar RelativeWeekPos",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar RelativeMonthPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "668bf761-a763-4e08-a606-68cc1821c488",
            "sourceColumn": "Calendar RelativeMonthPos",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar RelativeQuarterPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d175e498-b6ce-430d-9d8b-f442b9ecc03b",
            "sourceColumn": "Calendar RelativeQuarterPos",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar RelativeYearPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4b7a5947-e238-44d8-9a4a-04df15bdee74",
            "sourceColumn": "Calendar RelativeYearPos",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar StartOfMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "a7754919-a37c-4d4a-9c21-aea48e912310",
            "sourceColumn": "Calendar StartOfMonth",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar EndOfMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "2c9d68fc-2bc6-4536-93ea-bd3bc58f23d9",
            "sourceColumn": "Calendar EndOfMonth",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar DayOfMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4983d518-5b09-4417-a212-307c4691341d",
            "sourceColumn": "Calendar DayOfMonth",
            "summarizeBy": "sum"
          },
          {
            "name": "Calendar StartOfQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "ae414372-bc71-42ba-9368-ecb95630cd44",
            "sourceColumn": "Calendar StartOfQuarter",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar EndOfQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "b4e65f0e-8af2-49a0-bd0a-68bc9d44389a",
            "sourceColumn": "Calendar EndOfQuarter",
            "summarizeBy": "none"
          },
          {
            "name": "Calendar DayOfQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b212b283-9110-4ddf-a6cf-454fc99bd2f4",
            "sourceColumn": "Calendar DayOfQuarter",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "a969d272-4233-43c5-96b6-9865ecb4a028",
        "partitions": [
          {
            "name": "Dates_IMKE-f8182f19-7b23-4b43-ac5a-5de5b6e70196",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Imke_function(#date(2000, 1, 1), #date(2030, 1, 1), \"en-gb\")",
                "in",
                "    Source"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "DISCONNECTED Countries",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "EnglishCountryRegionName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "4ac03d37-4a8e-4086-8527-77e78a86ba72",
            "sourceColumn": "EnglishCountryRegionName",
            "summarizeBy": "none"
          },
          {
            "name": "CountryIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "39a848cf-5dc5-417b-9631-0ae276abf576",
            "sourceColumn": "CountryIndex",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "b491a936-5a1f-44c1-880f-c4914fba2095",
        "measures": [
          {
            "name": "Selected Country flag",
            "changedProperties": [
              {
                "property": "FormatString"
              },
              {
                "property": "IsHidden"
              }
            ],
            "description": [
              "",
              "IF(",
              "SELECTEDVALUE('DISCONNECTED Countries'[EnglishCountryRegionName])=SELECTEDVALUE(Geography[EnglishCountryRegionName]),",
              "1,",
              "0",
              ")"
            ],
            "expression": [
              "",
              "IF(",
              "SELECTEDVALUE('DISCONNECTED Countries'[EnglishCountryRegionName])=SELECTEDVALUE(Geography[EnglishCountryRegionName]),",
              "1,",
              "0",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "98d21688-739d-4476-86ef-a7b094ea23de"
          }
        ],
        "partitions": [
          {
            "name": "DISCONNECTED Countries-ebd8090d-a873-48f7-85d0-1942dd2ff35e",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Geography,",
                "    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"EnglishCountryRegionName\"}),",
                "    #\"Grouped Rows\" = Table.Group(#\"Removed Other Columns\", {\"EnglishCountryRegionName\"}, {{\"Count\", each _, type table [EnglishCountryRegionName=nullable text]}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Grouped Rows\",{\"Count\"}),",
                "    #\"Added Index\" = Table.AddIndexColumn(#\"Removed Columns\", \"Index\", 1, 1, Int64.Type),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Added Index\",{{\"Index\", \"CountryIndex\"}})",
                "in",
                "    #\"Renamed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "TopList",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "b1f0ea1c4d854a1e8956e0b56d1620b1"
          }
        ],
        "columns": [
          {
            "name": "TopList",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "d32ded51-e2fb-419e-9cda-7b57f5904092",
            "relatedColumnDetails": {
              "groupByColumns": [
                {
                  "groupingColumn": "TopList Fields"
                }
              ]
            },
            "sortByColumn": "TopList Order",
            "sourceColumn": "[Value1]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "TopList Fields",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "kind": 2,
                  "version": 3
                }
              }
            ],
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "785cb07f-9554-41cb-8917-dfe2adb247f1",
            "sortByColumn": "TopList Order",
            "sourceColumn": "[Value2]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "TopList Order",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "156523a6-92fb-437e-8459-168e3e16df49",
            "sourceColumn": "[Value3]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "5eda14fb-5fce-4ade-a8d5-67e74835aa24",
        "partitions": [
          {
            "name": "TopList-1c177b52-8eab-49ce-afc9-64b209489fd0",
            "mode": "import",
            "source": {
              "expression": [
                "{",
                "    (\"Top N Products List\", NAMEOF('All Rank (Top) Measures'[Top N Products List]), 0),",
                "    (\"Top N Days List\", NAMEOF('All Rank (Top) Measures'[Top N Days List]), 1),",
                "    (\"Top N Customers List\", NAMEOF('All Rank (Top) Measures'[Top N Customers List]), 2)",
                "}"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "DAX Debugger DATESYTD",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Text"
          }
        ],
        "columns": [
          {
            "name": "DAX Debugger DATESYTD",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "0a7e15b7-e2cb-4d33-875d-35bf62241f7b",
            "sourceColumn": "DAX Debugger DATESYTD",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "5ec5d135-0956-496e-b4b3-285af047cdd9",
        "partitions": [
          {
            "name": "DAX Debugger DATESYTD-ea83a9f1-4f04-4823-9a89-631442ab26bf",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = #\"DAX Debugger\"(\"DATESYTD ( 'Date 👍'[Date])\", \"Date\", null)",
                "in",
                "    Source"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Customer earliest order per year",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "EmailAddress",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "e9f4b81f-af2b-441e-a85e-6da8c1c66514",
            "sourceColumn": "EmailAddress",
            "summarizeBy": "none"
          },
          {
            "name": "2013",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "cecf4e06-b08d-4b7f-84b3-8b1d84ac5588",
            "sourceColumn": "2013",
            "summarizeBy": "none"
          },
          {
            "name": "2014",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "b3056919-525b-4bf4-8f87-a76319f73a1b",
            "sourceColumn": "2014",
            "summarizeBy": "none"
          },
          {
            "name": "2011",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "e968e6fe-732a-49cc-a882-6f12214b7b12",
            "sourceColumn": "2011",
            "summarizeBy": "none"
          },
          {
            "name": "2012",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "3804cc08-aa2a-4ccc-8ee3-d5e408e80344",
            "sourceColumn": "2012",
            "summarizeBy": "none"
          },
          {
            "name": "2010",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "f4dcc0c5-c4ba-423e-a866-9430755130e7",
            "sourceColumn": "2010",
            "summarizeBy": "none"
          },
          {
            "name": "earliest order",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "expression": [
              "",
              "// see https://data-mozart.com/use-aggregate-functions-on-rows-in-power-bi/",
              "// this is like COELESCE in SQL",
              "minx(",
              "    { -- list the columns to iterate over",
              "        'Customer earliest order per year'[2010],",
              "        'Customer earliest order per year'[2011],",
              "        'Customer earliest order per year'[2012],",
              "        'Customer earliest order per year'[2013],",
              "        'Customer earliest order per year'[2014]",
              "        },",
              "        [Value] -- this comes up in the intellisense",
              "        )"
            ],
            "formatString": "General Date",
            "isDataTypeInferred": true,
            "lineageTag": "3389d22a-e1b2-479b-8fa9-46157110c332",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "19e23077-da26-4c7b-8745-0a0ef52d655b",
        "partitions": [
          {
            "name": "Customer earliest order per year-2c679e2f-1ea7-4a9e-841d-4fcda7541847",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\".\", \"adventureworksdw2019\", [Query=\"SELECT        #(lf)d.CalendarYear#(lf), c.EmailAddress#(lf), min( d.FullDateAlternateKey) as 'min date'#(lf)FROM            #(lf)DimCustomer AS c #(lf)INNER JOIN#(lf)FactInternetSales AS [IS] #(lf)ON c.CustomerKey = [IS].CustomerKey #(lf)INNER JOIN#(lf)DimDate AS d #(lf)ON [IS].OrderDateKey = d.DateKey #(lf)group by d.CalendarYear, c.EmailAddress\"]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"CalendarYear\", Int64.Type}}),",
                "    #\"Pivoted Column\" = Table.Pivot(Table.TransformColumnTypes(#\"Changed Type\", {{\"CalendarYear\", type text}}, \"en-GB\"), List.Distinct(Table.TransformColumnTypes(#\"Changed Type\", {{\"CalendarYear\", type text}}, \"en-GB\")[CalendarYear]), \"CalendarYear\", \"min date\"),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Pivoted Column\",{\"EmailAddress\", \"2010\", \"2011\", \"2012\", \"2013\", \"2014\"})",
                "in",
                "    #\"Reordered Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Pick_column",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "d3588b822cec4f009553b774a8575a8c"
          }
        ],
        "columns": [
          {
            "name": "Pick_column",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "4113c692-425f-4939-b03b-435ec5b3533a",
            "relatedColumnDetails": {
              "groupByColumns": [
                {
                  "groupingColumn": "Pick_column Fields"
                }
              ]
            },
            "sortByColumn": "Pick_column Order",
            "sourceColumn": "[Value1]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Pick_column Fields",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "kind": 2,
                  "version": 3
                }
              }
            ],
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "7329d66e-4dd7-44d8-99ad-08d12c19c39c",
            "sortByColumn": "Pick_column Order",
            "sourceColumn": "[Value2]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Pick_column Order",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "20286106-e71f-49bf-8226-bce466e9480d",
            "sourceColumn": "[Value3]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "baa8e6b2-597d-4323-8bec-82a92c38ad52",
        "partitions": [
          {
            "name": "Pick_column-723ed7ba-8cd4-4b00-9efd-8f70575c757e",
            "mode": "import",
            "source": {
              "expression": [
                "{",
                "    (\"EmailAddress\", NAMEOF('Customer'[EmailAddress]), 0),",
                "    (\"CalendarYear\", NAMEOF('Date 👍'[CalendarYear]), 1),",
                "    (\"EnglishCountryRegionName\", NAMEOF('Geography'[EnglishCountryRegionName]), 2),",
                "    (\"ProductCategoryName\", NAMEOF('ProductCategory 😀'[ProductCategoryName]), 3)",
                "}"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "2020 Summer Olympics",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "changedProperties": [
          {
            "property": "Name"
          }
        ],
        "columns": [
          {
            "name": "Country",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "38c00ebc-6284-4682-a705-c52ab911915f",
            "sourceColumn": "Country",
            "summarizeBy": "none"
          },
          {
            "name": "Gold",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "098b648d-d558-4e47-99cd-5f940182aff6",
            "sourceColumn": "Gold",
            "summarizeBy": "sum"
          },
          {
            "name": "Silver",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e32be29b-e756-465d-b7e9-4b8d046050bd",
            "sourceColumn": "Silver",
            "summarizeBy": "sum"
          },
          {
            "name": "Bronze",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a836c201-a639-499e-a662-d78996b67c71",
            "sourceColumn": "Bronze",
            "summarizeBy": "sum"
          },
          {
            "name": "ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "expression": [
              "",
              "ROWNUMBER(",
              "    '2020 Summer Olympics'",
              "    , ORDERBY([Country])",
              "    , MATCHBY([Country]) -- if rem this out then get a circular dependency error!!!",
              "    )"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "6f50b8ae-e56c-49a2-994a-c6aa15df3ab1",
            "summarizeBy": "count",
            "type": "calculated"
          },
          {
            "name": "Prev Country (matchby)",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "-- see https://pbidax.wordpress.com/2023/05/25/introducing-matchby-for-dax-window-functions/",
              "    SELECTCOLUMNS(",
              "        OFFSET(",
              "            -1,",
              "            SELECTCOLUMNS('2020 Summer Olympics',[Country], [Gold], [Silver], [Bronze]),",
              "            ORDERBY([Gold] + [Silver] + [Bronze], DESC) -- total medals",
              "            ,MATCHBY([Country]) -- rem out to get duplicate rows error!!!!",
              "        ),",
              "        [Country]",
              "    )"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "e454b7d1-5f6d-4301-b5ef-8c3030f9bd81",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "ab02bd4f-d011-455d-8cd3-bbb82142a278",
        "measures": [
          {
            "name": "All medals",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "expression": "[Gold Medals]+[Silver Medals]+[Bronze Medals]",
            "lineageTag": "41aa9203-62f2-4f51-b851-6dbc0addbadc"
          },
          {
            "name": "Gold Medals",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "expression": "SUM([Gold])",
            "lineageTag": "c2e6fc6f-d797-4909-bc7f-84592c3e8ed7"
          },
          {
            "name": "Silver Medals",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "expression": "SUM([Silver])",
            "lineageTag": "257f953d-1999-44e1-abab-072cfd188d73"
          },
          {
            "name": "Bronze Medals",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "expression": "SUM([Bronze])",
            "lineageTag": "87449abe-7bb2-49a5-9ea4-23dd70445ef5"
          }
        ],
        "partitions": [
          {
            "name": "2020 Summer Olympics-cc55d2b5-9cab-4984-85cc-2db417d398fb",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Web.BrowserContents(\"https://en.wikipedia.org/wiki/2020_Summer_Olympics_medal_table\"),",
                "    #\"Extracted Table From Html\" = Html.Table(Source, {{\"Column1\", \"TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"2\"\"]:not([colspan]):nth-child(1):nth-last-child(6), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"4\"\"]:not([colspan]):nth-child(1):nth-last-child(6), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"3\"\"]:not([colspan]):nth-child(1):nth-last-child(6), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"6\"\"]:not([colspan]):nth-child(1):nth-last-child(6), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"8\"\"]:not([colspan]):nth-child(1):nth-last-child(6), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH[colspan=\"\"2\"\"]:not([rowspan]):nth-child(1):nth-last-child(5)\"}, {\"Column2\", \"TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"2\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(5), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"4\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"3\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"6\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"8\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH[colspan=\"\"2\"\"]:not([rowspan]):nth-child(1):nth-last-child(5)\"}, {\"Column3\", \"TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TH:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"2\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(4), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"4\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"3\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"6\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"8\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH[colspan=\"\"2\"\"]:not([rowspan]):nth-child(1):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(4)\"}, {\"Column4\", \"TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TH:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TH:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"2\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(3), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"4\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"3\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"6\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"8\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH[colspan=\"\"2\"\"]:not([rowspan]):nth-child(1):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(3)\"}, {\"Column5\", \"TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TH:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TH:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TH:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"2\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(2), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"4\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"3\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"6\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"8\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH[colspan=\"\"2\"\"]:not([rowspan]):nth-child(1):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(2)\"}, {\"Column6\", \"TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TH:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TH:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TH:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2) + TH:not([colspan]):not([rowspan]):nth-child(6):nth-last-child(1), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2) + TD:not([colspan]):not([rowspan]):nth-child(6):nth-last-child(1), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"2\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2) + TD:not([colspan]):not([rowspan]):nth-child(6):nth-last-child(1), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH:not([colspan]):not([rowspan]):nth-child(1):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(2) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(1), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"4\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2) + TD:not([colspan]):not([rowspan]):nth-child(6):nth-last-child(1), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"3\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2) + TD:not([colspan]):not([rowspan]):nth-child(6):nth-last-child(1), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"6\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2) + TD:not([colspan]):not([rowspan]):nth-child(6):nth-last-child(1), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TD[rowspan=\"\"8\"\"]:not([colspan]):nth-child(1):nth-last-child(6) + TH:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(2) + TD:not([colspan]):not([rowspan]):nth-child(6):nth-last-child(1), TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR > TH[colspan=\"\"2\"\"]:not([rowspan]):nth-child(1):nth-last-child(5) + TD:not([colspan]):not([rowspan]):nth-child(2):nth-last-child(4) + TD:not([colspan]):not([rowspan]):nth-child(3):nth-last-child(3) + TD:not([colspan]):not([rowspan]):nth-child(4):nth-last-child(2) + TD:not([colspan]):not([rowspan]):nth-child(5):nth-last-child(1)\"}}, [RowSelector=\"TABLE.wikitable.sortable.plainrowheaders.jquery-tablesorter > * > TR\"]),",
                "    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Extracted Table From Html\", [PromoteAllScalars=true]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Promoted Headers\",{{\"Rank\", type text}, {\"NOC\", type text}, {\"Gold\", Int64.Type}, {\"Silver\", Int64.Type}, {\"Bronze\", Int64.Type}, {\"Total\", Int64.Type}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Rank\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"NOC\", \"Country\"}}),",
                "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Renamed Columns\",{\"Total\"}),",
                "    #\"Removed Bottom Rows\" = Table.RemoveLastN(#\"Removed Columns1\",1),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Removed Bottom Rows\",\"Japan*\",\"Japan\",Replacer.ReplaceText,{\"Country\"})",
                "in",
                "    #\"Replaced Value\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Calendar53",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "3577203e-1642-49ce-bd32-096f7e6977cf",
            "sourceColumn": "Year",
            "summarizeBy": "sum"
          },
          {
            "name": "FM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c18d9387-f84c-4b50-8173-eda299f9c127",
            "sourceColumn": "FM",
            "summarizeBy": "sum"
          },
          {
            "name": "WeekInFM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "453d244e-dca5-44d2-a376-4ce7e9814465",
            "sourceColumn": "WeekInFM",
            "summarizeBy": "sum"
          },
          {
            "name": "FW_Index",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a191a4d2-32c2-4012-b903-b6c18ac92b10",
            "sourceColumn": "FW_Index",
            "summarizeBy": "sum"
          },
          {
            "name": "FWinYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "325b710c-00e4-44f3-9fa0-50928aa8afa8",
            "sourceColumn": "FWinYear",
            "summarizeBy": "none"
          },
          {
            "name": "DayIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "697b9709-6903-4d61-9162-d5ec4ce2cbb9",
            "sourceColumn": "DayIndex",
            "summarizeBy": "sum"
          },
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "da839028-0b1d-4129-b0aa-21ee06099ad7",
            "sourceColumn": "Date",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "d5b54201-b69f-417a-b5a0-b34774083349",
        "partitions": [
          {
            "name": "Calendar53",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "",
                "// see https://hoosierbi.com/2021/07/04/445-calendar-with-53-week-years/",
                "",
                "  // Enter the date in Advanced Editor for the first day of the earliest Fiscal Year in #date(yyyy,m,d) format                                                                                                            ",
                "  StartDate = #date(2000, 01, 01),",
                "  // Enter the desired range of years as List in Advanced Editor                                                              ",
                "  YearRange = {2000 .. 2030},",
                "  // In Advanced Editor, use one of the two options for this step (code out the one not used with //) to either hard code or dynamically calculate the years with 53 weeks.  Substitute a different evaluation criterion as needed.                                                                                                                                                                                                                                 ",
                "  // YearsWith53Weeks = {2019},                             ",
                "  YearsWith53Weeks = List.Select(YearRange, each Date.DayOfWeekName(#date(_, 11, 30)) = \"Saturday\"),",
                "  StartingTable = Table.FromColumns({YearRange}, {\"Year\"}),",
                "  AddNumberOfWeeksColumn = Table.AddColumn(",
                "    StartingTable,",
                "    \"Weeks\",",
                "    each if List.Contains(YearsWith53Weeks, [Year]) then 53 else 52",
                "  ),",
                "  #\"Changed Type4\" = Table.TransformColumnTypes(",
                "    AddNumberOfWeeksColumn,",
                "    {{\"Year\", Int64.Type}, {\"Weeks\", Int64.Type}}",
                "  ),",
                "  // In the Advanced Editor, enter the two patterns for 52 and 53 week years as a list of weeks per fiscal month                                                                                                              ",
                "  AddListOfMonthAndWeekCounts = Table.AddColumn(",
                "    #\"Changed Type4\",",
                "    \"Custom\",",
                "    each",
                "      if [Weeks] = 53 then",
                "        List.Zip({{1 .. 12}, {4, 4, 5, 4, 4, 5, 4, 4, 5, 4, 5, 5}})",
                "      else",
                "        List.Zip({{1 .. 12}, {4, 4, 5, 4, 4, 5, 4, 4, 5, 4, 4, 5}})",
                "  ),",
                "  #\"Expanded Custom\" = Table.ExpandListColumn(AddListOfMonthAndWeekCounts, \"Custom\"),",
                "  #\"Extracted Values\" = Table.TransformColumns(",
                "    #\"Expanded Custom\",",
                "    {\"Custom\", each Text.Combine(List.Transform(_, Text.From), \";\"), type text}",
                "  ),",
                "  #\"Split Column by Delimiter\" = Table.SplitColumn(",
                "    #\"Extracted Values\",",
                "    \"Custom\",",
                "    Splitter.SplitTextByDelimiter(\";\", QuoteStyle.Csv),",
                "    {\"FM\", \"NumWeeks\"}",
                "  ),",
                "  #\"Changed Type\" = Table.TransformColumnTypes(",
                "    #\"Split Column by Delimiter\",",
                "    {{\"FM\", Int64.Type}, {\"NumWeeks\", Int64.Type}}",
                "  ),",
                "  AddListOfWeeksColumn = Table.AddColumn(#\"Changed Type\", \"WeekInFM\", each {1 .. [NumWeeks]}),",
                "  #\"Expanded Custom1\" = Table.ExpandListColumn(AddListOfWeeksColumn, \"WeekInFM\"),",
                "  #\"Changed Type1\" = Table.TransformColumnTypes(#\"Expanded Custom1\", {{\"WeekInFM\", Int64.Type}}),",
                "  AddWeekIndex = Table.AddIndexColumn(#\"Changed Type1\", \"FW_Index\", 1, 1, Int64.Type),",
                "  AddFWinYear = Table.AddColumn(",
                "    AddWeekIndex,",
                "    \"FWinYear\",",
                "    each",
                "      let",
                "        thisyear = [Year],",
                "        thisindex = [FW_Index],",
                "        result = Table.RowCount(",
                "          Table.SelectRows(AddWeekIndex, each [Year] = thisyear and [FW_Index] <= thisindex)",
                "        )",
                "      in",
                "        result",
                "  ),",
                "  Add7DayListPerWeek = Table.AddColumn(AddFWinYear, \"WeekDay\", each {1 .. 7}),",
                "  #\"Expanded WeekDay\" = Table.ExpandListColumn(Add7DayListPerWeek, \"WeekDay\"),",
                "  #\"Changed Type2\" = Table.TransformColumnTypes(#\"Expanded WeekDay\", {{\"WeekDay\", Int64.Type}}),",
                "  RemoveUnneededColumns = Table.RemoveColumns(#\"Changed Type2\", {\"Weeks\", \"NumWeeks\", \"WeekDay\"}),",
                "  AddDayIndex = Table.AddIndexColumn(RemoveUnneededColumns, \"DayIndex\", 0, 1, Int64.Type),",
                "  AddDatesBasedOnStartDateAndDayIndex = Table.AddColumn(",
                "    AddDayIndex,",
                "    \"Date\",",
                "    each Date.AddDays(StartDate, [DayIndex]),",
                "    type date",
                "  )",
                "in",
                "  AddDatesBasedOnStartDateAndDayIndex"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Dates_AVI",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "8d6616e5-046a-48f2-9d11-c465c5b99b0b",
            "sourceColumn": "Date",
            "summarizeBy": "none"
          },
          {
            "name": "MonthNum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "80e4451c-b99e-4c53-9e3d-e2d0b8f6b479",
            "sourceColumn": "MonthNum",
            "summarizeBy": "sum"
          },
          {
            "name": "Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "735a8610-4b98-46d6-b4d8-091361ed1e46",
            "sourceColumn": "Month",
            "summarizeBy": "none"
          },
          {
            "name": "MonthLong",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "dd3a2864-a0a1-4976-b962-21aa42bd9ec5",
            "sourceColumn": "MonthLong",
            "summarizeBy": "none"
          },
          {
            "name": "Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "84828b66-011b-4165-b9a0-ee9ec9b9b3c7",
            "sourceColumn": "Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2a58c938-dec9-4b16-8922-b1a11ec4930e",
            "sourceColumn": "Year",
            "summarizeBy": "sum"
          },
          {
            "name": "FiscalMonthNum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "108a8015-194c-4a9b-af21-2c38fcedeb86",
            "sourceColumn": "FiscalMonthNum",
            "summarizeBy": "sum"
          },
          {
            "name": "FiscalMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f7da78e5-cdee-4ce9-9646-836cfc8ac1e8",
            "sourceColumn": "FiscalMonth",
            "summarizeBy": "none"
          },
          {
            "name": "FiscalMonthLong",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c83905d9-3e7a-4c5d-b912-9dfa1d229bc8",
            "sourceColumn": "FiscalMonthLong",
            "summarizeBy": "none"
          },
          {
            "name": "FiscalQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b3cb1a0e-dec9-48ba-b3c5-e906c3195c23",
            "sourceColumn": "FiscalQuarter",
            "summarizeBy": "none"
          },
          {
            "name": "FiscalYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "586ff8f9-13f5-4a50-8a48-b66cca333c2e",
            "sourceColumn": "FiscalYear",
            "summarizeBy": "none"
          },
          {
            "name": "CurMonthOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e74acc7a-2dad-4bf9-923e-9c3d30f027bf",
            "sourceColumn": "CurMonthOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "CurQuarterOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2e9b07f6-f102-442a-a238-69870bea20f6",
            "sourceColumn": "CurQuarterOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "CurYearOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b9024227-91f5-4d82-a12c-ed8b885d3d83",
            "sourceColumn": "CurYearOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "FutureDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c6c26fc6-b01f-4f97-8c31-f4e25209f5f7",
            "sourceColumn": "FutureDate",
            "summarizeBy": "none"
          },
          {
            "name": "CurFiscalYearOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "335ccb8b-8f9e-4df5-9e54-49467e7abcb5",
            "sourceColumn": "CurFiscalYearOffset",
            "summarizeBy": "none"
          },
          {
            "name": "MonthYearNum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b1783e2d-2f2e-49ba-8937-04ccfa59d804",
            "sourceColumn": "MonthYearNum",
            "summarizeBy": "sum"
          },
          {
            "name": "MonthYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f9934506-e6bc-4c2a-b24f-387099eae32e",
            "sourceColumn": "MonthYear",
            "summarizeBy": "none"
          },
          {
            "name": "MonthYearLong",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c6d32add-0726-4f58-a485-bf5fa4d3aadf",
            "sourceColumn": "MonthYearLong",
            "summarizeBy": "none"
          },
          {
            "name": "WeekdayNum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "1269a0f6-6cad-4017-b459-4bfcd2207eea",
            "sourceColumn": "WeekdayNum",
            "summarizeBy": "sum"
          },
          {
            "name": "Weekday",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f4f9a46d-f196-4b1b-a7bf-63fd29f026fd",
            "sourceColumn": "Weekday",
            "summarizeBy": "none"
          },
          {
            "name": "WeekdayWeekend",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "330a03d2-4dd9-42b0-94ca-cd73c6295242",
            "sourceColumn": "WeekdayWeekend",
            "summarizeBy": "none"
          },
          {
            "name": "WeekSequenceNum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ae71a80d-1ce6-48cf-9549-97015eb7fb69",
            "sourceColumn": "WeekSequenceNum",
            "summarizeBy": "sum"
          },
          {
            "name": "WeekDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "ee45d15b-def1-4f58-8925-500825748823",
            "sourceColumn": "WeekDate",
            "summarizeBy": "none"
          },
          {
            "name": "Week of Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "fc63428a-6534-481d-a1f9-fb66fdfe82d0",
            "sourceColumn": "Week of Year",
            "summarizeBy": "sum"
          },
          {
            "name": "CurWeekOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4948dd66-3e74-4689-839b-4fada0f5cea1",
            "sourceColumn": "CurWeekOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "Day of Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "3c8c1c9e-0ecb-48cf-b42a-e696a77827cf",
            "sourceColumn": "Day of Year",
            "summarizeBy": "sum"
          },
          {
            "name": "Flag_YTD",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "74a2e9c2-b7ef-453c-ade0-3a3a9caeac0f",
            "sourceColumn": "Flag_YTD",
            "summarizeBy": "none"
          },
          {
            "name": "Flag_MTD",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "61dc7118-7b14-4afa-b107-297275f84333",
            "sourceColumn": "Flag_MTD",
            "summarizeBy": "none"
          },
          {
            "name": "Flag_QTD",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c58b82a8-0672-4f65-b5b9-a5d24baefdad",
            "sourceColumn": "Flag_QTD",
            "summarizeBy": "none"
          },
          {
            "name": "CurrentDayOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "33dd1ede-e9a1-43e1-a87a-c961d38d5d0e",
            "sourceColumn": "CurrentDayOffset",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "7ca6713e-c478-44a3-8bda-2d59fdadbcef",
        "partitions": [
          {
            "name": "Dates_AVI",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    /*",
                "    ****This Calendar was created and provided by Avi Singh****",
                "    ****This can be freely shared as long as this text comment is retained.****",
                "    http://www.youtube.com/PowerBIPro",
                "    www.LearnPowerBI.com by Avi Singh",
                "    For More on Ultimate Calendar: https://www.youtube.com/playlist?list=PL7GQQXV5Z8eczWqKFMDVoHMjTcpH3tgZm",
                "    */",
                "    #\"LearnPowerBI.com by Avi Singh\" = 1,",
                "    StartDate = #date(2014, 1, 1),",
                "    EndDate = Date.EndOfYear(DateTime.Date(DateTime.FixedLocalNow())) /*was \"#date(2017, 1, 1)\" Updated on 201802027: hard Coded End of Year caused some formulas to break, switching to dynamic date*/,",
                "    //Used for 'Offset' Column calculations, you may Hard code CurrentDate for testing e.g. #date(2017,9,1)",
                "    CurrentDate = DateTime.Date(DateTime.FixedLocalNow()),",
                "    // Specify the last month in your Fiscal Year, e.g. if June is the last month of your Fiscal Year, specify 6",
                "    FiscalYearEndMonth = 6,",
                "    #\"==SET PARAMETERS ABOVE==\" = 1,",
                "    #\"==Build Date Column==\" = #\"==SET PARAMETERS ABOVE==\",",
                "    ListDates = List.Dates(StartDate, Number.From(EndDate - StartDate)+1, #duration(1,0,0,0)),",
                "    #\"Converted to Table\" = Table.FromList(ListDates, Splitter.SplitByNothing(), null, null, ExtraValues.Error),",
                "    #\"Renamed Columns as Date\" = Table.RenameColumns(#\"Converted to Table\",{{\"Column1\", \"Date\"}}),",
                "    // As far as Power BI is concerned, the 'Date' column is all that is needed :-) But we will continue and add a few Human-Friendly Columns",
                "    #\"Changed Type to Date\" = Table.TransformColumnTypes(#\"Renamed Columns as Date\",{{\"Date\", type date}}),",
                "    #\"==Add Calendar Columns==\" = #\"Changed Type to Date\",",
                "    #\"Added Calendar MonthNum\" = Table.AddColumn(#\"==Add Calendar Columns==\", \"MonthNum\", each Date.Month([Date]), Int64.Type),",
                "    #\"Added Month Name\" = Table.AddColumn(#\"Added Calendar MonthNum\", \"Month\", each Text.Start(Date.MonthName([Date]),3), type text),",
                "    #\"Added Month Name Long\" = Table.AddColumn(#\"Added Month Name\", \"MonthLong\", each Date.MonthName([Date]), type text),",
                "    #\"Added Calendar Quarter\" = Table.AddColumn(#\"Added Month Name Long\", \"Quarter\", each \"Q\" & Text.From(Date.QuarterOfYear([Date]))),",
                "    #\"Added Calendar Year\" = Table.AddColumn(#\"Added Calendar Quarter\", \"Year\", each Date.Year([Date]), Int64.Type),",
                "    #\"==Add Fiscal Calendar Columns==\" = #\"Added Calendar Year\",",
                "    #\"Added FiscalMonthNum\" = Table.AddColumn(#\"==Add Fiscal Calendar Columns==\", \"FiscalMonthNum\", each if [MonthNum] > FiscalYearEndMonth",
                "then [MonthNum] - FiscalYearEndMonth",
                "else [MonthNum] + (12 - FiscalYearEndMonth), type number),",
                "    #\"Added FiscalMonth Name\" = Table.AddColumn(#\"Added FiscalMonthNum\", \"FiscalMonth\", each [Month]),",
                "    #\"Added FiscalMonth Name Long\" = Table.AddColumn(#\"Added FiscalMonth Name\", \"FiscalMonthLong\", each [MonthLong]),",
                "    #\"Added FiscalQuarter\" = Table.AddColumn(#\"Added FiscalMonth Name Long\", \"FiscalQuarter\", each \"FQ\" & Text.From(Number.RoundUp([FiscalMonthNum] / 3,0))),",
                "    #\"Added FiscalYear\" = Table.AddColumn(#\"Added FiscalQuarter\", \"FiscalYear\", each \"FY\" & ",
                "Text.End(",
                "  Text.From(",
                "    if [MonthNum] > FiscalYearEndMonth",
                "    then [Year] + 1",
                "    else [Year]",
                "  )",
                "  , 2",
                ")),",
                "",
                "    #\"==Add Calendar Date Offset Columns==\" = #\"Added FiscalYear\",",
                "    // Can be used to for example to show the past 3 months(CurMonthOffset = 0, -1, -2)",
                "    #\"Added CurMonthOffset\" = Table.AddColumn(#\"==Add Calendar Date Offset Columns==\", \"CurMonthOffset\", each ( Date.Year([Date]) - Date.Year(CurrentDate) ) * 12",
                "+ Date.Month([Date]) - Date.Month(CurrentDate), Int64.Type),",
                "    // Can be used to for example to show the past 3 quarters (CurQuarterOffset = 0, -1, -2)",
                "    #\"Added CurQuarterOffset\" = Table.AddColumn(#\"Added CurMonthOffset\", \"CurQuarterOffset\", each /*Year Difference*/",
                "       ( Date.Year([Date]) - Date.Year(CurrentDate) )*4",
                "       /*Quarter Difference*/",
                "      + Number.RoundUp(Date.Month([Date]) / 3) ",
                "      - Number.RoundUp(Date.Month(CurrentDate) / 3),",
                "Int64.Type),",
                "    // Can be used to for example to show the past 3 years (CurYearOffset = 0, -1, -2)",
                "    #\"Added CurYearOffset\" = Table.AddColumn(#\"Added CurQuarterOffset\", \"CurYearOffset\", each Date.Year([Date]) - Date.Year(CurrentDate), Int64.Type),",
                "    // Can be used to for example filter out all future dates",
                "    #\"Added FutureDate Flag\" = Table.AddColumn(#\"Added CurYearOffset\", \"FutureDate\", each if [Date] > CurrentDate then \"Future\" else \"Past\" ),",
                "    // FiscalYearOffset is the only Offset that is different.",
                "    // FiscalQuarterOffset = is same as CurQuarterOffset",
                "    // FiscalMonthOffset = is same as CurMonthOffset",
                "    #\"==Add FiscalYearOffset==\" = #\"Added FutureDate Flag\",",
                "    #\"Filtered Rows to CurrentDate\" = Table.SelectRows(#\"==Add FiscalYearOffset==\", each ([Date] = CurrentDate)),",
                "    CurrentFiscalYear = #\"Filtered Rows to CurrentDate\"{0}[FiscalYear],",
                "    #\"Continue...Orig Table\" = #\"==Add FiscalYearOffset==\",",
                "    #\"Added CurFiscalYearOffset\" = Table.AddColumn(#\"Continue...Orig Table\", \"CurFiscalYearOffset\", each Number.From(Text.Range([FiscalYear],2,2)) - ",
                "Number.From(Text.Range(CurrentFiscalYear,2,2))",
                "/*Extract the numerical portion, e.g. FY18 = 18*/),",
                "    #\"==Add General Columns==\" = #\"Added CurFiscalYearOffset\",",
                "    // Used as 'Sort by Column' for MonthYear columns",
                "    #\"Added MonthYearNum\" = Table.AddColumn(#\"==Add General Columns==\", \"MonthYearNum\", each [Year]*100 + [MonthNum] /*e.g. Sep-2016 would become 201609*/, Int64.Type),",
                "    #\"Added MonthYear\" = Table.AddColumn(#\"Added MonthYearNum\", \"MonthYear\", each [Month] & \"-\" & Text.End(Text.From([Year]),2)),",
                "    #\"Added MonthYearLong\" = Table.AddColumn(#\"Added MonthYear\", \"MonthYearLong\", each [Month] & \"-\" & Text.From([Year])),",
                "    #\"Added WeekdayNum\" = Table.AddColumn(#\"Added MonthYearLong\", \"WeekdayNum\", each Date.DayOfWeek([Date]), Int64.Type),",
                "    #\"Added Weekday Name\" = Table.AddColumn(#\"Added WeekdayNum\", \"Weekday\", each Text.Start(Date.DayOfWeekName([Date]),3), type text),",
                "    #\"Added WeekdayWeekend\" = Table.AddColumn(#\"Added Weekday Name\", \"WeekdayWeekend\", each if [WeekdayNum] = 0 or [WeekdayNum] = 6",
                "then \"Weekend\"",
                "else \"Weekday\"),",
                "    #\"==Improve Ultimate Table\" = #\"Added WeekdayWeekend\",",
                "    #\"----Add WeekSequenceNum----\" = #\"==Improve Ultimate Table\",",
                "    #\"Filtered Rows Sundays Only (Start of Week)\" = Table.SelectRows(#\"----Add WeekSequenceNum----\", each ([WeekdayNum] = 0)),",
                "    #\"Added Index WeekSequenceNum\" = Table.AddIndexColumn(#\"Filtered Rows Sundays Only (Start of Week)\", \"WeekSequenceNum\", 2, 1),",
                "    #\"Merged Queries Ultimate Table to WeekSequenceNum\" = Table.NestedJoin(#\"==Improve Ultimate Table\",{\"Date\"},#\"Added Index WeekSequenceNum\",{\"Date\"},\"Added Index WeekNum\",JoinKind.LeftOuter),",
                "    #\"Expanded Added Index WeekNum\" = Table.ExpandTableColumn(#\"Merged Queries Ultimate Table to WeekSequenceNum\", \"Added Index WeekNum\", {\"WeekSequenceNum\"}, {\"WeekSequenceNum\"}),",
                "    // somehow it ends up being unsorted after Expand Column, should not matter for the end table, but makes it harder to debug and check everything is correct. Thus sorting it.",
                "    #\"ReSorted Rows by Date\" = Table.Sort(#\"Expanded Added Index WeekNum\",{{\"Date\", Order.Ascending}}),",
                "    #\"Filled Down WeekSequenceNum\" = Table.FillDown(#\"ReSorted Rows by Date\",{\"WeekSequenceNum\"}),",
                "    #\"Replaced Value WeekSequenceNum null with 1\" = Table.ReplaceValue(#\"Filled Down WeekSequenceNum\",null,1,Replacer.ReplaceValue,{\"WeekSequenceNum\"}),",
                "    #\"Inserted Start of Week (WeekDate)\" = Table.AddColumn(#\"Replaced Value WeekSequenceNum null with 1\", \"WeekDate\", each Date.StartOfWeek([Date]), type date),",
                "    // Updated Oct-2019",
                "    #\"Inserted Week of Year\" = Table.AddColumn(#\"Inserted Start of Week (WeekDate)\", \"Week of Year\", each Date.WeekOfYear([Date]), Int64.Type),",
                "    #\"----WeekSequenceNum Complete----\" = #\"Inserted Week of Year\",",
                "    Current_WeekSequenceNum = #\"----WeekSequenceNum Complete----\"{[Date = CurrentDate]}?[WeekSequenceNum],",
                "    #\"Added Custom CurWeekOffset\" = Table.AddColumn(#\"----WeekSequenceNum Complete----\", \"CurWeekOffset\", each [WeekSequenceNum] - Current_WeekSequenceNum, Int64.Type),",
                "    // Adding a DayofYear 1 to 365",
                "    // And YTD, QTD, MTD Columns (can help with showing YTD Numbers across multiple years)",
                "    #\"==Updates 2019-Feb DayofYear and YTD QTD MTD Columns\" = #\"Added Custom CurWeekOffset\",",
                "    // This maybe useful in some DAX Calculations",
                "    #\"Inserted Day of Year\" = Table.AddColumn(#\"==Updates 2019-Feb DayofYear and YTD QTD MTD Columns\", \"Day of Year\", each Date.DayOfYear([Date]), Int64.Type),",
                "    #\"Added Flag_YTD\" = Table.AddColumn(#\"Inserted Day of Year\", \"Flag_YTD\", each if Date.DayOfYear([Date]) <= Date.DayOfYear(CurrentDate)",
                " then \"YTD\"",
                " else null),",
                "    #\"Added Flag_MTD\" = Table.AddColumn(#\"Added Flag_YTD\", \"Flag_MTD\", each if Date.Day([Date]) <= Date.Day(CurrentDate)",
                " then \"MTD\"",
                " else null),",
                "    #\"Added Flag_QTD\" = Table.AddColumn(#\"Added Flag_MTD\", \"Flag_QTD\", each //Compare Month Number in Quarter (1,2,3) for [Date] and CurrentDate",
                "if Number.Mod(Date.Month([Date])-1, 3) + 1",
                "<= Number.Mod(Date.Month(CurrentDate)-1, 3) + 1",
                "then \"QTD\"",
                "else null),",
                "    #\"==Update 2019-Mar CurrentDatOffset\" = #\"Added Flag_QTD\",",
                "    #\"Added CurrentDayOffset\" = Table.AddColumn(#\"==Update 2019-Mar CurrentDatOffset\", \"CurrentDayOffset\", each [Date] - CurrentDate),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Added CurrentDayOffset\",{{\"CurrentDayOffset\", Int64.Type}})",
                "in",
                "    #\"Changed Type1\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "MeasureKiller",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "bdf305ee-e6c0-414c-bf15-3ed078b1a6c3",
            "sourceColumn": "name",
            "summarizeBy": "none"
          },
          {
            "name": "type",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ab614c0c-848d-4c78-bff5-3bdafa0b06fd",
            "sourceColumn": "type",
            "summarizeBy": "none"
          },
          {
            "name": "table",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "dab88e88-21a9-4e92-b083-84d1f002e63a",
            "sourceColumn": "table",
            "summarizeBy": "none"
          },
          {
            "name": "report",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6eeccb88-d7ac-4043-b5bd-e7c43573e076",
            "sourceColumn": "report",
            "summarizeBy": "none"
          },
          {
            "name": "is_used",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "5081c0d9-8f70-4bad-9758-6cd3baf42691",
            "sourceColumn": "is_used",
            "summarizeBy": "none"
          },
          {
            "name": "number_of_uses",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "957a3c8c-e5b9-4849-8173-71667c6837b9",
            "sourceColumn": "number_of_uses",
            "summarizeBy": "none"
          },
          {
            "name": "size",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "39224223-3dfb-4f61-9ce1-f0b5993b3eec",
            "sourceColumn": "size",
            "summarizeBy": "none"
          },
          {
            "name": "expression",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "df7beb0f-4154-4392-ad61-8d0cf64e089b",
            "sourceColumn": "expression",
            "summarizeBy": "none"
          },
          {
            "name": "format_string",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "dfb2f77c-4bc4-47f6-b896-ea515cb2f788",
            "sourceColumn": "format_string",
            "summarizeBy": "none"
          },
          {
            "name": "dynamic_format",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "80434c59-4a8c-4769-b449-a5f1d1df9554",
            "sourceColumn": "dynamic_format",
            "summarizeBy": "none"
          },
          {
            "name": "referenced_object",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "cfdfc062-3c41-44e1-bfc7-44ff5aa0f865",
            "sourceColumn": "referenced_object",
            "summarizeBy": "none"
          },
          {
            "name": "referenced_table",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a4a365d0-b64d-4caa-83b3-7887629fe401",
            "sourceColumn": "referenced_table",
            "summarizeBy": "none"
          },
          {
            "name": "referenced_report",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ff9c68d4-ef6b-4dbc-88ec-f556f90c8242",
            "sourceColumn": "referenced_report",
            "summarizeBy": "none"
          },
          {
            "name": "category",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "9386d0a1-ddda-418b-9376-e9ac83ba8189",
            "sourceColumn": "category",
            "summarizeBy": "none"
          },
          {
            "name": "referenced_expression",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b598e6df-89f4-47cb-91a0-5c2b43c7f4d5",
            "sourceColumn": "referenced_expression",
            "summarizeBy": "none"
          },
          {
            "name": "visual_type",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "00c46ca5-7802-4317-9535-40ea00b12d3f",
            "sourceColumn": "visual_type",
            "summarizeBy": "none"
          },
          {
            "name": "visual_title",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "0982103f-9779-489d-8cef-f5f686343df9",
            "sourceColumn": "visual_title",
            "summarizeBy": "none"
          },
          {
            "name": "visual_subtitle",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "abec3deb-09c2-4fdb-b4f4-5eeab5648573",
            "sourceColumn": "visual_subtitle",
            "summarizeBy": "none"
          },
          {
            "name": "visual_id",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "debd8bea-1632-462f-85e9-156421f6c165",
            "sourceColumn": "visual_id",
            "summarizeBy": "none"
          },
          {
            "name": "visual_coordinates",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "cfdb0812-49df-46bb-9f5e-a7e1aa2183fc",
            "sourceColumn": "visual_coordinates",
            "summarizeBy": "none"
          },
          {
            "name": "visual_width",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "15ced32c-e0a9-49b6-a95c-630bf826b0df",
            "sourceColumn": "visual_width",
            "summarizeBy": "none"
          },
          {
            "name": "visual_height",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a7756ee4-7205-4803-8f27-388eae9a98d0",
            "sourceColumn": "visual_height",
            "summarizeBy": "none"
          },
          {
            "name": "page_name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "2556557d-d2be-45dd-934b-2fb1dfec0b02",
            "sourceColumn": "page_name",
            "summarizeBy": "none"
          },
          {
            "name": "report_type",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6ade06fa-0e7c-42da-a71e-34948621ccbf",
            "sourceColumn": "report_type",
            "summarizeBy": "none"
          },
          {
            "name": "relationship_id",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "505a94e0-83f7-4fe1-b04d-f324467fc5cb",
            "sourceColumn": "relationship_id",
            "summarizeBy": "none"
          },
          {
            "name": "table_dax_expression",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e1d3fb55-c790-4a5c-8596-1a7ca44ca9d1",
            "sourceColumn": "table_dax_expression",
            "summarizeBy": "none"
          },
          {
            "name": "filter_type",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "bbadbbe5-b3e5-44d4-92c8-0c6de120fe54",
            "sourceColumn": "filter_type",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "c79ca898-dde6-4f4b-859f-4c3cb4977757",
        "partitions": [
          {
            "name": "MeasureKiller",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Excel.Workbook(File.Contents(\"Y:\\Downloads\\MK_AdventureworksDWv29_20241219.xlsx\"), null, true),",
                "    Sheet1_Sheet = Source{[Item=\"Sheet1\",Kind=\"Sheet\"]}[Data],",
                "    #\"Promoted Headers\" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true]),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Promoted Headers\", each ([expression] <> null))",
                "in",
                "    #\"Filtered Rows\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "CG1",
        "calculationGroup": {
          "calculationItems": [
            {
              "name": "Base",
              "expression": "SelectedMeasure()",
              "ordinal": 0
            },
            {
              "name": "LY",
              "expression": [
                "if(",
                "    not(isinscope('Date 👍'[EnglishMonthName*])), //remove month context",
                "    calculate(SelectedMeasure(),sameperiodlastyear('Date 👍'[Date]))",
                "    )"
              ],
              "ordinal": 1
            },
            {
              "name": "Growth",
              "expression": [
                "var cy=SelectedMeasure()",
                "var ly=calculate(SelectedMeasure(),sameperiodlastyear('Date 👍'[Date]))",
                "return",
                "if(cy && ly && not(isinscope('Date 👍'[EnglishMonthName*])),",
                "    divide(cy,ly)-1",
                "    )",
                "    ",
                "//also see the Format String expression"
              ],
              "formatStringDefinition": {
                "expression": [
                  "var output=",
                  "if(selectedmeasure()>=0,",
                  "    format(selectedmeasure(),\"0%\"),",
                  "    \"🔻 \" & format(selectedmeasure(),\"0%;(0%)\")",
                  "    )",
                  "return ",
                  "\"\"\"\" // this seems to get rid of the minus sign!!!",
                  "& output"
                ]
              },
              "ordinal": 2
            }
          ],
          "precedence": 3
        },
        "columns": [
          {
            "name": "CG1 Items",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "2f0e092f-8b62-478d-ba4f-384e6ba5c2c5",
            "sortByColumn": "Ordinal",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Ordinal",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "isHidden": true,
            "lineageTag": "da00a1ed-e437-4950-8ecf-cab6aa1abc28",
            "sourceColumn": "Ordinal",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "35ae9e4e-f144-47a3-95f8-d087da505637",
        "partitions": [
          {
            "name": "Partition",
            "mode": "import",
            "source": {
              "type": "calculationGroup"
            }
          }
        ]
      },
      {
        "name": "CG +1000000 (precedence=10)",
        "calculationGroup": {
          "calculationItems": [
            {
              "name": "add 1000000",
              "expression": "selectedmeasure() +1000000"
            }
          ],
          "precedence": 10
        },
        "columns": [
          {
            "name": "add",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b74ec3b0-b84d-4c07-a171-94c841a48b6c",
            "sortByColumn": "Ordinal",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Ordinal",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "isHidden": true,
            "lineageTag": "222d7fca-2868-4dcd-8b71-faed50b78e75",
            "sourceColumn": "Ordinal",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "ef978a7a-8657-4d1c-8527-5f36e530502f",
        "partitions": [
          {
            "name": "Partition",
            "mode": "import",
            "source": {
              "type": "calculationGroup"
            }
          }
        ]
      },
      {
        "name": "CG /2 (precedence=20)",
        "calculationGroup": {
          "calculationItems": [
            {
              "name": "divide 2",
              "expression": "selectedmeasure() /2"
            }
          ],
          "precedence": 20
        },
        "columns": [
          {
            "name": "divide",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4eb226b0-661c-4c6e-8f06-547a5a9e67e2",
            "sortByColumn": "Ordinal",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Ordinal",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "isHidden": true,
            "lineageTag": "b17304b7-55d5-4f7a-ac9e-a32b458306cd",
            "sourceColumn": "Ordinal",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "772d9c7a-497a-4a6d-9f04-406d4c0ae616",
        "partitions": [
          {
            "name": "Partition",
            "mode": "import",
            "source": {
              "type": "calculationGroup"
            }
          }
        ]
      },
      {
        "name": "Dates_DeGroot",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "f4253fd4-0806-4d92-903f-d9d2a3c2cc81",
            "sourceColumn": "Date",
            "summarizeBy": "none"
          },
          {
            "name": "Date Integer",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e6abea4a-19f5-42b4-8a32-63052b92e14b",
            "sourceColumn": "Date Integer",
            "summarizeBy": "sum"
          },
          {
            "name": "Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "89a5de43-0891-45b9-a747-57d09f389160",
            "sourceColumn": "Year",
            "summarizeBy": "sum"
          },
          {
            "name": "Year Default",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "45f015b4-b81e-4485-b9fb-74e09bf17c95",
            "sourceColumn": "Year Default",
            "summarizeBy": "none"
          },
          {
            "name": "YYYY-MM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f4e6f597-4afb-4139-9cb3-04222eabef41",
            "sourceColumn": "YYYY-MM",
            "summarizeBy": "none"
          },
          {
            "name": "Month-Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "36b54307-e711-43e6-a2db-5b6c4cde2b92",
            "sourceColumn": "Month-Year",
            "summarizeBy": "none"
          },
          {
            "name": "Month Number",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ce57a2f4-a3b4-4a8e-810a-2bd0030b1ea0",
            "sourceColumn": "Month Number",
            "summarizeBy": "sum"
          },
          {
            "name": "Month Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "eae56fa9-9d38-4880-8644-f651df10fc01",
            "sourceColumn": "Month Name",
            "summarizeBy": "none"
          },
          {
            "name": "Month Name Short",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "dabee19c-fc4f-431d-87d5-003f4b92d75e",
            "sourceColumn": "Month Name Short",
            "summarizeBy": "none"
          },
          {
            "name": "Month Name Default",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "58711cb7-4f97-4673-85a7-5e63c47e3ee7",
            "sourceColumn": "Month Name Default",
            "summarizeBy": "none"
          },
          {
            "name": "Start of Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "18c902dd-b970-46af-b4dc-c0a4b387d975",
            "sourceColumn": "Start of Month",
            "summarizeBy": "none"
          },
          {
            "name": "End of Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "284b478a-79f5-4bc8-a451-c380f65b50b8",
            "sourceColumn": "End of Month",
            "summarizeBy": "none"
          },
          {
            "name": "Days in Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "5c395423-f6b1-4fd3-976f-b094a3104a4f",
            "sourceColumn": "Days in Month",
            "summarizeBy": "sum"
          },
          {
            "name": "ISO Weeknumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "01bc2939-2f9f-4e77-8219-c00196c3bc26",
            "sourceColumn": "ISO Weeknumber",
            "summarizeBy": "sum"
          },
          {
            "name": "ISO W + Weeknumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4edd78a7-b143-456c-9c1a-6984af7a2d5e",
            "sourceColumn": "ISO W + Weeknumber",
            "summarizeBy": "none"
          },
          {
            "name": "ISO Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b5712c20-758b-4286-a854-8161c58440ca",
            "sourceColumn": "ISO Year",
            "summarizeBy": "sum"
          },
          {
            "name": "Start of Week",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "87d77a59-13b2-4d0a-8713-e05353b885d3",
            "sourceColumn": "Start of Week",
            "summarizeBy": "none"
          },
          {
            "name": "Quarter Number",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "41a87235-0c58-423b-984c-3b9d25107efc",
            "sourceColumn": "Quarter Number",
            "summarizeBy": "sum"
          },
          {
            "name": "Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "63d74034-61e1-4dfc-8c5f-a2bd5978ce99",
            "sourceColumn": "Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "Year-Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6839aaec-9d76-44d4-b081-b0e59da9eeaa",
            "sourceColumn": "Year-Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "Day Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "236f369d-8141-44a0-993d-9aff8934c029",
            "sourceColumn": "Day Name",
            "summarizeBy": "none"
          },
          {
            "name": "Day Name Short",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a95af914-1b6c-4a4f-bf51-a8a57ae67911",
            "sourceColumn": "Day Name Short",
            "summarizeBy": "none"
          },
          {
            "name": "Day of Month Number",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e7cbc496-c038-47a6-96d8-590ca9f9b5ad",
            "sourceColumn": "Day of Month Number",
            "summarizeBy": "sum"
          },
          {
            "name": "Day of Week Number",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b6b3eabb-f369-4c7f-94cd-c32387c5ab44",
            "sourceColumn": "Day of Week Number",
            "summarizeBy": "sum"
          },
          {
            "name": "Day of Year Number",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a7613180-a625-4d8a-8cd0-ef9e1b0aa85c",
            "sourceColumn": "Day of Year Number",
            "summarizeBy": "sum"
          },
          {
            "name": "Day Offset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4c42c7df-347d-4879-a5ba-9e6029664056",
            "sourceColumn": "Day Offset",
            "summarizeBy": "sum"
          },
          {
            "name": "Week Offset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2aae9808-3ad7-4209-9874-705015e54abb",
            "sourceColumn": "Week Offset",
            "summarizeBy": "sum"
          },
          {
            "name": "Month Offset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0f2327aa-4d92-4701-a326-2ade96dced78",
            "sourceColumn": "Month Offset",
            "summarizeBy": "sum"
          },
          {
            "name": "Quarter Offset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "32c6ce42-5174-48cb-b128-53efb005b91f",
            "sourceColumn": "Quarter Offset",
            "summarizeBy": "sum"
          },
          {
            "name": "Year Offset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "7919c54f-b615-40e3-a427-880b2ae10882",
            "sourceColumn": "Year Offset",
            "summarizeBy": "sum"
          },
          {
            "name": "Is Weekend",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "5052fd9f-5a71-4cea-a01c-5d82afe726f3",
            "sourceColumn": "Is Weekend",
            "summarizeBy": "sum"
          },
          {
            "name": "Is Weekday",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c9d9690d-b159-4088-9711-dad8dd51e548",
            "sourceColumn": "Is Weekday",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "fd123dde-8bbc-4ca7-84ba-204631e362c9",
        "partitions": [
          {
            "name": "Dates_DeGroot",
            "mode": "import",
            "source": {
              "expression": [
                "//https://gorilla.bi/power-query/date-table-with-dynamic-language/",
                "",
                "let",
                "    Today = Date.From( DateTime.LocalNow() ),",
                "    StartDate = #date( 2021, 1, 1 ),",
                "    EndDate = Date.EndOfYear( Today ),",
                "    TranslateColumnNames = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"bZLRboMwDEV/xeJ18BdUU1exauKhmqo+eMK01UqQaNjUv58dEidh5QV870lwbnw8FjVaKkp5zUNxKhcBtsbSmaZgwCtZvDn7k1DkN+RXqKGmHueb9Tq0Fk3HH91C8FM1jZj8yJeozWjspfK7NcgLKt3TefA+D1+krpQDZT4OFF3EYeVBexknmxGwE2WFxeYTMD8CV5OFsQe3jMlF+EEDy5oY34arBNxcTUdPwRofd7gaJWs8k3GCgA7Ztns4EH2bkEQQ0jBE8zHKp4aoPcuCrGW3Q2zkY2aDppj37pcFxFv6Fw8lrt5+FT35eZUBfMpwUXzAeE1B10sKbrwiQUKSsTnhYpxJhx4P8eT0OjQPu+H9B7sZXsH7vr9T6NMX4rmN1UyrOGVqLz0nfoheCY0+gVyTSrjmEnd7d4cjHpkyLRKvw0fwJi7Ocbbg5cl8eVETOP0B\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [English = _t, Nederlands = _t]),",
                "    LanguageParameters = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45Wcs1Lz8kszlDSUUrN03X1A9LOpUVFqXklSrE60Up+qSmpRTmJeSnFQIm8HF0/HyDtUZqZkpmeqhQbCwA=\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [Language = _t, Culture = _t, DefaultValue = _t]),",
                "    CultureCode = LanguageParameters[Culture]  { List.PositionOf( LanguageParameters[Language] , CalendarLanguage ) },",
                "    Defaultvalue = LanguageParameters[DefaultValue] { List.PositionOf( LanguageParameters[Language] , CalendarLanguage ) },",
                "    #\"List of Dates\" = List.Dates( StartDate, Duration.Days( EndDate - StartDate ) +1, #duration( 1, 0, 0, 0 ) ),",
                "    #\"Converted to Table\" = Table.FromList( #\"List of Dates\", Splitter.SplitByNothing(), type table[Date = Date.Type] ),",
                "    #\"Insert Date Integer\" = Table.AddColumn(#\"Converted to Table\", \"Date Integer\", each Number.From( Date.ToText( [Date], \"yyyyMMdd\" ) ) , Int64.Type ) ,",
                "    #\"Insert Year\" = Table.AddColumn(#\"Insert Date Integer\", \"Year\", each Date.Year([Date]), Int64.Type),",
                "    // Creates a dynamic year value called 'Current' that moves with the current date. Put this value in a slicer and it automatically switches to the Current period.",
                "    #\"Add Year Default\" = Table.AddColumn(#\"Insert Year\", \"Year Default\", each if Date.Year( Today ) = [Year] then Defaultvalue else Text.From( [Year] ), type text),",
                "    #\"Insert YYYY-MM\" = Table.AddColumn(#\"Add Year Default\", \"YYYY-MM\", each Date.ToText( [Date], \"yyyy-MM\"), type text),",
                "    #\"Insert Month-Year\" = Table.AddColumn(#\"Insert YYYY-MM\", \"Month-Year\", each Text.Proper( Date.ToText( [Date], \"MMM yyyy\", CultureCode ) ), type text),",
                "    #\"Insert Month Number\" = Table.AddColumn(#\"Insert Month-Year\", \"Month Number\", each Date.Month([Date]), Int64.Type),",
                "    #\"Insert Month Name\" = Table.AddColumn(#\"Insert Month Number\", \"Month Name\", each Text.Proper( Date.MonthName([Date], CultureCode ) ), type text),",
                "    #\"Insert Month Name Short\" = Table.AddColumn(#\"Insert Month Name\", \"Month Name Short\", each Text.Proper( Date.ToText( [Date] , \"MMM\", CultureCode ) ), type text),",
                "    // Creates a dynamic year value called 'Current' that moves with the current date. Put this value in a slicer and it automatically switches to the current period.",
                "    #\"Add Month Name Default\" = Table.AddColumn(#\"Insert Month Name Short\", \"Month Name Default\", each if Date.Month( Today ) = [Month Number] then Defaultvalue else [Month Name], type text ),",
                "    #\"Insert Start of Month\" = Table.AddColumn(#\"Add Month Name Default\", \"Start of Month\", each Date.StartOfMonth([Date]), type date),",
                "    #\"Inserted End of Month\" = Table.AddColumn(#\"Insert Start of Month\", \"End of Month\", each Date.EndOfMonth( [Date] ), type date),",
                "    #\"Inserted Days in Month\" = Table.AddColumn(#\"Inserted End of Month\", \"Days in Month\", each Date.DaysInMonth([Date]), Int64.Type),",
                "    #\"Add ISO Week\" = Table.AddColumn(#\"Inserted Days in Month\", \"ISO Weeknumber\", each let",
                "CurrentThursday = Date.AddDays([Date], 3 - Date.DayOfWeek([Date], Day.Monday ) ),",
                "YearCurrThursday = Date.Year( CurrentThursday ),",
                "FirstThursdayOfYear = Date.AddDays(#date( YearCurrThursday,1,7),- Date.DayOfWeek(#date(YearCurrThursday,1,1), Day.Friday) ),",
                "ISO_Week = Duration.Days( CurrentThursday - FirstThursdayOfYear) / 7 + 1",
                "in ISO_Week, Int64.Type ),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Add ISO Week\", \"ISO W + Weeknumber\", each \"W\" & Text.From( [ISO Weeknumber] ), type text ),",
                "    #\"Add ISO Year\" = Table.AddColumn(#\"Added Custom\", \"ISO Year\", each let",
                "CurrentThursday = Date.AddDays([Date], 3 - Date.DayOfWeek([Date], Day.Monday ) ),",
                "YearCurrThursday = Date.Year( CurrentThursday )",
                "in YearCurrThursday, Int64.Type ),",
                "    #\"Insert Start of Week\" = Table.AddColumn(#\"Add ISO Year\", \"Start of Week\", each Date.StartOfWeek([Date], Day.Monday ), type date),",
                "    #\"Insert Quarter Number\" = Table.AddColumn(#\"Insert Start of Week\", \"Quarter Number\", each Date.QuarterOfYear([Date]), Int64.Type),",
                "    #\"Added Quarter\" = Table.AddColumn(#\"Insert Quarter Number\", \"Quarter\", each \"Q\" & Text.From( Date.QuarterOfYear([Date]) ), type text ),",
                "    #\"Add Year-Quarter\" = Table.AddColumn(#\"Added Quarter\", \"Year-Quarter\", each Text.From( Date.Year([Date]) ) & \"-Q\" & Text.From( Date.QuarterOfYear([Date]) ), type text ),",
                "    #\"Insert Day Name\" = Table.AddColumn(#\"Add Year-Quarter\", \"Day Name\", each Text.Proper( Date.DayOfWeekName([Date], CultureCode ) ), type text),",
                "    #\"Insert Day Name Short\" = Table.AddColumn( #\"Insert Day Name\", \"Day Name Short\", each Text.Proper( Date.ToText( [Date], \"ddd\", CultureCode ) ), type text),",
                "    #\"Insert Day of Month Number\" = Table.AddColumn(#\"Insert Day Name Short\", \"Day of Month Number\", each Date.Day([Date]), Int64.Type),",
                "    #\"Insert Day of Week\" = Table.AddColumn(#\"Insert Day of Month Number\", \"Day of Week Number\", each Date.DayOfWeek([Date]), Int64.Type),",
                "    #\"Insert Day of Year\" = Table.AddColumn(#\"Insert Day of Week\", \"Day of Year Number\", each Date.DayOfYear([Date]), Int64.Type),",
                "    #\"Add Day Offset\" = Table.AddColumn(#\"Insert Day of Year\", \"Day Offset\", each Number.From( Date.From( Today ) - [Date] ) , Int64.Type ),",
                "    #\"Add Week Offset\" = Table.AddColumn(#\"Add Day Offset\", \"Week Offset\", each ( Number.From( Date.StartOfWeek( [Date], Day.Monday) )- Number.From( Date.StartOfWeek( Today, Day.Monday ) ) ) / 7, Int64.Type ),",
                "    #\"Add Month Offset\" = Table.AddColumn(#\"Add Week Offset\", \"Month Offset\", each ([Year] - Date.Year( Today ) ) *12 + ( [Month Number] - Date.Month( Today ) ), Int64.Type ),",
                "    #\"Add Quarter Offset\" = Table.AddColumn(#\"Add Month Offset\", \"Quarter Offset\", each ( [Year] - Date.Year(Today) ) * 4 + Date.QuarterOfYear( [Date] ) - Date.QuarterOfYear( Today ), Int64.Type ),",
                "    #\"Add Year Offset\" = Table.AddColumn(#\"Add Quarter Offset\", \"Year Offset\", each [Year] - Date.Year(Today), Int64.Type ),",
                "    #\"Insert Is Weekend\" = Table.AddColumn(#\"Add Year Offset\", \"Is Weekend\", each if Date.DayOfWeek([Date], Day.Monday ) >= 5 then 1 else 0, Int64.Type ),",
                "    #\"Insert Is Weekday\" = Table.AddColumn(#\"Insert Is Weekend\", \"Is Weekday\", each if Date.DayOfWeek([Date], Day.Monday ) < 5  then 1 else 0, Int64.Type ),",
                "    #\"Rename Columns to Language\" = Table.RenameColumns(#\"Insert Is Weekday\", List.Zip( { List.Buffer( TranslateColumnNames[English] ), List.Buffer( Table.Column( TranslateColumnNames, CalendarLanguage ) ) } ), MissingField.Ignore )",
                "in",
                "    #\"Rename Columns to Language\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "CalendarLanguage",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Text"
          }
        ],
        "columns": [
          {
            "name": "CalendarLanguage",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "35748cf2-f1f2-44d7-be6e-38b765718c12",
            "sourceColumn": "CalendarLanguage",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "e40f308d-69ab-452d-adde-920fd3d8df51",
        "partitions": [
          {
            "name": "CalendarLanguage",
            "mode": "import",
            "source": {
              "expression": [
                "// CalendarLanguage",
                "\"English\"",
                "  meta [",
                "    IsParameterQuery         = true, ",
                "    List                     = {\"English\", \"Nederlands\"}, ",
                "    DefaultValue             = \"English\", ",
                "    Type                     = \"Text\", ",
                "    IsParameterQueryRequired = true",
                "  ]"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Tally",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "86219f474b85480f9bd1b167c773c3aa"
          }
        ],
        "columns": [
          {
            "name": "Value",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "ad5c4bb5-04ed-4b2b-8f62-a41e5e8b35a2",
            "sourceColumn": "[Value]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "50414b69-38aa-4504-b17a-eaf3d8369953",
            "sourceColumn": "[Date]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Day10",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1df6138f-5f31-49dc-9f18-c184a9e1fbcd",
            "sourceColumn": "[Day10]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Day10Max",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "4cdc0dce-dd47-4e6e-9e60-717dfae037c3",
            "sourceColumn": "[Day10Max]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Week4",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "f1ffca80-c5b9-409b-beba-ac58219bcb99",
            "sourceColumn": "[Week4]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Week4Max",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "550c452e-cf5f-4519-a079-fbae516bd1c8",
            "sourceColumn": "[Week4Max]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Month3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "260b26db-c599-44dc-95de-aef53515b604",
            "sourceColumn": "[Month3]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Month3Max",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "325cd55a-37e2-41c2-b5f2-1ca6adb11a7a",
            "sourceColumn": "[Month3Max]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Year1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "7f1a2db7-8368-48f8-a903-34b7d39b83fe",
            "sourceColumn": "[Year1]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Year1Max",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "5ed00dd8-ba20-43a9-9b14-5a7899ff25d5",
            "sourceColumn": "[Year1Max]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Day10Band",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "f12db111-d6f6-4a23-b9a8-f3dbd746b906",
            "sourceColumn": "[Day10Band]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Week4Band",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "69f9e6b9-71f9-49fc-bd31-ea169973a447",
            "sourceColumn": "[Week4Band]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Month3Band",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "c614dd19-a705-4e94-a39d-e9681b13b829",
            "sourceColumn": "[Month3Band]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "YearBand",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "12a4d85d-23c7-43b0-aec7-23b0d417e6f1",
            "sourceColumn": "[YearBand]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "4ec083a6-13e7-4a10-bcb0-14d3e1160bb9",
        "partitions": [
          {
            "name": "Tally",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "//originally based on https://www.sqlservercentral.com/articles/dimensional-modeling-case-study-part-2-days-dimension",
                "//nb. not perfect but just to give you an idea of the concept.",
                "//of course, all the numbers could be changed.",
                "// Create a table with 365*5 rows and add calculated columns for banding and bands",
                "",
                "        ADDCOLUMNS(",
                "            ADDCOLUMNS(",
                "                // The GENERATESERIES function generates a table with one column, named [Value], ",
                "                // that contains a contiguous set of numbers from the start value to the end value, ",
                "                // with an increment of 1. In this case, it generates a sequence of numbers from 1 to 1825.",
                "                // This is equivalent to creating a tally table in SQL with a row for each day for 5 years.",
                "                GENERATESERIES(1, 5*365, 1), ",
                "                \"Date\", DATE(2020, 1, 1) + [Value] - 1, // starting date is 01/01/2020",
                "",
                "                // The ROUNDDOWN function rounds a number down, towards zero.",
                "                // Here we are creating a new column \"Day10\" in the table.",
                "                // For each row, it divides the [Value] by 10, rounds it down to the nearest integer, and then multiplies it by 10.",
                "                // This effectively groups the days into bands of 10.",
                "                \"Day10\", ROUNDDOWN([Value] / 10, 0) * 10,",
                "",
                "                // Creating a new column \"Day10Max\" in the table.",
                "                // For each row, it calculates the maximum value of the \"Day10\" band by adding 10 to the \"Day10\" value.",
                "                \"Day10Max\", ROUNDDOWN([Value] / 10, 0) * 10 + 10,",
                "",
                "                // Creating a new column \"Week4\" in the table.",
                "                // For each row, it divides the [Value] by 28 (approximately 4 weeks), rounds it down to the nearest integer, and then multiplies it by 4.",
                "                // This effectively groups the days into bands of 4 weeks.",
                "                \"Week4\", ROUNDDOWN([Value] / 28, 0) * 4,",
                "",
                "                // Creating a new column \"Week4Max\" in the table.",
                "                // For each row, it calculates the maximum value of the \"Week4\" band by adding 4 to the \"Week4\" value.",
                "                \"Week4Max\", ROUNDDOWN([Value] / 28, 0) * 4 + 4,",
                "",
                "                // Creating a new column \"Month3\" in the table.",
                "                // For each row, it divides the [Value] by 90 (approximately 3 months), rounds it down to the nearest integer, and then multiplies it by 3.",
                "                // This effectively groups the days into bands of 3 months.",
                "                \"Month3\", ROUNDDOWN([Value] / 90, 0) * 3,",
                "",
                "                // Creating a new column \"Month3Max\" in the table.",
                "                // For each row, it calculates the maximum value of the \"Month3\" band by adding 3 to the \"Month3\" value.",
                "                \"Month3Max\", ROUNDDOWN([Value] / 90, 0) * 3 + 3,",
                "",
                "                // Creating a new column \"Year1\" in the table.",
                "                // For each row, it divides the [Value] by 365 (1 year), and rounds it down to the nearest integer.",
                "                // This effectively groups the days into bands of 1 year. n.b does not account for leap years!!!!!!",
                "                \"Year1\", ROUNDDOWN([Value] / 365, 0),",
                "",
                "                // Creating a new column \"Year1Max\" in the table.",
                "                // For each row, it calculates the maximum value of the \"Year1\" band by adding 1 to the \"Year1\" value.",
                "                \"Year1Max\", ROUNDDOWN([Value] / 365, 0) + 1",
                "            ),",
                "",
                "            // The IF function checks whether a condition is met, and returns one value if TRUE, and another value if FALSE.",
                "            // Here we are creating a new column \"Day10Band\" in the table.",
                "            // For each row, if the \"Day10Max\" value is less than or equal to 150, it concatenates the \"Day10\" and \"Day10Max\" values with a dash and \" Days\" to form a band label.",
                "            // Otherwise, it returns the string \"150+ Days\".",
                "            \"Day10Band\", IF([Day10Max] <= 150, [Day10] & \"-\" & [Day10Max] & \" Days\", \"150+ Days\"),",
                "",
                "            // Creating a new column \"Week4Band\" in the table.",
                "            // The logic is similar to the \"Day10Band\" column, but with \"Week4\" and \"Week4Max\" values and a maximum of 20 weeks.",
                "            \"Week4Band\", IF([Week4Max] <= 20, [Week4] & \"-\" & [Week4Max] & \" Weeks\", \"20+ Weeks\"),",
                "",
                "            // Creating a new column \"Month3Band\" in the table.",
                "            // The logic is similar to the \"Day10Band\" column, but with \"Month3\" and \"Month3Max\" values and a maximum of 24 months.",
                "            \"Month3Band\", IF([Month3Max] <= 24, [Month3] & \"-\" & [Month3Max] & \" Months\", \"24+ Months\"),",
                "",
                "            // Creating a new column \"YearBand\" in the table.",
                "            // The logic is similar to the \"Day10Band\" column, but with \"Year1\" and \"Year1Max\" values and a maximum of 5 years.",
                "            \"YearBand\", IF([Year1Max] <= 5, [Year1] & \"-\" & [Year1Max] & \" Years\", \"5+ Years\")",
                "        )",
                "",
                ""
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Tally (in M)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Value",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "48251346-0ae4-440d-bda7-fc26111c880c",
            "sourceColumn": "Value",
            "summarizeBy": "none"
          },
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "aee0b8f0-449c-4bde-bba8-5ca063da5216",
            "sourceColumn": "Date",
            "summarizeBy": "none"
          },
          {
            "name": "Day10",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "03efbbc8-a126-427a-b58d-b125113b3c7e",
            "sourceColumn": "Day10",
            "summarizeBy": "none"
          },
          {
            "name": "Day10Max",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d9d5d848-e0e8-42ab-a551-2829e28d3020",
            "sourceColumn": "Day10Max",
            "summarizeBy": "none"
          },
          {
            "name": "Week4",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "9c9d25f1-8144-4437-b5fe-10c0a93c5cf3",
            "sourceColumn": "Week4",
            "summarizeBy": "none"
          },
          {
            "name": "Week4Max",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "954b6418-4d27-47d0-b5ab-8b341da78510",
            "sourceColumn": "Week4Max",
            "summarizeBy": "none"
          },
          {
            "name": "Month3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "0f366fba-fba0-4fae-a939-91ec27e82df3",
            "sourceColumn": "Month3",
            "summarizeBy": "none"
          },
          {
            "name": "Month3Max",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e96fbea0-c1b0-45af-bcaa-71da2997aec2",
            "sourceColumn": "Month3Max",
            "summarizeBy": "none"
          },
          {
            "name": "Year1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "def48938-e098-4f28-9d34-2fb4287aca51",
            "sourceColumn": "Year1",
            "summarizeBy": "none"
          },
          {
            "name": "Year1Max",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "87b6d675-72db-42d6-bb9c-eb57ba3c1fa0",
            "sourceColumn": "Year1Max",
            "summarizeBy": "none"
          },
          {
            "name": "Day10Band",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "8c3d343e-fc68-4ed1-add6-dd8b570b323a",
            "sourceColumn": "Day10Band",
            "summarizeBy": "none"
          },
          {
            "name": "Week4Band",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "5086460d-5db2-4f7b-99d2-10507e496ce3",
            "sourceColumn": "Week4Band",
            "summarizeBy": "none"
          },
          {
            "name": "Month3Band",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c2a1a1cd-25bb-412a-9385-155056338c7f",
            "sourceColumn": "Month3Band",
            "summarizeBy": "none"
          },
          {
            "name": "YearBand",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "cbcf9661-96b8-46d8-bd13-1d645f862fab",
            "sourceColumn": "YearBand",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "17dcbd39-0128-4f4f-8ef5-59b05fafeae0",
        "partitions": [
          {
            "name": "Tally (in M)",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    // Generate a list of numbers from 1 to 5*365",
                "    Source = List.Numbers(1, 5*365, 1),",
                "    // Convert the list to a table",
                "    #\"Converted to Table\" = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),",
                "    // Rename the column to \"Value\"",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Converted to Table\",{{\"Column1\", \"Value\"}}),",
                "    // Add a \"Date\" column that starts from 01/01/2020",
                "    #\"Added Custom\" = Table.AddColumn(#\"Renamed Columns\", \"Date\", each Date.AddDays(#date(2020, 1, 1), [Value] - 1)),",
                "    // Add other columns",
                "    #\"Added Custom1\" = Table.AddColumn(#\"Added Custom\", \"Day10\", each Number.RoundDown([Value] / 10, 0) * 10),",
                "    #\"Added Custom2\" = Table.AddColumn(#\"Added Custom1\", \"Day10Max\", each Number.RoundDown([Value] / 10, 0) * 10 + 10),",
                "    #\"Added Custom3\" = Table.AddColumn(#\"Added Custom2\", \"Week4\", each Number.RoundDown([Value] / 28, 0) * 4),",
                "    #\"Added Custom4\" = Table.AddColumn(#\"Added Custom3\", \"Week4Max\", each Number.RoundDown([Value] / 28, 0) * 4 + 4),",
                "    #\"Added Custom5\" = Table.AddColumn(#\"Added Custom4\", \"Month3\", each Number.RoundDown([Value] / 90, 0) * 3),",
                "    #\"Added Custom6\" = Table.AddColumn(#\"Added Custom5\", \"Month3Max\", each Number.RoundDown([Value] / 90, 0) * 3 + 3),",
                "    #\"Added Custom7\" = Table.AddColumn(#\"Added Custom6\", \"Year1\", each Number.RoundDown([Value] / 365, 0)),",
                "    #\"Added Custom8\" = Table.AddColumn(#\"Added Custom7\", \"Year1Max\", each Number.RoundDown([Value] / 365, 0) + 1),",
                "    // Add band columns",
                "    #\"Added Custom9\" = Table.AddColumn(#\"Added Custom8\", \"Day10Band\", each if [Day10Max] <= 150 then Text.Combine({Text.From([Day10]), \"-\", Text.From([Day10Max]), \" Days\"}, \"\") else \"150+ Days\"),",
                "    #\"Added Custom10\" = Table.AddColumn(#\"Added Custom9\", \"Week4Band\", each if [Week4Max] <= 20 then Text.Combine({Text.From([Week4]), \"-\", Text.From([Week4Max]), \" Weeks\"}, \"\") else \"20+ Weeks\"),",
                "    #\"Added Custom11\" = Table.AddColumn(#\"Added Custom10\", \"Month3Band\", each if [Month3Max] <= 24 then Text.Combine({Text.From([Month3]), \"-\", Text.From([Month3Max]), \" Months\"}, \"\") else \"24+ Months\"),",
                "    #\"Added Custom12\" = Table.AddColumn(#\"Added Custom11\", \"YearBand\", each if [Year1Max] <= 5 then Text.Combine({Text.From([Year1]), \"-\", Text.From([Year1Max]), \" Years\"}, \"\") else \"5+ Years\")",
                "in",
                "    #\"Added Custom12\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Pick1to12",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "9ef3c274c65f462d8225945fe4c0d63e"
          }
        ],
        "columns": [
          {
            "name": "Pick1to12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "version": 0
                }
              }
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "0fd7b345-f156-4839-8a18-080545d814a5",
            "sourceColumn": "[Value]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "ef80f715-b8a7-4dd1-931b-3a218dc9ee0b",
        "measures": [
          {
            "name": "Pick1to12 Value",
            "expression": "SELECTEDVALUE('Pick1to12'[Pick1to12], 1)",
            "formatString": "0",
            "lineageTag": "a3f6d809-cff4-4a2c-a84d-4cbc57ea225b"
          }
        ],
        "partitions": [
          {
            "name": "Pick1to12",
            "mode": "import",
            "source": {
              "expression": "GENERATESERIES(1, 12, 1)",
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Date (Disconnected)",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "2521202317ed421281810a9297b0782f"
          }
        ],
        "columns": [
          {
            "name": "DateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "5e588c8e-ad28-49e1-801a-3625395e40e9",
            "sourceColumn": "Date 👍[DateKey]",
            "summarizeBy": "count",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "e1ee1a3d-fd4f-4101-a7f1-8012148b5b2d",
            "sourceColumn": "Date 👍[Date]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "DayNumberOfWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "75d9b08a-af33-4345-b5a7-3a35c7e0f9b6",
            "sourceColumn": "Date 👍[DayNumberOfWeek]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "EnglishDayNameOfWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "c368684e-978b-4500-81c9-b5155ddfb6d8",
            "sourceColumn": "Date 👍[EnglishDayNameOfWeek]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "DayNumberOfMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "e6652a29-21b7-43b0-90a9-810f10b230f1",
            "sourceColumn": "Date 👍[DayNumberOfMonth]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "DayNumberOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "70e66d71-fe53-41ee-b175-c1e8c3c88cc4",
            "sourceColumn": "Date 👍[DayNumberOfYear]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "WeekNumberOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "b2c7959b-3271-4c82-af48-df2d82aed1ae",
            "sourceColumn": "Date 👍[WeekNumberOfYear]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "EnglishMonthName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "d6ca71a4-266c-45a8-b940-9dccef85b07e",
            "sourceColumn": "Date 👍[EnglishMonthName]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "MonthNumberOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "976583fb-3487-46e5-aaea-328eaae306fc",
            "sourceColumn": "Date 👍[MonthNumberOfYear]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "CalendarQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1496d314-595b-4be9-b46c-e3a7d7727999",
            "sourceColumn": "Date 👍[CalendarQuarter]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "CalendarYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "ea2d61a8-0a5b-4e40-8b04-2c4b1d2e6e06",
            "sourceColumn": "Date 👍[CalendarYear]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "CalendarSemester",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "284d09df-5e5c-447a-bcd8-232a84faf60b",
            "sourceColumn": "Date 👍[CalendarSemester]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FiscalQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "91609010-24ee-424e-a358-6e0be4b4808b",
            "sourceColumn": "Date 👍[FiscalQuarter]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FiscalYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "4262cfa1-685d-4020-a015-52594cdf3c94",
            "sourceColumn": "Date 👍[FiscalYear]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FiscalSemester",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "0db6c5b3-3498-46dd-968d-420152ef3d8b",
            "sourceColumn": "Date 👍[FiscalSemester]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "QYYYY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "b7aed526-11c0-44c8-bbcb-84d45e2cc4f3",
            "sourceColumn": "Date 👍[QYYYY]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "QYYYY sort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "bbe8f3a6-66ef-49b8-b484-9be0e1a9c430",
            "sourceColumn": "Date 👍[QYYYY sort]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "MMMYYYY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "186f9d62-2464-4bc9-9c08-34842cfcdff0",
            "sortByColumn": "MMMYYYY sort",
            "sourceColumn": "Date 👍[MMMYYYY]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "MMMYYYY sort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "d506cf11-9b2e-4e8b-b6d0-34c9d05bda0a",
            "sourceColumn": "Date 👍[MMMYYYY sort]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "IsPast",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "4cf3ec13-19df-44aa-8904-bc988d873b7f",
            "sourceColumn": "Date 👍[IsPast]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "EnglishMonthName**",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "b82c393d-f4ef-447d-8389-5505bbe91ecd",
            "sourceColumn": "Date 👍[EnglishMonthName**]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "EnglishMonthName*",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "0022c8b2-5c8f-4ea8-a3ac-fa8349032342",
            "sourceColumn": "Date 👍[EnglishMonthName*]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Month_nosort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "2a9dc906-bd84-4a33-a3e3-d1ad8742c58f",
            "sourceColumn": "Date 👍[Month_nosort]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "DayName_nosort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "41bdc9b8-7217-4fc2-9564-52a093ca1649",
            "sourceColumn": "Date 👍[DayName_nosort]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "YearMonth_nosort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "d357b739-6fa1-430b-9f36-43a9d87e2d59",
            "sourceColumn": "Date 👍[YearMonth_nosort]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "YearQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "f54abf66-51ab-43a8-b015-ff7e71cb841f",
            "sourceColumn": "Date 👍[YearQuarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "YearWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "a6ed747c-c68d-45d5-bc00-094bdb3a5629",
            "sourceColumn": "Date 👍[YearWeek]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "WorkingDay",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "a86acc48-35bf-4fdc-9bdc-7e41c9d480ae",
            "sourceColumn": "Date 👍[WorkingDay]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "DaysFromNow",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "44ecc9ce-6fb3-41a5-88e6-84578071da40",
            "sourceColumn": "Date 👍[DaysFromNow]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "WeeksFromNow",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "040cd9c3-e7bf-49d6-9184-f9c489ef457a",
            "sourceColumn": "Date 👍[WeeksFromNow]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "MonthsFromNow",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "5abcc004-0040-4019-8141-b5e4458e0c3f",
            "sourceColumn": "Date 👍[MonthsFromNow]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "QuartersFromNow",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "3ef4e0b6-86d9-4ab6-a618-7290066e7b87",
            "sourceColumn": "Date 👍[QuartersFromNow]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "YearsFromNow",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "fca18325-c5c5-4b06-b999-7f2ebedf4d33",
            "sourceColumn": "Date 👍[YearsFromNow]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Daylight savings Offset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "bcf26093-158d-46f0-8e67-7254cdd450f9",
            "sourceColumn": "Date 👍[Daylight savings Offset]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Sales Check",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "58d47a7f-79df-4c41-b644-d6fadeb512f1",
            "sourceColumn": "Date 👍[Sales Check]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Dates With Sales",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "5dcd5812-74df-4410-a3c4-dceaa58e4658",
            "sourceColumn": "Date 👍[Dates With Sales]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "DateWithTransactions",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "657c1fbf-4ab2-4913-8e27-9f6d69218ee1",
            "sourceColumn": "Date 👍[DateWithTransactions]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "LastDateWithData",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "0ef0d239-2252-4543-835f-93729a8875dc",
            "sourceColumn": "Date 👍[LastDateWithData]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "6d2712da-55a6-4b4b-90d5-2a2022803f02",
        "partitions": [
          {
            "name": "Date (Disconnected)",
            "mode": "import",
            "source": {
              "expression": "'Date 👍'",
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Countries PQ",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Country",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e0b0de0e-ac3c-46d2-888a-19f7be9bac0e",
            "sourceColumn": "Country",
            "summarizeBy": "none"
          },
          {
            "name": "Country Group PQ",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "dccd51f1-ca2d-4de4-aa45-3bdf50ade351",
            "sourceColumn": "Country Group PQ",
            "summarizeBy": "none"
          },
          {
            "name": "Country Group Switch",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": [
              "",
              "SWITCH('Countries PQ'[Country],",
              "\"UK\",\"Europe\",",
              "\"France\",\"Europe\",",
              "\"Germany\",\"Europe\",",
              "\"Canada\",\"North America\",",
              "\"USA\",\"North America\",",
              "\"Other\"",
              ")"
            ],
            "isDataTypeInferred": true,
            "lineageTag": "a002b653-6280-4639-840d-fb28eaf0166b",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "6164bdfc-091e-4c46-bee9-b8d0cade9b6e",
        "partitions": [
          {
            "name": "Countries PQ",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = #table(",
                "        {\"Country\"}, // Define the column name",
                "        {",
                "            {\"UK\"},",
                "            {\"France\"},",
                "            {\"Germany\"},",
                "            {\"Canada\"},",
                "            {\"USA\"},",
                "             {\"Brazil\"}",
                "        }",
                "    ),",
                "    #\"Added Custom\" = Table.AddColumn(Source, \"Country Group PQ\", each Record.FieldOrDefault( //equivalent to SWITCH in DAX",
                "    [",
                "      UK=\"Europe\", //original value=new value",
                "      France=\"Europe\",",
                "      Germany=\"Europe\",",
                "      Canada=\"North America\",",
                "      USA=\"North America\"",
                "    ],",
                "    [Country], //original column",
                "    \"Other\" //else",
                "))",
                "in",
                "    #\"Added Custom\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "CG Stats",
        "calculationGroup": {
          "calculationItems": [
            {
              "name": "Sum",
              "expression": [
                "",
                "sumx('InternetSales 😀',SELECTEDMEASURE())"
              ]
            },
            {
              "name": "Max",
              "expression": [
                "",
                "maxx('InternetSales 😀',SELECTEDMEASURE())"
              ]
            },
            {
              "name": "Min",
              "expression": [
                "",
                "minx('InternetSales 😀',SELECTEDMEASURE())"
              ]
            },
            {
              "name": "Average",
              "expression": [
                "",
                "averagex('InternetSales 😀',SELECTEDMEASURE())"
              ]
            }
          ],
          "precedence": 21
        },
        "columns": [
          {
            "name": "Stat",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "0cfc1485-c26d-424e-b1bc-e92397497d2a",
            "sortByColumn": "Ordinal",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Ordinal",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "1adb6aa9-d6e9-451d-b500-bce9fefae835",
            "sourceColumn": "Ordinal",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "cdbd35ec-8983-4ddd-a86f-897f610e5481",
        "partitions": [
          {
            "name": "CG Stats",
            "mode": "import",
            "source": {
              "type": "calculationGroup"
            }
          }
        ]
      },
      {
        "name": "PQ input data then custom grouping",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "dabc8814-bcb3-4cb7-a39f-b0a29434d822",
            "sourceColumn": "Year",
            "summarizeBy": "none"
          },
          {
            "name": "Customer",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "1c7112aa-fa27-4253-9f06-74ac02301f8a",
            "sourceColumn": "Customer",
            "summarizeBy": "none"
          },
          {
            "name": "Total Sales",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "3b39d77f-62a6-46de-a30c-308b763a73e5",
            "sourceColumn": "Total Sales",
            "summarizeBy": "sum"
          },
          {
            "name": "Sales Reps",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "0c862d02-481a-408f-ae8e-942c51eab106",
            "sourceColumn": "Sales Reps",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "29065c0a-74cb-405b-b992-aad37ddd9d4c",
        "partitions": [
          {
            "name": "PQ input data then custom grouping",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    // Define the data as a list of records",
                "    dataRecords = {",
                "        [Year=2020, Customer=\"A\", Sales Rep=\"SR1\", Sale=99],",
                "        [Year=2020, Customer=\"A\", Sales Rep=\"SR1\", Sale=99],",
                "        [Year=2020, Customer=\"B\", Sales Rep=\"SR1\", Sale=99],",
                "        [Year=2020, Customer=\"B\", Sales Rep=\"SR1\", Sale=99],",
                "        [Year=2020, Customer=\"B\", Sales Rep=\"SR2\", Sale=99],",
                "        [Year=2020, Customer=\"C\", Sales Rep=\"SR1\", Sale=99],",
                "        [Year=2020, Customer=\"C\", Sales Rep=\"SR2\", Sale=99],",
                "        [Year=2020, Customer=\"C\", Sales Rep=\"SR3\", Sale=99],",
                "        [Year=2020, Customer=\"C\", Sales Rep=\"SR1\", Sale=99],",
                "        [Year=2021, Customer=\"A\", Sales Rep=\"SR1\", Sale=99],",
                "        [Year=2021, Customer=\"A\", Sales Rep=\"SR1\", Sale=99],",
                "        [Year=2021, Customer=\"B\", Sales Rep=\"SR1\", Sale=99],",
                "        [Year=2021, Customer=\"B\", Sales Rep=\"SR1\", Sale=99],",
                "        [Year=2021, Customer=\"B\", Sales Rep=\"SR2\", Sale=99],",
                "        [Year=2021, Customer=\"C\", Sales Rep=\"SR1\", Sale=99],",
                "        [Year=2021, Customer=\"C\", Sales Rep=\"SR2\", Sale=99],",
                "        [Year=2021, Customer=\"C\", Sales Rep=\"SR3\", Sale=99],",
                "        [Year=2021, Customer=\"C\", Sales Rep=\"SR1\", Sale=99]",
                "    },",
                "    ",
                "    // Create the table from the records",
                "    salesData = Table.FromRecords(dataRecords),",
                "    //#\"Grouped Rows\" = Table.Group(salesData, {\"Year\", \"Customer\"}, {{\"Total Sales\", each List.Sum([Sale]), type number}})",
                "",
                "",
                "    #\"Grouped Rows\" = Table.Group(salesData, {\"Year\", \"Customer\"}, ",
                "                        {",
                "                            {\"Total Sales\", each List.Sum([Sale]), type nullable number},",
                "                            // see https://www.youtube.com/watch?v=SmwQuyh3Cz0 for following custom step in PQ",
                "                            {\"Sales Reps\", each Text.Combine(List.Distinct([Sales Rep]),\", \"), type text}",
                "                        })",
                "in",
                "    #\"Grouped Rows\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Time - Radacad",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Time",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Time"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Time",
            "lineageTag": "64f5d59e-305f-4b45-b210-711c1382d7a2",
            "sourceColumn": "Time",
            "summarizeBy": "none"
          },
          {
            "name": "Hour",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d8f3b123-4502-4278-a3ff-648776f45570",
            "sourceColumn": "Hour",
            "summarizeBy": "sum"
          },
          {
            "name": "Minute",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "824e2862-2811-4558-a413-3339d2e6e7c9",
            "sourceColumn": "Minute",
            "summarizeBy": "sum"
          },
          {
            "name": "Second",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "1db32d9a-f4c7-4efe-bd86-d4166f54d3a3",
            "sourceColumn": "Second",
            "summarizeBy": "sum"
          },
          {
            "name": "AM/PM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "637e93f9-7cc4-4e87-b50e-aa0ef41faf2a",
            "sourceColumn": "AM/PM",
            "summarizeBy": "none"
          },
          {
            "name": "Hour Label",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "47db5caa-d55b-41d0-84d1-53e6d1255974",
            "sourceColumn": "Hour Label",
            "summarizeBy": "none"
          },
          {
            "name": "Minute Label",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d1f30c1f-43b8-42da-b477-19ba8581f0e9",
            "sourceColumn": "Minute Label",
            "summarizeBy": "none"
          },
          {
            "name": "Second Label",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "fb85a326-da9c-419c-9861-348d2bb77bcc",
            "sourceColumn": "Second Label",
            "summarizeBy": "none"
          },
          {
            "name": "TimeKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "beb5c69b-a131-41ff-b1c8-35acb7aa0832",
            "sourceColumn": "TimeKey",
            "summarizeBy": "count"
          },
          {
            "name": "Hour Bin 12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "9fdfe04f-7090-42f9-ace2-c635b0da4b1b",
            "sourceColumn": "Hour Bin 12",
            "summarizeBy": "sum"
          },
          {
            "name": "Hour Bin 8",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0b6353de-639a-4f11-a5e9-0161d7e15266",
            "sourceColumn": "Hour Bin 8",
            "summarizeBy": "sum"
          },
          {
            "name": "Hour Bin 6",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4d5af400-7833-486f-a763-bf36c4232ba1",
            "sourceColumn": "Hour Bin 6",
            "summarizeBy": "sum"
          },
          {
            "name": "Hour Bin 4",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "1893af42-9e0e-47fc-88ca-d1518d908e6a",
            "sourceColumn": "Hour Bin 4",
            "summarizeBy": "sum"
          },
          {
            "name": "Hour Bin 3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e0dbc3a1-a592-4c3a-bf65-f16a0265378d",
            "sourceColumn": "Hour Bin 3",
            "summarizeBy": "sum"
          },
          {
            "name": "Hour Bin 2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "91a69446-7b92-4ef4-831a-1a6ee57c024b",
            "sourceColumn": "Hour Bin 2",
            "summarizeBy": "sum"
          },
          {
            "name": "Minute Bin 30",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "4e5755c6-a94b-48b3-a8f6-3cb1c08ba1d1",
            "sourceColumn": "Minute Bin 30",
            "summarizeBy": "sum"
          },
          {
            "name": "Minute Bin 15",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "59033c47-885b-4d8e-9440-c1c93122946d",
            "sourceColumn": "Minute Bin 15",
            "summarizeBy": "sum"
          },
          {
            "name": "Minute Bin 10",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "278ea97b-c2a6-43a8-b30b-fe854a4f4668",
            "sourceColumn": "Minute Bin 10",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "08f469e5-f713-4ac2-87c7-b9f30f84df8e",
        "partitions": [
          {
            "name": "Time - Radacad",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    // https://radacad.com/script-for-creating-time-table-in-power-bi-with-hours-minutes-and-seconds-buckets",
                "    Source = List.Times(#time(0,0,0),24*60*60,#duration(0,0,0,1)),",
                "    #\"Converted to Table\" = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Converted to Table\",{{\"Column1\", \"Time\"}}),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns\",{{\"Time\", type time}}),",
                "    #\"Inserted Hour\" = Table.AddColumn(#\"Changed Type\", \"Hour\", each Time.Hour([Time]), Int64.Type),",
                "    #\"Inserted Minute\" = Table.AddColumn(#\"Inserted Hour\", \"Minute\", each Time.Minute([Time]), Int64.Type),",
                "    #\"Inserted Second\" = Table.AddColumn(#\"Inserted Minute\", \"Second\", each Time.Second([Time]), type number),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Inserted Second\", \"AM/PM\", each if [Hour] < 12 then \"a.m.\" else \"p.m.\"),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Added Conditional Column\",{{\"AM/PM\", type text}}),",
                "    #\"Duplicated Column\" = Table.DuplicateColumn(#\"Changed Type1\", \"Time\", \"Time - Copy\"),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Duplicated Column\",{\"Time - Copy\"}),",
                "    #\"Duplicated Column1\" = Table.DuplicateColumn(#\"Removed Columns\", \"Hour\", \"Hour - Copy\"),",
                "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Duplicated Column1\",{{\"Hour - Copy\", \"Hour label\"}}),",
                "    #\"Changed Type2\" = Table.TransformColumnTypes(#\"Renamed Columns1\",{{\"Hour label\", type text}}),",
                "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Changed Type2\",{\"Hour label\"}),",
                "    #\"Inserted Prefix\" = Table.AddColumn(#\"Removed Columns1\", \"Prefix\", each \"0\" & Text.From([Hour], \"en-NZ\"), type text),",
                "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Inserted Prefix\",{{\"Prefix\", \"Hour Label\"}}),",
                "    #\"Extracted Last Characters\" = Table.TransformColumns(#\"Renamed Columns2\", {{\"Hour Label\", each Text.End(_, 2), type text}}),",
                "    #\"Inserted Prefix1\" = Table.AddColumn(#\"Extracted Last Characters\", \"Prefix\", each \"0\" & Text.From([Minute], \"en-NZ\"), type text),",
                "    #\"Renamed Columns3\" = Table.RenameColumns(#\"Inserted Prefix1\",{{\"Prefix\", \"Minute Label\"}}),",
                "    #\"Extracted Last Characters1\" = Table.TransformColumns(#\"Renamed Columns3\", {{\"Minute Label\", each Text.End(_, 2), type text}}),",
                "    #\"Inserted Prefix2\" = Table.AddColumn(#\"Extracted Last Characters1\", \"Prefix\", each \"0\" & Text.From([Second], \"en-NZ\"), type text),",
                "    #\"Renamed Columns4\" = Table.RenameColumns(#\"Inserted Prefix2\",{{\"Prefix\", \"Second Label\"}}),",
                "    #\"Extracted Last Characters2\" = Table.TransformColumns(#\"Renamed Columns4\", {{\"Second Label\", each Text.End(_, 2), type text}}),",
                "    #\"Added Index\" = Table.AddIndexColumn(#\"Extracted Last Characters2\", \"Index\", 0, 1),",
                "    #\"Renamed Columns5\" = Table.RenameColumns(#\"Added Index\",{{\"Index\", \"TimeKey\"}}),",
                "    #\"Inserted Modulo\" = Table.AddColumn(#\"Renamed Columns5\", \"Modulo\", each Number.Mod([Hour], 12), type number),",
                "    #\"Renamed Columns6\" = Table.RenameColumns(#\"Inserted Modulo\",{{\"Modulo\", \"Hour Bin 12\"}}),",
                "    #\"Inserted Integer-Division\" = Table.AddColumn(#\"Renamed Columns6\", \"Integer-Division\", each Number.IntegerDivide([Hour], 8), Int64.Type),",
                "    #\"Renamed Columns7\" = Table.RenameColumns(#\"Inserted Integer-Division\",{{\"Integer-Division\", \"Hour Bin 8\"}}),",
                "    #\"Inserted Integer-Division1\" = Table.AddColumn(#\"Renamed Columns7\", \"Integer-Division\", each Number.IntegerDivide([Hour], 6), Int64.Type),",
                "    #\"Renamed Columns8\" = Table.RenameColumns(#\"Inserted Integer-Division1\",{{\"Integer-Division\", \"Hour Bin 6\"}}),",
                "    #\"Inserted Integer-Division2\" = Table.AddColumn(#\"Renamed Columns8\", \"Integer-Division\", each Number.IntegerDivide([Hour], 4), Int64.Type),",
                "    #\"Renamed Columns9\" = Table.RenameColumns(#\"Inserted Integer-Division2\",{{\"Integer-Division\", \"Hour Bin 4\"}}),",
                "    #\"Inserted Integer-Division3\" = Table.AddColumn(#\"Renamed Columns9\", \"Integer-Division\", each Number.IntegerDivide([Hour], 3), Int64.Type),",
                "    #\"Renamed Columns10\" = Table.RenameColumns(#\"Inserted Integer-Division3\",{{\"Integer-Division\", \"Hour Bin 3\"}}),",
                "    #\"Inserted Integer-Division4\" = Table.AddColumn(#\"Renamed Columns10\", \"Integer-Division\", each Number.IntegerDivide([Hour], 2), Int64.Type),",
                "    #\"Renamed Columns11\" = Table.RenameColumns(#\"Inserted Integer-Division4\",{{\"Integer-Division\", \"Hour Bin 2\"}}),",
                "    #\"Inserted Integer-Division5\" = Table.AddColumn(#\"Renamed Columns11\", \"Integer-Division\", each Number.IntegerDivide([Minute], 30), Int64.Type),",
                "    #\"Multiplied Column\" = Table.TransformColumns(#\"Inserted Integer-Division5\", {{\"Integer-Division\", each _ * 30, type number}}),",
                "    #\"Renamed Columns12\" = Table.RenameColumns(#\"Multiplied Column\",{{\"Integer-Division\", \"Minute Bin 30\"}}),",
                "    #\"Inserted Integer-Division6\" = Table.AddColumn(#\"Renamed Columns12\", \"Integer-Division\", each Number.IntegerDivide([Minute], 15), Int64.Type),",
                "    #\"Multiplied Column1\" = Table.TransformColumns(#\"Inserted Integer-Division6\", {{\"Integer-Division\", each _ * 15, type number}}),",
                "    #\"Renamed Columns13\" = Table.RenameColumns(#\"Multiplied Column1\",{{\"Integer-Division\", \"Minute Bin 15\"}}),",
                "    #\"Inserted Integer-Division7\" = Table.AddColumn(#\"Renamed Columns13\", \"Integer-Division\", each Number.IntegerDivide([Minute], 10), Int64.Type),",
                "    #\"Multiplied Column2\" = Table.TransformColumns(#\"Inserted Integer-Division7\", {{\"Integer-Division\", each _ * 10, type number}}),",
                "    #\"Renamed Columns14\" = Table.RenameColumns(#\"Multiplied Column2\",{{\"Integer-Division\", \"Minute Bin 10\"}})",
                "in",
                "    #\"Renamed Columns14\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Time - DST v3",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "6e20a31ff21b4606aa0742ca82c63aff"
          }
        ],
        "columns": [
          {
            "name": "Value",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "57a6c5df-3d63-40f7-a970-1d3c2b8e27c8",
            "sourceColumn": "[Value]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "BST",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "92c8e27a-9005-4d1a-9af4-b63c39ef6034",
            "sourceColumn": "[BST]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "StartSunday",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "5945f2b6-7a3e-4638-ba37-a8d4aced20e2",
            "sourceColumn": "[StartSunday]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FinishSunday",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "edeab745-3e9d-4803-b04f-cc7bb67aa2f8",
            "sourceColumn": "[FinishSunday]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "DST",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "7a0e4ee4-a714-492b-a00b-615a22c6af2c",
            "sourceColumn": "[DST]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "7733cd59-f92f-45ac-8bc6-e29b0993cab9",
        "partitions": [
          {
            "name": "Time - DST v3",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "//BST = last sunday in March and October",
                "// 31/3/2024 to 27/10/2024",
                "// 30/3/2025 to 26/10/2025",
                "// 29/3/2026 to 25/10/2026",
                "",
                "VAR TimeValues =",
                "    SELECTCOLUMNS ( GENERATESERIES ( 0, 23 ), \"@Time\", TIME ( [Value], 0, 0 ) )",
                "VAR DateValues =",
                "    GENERATESERIES (",
                "    \tDATE ( 2024, 1, 1 ), // Start date (January 1, 2024)",
                "\t    DATE ( 2026, 12, 31 ) // End date (December 31, 2026)",
                "\t)",
                "VAR DateTimeValues =",
                "    SELECTCOLUMNS (",
                "        GENERATE (",
                "            DateValues,",
                "            TimeValues -- 0:00 to 23:00",
                "        ),",
                "        \"Value\", [Value] + [@Time]",
                "    )",
                "RETURN",
                "    ADDCOLUMNS (",
                "        ADDCOLUMNS (",
                "\t\t\tDateTimeValues,",
                "            \"BST\",",
                "                [Value] + ( 1 / 24 ) ",
                "                ,",
                "            \"StartSunday\",",
                "                VAR d =",
                "                    DATE ( YEAR ( [Value] ), 3, 1 ) //  March ",
                "                VAR r =",
                "                    EOMONTH ( d, 0 ) - MOD ( WEEKDAY ( EOMONTH ( d, 0 ), 2 ), 7 )",
                "                RETURN",
                "                    r,",
                "            \"FinishSunday\",",
                "                VAR d =",
                "                    DATE ( YEAR ( [Value] ), 10, 1 ) //  October ",
                "                VAR r =",
                "                    EOMONTH ( d, 0 ) - MOD ( WEEKDAY ( EOMONTH ( d, 0 ), 2 ), 7 )",
                "                RETURN",
                "                    r",
                "        ),",
                "        //end of addcolumns",
                "        \"DST\",",
                "            IF ( [StartSunday] < [Value] && [FinishSunday] > [Value], \"BST\", \"GMT\" )",
                "    )",
                "//end of addcolumns"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Total Sales Amount Filter",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "27d53731249b4105b6675e8958a8efdd"
          }
        ],
        "columns": [
          {
            "name": "Total Sales Amount Filter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "version": 0
                }
              }
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "a8a99a69-8c23-4246-8676-c146d773ce67",
            "sourceColumn": "[Value]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "d3e6f162-1edd-4ae7-9d81-2b45f39dd968",
        "measures": [
          {
            "name": "Total Sales Amount Filter Value",
            "expression": "SELECTEDVALUE('Total Sales Amount Filter'[Total Sales Amount Filter], 50000)",
            "formatString": "0",
            "lineageTag": "0b59bf66-6836-4738-94b1-19d043a8ff7c"
          },
          {
            "name": "Total Sales Amount Filter By Month",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "var __minsales=min([Total Sales Amount Filter]) //column",
              "var __maxsales=max([Total Sales Amount Filter])",
              "RETURN",
              "CALCULATE(",
              "    [Total Sales],",
              "    FILTER(",
              "        VALUES('Date 👍'[MMMYYYY]), // whatever granularity you like",
              "        [Total Sales]>=__minsales &&",
              "        [Total Sales]<=__maxsales",
              "    )",
              ")"
            ],
            "lineageTag": "7d284a35-0aef-4621-bc0b-495416712ea0"
          },
          {
            "name": "Total Sales Amount Filter By YearWeek",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "var __minsales=min([Total Sales Amount Filter]) //column",
              "var __maxsales=max([Total Sales Amount Filter])",
              "RETURN",
              "CALCULATE(",
              "    [Total Sales],",
              "    FILTER(",
              "        VALUES('Date 👍'[YearWeek]), // whatever granularity you like",
              "        [Total Sales]>=__minsales &&",
              "        [Total Sales]<=__maxsales",
              "    )",
              ")"
            ],
            "lineageTag": "e880c0b4-ee02-4138-a09f-dcb21163c03c"
          },
          {
            "name": "Total Sales Amount Filter By Subcategory",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "var __minsales=min([Total Sales Amount Filter]) //column",
              "var __maxsales=max([Total Sales Amount Filter])",
              "RETURN",
              "CALCULATE(",
              "    [Total Sales],",
              "    FILTER(",
              "        VALUES(ProductSubcategory[ProductSubcategoryName]), // whatever granularity you like",
              "        [Total Sales]>=__minsales &&",
              "        [Total Sales]<=__maxsales",
              "    )",
              ")"
            ],
            "lineageTag": "e2fa40d4-040c-43ad-bc40-314d393b378e"
          }
        ],
        "partitions": [
          {
            "name": "Total Sales Amount Filter",
            "mode": "import",
            "source": {
              "expression": "GENERATESERIES(50000, 1000000, 50000)",
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Total Sales Amount Range Filter",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "c9ba2d76bb834f4cb8068894c49494e8"
          }
        ],
        "columns": [
          {
            "name": "Range",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "9192d7fa-0140-4923-9b47-1c7883c5e856",
            "sortByColumn": "index",
            "sourceColumn": "[Range]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Min",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "66705d6c-8bee-426b-8857-40fcd3258643",
            "sourceColumn": "[Min]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Max",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "a5e28a11-afcf-4c11-8e6c-50e05758f1ed",
            "sourceColumn": "[Max]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          },
          {
            "name": "index",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "9a236bb6-7c9b-4399-a439-2d2ec7668fcc",
            "sourceColumn": "[index]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "56d706be-12b3-48f7-ac43-7b914511ad06",
        "measures": [
          {
            "name": "Total Sales Amount Range Filter By YearWeek",
            "expression": [
              "",
              "//'Total Sales Amount Range Filter' is a disconnected table so SUMMARIZE is required to associate Sales with the correct context",
              "var __minrange=min('Total Sales Amount Range Filter'[Min]) //column",
              "var __maxrange=max('Total Sales Amount Range Filter'[Max])",
              "RETURN",
              "CALCULATE(",
              "    [Total Sales],",
              "    FILTER(",
              "        SUMMARIZE('InternetSales 😀','Date 👍'[YearWeek]), // whatever granularity you like",
              "        [Total Sales]>=__minrange &&",
              "        [Total Sales]<=__maxrange",
              "    )",
              ")"
            ],
            "formatString": "0",
            "lineageTag": "84115366-2488-4a3f-98b3-ee34daa77ce7"
          }
        ],
        "partitions": [
          {
            "name": "Total Sales Amount Range Filter",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "DATATABLE(",
                "    \"Range\",STRING,\"Min\",INTEGER,\"Max\",INTEGER,\"index\",INTEGER,",
                "    //don't forget to sort range by index",
                "    {",
                "        {\"0-50000\",0,50000,1},",
                "        {\"50001-100000\",50001,100000,2},",
                "        {\"100001-150000\",100001,150000,3},",
                "        {\"150001-200000\",150001,200000,4},",
                "        {\"200001+\",200001,1000000,5}",
                "    }",
                ")"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Product Integrity Check",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "c3cfda97bc954985afd57fb0493691a8"
          }
        ],
        "columns": [
          {
            "name": "Table",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "a85488a1-13b8-4946-93ec-b2a630c030be",
            "sourceColumn": "[Table]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "ProductKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "7177ff2e-8ff8-4fad-888b-32df30500ac5",
            "sourceColumn": "InternetSales 😀[ProductKey]",
            "summarizeBy": "count",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "87c7ba53-8acc-4c4e-b3de-85f771374fd3",
        "measures": [
          {
            "name": "Product Referential Check",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "//see - https://www.youtube.com/watch?v=qdqXOq1S4mY",
              "IF(",
              "    ISEMPTY('Product Integrity Check'),",
              "    \"💚\",\"🥵\"",
              ")"
            ],
            "lineageTag": "8df86e32-b875-48ec-9bf6-1f3d7cc28422"
          }
        ],
        "partitions": [
          {
            "name": "Product Integrity Check",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "",
                "//The result will show:",
                "--Products from sales that don't have corresponding entries in the Product table.",
                "--Subcategories that exist in Product but not in Productsubcategory.",
                "--Categories that exist in ProductSubCategory but not in ProductCategory.",
                "",
                "var ProdTable=",
                "ADDCOLUMNS(",
                "    EXCEPT(",
                "        VALUES('InternetSales 😀'[ProductKey]),",
                "        VALUES(Product[ProductKey])",
                "        ),",
                "        \"Table\",\"Product\"",
                ")",
                "",
                "var SubcatTable=",
                "ADDCOLUMNS(",
                "    EXCEPT(",
                "        VALUES('Product'[ProductSubcategoryKey]),",
                "        VALUES(ProductSubcategory[ProductsubcategoryKey])",
                "        ),",
                "        \"Table\",\"ProductSubcategory\"",
                ")",
                "",
                "var CatTable=",
                "ADDCOLUMNS(",
                "    EXCEPT(",
                "        VALUES(ProductSubcategory[ProductCategoryKey]),",
                "        VALUES('ProductCategory 😀'[ProductCategoryKey])",
                "        ),",
                "        \"Table\",\"ProductCategory\"",
                ")",
                "",
                "RETURN",
                "UNION(ProdTable,SubcatTable,CatTable)"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Time - seconds",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Time",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Time"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Time",
            "lineageTag": "233ba706-dd25-4844-a1a8-5836fdaec6bb",
            "sourceColumn": "Time",
            "summarizeBy": "none"
          },
          {
            "name": "Hour",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d482c2ed-6b1d-4278-9d21-62f0392b5211",
            "sourceColumn": "Hour",
            "summarizeBy": "none"
          },
          {
            "name": "Minute",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4a613dd9-13bc-4543-9d62-5cdba8b3358c",
            "sourceColumn": "Minute",
            "summarizeBy": "none"
          },
          {
            "name": "Second",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "1e95e7e8-320b-42d3-90e6-2fb3567cb7b1",
            "sourceColumn": "Second",
            "summarizeBy": "none"
          },
          {
            "name": "Start of Hour",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "5fad699a-1b09-454c-9b35-e415d743d246",
            "sourceColumn": "Start of Hour",
            "summarizeBy": "none"
          },
          {
            "name": "End of Hour",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "bf2f6ae2-4428-4017-8703-dcd44aef3195",
            "sourceColumn": "End of Hour",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "cac6ceb4-8246-4b1a-a316-d6681bed23db",
        "partitions": [
          {
            "name": "Time - seconds",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = List.Generate( () => 0, each _ < 24 * 60 * 60, each _ + 1 ),",
                "    Table = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),",
                "    Divide = Table.TransformColumns(Table, {{\"Column1\", each _ / 24 / 60 / 60, type number}}),",
                "    ChangeType = Table.TransformColumnTypes(Divide,{{\"Column1\", type time}}),",
                "    RenameColumns = Table.RenameColumns(ChangeType,{{\"Column1\", \"Time\"}}),",
                "    AddHourColumn = Table.AddColumn(RenameColumns, \"Hour\", each Time.Hour([Time])),",
                "    AddMinuteColumn = Table.AddColumn(AddHourColumn, \"Minute\", each Time.Minute([Time])),",
                "    AddSecondColumn = Table.AddColumn(AddMinuteColumn, \"Second\", each Time.Second([Time])),",
                "    AddStartOfHourColumn = Table.AddColumn(AddSecondColumn, \"Start of Hour\", each Time.StartOfHour([Time])),",
                "    AddEndOfHourColumn = Table.AddColumn(AddStartOfHourColumn, \"End of Hour\", each Time.EndOfHour([Time]))",
                "in",
                "    AddEndOfHourColumn"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Time - minutes",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Time",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Time"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Time",
            "lineageTag": "679411ac-ccaa-4741-8dbf-1fd8d7d35e59",
            "sourceColumn": "Time",
            "summarizeBy": "none"
          },
          {
            "name": "Hour",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "8981fde6-f23c-4a6e-b8b3-460b97398ee3",
            "sourceColumn": "Hour",
            "summarizeBy": "none"
          },
          {
            "name": "Minute",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "10b470e8-9267-4c08-8b07-fcdc579a2ae9",
            "sourceColumn": "Minute",
            "summarizeBy": "none"
          },
          {
            "name": "Second",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4a4ea10c-624a-4441-8782-1e0aa803bdb4",
            "sourceColumn": "Second",
            "summarizeBy": "none"
          },
          {
            "name": "Start of Hour",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "3d32937e-380e-46f1-91ae-0d62a7d6c091",
            "sourceColumn": "Start of Hour",
            "summarizeBy": "none"
          },
          {
            "name": "End of Hour",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "925a556f-bed5-454e-96b7-71187b13d2f8",
            "sourceColumn": "End of Hour",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "38f681d9-e698-46b7-8d54-ed223c620d6e",
        "partitions": [
          {
            "name": "Time - minutes",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = List.Generate( () => 0, each _ < 24 * 60, each _ + 1 ),",
                "    Table = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),",
                "    Divide = Table.TransformColumns(Table, {{\"Column1\", each _ / 24 / 60, type number}}),",
                "    ChangeType = Table.TransformColumnTypes(Divide,{{\"Column1\", type time}}),",
                "    RenameColumns = Table.RenameColumns(ChangeType,{{\"Column1\", \"Time\"}}),",
                "    AddHourColumn = Table.AddColumn(RenameColumns, \"Hour\", each Time.Hour([Time])),",
                "    AddMinuteColumn = Table.AddColumn(AddHourColumn, \"Minute\", each Time.Minute([Time])),",
                "    AddSecondColumn = Table.AddColumn(AddMinuteColumn, \"Second\", each Time.Second([Time])),",
                "    AddStartOfHourColumn = Table.AddColumn(AddSecondColumn, \"Start of Hour\", each Time.StartOfHour([Time])),",
                "    AddEndOfHourColumn = Table.AddColumn(AddStartOfHourColumn, \"End of Hour\", each Time.EndOfHour([Time]))",
                "in",
                "    AddEndOfHourColumn"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Dates Integrity Check",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "24bac972bdb142a285bdda756f48bf67"
          }
        ],
        "columns": [
          {
            "name": "Table",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "c5cbbee8-6944-4c05-ba24-a3a8c73d07c2",
            "sourceColumn": "[Table]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "OrderDateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "b120b6e0-acf5-422e-98f0-d3a4ab35dcad",
            "sourceColumn": "InternetSales 😀[OrderDateKey]",
            "summarizeBy": "count",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "d00d10e2-991c-4631-ba1b-26dcb558067c",
        "measures": [
          {
            "name": "Dates Referential Check",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "//see - https://www.youtube.com/watch?v=qdqXOq1S4mY",
              "IF(",
              "    ISEMPTY('Dates Integrity Check'),",
              "    \"💚\",\"🥵\"",
              ")"
            ],
            "lineageTag": "f0cbeb0b-72e8-4d47-b61e-9282676d80e4"
          }
        ],
        "partitions": [
          {
            "name": "Dates Integrity Check",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "",
                "//The result will show:",
                "--Dates from sales that don't have corresponding entries in the Date table.",
                "",
                "",
                "var oDateTable=",
                "ADDCOLUMNS(",
                "    EXCEPT(",
                "        VALUES('InternetSales 😀'[OrderDateKey]),",
                "        VALUES('Date 👍'[DateKey])",
                "        ),",
                "        \"Table\",\"Date\"",
                ")",
                "",
                "var dDateTable=",
                "ADDCOLUMNS(",
                "    EXCEPT(",
                "        VALUES('InternetSales 😀'[DueDateKey]),",
                "        VALUES('Date 👍'[DateKey])",
                "        ),",
                "        \"Table\",\"Date\"",
                ")",
                "",
                "var sDateTable=",
                "ADDCOLUMNS(",
                "    EXCEPT(",
                "        VALUES('InternetSales 😀'[ShipDateKey]),",
                "        VALUES('Date 👍'[DateKey])",
                "        ),",
                "        \"Table\",\"Date\"",
                ")",
                "",
                "RETURN",
                "union(oDateTable,dDateTable,sDateTable)"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Dates_Haq",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "4918a5f3-b3d0-4bee-87f6-7059858071ee",
            "sourceColumn": "Date",
            "summarizeBy": "none"
          },
          {
            "name": "CY Selection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "566bf8c5-d0e6-4d62-80c7-7360a4561571",
            "sourceColumn": "CY Selection",
            "summarizeBy": "none"
          },
          {
            "name": "isYearComplete",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "684e6586-10b1-495b-bd7d-ce0cf1dcca37",
            "sourceColumn": "isYearComplete",
            "summarizeBy": "none"
          },
          {
            "name": "IsYTD",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "325e2526-d76a-4ac9-86f5-8c9067f2a564",
            "sourceColumn": "IsYTD",
            "summarizeBy": "none"
          },
          {
            "name": "YearNUM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "01009e55-59d5-4e18-b83b-acd3d8f87126",
            "sourceColumn": "YearNUM",
            "summarizeBy": "sum"
          },
          {
            "name": "YearOFFSET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "5f88e3c5-3318-4646-8258-612ad29d4f30",
            "sourceColumn": "YearOFFSET",
            "summarizeBy": "sum"
          },
          {
            "name": "Academic Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "574fde87-56f9-479e-94ef-1febd78be08e",
            "sourceColumn": "Academic Year",
            "summarizeBy": "none"
          },
          {
            "name": "Academic_Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "0abbf92e-6baa-4afd-a057-9a74a746614a",
            "sourceColumn": "Academic_Year",
            "summarizeBy": "none"
          },
          {
            "name": "AY Selection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b98d7cf9-e1df-4af2-bc67-f560340c84b0",
            "sourceColumn": "AY Selection",
            "summarizeBy": "none"
          },
          {
            "name": "Fiscal Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "892bb148-d652-49c3-92dd-0f95c8c752f9",
            "sourceColumn": "Fiscal Year",
            "summarizeBy": "none"
          },
          {
            "name": "Fiscal_Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "46542d93-b75f-4bc2-8dba-46c1417ded13",
            "sourceColumn": "Fiscal_Year",
            "summarizeBy": "none"
          },
          {
            "name": "FY Selection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b784410b-0977-473d-8912-d21d9dce6393",
            "sourceColumn": "FY Selection",
            "summarizeBy": "none"
          },
          {
            "name": "IsFuture",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "1c4204ba-407a-4261-a552-c031fcb080f6",
            "sourceColumn": "IsFuture",
            "summarizeBy": "none"
          },
          {
            "name": "QuarterNUM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "fcd455f4-fd00-4095-a784-9280d930b20a",
            "sourceColumn": "QuarterNUM",
            "summarizeBy": "sum"
          },
          {
            "name": "Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "79c31278-06c0-486d-ac39-b0db023b8220",
            "sourceColumn": "Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "Quarter Start",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "45f23c4a-eb1f-40c0-81fb-786108e4615e",
            "sourceColumn": "Quarter Start",
            "summarizeBy": "none"
          },
          {
            "name": "Quarter End",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "068d1145-0e9f-41da-8ae1-ee9dbd5250f9",
            "sourceColumn": "Quarter End",
            "summarizeBy": "none"
          },
          {
            "name": "Quarter & Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c1c04c3f-ae0c-4407-be97-48d025596857",
            "sourceColumn": "Quarter & Year",
            "summarizeBy": "none"
          },
          {
            "name": "QuarterYearINT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "168c0091-84ad-49a6-ac56-ae20878cd267",
            "sourceColumn": "QuarterYearINT",
            "summarizeBy": "sum"
          },
          {
            "name": "QuarterOFFSET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "567d1021-68d8-4d94-97ef-e9c34d80a2e5",
            "sourceColumn": "QuarterOFFSET",
            "summarizeBy": "sum"
          },
          {
            "name": "isQuarterComplete",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "84a07961-5bb4-4a4c-b321-b361c7c8a5f0",
            "sourceColumn": "isQuarterComplete",
            "summarizeBy": "none"
          },
          {
            "name": "MonthNUM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a190826a-a2e3-49b2-adbf-bf257e71aa76",
            "sourceColumn": "MonthNUM",
            "summarizeBy": "sum"
          },
          {
            "name": "Month Selection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b2e3adbc-f687-4c17-bffe-333f3ace49b0",
            "sourceColumn": "Month Selection",
            "summarizeBy": "none"
          },
          {
            "name": "FiscalPeriodNUM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "496c6bbc-4180-4559-80d8-8d117516a39f",
            "sourceColumn": "FiscalPeriodNUM",
            "summarizeBy": "sum"
          },
          {
            "name": "Fiscal Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "5d9589d3-79a0-4fd8-8c8f-21323925d648",
            "sourceColumn": "Fiscal Month",
            "summarizeBy": "none"
          },
          {
            "name": "AcademicPeriodNUM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0095daaa-d72a-4785-895a-f2863ee1e449",
            "sourceColumn": "AcademicPeriodNUM",
            "summarizeBy": "sum"
          },
          {
            "name": "Academic Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7448e7b3-d5bf-4b5f-845a-17a9064602f1",
            "sourceColumn": "Academic Month",
            "summarizeBy": "none"
          },
          {
            "name": "Month Start",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "24c7bd9c-18c3-4ca4-93cc-38231019e033",
            "sourceColumn": "Month Start",
            "summarizeBy": "none"
          },
          {
            "name": "Month End",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "aabe95a6-5f4d-45f5-9c2b-afb7aafccd6b",
            "sourceColumn": "Month End",
            "summarizeBy": "none"
          },
          {
            "name": "Month & Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a857fe97-b530-45a0-9876-807850968867",
            "sourceColumn": "Month & Year",
            "summarizeBy": "none"
          },
          {
            "name": "MonthYearINT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "68200925-772b-43b6-a03a-3e7af3adab26",
            "sourceColumn": "MonthYearINT",
            "summarizeBy": "sum"
          },
          {
            "name": "MonthOFFSET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0266037d-3b53-4d55-bdd0-42a9b65d9ebd",
            "sourceColumn": "MonthOFFSET",
            "summarizeBy": "sum"
          },
          {
            "name": "isMonthComplete",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "e9b79ef8-f6b0-4e69-8a74-598c508e725d",
            "sourceColumn": "isMonthComplete",
            "summarizeBy": "none"
          },
          {
            "name": "Month Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6fe87950-df83-4fd7-9afb-292be2196ca7",
            "sourceColumn": "Month Name",
            "summarizeBy": "none"
          },
          {
            "name": "Month Short",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7c154a37-dbb0-4f26-b548-c392b65622b5",
            "sourceColumn": "Month Short",
            "summarizeBy": "none"
          },
          {
            "name": "Month Initial",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "8d387057-1b7e-445a-a201-f79dcab4f543",
            "sourceColumn": "Month Initial",
            "summarizeBy": "none"
          },
          {
            "name": "DayMonthNUM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e3483b1d-3258-4e27-bef4-98c6bff080ad",
            "sourceColumn": "DayMonthNUM",
            "summarizeBy": "sum"
          },
          {
            "name": "Week Number",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "57cef370-8dde-447d-ab3b-812a504f30ea",
            "sourceColumn": "Week Number",
            "summarizeBy": "sum"
          },
          {
            "name": "Week Start",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "ee3e427f-fda0-4343-b847-c4a70b11cf39",
            "sourceColumn": "Week Start",
            "summarizeBy": "none"
          },
          {
            "name": "Week End",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "f008d106-8db9-48f5-8386-34e68f125999",
            "sourceColumn": "Week End",
            "summarizeBy": "none"
          },
          {
            "name": "Week & Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6df8ec47-72a9-4932-b0df-57de1b685385",
            "sourceColumn": "Week & Year",
            "summarizeBy": "none"
          },
          {
            "name": "WeekYearINT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0b2e9f3f-57c5-42d1-a641-dc6671a1331b",
            "sourceColumn": "WeekYearINT",
            "summarizeBy": "sum"
          },
          {
            "name": "WeekOFFSET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "19e23040-8b4e-4a8d-8900-bf1263568c45",
            "sourceColumn": "WeekOFFSET",
            "summarizeBy": "sum"
          },
          {
            "name": "WeekCompleted",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "dd0c92b8-e181-47a7-a20a-47580e78d6f0",
            "sourceColumn": "WeekCompleted",
            "summarizeBy": "none"
          },
          {
            "name": "DayWeekNUM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4c7bbd2f-eef3-4e7a-915f-dae668f7e879",
            "sourceColumn": "DayWeekNUM",
            "summarizeBy": "sum"
          },
          {
            "name": "Day of Week Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "807934f8-ce27-4b2e-9571-32158269e1e0",
            "sourceColumn": "Day of Week Name",
            "summarizeBy": "none"
          },
          {
            "name": "Day Initial",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7b81818a-1d5b-4535-8f7f-8dd9eba14967",
            "sourceColumn": "Day Initial",
            "summarizeBy": "none"
          },
          {
            "name": "DateINT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "1e89de60-88b4-419a-ac53-b956d0100f7e",
            "sourceColumn": "DateINT",
            "summarizeBy": "sum"
          },
          {
            "name": "DayOffset",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ca417ad6-6b2c-4e6a-88d1-070343228837",
            "sourceColumn": "DayOffset",
            "summarizeBy": "sum"
          },
          {
            "name": "IsAfterToday",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "f9e6a18d-89cf-4c31-98e7-fc2fd488a512",
            "sourceColumn": "IsAfterToday",
            "summarizeBy": "none"
          },
          {
            "name": "IsWeekDay",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "64356c94-e014-49de-b9f1-0364c40d6905",
            "sourceColumn": "IsWeekDay",
            "summarizeBy": "none"
          },
          {
            "name": "IsHoliday",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b9646227-8896-4e19-8ddd-3f1ca9039e31",
            "sourceColumn": "IsHoliday",
            "summarizeBy": "none"
          },
          {
            "name": "IsBusinessDay",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "4fffa9cd-f0b2-4d70-ae87-3997b91ac290",
            "sourceColumn": "IsBusinessDay",
            "summarizeBy": "none"
          },
          {
            "name": "Day Type",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "00554eb5-ff45-4202-be62-138eab7e1947",
            "sourceColumn": "Day Type",
            "summarizeBy": "none"
          },
          {
            "name": "ISO Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "81c6b690-a271-4c92-8a64-0fcbafdf88e9",
            "sourceColumn": "ISO Year",
            "summarizeBy": "sum"
          },
          {
            "name": "Academic Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7928a05f-172a-4b08-9639-fd8b3f02c21c",
            "sourceColumn": "Academic Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "ISO YearOFFSET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d8351614-acc8-4f0c-8b68-d7a07bb3633b",
            "sourceColumn": "ISO YearOFFSET",
            "summarizeBy": "sum"
          },
          {
            "name": "AcademicQuarterYearINT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "3ba73f34-d8ca-4935-85a0-d04ca9be99b2",
            "sourceColumn": "AcademicQuarterYearINT",
            "summarizeBy": "sum"
          },
          {
            "name": "ISO Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "04918f78-d2af-4312-970e-8fa579d01b32",
            "sourceColumn": "ISO Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "ISO Quarter & Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6f42aa30-4392-44a8-8e58-2bdf510ab3c7",
            "sourceColumn": "ISO Quarter & Year",
            "summarizeBy": "none"
          },
          {
            "name": "Academic Period",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ceb1c51f-71a4-4761-bfa5-7ab35874442c",
            "sourceColumn": "Academic Period",
            "summarizeBy": "none"
          },
          {
            "name": "ISO QuarterYearINT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e0fd5d8e-88ec-4e9d-9cee-cafed3cd289b",
            "sourceColumn": "ISO QuarterYearINT",
            "summarizeBy": "sum"
          },
          {
            "name": "AcademicPeriodYearINT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "7aff7347-dbaf-420b-83ff-b90956d09fc2",
            "sourceColumn": "AcademicPeriodYearINT",
            "summarizeBy": "sum"
          },
          {
            "name": "AYStartDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "c1d05fb8-eef3-4b95-ac34-89410001fbfe",
            "sourceColumn": "AYStartDate",
            "summarizeBy": "none"
          },
          {
            "name": "AYEndDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "b62263d8-0cc0-4da3-b3ec-324af0ef0a37",
            "sourceColumn": "AYEndDate",
            "summarizeBy": "none"
          },
          {
            "name": "FYStartDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "b9e77e6f-750c-43d1-b0da-c7eb8905f600",
            "sourceColumn": "FYStartDate",
            "summarizeBy": "none"
          },
          {
            "name": "FYEndDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "fccd39e4-7286-4cd7-a3aa-4c543f847d0e",
            "sourceColumn": "FYEndDate",
            "summarizeBy": "none"
          },
          {
            "name": "ISO QuarterOFFSET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "38d8459a-79b1-4f3a-a4fe-a2f00c84ebf1",
            "sourceColumn": "ISO QuarterOFFSET",
            "summarizeBy": "sum"
          },
          {
            "name": "FiscalYearOFFSET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "26cf92d7-7c9d-463e-a4a0-7e65943fe190",
            "sourceColumn": "FiscalYearOFFSET",
            "summarizeBy": "sum"
          },
          {
            "name": "FiscalQuarterOFFSET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "439f7ae7-dcdd-462e-91aa-fcc2600b9bc4",
            "sourceColumn": "FiscalQuarterOFFSET",
            "summarizeBy": "sum"
          },
          {
            "name": "Fiscal Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f9498580-5918-45fb-bcb6-6cb70fd48f28",
            "sourceColumn": "Fiscal Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "FiscalQuarterYearINT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2d4294b6-5fc3-4afd-9c9d-ac415b30527a",
            "sourceColumn": "FiscalQuarterYearINT",
            "summarizeBy": "sum"
          },
          {
            "name": "Fiscal Quarter Month Start",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "3dcef048-4cad-4d3c-aacd-5dc94178a2c2",
            "sourceColumn": "Fiscal Quarter Month Start",
            "summarizeBy": "none"
          },
          {
            "name": "Fiscal Quarter Month End",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "d50af1e5-491e-4f25-97e3-3fe82fe49091",
            "sourceColumn": "Fiscal Quarter Month End",
            "summarizeBy": "none"
          },
          {
            "name": "Fiscal Period",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "38178fab-dbf2-4ba1-b037-78db3ca92d23",
            "sourceColumn": "Fiscal Period",
            "summarizeBy": "none"
          },
          {
            "name": "FiscalPeriodYearINT",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a936ba46-80a1-4799-89ea-ce0655fed272",
            "sourceColumn": "FiscalPeriodYearINT",
            "summarizeBy": "sum"
          },
          {
            "name": "Fiscal Week Number",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2957e8e3-b425-456c-936c-d2534f8b5d7a",
            "sourceColumn": "Fiscal Week Number",
            "summarizeBy": "sum"
          },
          {
            "name": "Fiscal Week",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e1859c5e-c477-4113-b82e-cb58a6b3ab02",
            "sourceColumn": "Fiscal Week",
            "summarizeBy": "none"
          },
          {
            "name": "AcademicYearOFFSET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "02c4d8b3-1846-4bae-b78a-5cf9d6563af5",
            "sourceColumn": "AcademicYearOFFSET",
            "summarizeBy": "sum"
          },
          {
            "name": "IsCurrentAY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "d73ee371-81da-491e-a963-3f930554937d",
            "sourceColumn": "IsCurrentAY",
            "summarizeBy": "none"
          },
          {
            "name": "AcademicQuarterOFFSET",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0449ad2f-2a1e-45fa-b310-0fe294e68ea8",
            "sourceColumn": "AcademicQuarterOFFSET",
            "summarizeBy": "sum"
          },
          {
            "name": "IsCurrentAQ",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "fad8c723-aa53-4e7a-bc2e-38970708b1bd",
            "sourceColumn": "IsCurrentAQ",
            "summarizeBy": "none"
          },
          {
            "name": "Academic Quarter Month Start",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "339aed97-2efa-4c74-8baa-6d29fd029829",
            "sourceColumn": "Academic Quarter Month Start",
            "summarizeBy": "none"
          },
          {
            "name": "IsCurrentAP",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "5b6eff52-afd6-4079-8287-96a70f668bea",
            "sourceColumn": "IsCurrentAP",
            "summarizeBy": "none"
          },
          {
            "name": "Academic Quarter Month End",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "524edb15-7dc1-4116-bd60-32a729913a25",
            "sourceColumn": "Academic Quarter Month End",
            "summarizeBy": "none"
          },
          {
            "name": "IsCurrentFY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "840c029e-3f5e-4537-8d53-55a1f3524e04",
            "sourceColumn": "IsCurrentFY",
            "summarizeBy": "none"
          },
          {
            "name": "IsCurrentFQ",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "0615f59e-6b3c-4275-8abd-8bb1f1d97461",
            "sourceColumn": "IsCurrentFQ",
            "summarizeBy": "none"
          },
          {
            "name": "IsPreviousAY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "94f46f07-65d9-453b-9148-57b777e06ac3",
            "sourceColumn": "IsPreviousAY",
            "summarizeBy": "none"
          },
          {
            "name": "Relative Networkdays",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "5a19e060-543e-4e48-9a38-062ed08166d9",
            "sourceColumn": "Relative Networkdays",
            "summarizeBy": "sum"
          },
          {
            "name": "IsCurrentFP",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "ebc016d4-d1f6-419d-b4ec-3bc25d51f718",
            "sourceColumn": "IsCurrentFP",
            "summarizeBy": "none"
          },
          {
            "name": "IsCurrentFW",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "c3338cc8-f208-474f-8e5d-43890f2536b4",
            "sourceColumn": "IsCurrentFW",
            "summarizeBy": "none"
          },
          {
            "name": "IsPreviousYTD",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "967775f0-350e-4e52-babc-076ed212ea11",
            "sourceColumn": "IsPreviousYTD",
            "summarizeBy": "none"
          },
          {
            "name": "IsPreviousFY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "6eb25234-7169-4edc-af65-f56648f3aee7",
            "sourceColumn": "IsPreviousFY",
            "summarizeBy": "none"
          },
          {
            "name": "2W Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "46cf3647-e16a-4bfd-b614-0ad3641ed2e2",
            "sourceColumn": "2W Date",
            "summarizeBy": "none"
          },
          {
            "name": "2M Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "f967c16e-d661-43b3-9cda-5f06500410a5",
            "sourceColumn": "2M Date",
            "summarizeBy": "none"
          },
          {
            "name": "6M Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "a40bd276-d03f-4314-9363-aacab1352ef2",
            "sourceColumn": "6M Date",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "63a8bf36-74be-4220-8a24-a39dc312a1bd",
        "partitions": [
          {
            "name": "Dates_Haq",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    // https://github.com/OscarValerock/PowerQueryFunctions/blob/main/Functions/Date/fnDates.pq",
                "    Source = Dates_Haq_fn(2010, 2030, 4, 9, null, 1, true)",
                "in",
                "    Source"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Stock",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "product",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "54a6d9af-d5c6-438f-98af-e667fbe6283e",
            "sourceColumn": "product",
            "summarizeBy": "none"
          },
          {
            "name": "date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "e4b36685-75c6-45ca-b96e-a2118da21a83",
            "sourceColumn": "date",
            "summarizeBy": "none"
          },
          {
            "name": "qty",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "9a7c6093-1e33-4713-8ff3-9da513786cdd",
            "sourceColumn": "qty",
            "summarizeBy": "sum"
          },
          {
            "name": "Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "17d23716-c291-43b2-b736-3b80f82c8559",
            "sourceColumn": "Year",
            "summarizeBy": "none"
          },
          {
            "name": "Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "51efeabe-c8f5-40fc-91d0-83c4f9d21d81",
            "sourceColumn": "Quarter",
            "summarizeBy": "none"
          },
          {
            "name": "YQ",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "568f0b99-18cc-4773-a702-11d383c865c1",
            "sourceColumn": "YQ",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "2eeaf5a3-f5f6-4faf-90a5-db788eed26fb",
        "measures": [
          {
            "name": "Last quantity",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "CALCULATE(SUM('Stock'[qty]),LASTDATE('Stock'[date]))",
            "lineageTag": "2a81bdaa-9ea8-4803-a851-3f721bf81e78"
          }
        ],
        "partitions": [
          {
            "name": "Stock",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"PcvBCcAwDEPRXXQOqHbshM4SfGj3H6IlDr6Jx9daeNAgFKr9wxEtSalJo6izJ+mmd1fnOIuqEikzWtpd5PSTXYj4AA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [product = _t, date = _t, qty = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"product\", type text}, {\"date\", type date}, {\"qty\", Int64.Type}}),",
                "    #\"Inserted Year\" = Table.AddColumn(#\"Changed Type\", \"Year\", each Date.Year([date]), Int64.Type),",
                "    #\"Inserted Quarter\" = Table.AddColumn(#\"Inserted Year\", \"Quarter\",  each Date.QuarterOfYear([date]), Int64.Type),",
                "    #\"Inserted Merged Column\" = Table.AddColumn(#\"Inserted Quarter\", \"Merged\", each Text.Combine({\"Q\", Text.From([Quarter], \"en-GB\")}), type text),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Inserted Merged Column\",{\"Quarter\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Merged\", \"Quarter\"}}),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Renamed Columns\",{{\"Year\", type text}}),",
                "    #\"Inserted Merged Column1\" = Table.AddColumn(#\"Changed Type1\", \"Merged\", each Text.Combine({[Year], \" \", [Quarter]}), type text),",
                "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Inserted Merged Column1\",{{\"Merged\", \"YQ\"}})",
                "in",
                "    #\"Renamed Columns1\""
              ],
              "type": "m"
            }
          }
        ]
      }
    ]
  }
}